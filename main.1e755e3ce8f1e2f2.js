(self.webpackChunkdata_vis=self.webpackChunkdata_vis||[]).push([[179],{121:(Pi,po,G)=>{"use strict";var nt={};G.r(nt),G.d(nt,{JsonPatchError:()=>$t,_areEquals:()=>wg,applyOperation:()=>fc,applyPatch:()=>Yv,applyReducer:()=>phe,deepClone:()=>dhe,getValueByPointer:()=>Gv,validate:()=>s6,validator:()=>Xv});var ut={};G.r(ut),G.d(ut,{compare:()=>xhe,generate:()=>ES,observe:()=>whe,unobserve:()=>_he});var lt={};G.r(lt),G.d(lt,{aggregate:()=>Hu,bin:()=>oO,collect:()=>sO,compare:()=>U4,countpattern:()=>aO,cross:()=>uO,density:()=>lO,dotbin:()=>fO,expression:()=>X4,extent:()=>dO,facet:()=>M1,field:()=>Q4,filter:()=>pO,flatten:()=>gO,fold:()=>mO,formula:()=>yO,generate:()=>K4,impute:()=>vO,joinaggregate:()=>bO,kde:()=>_O,key:()=>Z4,load:()=>J4,lookup:()=>xO,multiextent:()=>ez,multivalues:()=>tz,params:()=>nz,pivot:()=>EO,prefacet:()=>rz,project:()=>DO,proxy:()=>iz,quantile:()=>CO,relay:()=>oz,sample:()=>SO,sequence:()=>AO,sieve:()=>sz,subflow:()=>hO,timeunit:()=>OO,tupleindex:()=>uz,values:()=>lz,window:()=>MO});var gt={};G.r(gt),G.d(gt,{interpolate:()=>Xu,interpolateArray:()=>Sye,interpolateBasis:()=>Xz,interpolateBasisClosed:()=>Qz,interpolateCubehelix:()=>pve,interpolateCubehelixLong:()=>gve,interpolateDate:()=>tU,interpolateDiscrete:()=>Kye,interpolateHcl:()=>fve,interpolateHclLong:()=>dve,interpolateHsl:()=>ave,interpolateHslLong:()=>uve,interpolateHue:()=>Zye,interpolateLab:()=>cve,interpolateNumber:()=>Io,interpolateNumberArray:()=>YO,interpolateObject:()=>nU,interpolateRgb:()=>GO,interpolateRgbBasis:()=>Dye,interpolateRgbBasisClosed:()=>Cye,interpolateRound:()=>Jg,interpolateString:()=>rU,interpolateTransformCss:()=>tve,interpolateTransformSvg:()=>nve,interpolateZoom:()=>sve,piecewise:()=>s2,quantize:()=>mve});var Oe={};G.r(Oe),G.d(Oe,{bound:()=>V7,identifier:()=>IM,mark:()=>W7,overlap:()=>G7,render:()=>J7,viewlayout:()=>oH});var qt={};G.r(qt),G.d(qt,{axisticks:()=>aH,datajoin:()=>uH,encode:()=>lH,legendentries:()=>cH,linkpath:()=>FM,pie:()=>RM,scale:()=>mH,sortitems:()=>bH,stack:()=>PM});var Ke={};G.r(Ke),G.d(Ke,{contour:()=>pT,geojson:()=>yT,geopath:()=>vT,geopoint:()=>bT,geoshape:()=>_T,graticule:()=>wT,heatmap:()=>xT,isocontour:()=>fT,kde2d:()=>hT,projection:()=>NV});var ci={};G.r(ci),G.d(ci,{force:()=>OT});var fi={};G.r(fi),G.d(fi,{nest:()=>NT,pack:()=>LT,partition:()=>$T,stratify:()=>BT,tree:()=>UT,treelinks:()=>HT,treemap:()=>qT});var Ye={};G.r(Ye),G.d(Ye,{label:()=>JT});var Re={};G.r(Re),G.d(Re,{loess:()=>ek,regression:()=>nk});var In={};G.r(In),G.d(In,{voronoi:()=>ak});var Li={};G.r(Li),G.d(Li,{wordcloud:()=>lk});var go={};G.r(go),G.d(go,{crossfilter:()=>ck,resolvefilter:()=>fk});var us={};G.r(us),G.d(us,{Bounds:()=>mn,CanvasHandler:()=>wm,CanvasRenderer:()=>Ob,DATE:()=>Yr,DAY:()=>ir,DAYOFYEAR:()=>Ss,Dataflow:()=>qd,Debug:()=>c6,Error:()=>SS,EventStream:()=>w1,Gradient:()=>y9,GroupItem:()=>ab,HOURS:()=>Ei,Handler:()=>il,Info:()=>l6,Item:()=>sb,MILLISECONDS:()=>ko,MINUTES:()=>Di,MONTH:()=>rr,Marks:()=>Si,MultiPulse:()=>RA,None:()=>u6,Operator:()=>vt,Parameters:()=>_1,Pulse:()=>Uu,QUARTER:()=>Gr,RenderType:()=>sl,Renderer:()=>js,ResourceLoader:()=>P2,SECONDS:()=>Qi,SVGHandler:()=>fM,SVGRenderer:()=>vM,SVGStringRenderer:()=>wM,Scenegraph:()=>sM,TIME_UNITS:()=>iA,Transform:()=>k,View:()=>HW,WEEK:()=>pn,Warn:()=>AS,YEAR:()=>Ln,accessor:()=>Vr,accessorFields:()=>Jn,accessorName:()=>Bt,array:()=>X,ascending:()=>e1,bandwidthNRD:()=>UA,bin:()=>E4,bootstrapCI:()=>D4,boundClip:()=>N7,boundContext:()=>dm,boundItem:()=>oM,boundMark:()=>Q9,boundStroke:()=>Ba,changeset:()=>yc,clampRange:()=>x6,codegenExpression:()=>Bq,compare:()=>IS,constant:()=>nr,cumulativeLogNormal:()=>YA,cumulativeNormal:()=>C1,cumulativeUniform:()=>ZA,dayofyear:()=>oB,debounce:()=>FS,defaultLocale:()=>_A,definition:()=>m4,densityLogNormal:()=>GA,densityNormal:()=>HA,densityUniform:()=>KA,domChild:()=>Qr,domClear:()=>Po,domCreate:()=>rl,domFind:()=>aM,dotbin:()=>C4,error:()=>F,expressionFunction:()=>on,extend:()=>Ee,extent:()=>Cs,extentIndex:()=>E6,falsy:()=>Tu,fastmap:()=>kd,field:()=>qr,flush:()=>D6,font:()=>bb,fontFamily:()=>ym,fontSize:()=>Ls,format:()=>h1,formatLocale:()=>f1,formats:()=>OA,hasOwnProperty:()=>ne,id:()=>xg,identity:()=>er,inferType:()=>ZB,inferTypes:()=>JB,ingest:()=>it,inherits:()=>z,inrange:()=>Id,interpolate:()=>D2,interpolateColors:()=>tb,interpolateRange:()=>e9,intersect:()=>k7,intersectBoxLine:()=>uh,intersectPath:()=>H2,intersectPoint:()=>V2,intersectRule:()=>N9,isArray:()=>R,isBoolean:()=>ku,isDate:()=>Iu,isFunction:()=>xe,isIterable:()=>C6,isNumber:()=>ft,isObject:()=>J,isRegExp:()=>S6,isString:()=>Y,isTuple:()=>y1,key:()=>RS,lerp:()=>A6,lineHeight:()=>tl,loader:()=>p1,locale:()=>XB,logger:()=>OS,lruCache:()=>O6,markup:()=>yM,merge:()=>M6,mergeConfig:()=>Md,multiLineOffset:()=>nM,one:()=>Od,pad:()=>T6,panLinear:()=>m6,panLog:()=>y6,panPow:()=>v6,panSymlog:()=>b6,parse:()=>Zke,parseExpression:()=>_k,parseSelector:()=>ml,pathCurves:()=>T2,pathEqual:()=>P7,pathParse:()=>oh,pathRectangle:()=>D9,pathRender:()=>am,pathSymbols:()=>E9,pathTrail:()=>C9,peek:()=>je,point:()=>wb,projection:()=>cT,quantileLogNormal:()=>XA,quantileNormal:()=>S1,quantileUniform:()=>JA,quantiles:()=>BA,quantizeInterpolator:()=>t9,quarter:()=>_6,quartiles:()=>zA,random:()=>Ki,randomInteger:()=>kme,randomKDE:()=>qA,randomLCG:()=>Tme,randomLogNormal:()=>A4,randomMixture:()=>O4,randomNormal:()=>VA,randomUniform:()=>M4,read:()=>r4,regressionExp:()=>k4,regressionLinear:()=>eO,regressionLoess:()=>P4,regressionLog:()=>T4,regressionPoly:()=>F4,regressionPow:()=>I4,regressionQuad:()=>tO,renderModule:()=>Tb,repeat:()=>Eg,resetDefaultLocale:()=>Dge,resetSVGClipId:()=>A9,resetSVGDefIds:()=>p_e,responseType:()=>n4,runtimeContext:()=>EW,sampleCurve:()=>O1,sampleLogNormal:()=>WA,sampleNormal:()=>D1,sampleUniform:()=>QA,scale:()=>Je,sceneEqual:()=>EM,sceneFromJSON:()=>Z9,scenePickVisit:()=>pb,sceneToJSON:()=>K9,sceneVisit:()=>No,sceneZOrder:()=>q2,scheme:()=>C2,serializeXML:()=>_7,setRandom:()=>Ome,span:()=>Dg,splitAccessPath:()=>Ds,stringValue:()=>H,textMetrics:()=>Ps,timeBin:()=>DB,timeFloor:()=>dB,timeFormatLocale:()=>jg,timeInterval:()=>zd,timeOffset:()=>gB,timeSequence:()=>vB,timeUnitSpecifier:()=>iB,timeUnits:()=>sA,toBoolean:()=>NS,toDate:()=>PS,toNumber:()=>tr,toSet:()=>To,toString:()=>LS,transform:()=>y4,transforms:()=>Wd,truncate:()=>k6,truthy:()=>Yi,tupleid:()=>oe,typeParsers:()=>CA,utcFloor:()=>hB,utcInterval:()=>Ud,utcOffset:()=>mB,utcSequence:()=>bB,utcdayofyear:()=>uB,utcquarter:()=>w6,utcweek:()=>lB,version:()=>mIe,visitArray:()=>Fu,week:()=>sB,writeConfig:()=>Td,zero:()=>Mu,zoomLinear:()=>MS,zoomLog:()=>TS,zoomPow:()=>Jv,zoomSymlog:()=>kS});var Wn={};G.r(Wn),G.d(Wn,{accessPathDepth:()=>Lh,accessPathWithDatum:()=>RI,compile:()=>s5e,contains:()=>Be,deepEqual:()=>qs,deleteNestedProperty:()=>hw,duplicate:()=>we,entries:()=>vl,every:()=>TI,fieldIntersection:()=>FI,flatAccessWithDatum:()=>QG,getFirstDefined:()=>sn,hasIntersection:()=>kI,hash:()=>$e,internalField:()=>JG,isBoolean:()=>w0,isEmpty:()=>ht,isEqual:()=>RIe,isInternalField:()=>eY,isNullOrFalse:()=>MI,isNumeric:()=>pw,keys:()=>P,logicalExpr:()=>x0,mergeDeep:()=>YG,never:()=>GG,normalize:()=>OQ,normalizeAngle:()=>D0,omit:()=>ki,pick:()=>Ph,prefixGenerator:()=>II,removePathFromField:()=>NI,replaceAll:()=>Qc,replacePathInField:()=>ao,resetIdCounter:()=>PIe,setEqual:()=>XG,some:()=>Xc,stringify:()=>Et,titleCase:()=>E0,unique:()=>Ws,uniqueId:()=>ZG,vals:()=>fr,varName:()=>kt,version:()=>l5e});var ls={};function Pe(e){return"function"==typeof e}function me(e){const n=e(r=>{Error.call(r),r.stack=(new Error).stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}G.r(ls),G.d(ls,{dark:()=>M5e,excel:()=>T5e,fivethirtyeight:()=>F5e,ggplot2:()=>R5e,googlecharts:()=>W5e,latimes:()=>j5e,quartz:()=>$5e,urbaninstitute:()=>q5e,version:()=>G5e,vox:()=>B5e});const Wt=me(e=>function(n){e(this),this.message=n?`${n.length} errors occurred during unsubscription:\n${n.map((r,i)=>`${i+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=n});function rt(e,t){if(e){const n=e.indexOf(t);0<=n&&e.splice(n,1)}}class Jt{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._teardowns=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(const o of n)o.remove(this);else n.remove(this);const{initialTeardown:r}=this;if(Pe(r))try{r()}catch(o){t=o instanceof Wt?o.errors:[o]}const{_teardowns:i}=this;if(i){this._teardowns=null;for(const o of i)try{Sf(o)}catch(s){t=null!=t?t:[],s instanceof Wt?t=[...t,...s.errors]:t.push(s)}}if(t)throw new Wt(t)}}add(t){var n;if(t&&t!==this)if(this.closed)Sf(t);else{if(t instanceof Jt){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._teardowns=null!==(n=this._teardowns)&&void 0!==n?n:[]).push(t)}}_hasParent(t){const{_parentage:n}=this;return n===t||Array.isArray(n)&&n.includes(t)}_addParent(t){const{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t}_removeParent(t){const{_parentage:n}=this;n===t?this._parentage=null:Array.isArray(n)&&rt(n,t)}remove(t){const{_teardowns:n}=this;n&&rt(n,t),t instanceof Jt&&t._removeParent(this)}}Jt.EMPTY=(()=>{const e=new Jt;return e.closed=!0,e})();const Ul=Jt.EMPTY;function Br(e){return e instanceof Jt||e&&"closed"in e&&Pe(e.remove)&&Pe(e.add)&&Pe(e.unsubscribe)}function Sf(e){Pe(e)?e():e.unsubscribe()}const cs={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},pa={setTimeout(...e){const{delegate:t}=pa;return((null==t?void 0:t.setTimeout)||setTimeout)(...e)},clearTimeout(e){const{delegate:t}=pa;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function ga(e){pa.setTimeout(()=>{const{onUnhandledError:t}=cs;if(!t)throw e;t(e)})}function Hl(){}const Af=ma("C",void 0,void 0);function ma(e,t,n){return{kind:e,value:t,error:n}}let ya=null;function sy(e){if(cs.useDeprecatedSynchronousErrorHandling){const t=!ya;if(t&&(ya={errorThrown:!1,error:null}),e(),t){const{errorThrown:n,error:r}=ya;if(ya=null,n)throw r}}else e()}class Vx extends Jt{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,Br(t)&&t.add(this)):this.destination=cJ}static create(t,n,r){return new qx(t,n,r)}next(t){this.isStopped?Gx(ma("N",t,void 0),this):this._next(t)}error(t){this.isStopped?Gx(ma("E",void 0,t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?Gx(Af,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}class qx extends Vx{constructor(t,n,r){let i;if(super(),Pe(t))i=t;else if(t){let o;({next:i,error:n,complete:r}=t),this&&cs.useDeprecatedNextContext?(o=Object.create(t),o.unsubscribe=()=>this.unsubscribe()):o=t,i=null==i?void 0:i.bind(o),n=null==n?void 0:n.bind(o),r=null==r?void 0:r.bind(o)}this.destination={next:i?Wx(i):Hl,error:Wx(null!=n?n:aN),complete:r?Wx(r):Hl}}}function Wx(e,t){return(...n)=>{try{e(...n)}catch(r){cs.useDeprecatedSynchronousErrorHandling?function(e){cs.useDeprecatedSynchronousErrorHandling&&ya&&(ya.errorThrown=!0,ya.error=e)}(r):ga(r)}}}function aN(e){throw e}function Gx(e,t){const{onStoppedNotification:n}=cs;n&&pa.setTimeout(()=>n(e,t))}const cJ={closed:!0,next:Hl,error:aN,complete:Hl},Yx="function"==typeof Symbol&&Symbol.observable||"@@observable";function Wl(e){return e}let Nt=(()=>{class e{constructor(n){n&&(this._subscribe=n)}lift(n){const r=new e;return r.source=this,r.operator=n,r}subscribe(n,r,i){const o=function(e){return e&&e instanceof Vx||function(e){return e&&Pe(e.next)&&Pe(e.error)&&Pe(e.complete)}(e)&&Br(e)}(n)?n:new qx(n,r,i);return sy(()=>{const{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return new(r=lN(r))((i,o)=>{let s;s=this.subscribe(a=>{try{n(a)}catch(u){o(u),null==s||s.unsubscribe()}},o,i)})}_subscribe(n){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(n)}[Yx](){return this}pipe(...n){return function(e){return 0===e.length?Wl:1===e.length?e[0]:function(n){return e.reduce((r,i)=>i(r),n)}}(n)(this)}toPromise(n){return new(n=lN(n))((r,i)=>{let o;this.subscribe(s=>o=s,s=>i(s),()=>r(o))})}}return e.create=t=>new e(t),e})();function lN(e){var t;return null!==(t=null!=e?e:cs.Promise)&&void 0!==t?t:Promise}const hJ=me(e=>function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let va=(()=>{class e extends Nt{constructor(){super(),this.closed=!1,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){const r=new cN(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new hJ}next(n){sy(()=>{if(this._throwIfClosed(),!this.isStopped){const r=this.observers.slice();for(const i of r)i.next(n)}})}error(n){sy(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;const{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){sy(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=null}get observed(){var n;return(null===(n=this.observers)||void 0===n?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){const{hasError:r,isStopped:i,observers:o}=this;return r||i?Ul:(o.push(n),new Jt(()=>rt(o,n)))}_checkFinalizedStatuses(n){const{hasError:r,thrownError:i,isStopped:o}=this;r?n.error(i):o&&n.complete()}asObservable(){const n=new Nt;return n.source=this,n}}return e.create=(t,n)=>new cN(t,n),e})();class cN extends va{constructor(t,n){super(),this.destination=t,this.source=n}next(t){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.next)||void 0===r||r.call(n,t)}error(t){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.error)||void 0===r||r.call(n,t)}complete(){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===n||n.call(t)}_subscribe(t){var n,r;return null!==(r=null===(n=this.source)||void 0===n?void 0:n.subscribe(t))&&void 0!==r?r:Ul}}function fN(e){return Pe(null==e?void 0:e.lift)}function Fn(e){return t=>{if(fN(t))return t.lift(function(n){try{return e(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}class Rn extends Vx{constructor(t,n,r,i,o){super(t),this.onFinalize=o,this._next=n?function(s){try{n(s)}catch(a){t.error(a)}}:super._next,this._error=i?function(s){try{i(s)}catch(a){t.error(a)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(s){t.error(s)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;const{closed:n}=this;super.unsubscribe(),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}function Ct(e,t){return Fn((n,r)=>{let i=0;n.subscribe(new Rn(r,o=>{r.next(e.call(t,o,i++))}))})}function Gl(e){return this instanceof Gl?(this.v=e,this):new Gl(e)}function mJ(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(e,t||[]),o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(d){r[d]&&(i[d]=function(h){return new Promise(function(p,g){o.push([d,h,p,g])>1||a(d,h)})})}function a(d,h){try{!function(d){d.value instanceof Gl?Promise.resolve(d.value.v).then(l,c):f(o[0][2],d)}(r[d](h))}catch(p){f(o[0][3],p)}}function l(d){a("next",d)}function c(d){a("throw",d)}function f(d,h){d(h),o.shift(),o.length&&a(o[0][0],o[0][1])}}function yJ(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,t=e[Symbol.asyncIterator];return t?t.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=e[o]&&function(s){return new Promise(function(a,u){!function(o,s,a,u){Promise.resolve(u).then(function(l){o({value:l,done:a})},s)}(a,u,(s=e[o](s)).done,s.value)})}}}const gN=e=>e&&"number"==typeof e.length&&"function"!=typeof e;function mN(e){return Pe(null==e?void 0:e.then)}function yN(e){return Pe(e[Yx])}function vN(e){return Symbol.asyncIterator&&Pe(null==e?void 0:e[Symbol.asyncIterator])}function bN(e){return new TypeError(`You provided ${null!==e&&"object"==typeof e?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const _N="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function wN(e){return Pe(null==e?void 0:e[_N])}function xN(e){return mJ(this,arguments,function*(){const n=e.getReader();try{for(;;){const{value:r,done:i}=yield Gl(n.read());if(i)return yield Gl(void 0);yield yield Gl(r)}}finally{n.releaseLock()}})}function EN(e){return Pe(null==e?void 0:e.getReader)}function ba(e){if(e instanceof Nt)return e;if(null!=e){if(yN(e))return function(e){return new Nt(t=>{const n=e[Yx]();if(Pe(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(gN(e))return function(e){return new Nt(t=>{for(let n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}(e);if(mN(e))return function(e){return new Nt(t=>{e.then(n=>{t.closed||(t.next(n),t.complete())},n=>t.error(n)).then(null,ga)})}(e);if(vN(e))return DN(e);if(wN(e))return function(e){return new Nt(t=>{for(const n of e)if(t.next(n),t.closed)return;t.complete()})}(e);if(EN(e))return function(e){return DN(xN(e))}(e)}throw bN(e)}function DN(e){return new Nt(t=>{(function(e,t){var n,r,i,o;return function(e,t,n,r){return new(n||(n=Promise))(function(o,s){function a(c){try{l(r.next(c))}catch(f){s(f)}}function u(c){try{l(r.throw(c))}catch(f){s(f)}}function l(c){c.done?o(c.value):function(o){return o instanceof n?o:new n(function(s){s(o)})}(c.value).then(a,u)}l((r=r.apply(e,t||[])).next())})}(this,void 0,void 0,function*(){try{for(n=yJ(e);!(r=yield n.next()).done;)if(t.next(r.value),t.closed)return}catch(s){i={error:s}}finally{try{r&&!r.done&&(o=n.return)&&(yield o.call(n))}finally{if(i)throw i.error}}t.complete()})})(e,t).catch(n=>t.error(n))})}function _a(e,t,n,r=0,i=!1){const o=t.schedule(function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(o),!i)return o}function _n(e,t,n=1/0){return Pe(t)?_n((r,i)=>Ct((o,s)=>t(r,o,i,s))(ba(e(r,i))),n):("number"==typeof t&&(n=t),Fn((r,i)=>function(e,t,n,r,i,o,s,a){const u=[];let l=0,c=0,f=!1;const d=()=>{f&&!u.length&&!l&&t.complete()},h=g=>l<r?p(g):u.push(g),p=g=>{l++;let m=!1;ba(n(g,c++)).subscribe(new Rn(t,v=>{t.next(v)},()=>{m=!0},void 0,()=>{if(m)try{for(l--;u.length&&l<r;){const v=u.shift();p(v)}d()}catch(v){t.error(v)}}))};return e.subscribe(new Rn(t,h,()=>{f=!0,d()})),()=>{}}(r,i,e,n)))}function gp(e=1/0){return _n(Wl,e)}const wa=new Nt(e=>e.complete());function Qx(e){return e[e.length-1]}function mp(e){return function(e){return e&&Pe(e.schedule)}(Qx(e))?e.pop():void 0}function CN(e,t=0){return Fn((n,r)=>{n.subscribe(new Rn(r,i=>_a(r,e,()=>r.next(i),t),()=>_a(r,e,()=>r.complete(),t),i=>_a(r,e,()=>r.error(i),t)))})}function SN(e,t=0){return Fn((n,r)=>{r.add(e.schedule(()=>n.subscribe(r),t))})}function AN(e,t){if(!e)throw new Error("Iterable cannot be null");return new Nt(n=>{_a(n,t,()=>{const r=e[Symbol.asyncIterator]();_a(n,t,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function Nn(e,t){return t?function(e,t){if(null!=e){if(yN(e))return function(e,t){return ba(e).pipe(SN(t),CN(t))}(e,t);if(gN(e))return function(e,t){return new Nt(n=>{let r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}(e,t);if(mN(e))return function(e,t){return ba(e).pipe(SN(t),CN(t))}(e,t);if(vN(e))return AN(e,t);if(wN(e))return function(e,t){return new Nt(n=>{let r;return _a(n,t,()=>{r=e[_N](),_a(n,t,()=>{let i,o;try{({value:i,done:o}=r.next())}catch(s){return void n.error(s)}o?n.complete():n.next(i)},0,!0)}),()=>Pe(null==r?void 0:r.return)&&r.return()})}(e,t);if(EN(e))return function(e,t){return AN(xN(e),t)}(e,t)}throw bN(e)}(e,t):ba(e)}function ay(e){return e<=0?()=>wa:Fn((t,n)=>{let r=0;t.subscribe(new Rn(n,i=>{++r<=e&&(n.next(i),e<=r&&n.complete())}))})}function Kx(e,t,...n){return!0===t?(e(),null):!1===t?null:t(...n).pipe(ay(1)).subscribe(()=>e())}function mt(e){for(let t in e)if(e[t]===mt)return t;throw Error("Could not find renamed property on target object.")}function Ue(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(Ue).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;const t=e.toString();if(null==t)return""+t;const n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function Jx(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}const $J=mt({__forward_ref__:mt});function eE(e){return e.__forward_ref__=eE,e.toString=function(){return Ue(this())},e}function De(e){return function(e){return"function"==typeof e&&e.hasOwnProperty($J)&&e.__forward_ref__===eE}(e)?e():e}class di extends Error{constructor(t,n){super(function(e,t){return`${e?`NG0${e}: `:""}${t}`}(t,n)),this.code=t}}function mr(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():function(e){return"string"==typeof e?e:null==e?"":String(e)}(e)}function uy(e,t){const n=t?` in ${t}`:"";throw new di("201",`No provider for ${mr(e)} found${n}`)}function pi(e,t){null==e&&function(e,t,n,r){throw new Error(`ASSERTION ERROR: ${e}`+(null==r?"":` [Expected=> ${n} ${r} ${t} <=Actual]`))}(t,e,null,"!=")}function Xe(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function hu(e){return{providers:e.providers||[],imports:e.imports||[]}}function nE(e){return MN(e,ly)||MN(e,kN)}function MN(e,t){return e.hasOwnProperty(t)?e[t]:null}function TN(e){return e&&(e.hasOwnProperty(rE)||e.hasOwnProperty(WJ))?e[rE]:null}const ly=mt({\u0275prov:mt}),rE=mt({\u0275inj:mt}),kN=mt({ngInjectableDef:mt}),WJ=mt({ngInjectorDef:mt});var _e=(()=>((_e=_e||{})[_e.Default=0]="Default",_e[_e.Host=1]="Host",_e[_e.Self=2]="Self",_e[_e.SkipSelf=4]="SkipSelf",_e[_e.Optional=8]="Optional",_e))();let iE;function pu(e){const t=iE;return iE=e,t}function IN(e,t,n){const r=nE(e);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&_e.Optional?null:void 0!==t?t:void uy(Ue(e),"Injector")}function gu(e){return{toString:e}.toString()}var mo=(()=>((mo=mo||{})[mo.OnPush=0]="OnPush",mo[mo.Default=1]="Default",mo))(),fs=(()=>{return(e=fs||(fs={}))[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",fs;var e})();const YJ="undefined"!=typeof globalThis&&globalThis,XJ="undefined"!=typeof window&&window,QJ="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,ct=YJ||"undefined"!=typeof global&&global||XJ||QJ,Of={},yt=[],cy=mt({\u0275cmp:mt}),oE=mt({\u0275dir:mt}),sE=mt({\u0275pipe:mt}),FN=mt({\u0275mod:mt}),Ea=mt({\u0275fac:mt}),yp=mt({__NG_ELEMENT_ID__:mt});let KJ=0;function fy(e){return gu(()=>{const n={},r={type:e.type,providersResolver:null,decls:e.decls,vars:e.vars,factory:null,template:e.template||null,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:n,inputs:null,outputs:null,exportAs:e.exportAs||null,onPush:e.changeDetection===mo.OnPush,directiveDefs:null,pipeDefs:null,selectors:e.selectors||yt,viewQuery:e.viewQuery||null,features:e.features||null,data:e.data||{},encapsulation:e.encapsulation||fs.Emulated,id:"c",styles:e.styles||yt,_:null,setInput:null,schemas:e.schemas||null,tView:null},i=e.directives,o=e.features,s=e.pipes;return r.id+=KJ++,r.inputs=LN(e.inputs,n),r.outputs=LN(e.outputs),o&&o.forEach(a=>a(r)),r.directiveDefs=i?()=>("function"==typeof i?i():i).map(RN):null,r.pipeDefs=s?()=>("function"==typeof s?s():s).map(NN):null,r})}function RN(e){return Yn(e)||function(e){return e[oE]||null}(e)}function NN(e){return function(e){return e[sE]||null}(e)}const PN={};function Yl(e){return gu(()=>{const t={type:e.type,bootstrap:e.bootstrap||yt,declarations:e.declarations||yt,imports:e.imports||yt,exports:e.exports||yt,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null};return null!=e.id&&(PN[e.id]=e.type),t})}function LN(e,t){if(null==e)return Of;const n={};for(const r in e)if(e.hasOwnProperty(r)){let i=e[r],o=i;Array.isArray(i)&&(o=i[1],i=i[0]),n[i]=r,t&&(t[i]=o)}return n}const Gn=fy;function Yn(e){return e[cy]||null}function ji(e,t){const n=e[FN]||null;if(!n&&!0===t)throw new Error(`Type ${Ue(e)} does not have '\u0275mod' property.`);return n}function ds(e){return Array.isArray(e)&&"object"==typeof e[1]}function vo(e){return Array.isArray(e)&&!0===e[1]}function lE(e){return 0!=(8&e.flags)}function gy(e){return 2==(2&e.flags)}function bo(e){return null!==e.template}function ree(e){return 0!=(512&e[2])}function Jl(e,t){return e.hasOwnProperty(Ea)?e[Ea]:null}class see{constructor(t,n,r){this.previousValue=t,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}}function $N(e){return e.type.prototype.ngOnChanges&&(e.setInput=uee),aee}function aee(){const e=zN(this),t=null==e?void 0:e.current;if(t){const n=e.previous;if(n===Of)e.previous=t;else for(let r in t)n[r]=t[r];e.current=null,this.ngOnChanges(t)}}function uee(e,t,n,r){const i=zN(e)||function(e,t){return e[BN]=t}(e,{previous:Of,current:null}),o=i.current||(i.current={}),s=i.previous,a=this.declaredInputs[n],u=s[a];o[a]=new see(u&&u.currentValue,t,s===Of),e[r]=t}const BN="__ngSimpleChanges__";function zN(e){return e[BN]||null}let dE;function Pt(e){return!!e.listen}const VN={createRenderer:(e,t)=>void 0!==dE?dE:"undefined"!=typeof document?document:void 0};function en(e){for(;Array.isArray(e);)e=e[0];return e}function zi(e,t){return en(t[e.index])}function mi(e,t){const n=t[e];return ds(n)?n:n[0]}function gE(e){return 128==(128&e[2])}function yu(e,t){return null==t?null:e[t]}function WN(e){e[18]=0}function mE(e,t){e[5]+=t;let n=e,r=e[3];for(;null!==r&&(1===t&&1===n[5]||-1===t&&0===n[5]);)r[5]+=t,n=r,r=r[3]}const ge={lFrame:eP(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function GN(){return ge.bindingsEnabled}function j(){return ge.lFrame.lView}function He(){return ge.lFrame.tView}function ln(){let e=YN();for(;null!==e&&64===e.type;)e=e.parent;return e}function YN(){return ge.lFrame.currentTNode}function hs(e,t){const n=ge.lFrame;n.currentTNode=e,n.isParent=t}function yE(){return ge.lFrame.isParent}function vy(){return ge.isInCheckNoChangesMode}function by(e){ge.isInCheckNoChangesMode=e}function Dee(e,t){const n=ge.lFrame;n.bindingIndex=n.bindingRootIndex=e,bE(t)}function bE(e){ge.lFrame.currentDirectiveIndex=e}function wE(e){ge.lFrame.currentQueryIndex=e}function See(e){const t=e[1];return 2===t.type?t.declTNode:1===t.type?e[6]:null}function ZN(e,t,n){if(n&_e.SkipSelf){let i=t,o=e;for(;!(i=i.parent,null!==i||n&_e.Host||(i=See(o),null===i||(o=o[15],10&i.type))););if(null===i)return!1;t=i,e=o}const r=ge.lFrame=JN();return r.currentTNode=t,r.lView=e,!0}function _y(e){const t=JN(),n=e[1];ge.lFrame=t,t.currentTNode=n.firstChild,t.lView=e,t.tView=n,t.contextLView=e,t.bindingIndex=n.bindingStartIndex,t.inI18n=!1}function JN(){const e=ge.lFrame,t=null===e?null:e.child;return null===t?eP(e):t}function eP(e){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function tP(){const e=ge.lFrame;return ge.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}const nP=tP;function wy(){const e=tP();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function vu(e){ge.lFrame.selectedIndex=e}function xy(e,t){for(let n=t.directiveStart,r=t.directiveEnd;n<r;n++){const o=e.data[n].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:u,ngAfterViewChecked:l,ngOnDestroy:c}=o;s&&(e.contentHooks||(e.contentHooks=[])).push(-n,s),a&&((e.contentHooks||(e.contentHooks=[])).push(n,a),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(n,a)),u&&(e.viewHooks||(e.viewHooks=[])).push(-n,u),l&&((e.viewHooks||(e.viewHooks=[])).push(n,l),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(n,l)),null!=c&&(e.destroyHooks||(e.destroyHooks=[])).push(n,c)}}function Ey(e,t,n){rP(e,t,3,n)}function Dy(e,t,n,r){(3&e[2])===n&&rP(e,t,n,r)}function xE(e,t){let n=e[2];(3&n)===t&&(n&=2047,n+=1,e[2]=n)}function rP(e,t,n,r){const o=null!=r?r:-1,s=t.length-1;let a=0;for(let u=void 0!==r?65535&e[18]:0;u<s;u++)if("number"==typeof t[u+1]){if(a=t[u],null!=r&&a>=r)break}else t[u]<0&&(e[18]+=65536),(a<o||-1==o)&&(Nee(e,n,t,u),e[18]=(4294901760&e[18])+u+2),u++}function Nee(e,t,n,r){const i=n[r]<0,o=n[r+1],a=e[i?-n[r]:n[r]];if(i){if(e[2]>>11<e[18]>>16&&(3&e[2])===t){e[2]+=2048;try{o.call(a)}finally{}}}else try{o.call(a)}finally{}}class xp{constructor(t,n,r){this.factory=t,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}}function Cy(e,t,n){const r=Pt(e);let i=0;for(;i<n.length;){const o=n[i];if("number"==typeof o){if(0!==o)break;i++;const s=n[i++],a=n[i++],u=n[i++];r?e.setAttribute(t,a,u,s):t.setAttributeNS(s,a,u)}else{const s=o,a=n[++i];DE(s)?r&&e.setProperty(t,s,a):r?e.setAttribute(t,s,a):t.setAttribute(s,a),i++}}return i}function iP(e){return 3===e||4===e||6===e}function DE(e){return 64===e.charCodeAt(0)}function Sy(e,t){if(null!==t&&0!==t.length)if(null===e||0===e.length)e=t.slice();else{let n=-1;for(let r=0;r<t.length;r++){const i=t[r];"number"==typeof i?n=i:0===n||oP(e,n,i,null,-1===n||2===n?t[++r]:null)}}return e}function oP(e,t,n,r,i){let o=0,s=e.length;if(-1===t)s=-1;else for(;o<e.length;){const a=e[o++];if("number"==typeof a){if(a===t){s=-1;break}if(a>t){s=o-1;break}}}for(;o<e.length;){const a=e[o];if("number"==typeof a)break;if(a===n){if(null===r)return void(null!==i&&(e[o+1]=i));if(r===e[o+1])return void(e[o+2]=i)}o++,null!==r&&o++,null!==i&&o++}-1!==s&&(e.splice(s,0,t),o=s+1),e.splice(o++,0,n),null!==r&&e.splice(o++,0,r),null!==i&&e.splice(o++,0,i)}function sP(e){return-1!==e}function Nf(e){return 32767&e}function Pf(e,t){let n=function(e){return e>>16}(e),r=t;for(;n>0;)r=r[15],n--;return r}let CE=!0;function Ay(e){const t=CE;return CE=e,t}let zee=0;function Dp(e,t){const n=AE(e,t);if(-1!==n)return n;const r=t[1];r.firstCreatePass&&(e.injectorIndex=t.length,SE(r.data,e),SE(t,null),SE(r.blueprint,null));const i=Oy(e,t),o=e.injectorIndex;if(sP(i)){const s=Nf(i),a=Pf(i,t),u=a[1].data;for(let l=0;l<8;l++)t[o+l]=a[s+l]|u[s+l]}return t[o+8]=i,o}function SE(e,t){e.push(0,0,0,0,0,0,0,0,t)}function AE(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function Oy(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let n=0,r=null,i=t;for(;null!==i;){const o=i[1],s=o.type;if(r=2===s?o.declTNode:1===s?i[6]:null,null===r)return-1;if(n++,i=i[15],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return-1}function My(e,t,n){!function(e,t,n){let r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(yp)&&(r=n[yp]),null==r&&(r=n[yp]=zee++);const i=255&r;t.data[e+(i>>5)]|=1<<i}(e,t,n)}function lP(e,t,n){if(n&_e.Optional)return e;uy(t,"NodeInjector")}function cP(e,t,n,r){if(n&_e.Optional&&void 0===r&&(r=null),0==(n&(_e.Self|_e.Host))){const i=e[9],o=pu(void 0);try{return i?i.get(t,r,n&_e.Optional):IN(t,r,n&_e.Optional)}finally{pu(o)}}return lP(r,t,n)}function fP(e,t,n,r=_e.Default,i){if(null!==e){const o=function(e){if("string"==typeof e)return e.charCodeAt(0)||0;const t=e.hasOwnProperty(yp)?e[yp]:void 0;return"number"==typeof t?t>=0?255&t:Vee:t}(n);if("function"==typeof o){if(!ZN(t,e,r))return r&_e.Host?lP(i,n,r):cP(t,n,r,i);try{const s=o(r);if(null!=s||r&_e.Optional)return s;uy(n)}finally{nP()}}else if("number"==typeof o){let s=null,a=AE(e,t),u=-1,l=r&_e.Host?t[16][6]:null;for((-1===a||r&_e.SkipSelf)&&(u=-1===a?Oy(e,t):t[a+8],-1!==u&&pP(r,!1)?(s=t[1],a=Nf(u),t=Pf(u,t)):a=-1);-1!==a;){const c=t[1];if(hP(o,a,c.data)){const f=qee(a,t,n,s,r,l);if(f!==dP)return f}u=t[a+8],-1!==u&&pP(r,t[1].data[a+8]===l)&&hP(o,a,t)?(s=c,a=Nf(u),t=Pf(u,t)):a=-1}}}return cP(t,n,r,i)}const dP={};function Vee(){return new Lf(ln(),j())}function qee(e,t,n,r,i,o){const s=t[1],a=s.data[e+8],c=function(e,t,n,r,i){const o=e.providerIndexes,s=t.data,a=1048575&o,u=e.directiveStart,c=o>>20,d=i?a+c:e.directiveEnd;for(let h=r?a:a+c;h<d;h++){const p=s[h];if(h<u&&n===p||h>=u&&p.type===n)return h}if(i){const h=s[u];if(h&&bo(h)&&h.type===n)return u}return null}(a,s,n,null==r?gy(a)&&CE:r!=s&&0!=(3&a.type),i&_e.Host&&o===a);return null!==c?Cp(t,s,c,a):dP}function Cp(e,t,n,r){let i=e[n];const o=t.data;if(function(e){return e instanceof xp}(i)){const s=i;s.resolving&&function(e,t){throw new di("200",`Circular dependency in DI detected for ${e}`)}(mr(o[n]));const a=Ay(s.canSeeViewProviders);s.resolving=!0;const u=s.injectImpl?pu(s.injectImpl):null;ZN(e,r,_e.Default);try{i=e[n]=s.factory(void 0,o,e,r),t.firstCreatePass&&n>=r.directiveStart&&function(e,t,n){const{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=t.type.prototype;if(r){const s=$N(t);(n.preOrderHooks||(n.preOrderHooks=[])).push(e,s),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,s)}i&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-e,i),o&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e,o),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,o))}(n,o[n],t)}finally{null!==u&&pu(u),Ay(a),s.resolving=!1,nP()}}return i}function hP(e,t,n){return!!(n[t+(e>>5)]&1<<e)}function pP(e,t){return!(e&_e.Self||e&_e.Host&&t)}class Lf{constructor(t,n){this._tNode=t,this._lView=n}get(t,n,r){return fP(this._tNode,this._lView,t,r,n)}}const $f="__parameters__";function zf(e,t,n){return gu(()=>{const r=function(e){return function(...n){if(e){const r=e(...n);for(const i in r)this[i]=r[i]}}}(t);function i(...o){if(this instanceof i)return r.apply(this,o),this;const s=new i(...o);return a.annotation=s,a;function a(u,l,c){const f=u.hasOwnProperty($f)?u[$f]:Object.defineProperty(u,$f,{value:[]})[$f];for(;f.length<=c;)f.push(null);return(f[c]=f[c]||[]).push(s),u}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=e,i.annotationCls=i,i})}class Qe{constructor(t,n){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=Xe({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}toString(){return`InjectionToken ${this._desc}`}}const Xee=new Qe("AnalyzeForEntryComponents");function ps(e,t){e.forEach(n=>Array.isArray(n)?ps(n,t):t(n))}function mP(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function ky(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}const Tp={},FE="__NG_DI_FLAG__",Fy="ngTempTokenPath",ote=/\n/gm,wP="__source",ate=mt({provide:String,useValue:mt});let kp;function xP(e){const t=kp;return kp=e,t}function ute(e,t=_e.Default){if(void 0===kp)throw new Error("inject() must be called from an injection context");return null===kp?IN(e,void 0,t):kp.get(e,t&_e.Optional?null:void 0,t)}function he(e,t=_e.Default){return(iE||ute)(De(e),t)}function RE(e){const t=[];for(let n=0;n<e.length;n++){const r=De(e[n]);if(Array.isArray(r)){if(0===r.length)throw new Error("Arguments array must have arguments.");let i,o=_e.Default;for(let s=0;s<r.length;s++){const a=r[s],u=lte(a);"number"==typeof u?-1===u?i=a.token:o|=u:i=a}t.push(he(i,o))}else t.push(he(r))}return t}function Ip(e,t){return e[FE]=t,e.prototype[FE]=t,e}function lte(e){return e[FE]}const Fp=Ip(zf("Inject",e=>({token:e})),-1),gs=Ip(zf("Optional"),8),Hf=Ip(zf("SkipSelf"),4),zP="__ngContext__";function Qn(e,t){e[zP]=t}function VE(e){const t=function(e){return e[zP]||null}(e);return t?Array.isArray(t)?t:t.lView:null}function WE(e){return e.ngOriginalError}function nne(e,...t){e.error(...t)}class Wf{constructor(){this._console=console}handleError(t){const n=this._findOriginalError(t),r=(e=t)&&e.ngErrorLogger||nne;var e;r(this._console,"ERROR",t),n&&r(this._console,"ORIGINAL ERROR",n)}_findOriginalError(t){let n=t&&WE(t);for(;n&&WE(n);)n=WE(n);return n||null}}const WP=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(ct))();function ys(e){return e instanceof Function?e():e}var vi=(()=>((vi=vi||{})[vi.Important=1]="Important",vi[vi.DashCase=2]="DashCase",vi))();function YE(e,t){return undefined(e,t)}function $p(e){const t=e[3];return vo(t)?t[3]:t}function XE(e){return KP(e[13])}function QE(e){return KP(e[4])}function KP(e){for(;null!==e&&!vo(e);)e=e[4];return e}function Yf(e,t,n,r,i){if(null!=r){let o,s=!1;vo(r)?o=r:ds(r)&&(s=!0,r=r[0]);const a=en(r);0===e&&null!==n?null==i?rL(t,n,a):tc(t,n,a,i||null,!0):1===e&&null!==n?tc(t,n,a,i||null,!0):2===e?function(e,t,n){const r=$y(e,t);r&&function(e,t,n,r){Pt(e)?e.removeChild(t,n,r):t.removeChild(n)}(e,r,t,n)}(t,a,s):3===e&&t.destroyNode(a),null!=o&&function(e,t,n,r,i){const o=n[7];o!==en(n)&&Yf(t,e,r,o,i);for(let a=10;a<n.length;a++){const u=n[a];Bp(u[1],u,e,t,r,o)}}(t,e,o,n,i)}}function ZE(e,t,n){return Pt(e)?e.createElement(t,n):null===n?e.createElement(t):e.createElementNS(n,t)}function JP(e,t){const n=e[9],r=n.indexOf(t),i=t[3];1024&t[2]&&(t[2]&=-1025,mE(i,-1)),n.splice(r,1)}function JE(e,t){if(e.length<=10)return;const n=10+t,r=e[n];if(r){const i=r[17];null!==i&&i!==e&&JP(i,r),t>0&&(e[n-1][4]=r[4]);const o=ky(e,10+t);!function(e,t){Bp(e,t,t[11],2,null,null),t[0]=null,t[6]=null}(r[1],r);const s=o[19];null!==s&&s.detachView(o[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}function eL(e,t){if(!(256&t[2])){const n=t[11];Pt(n)&&n.destroyNode&&Bp(e,t,n,3,null,null),function(e){let t=e[13];if(!t)return eD(e[1],e);for(;t;){let n=null;if(ds(t))n=t[13];else{const r=t[10];r&&(n=r)}if(!n){for(;t&&!t[4]&&t!==e;)ds(t)&&eD(t[1],t),t=t[3];null===t&&(t=e),ds(t)&&eD(t[1],t),n=t&&t[4]}t=n}}(t)}}function eD(e,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function(e,t){let n;if(null!=e&&null!=(n=e.destroyHooks))for(let r=0;r<n.length;r+=2){const i=t[n[r]];if(!(i instanceof xp)){const o=n[r+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){const a=i[o[s]],u=o[s+1];try{u.call(a)}finally{}}else try{o.call(i)}finally{}}}}(e,t),function(e,t){const n=e.cleanup,r=t[7];let i=-1;if(null!==n)for(let o=0;o<n.length-1;o+=2)if("string"==typeof n[o]){const s=n[o+1],a="function"==typeof s?s(t):en(t[s]),u=r[i=n[o+2]],l=n[o+3];"boolean"==typeof l?a.removeEventListener(n[o],u,l):l>=0?r[i=l]():r[i=-l].unsubscribe(),o+=2}else{const s=r[i=n[o+1]];n[o].call(s)}if(null!==r){for(let o=i+1;o<r.length;o++)r[o]();t[7]=null}}(e,t),1===t[1].type&&Pt(t[11])&&t[11].destroy();const n=t[17];if(null!==n&&vo(t[3])){n!==t[3]&&JP(n,t);const r=t[19];null!==r&&r.detachView(e)}}}function tL(e,t,n){return function(e,t,n){let r=t;for(;null!==r&&40&r.type;)r=(t=r).parent;if(null===r)return n[0];if(2&r.flags){const i=e.data[r.directiveStart].encapsulation;if(i===fs.None||i===fs.Emulated)return null}return zi(r,n)}(e,t.parent,n)}function tc(e,t,n,r,i){Pt(e)?e.insertBefore(t,n,r,i):t.insertBefore(n,r,i)}function rL(e,t,n){Pt(e)?e.appendChild(t,n):t.appendChild(n)}function iL(e,t,n,r,i){null!==r?tc(e,t,n,r,i):rL(e,t,n)}function $y(e,t){return Pt(e)?e.parentNode(t):t.parentNode}let aL=function(e,t,n){return 40&e.type?zi(e,n):null};function By(e,t,n,r){const i=tL(e,r,t),o=t[11],a=function(e,t,n){return aL(e,t,n)}(r.parent||t[6],r,t);if(null!=i)if(Array.isArray(n))for(let u=0;u<n.length;u++)iL(o,i,n[u],a,!1);else iL(o,i,n,a,!1)}function zy(e,t){if(null!==t){const n=t.type;if(3&n)return zi(t,e);if(4&n)return nD(-1,e[t.index]);if(8&n){const r=t.child;if(null!==r)return zy(e,r);{const i=e[t.index];return vo(i)?nD(-1,i):en(i)}}if(32&n)return YE(t,e)()||en(e[t.index]);{const r=lL(e,t);return null!==r?Array.isArray(r)?r[0]:zy($p(e[16]),r):zy(e,t.next)}}return null}function lL(e,t){return null!==t?e[16][6].projection[t.projection]:null}function nD(e,t){const n=10+e+1;if(n<t.length){const r=t[n],i=r[1].firstChild;if(null!==i)return zy(r,i)}return t[7]}function rD(e,t,n,r,i,o,s){for(;null!=n;){const a=r[n.index],u=n.type;if(s&&0===t&&(a&&Qn(en(a),r),n.flags|=4),64!=(64&n.flags))if(8&u)rD(e,t,n.child,r,i,o,!1),Yf(t,e,i,a,o);else if(32&u){const l=YE(n,r);let c;for(;c=l();)Yf(t,e,i,c,o);Yf(t,e,i,a,o)}else 16&u?fL(e,t,r,n,i,o):Yf(t,e,i,a,o);n=s?n.projectionNext:n.next}}function Bp(e,t,n,r,i,o){rD(n,r,e.firstChild,t,i,o,!1)}function fL(e,t,n,r,i,o){const s=n[16],u=s[6].projection[r.projection];if(Array.isArray(u))for(let l=0;l<u.length;l++)Yf(t,e,i,u[l],o);else rD(e,t,u,s[3],i,o,!0)}function dL(e,t,n){Pt(e)?e.setAttribute(t,"style",n):t.style.cssText=n}function iD(e,t,n){Pt(e)?""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n):t.className=n}function hL(e,t,n){let r=e.length;for(;;){const i=e.indexOf(t,n);if(-1===i)return i;if(0===i||e.charCodeAt(i-1)<=32){const o=t.length;if(i+o===r||e.charCodeAt(i+o)<=32)return i}n=i+1}}const pL="ng-template";function Tne(e,t,n){let r=0;for(;r<e.length;){let i=e[r++];if(n&&"class"===i){if(i=e[r],-1!==hL(i.toLowerCase(),t,0))return!0}else if(1===i){for(;r<e.length&&"string"==typeof(i=e[r++]);)if(i.toLowerCase()===t)return!0;return!1}}return!1}function gL(e){return 4===e.type&&e.value!==pL}function kne(e,t,n){return t===(4!==e.type||n?e.value:pL)}function Ine(e,t,n){let r=4;const i=e.attrs||[],o=function(e){for(let t=0;t<e.length;t++)if(iP(e[t]))return t;return e.length}(i);let s=!1;for(let a=0;a<t.length;a++){const u=t[a];if("number"!=typeof u){if(!s)if(4&r){if(r=2|1&r,""!==u&&!kne(e,u,n)||""===u&&1===t.length){if(_o(r))return!1;s=!0}}else{const l=8&r?u:t[++a];if(8&r&&null!==e.attrs){if(!Tne(e.attrs,l,n)){if(_o(r))return!1;s=!0}continue}const f=Fne(8&r?"class":u,i,gL(e),n);if(-1===f){if(_o(r))return!1;s=!0;continue}if(""!==l){let d;d=f>o?"":i[f+1].toLowerCase();const h=8&r?d:null;if(h&&-1!==hL(h,l,0)||2&r&&l!==d){if(_o(r))return!1;s=!0}}}}else{if(!s&&!_o(r)&&!_o(u))return!1;if(s&&_o(u))continue;s=!1,r=u|1&r}}return _o(r)||s}function _o(e){return 0==(1&e)}function Fne(e,t,n,r){if(null===t)return-1;let i=0;if(r||!n){let o=!1;for(;i<t.length;){const s=t[i];if(s===e)return i;if(3===s||6===s)o=!0;else{if(1===s||2===s){let a=t[++i];for(;"string"==typeof a;)a=t[++i];continue}if(4===s)break;if(0===s){i+=4;continue}}i+=o?1:2}return-1}return function(e,t){let n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){const r=e[n];if("number"==typeof r)return-1;if(r===t)return n;n++}return-1}(t,e)}function mL(e,t,n=!1){for(let r=0;r<t.length;r++)if(Ine(e,t[r],n))return!0;return!1}function yL(e,t){return e?":not("+t.trim()+")":t}function jne(e){let t=e[0],n=1,r=2,i="",o=!1;for(;n<e.length;){let s=e[n];if("string"==typeof s)if(2&r){const a=e[++n];i+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else 8&r?i+="."+s:4&r&&(i+=" "+s);else""!==i&&!_o(s)&&(t+=yL(o,i),i=""),r=s,o=o||!_o(r);n++}return""!==i&&(t+=yL(o,i)),t}const be={};function ML(e,t){const n=e.contentQueries;if(null!==n)for(let r=0;r<n.length;r+=2){const i=n[r],o=n[r+1];if(-1!==o){const s=e.data[o];wE(i),s.contentQueries(2,t[o],o)}}}function zp(e,t,n,r,i,o,s,a,u,l){const c=t.blueprint.slice();return c[0]=i,c[2]=140|r,WN(c),c[3]=c[15]=e,c[8]=n,c[10]=s||e&&e[10],c[11]=a||e&&e[11],c[12]=u||e&&e[12]||null,c[9]=l||e&&e[9]||null,c[6]=o,c[16]=2==t.type?e[16]:c,c}function Xf(e,t,n,r,i){let o=e.data[t];if(null===o)o=function(e,t,n,r,i){const o=YN(),s=yE(),u=e.data[t]=function(e,t,n,r,i,o){return{type:n,index:r,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,s?o:o&&o.parent,n,t,r,i);return null===e.firstChild&&(e.firstChild=u),null!==o&&(s?null==o.child&&null!==u.parent&&(o.child=u):null===o.next&&(o.next=u)),u}(e,t,n,r,i),ge.lFrame.inI18n&&(o.flags|=64);else if(64&o.type){o.type=n,o.value=r,o.attrs=i;const s=function(){const e=ge.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}();o.injectorIndex=null===s?-1:s.injectorIndex}return hs(o,!0),o}function Qf(e,t,n,r){if(0===n)return-1;const i=t.length;for(let o=0;o<n;o++)t.push(r),e.blueprint.push(r),e.data.push(null);return i}function Up(e,t,n){_y(t);try{const r=e.viewQuery;null!==r&&CD(1,r,n);const i=e.template;null!==i&&TL(e,t,i,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&ML(e,t),e.staticViewQueries&&CD(2,e.viewQuery,n);const o=e.components;null!==o&&function(e,t){for(let n=0;n<t.length;n++)wre(e,t[n])}(t,o)}catch(r){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),r}finally{t[2]&=-5,wy()}}function Kf(e,t,n,r){const i=t[2];if(256==(256&i))return;_y(t);const o=vy();try{WN(t),function(e){ge.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==n&&TL(e,t,n,2,r);const s=3==(3&i);if(!o)if(s){const l=e.preOrderCheckHooks;null!==l&&Ey(t,l,null)}else{const l=e.preOrderHooks;null!==l&&Dy(t,l,0,null),xE(t,0)}if(function(e){for(let t=XE(e);null!==t;t=QE(t)){if(!t[2])continue;const n=t[9];for(let r=0;r<n.length;r++){const i=n[r],o=i[3];0==(1024&i[2])&&mE(o,1),i[2]|=1024}}}(t),function(e){for(let t=XE(e);null!==t;t=QE(t))for(let n=10;n<t.length;n++){const r=t[n],i=r[1];gE(r)&&Kf(i,r,i.template,r[8])}}(t),null!==e.contentQueries&&ML(e,t),!o)if(s){const l=e.contentCheckHooks;null!==l&&Ey(t,l)}else{const l=e.contentHooks;null!==l&&Dy(t,l,1),xE(t,1)}!function(e,t){const n=e.hostBindingOpCodes;if(null!==n)try{for(let r=0;r<n.length;r++){const i=n[r];if(i<0)vu(~i);else{const o=i,s=n[++r],a=n[++r];Dee(s,o),a(2,t[o])}}}finally{vu(-1)}}(e,t);const a=e.components;null!==a&&function(e,t){for(let n=0;n<t.length;n++)_re(e,t[n])}(t,a);const u=e.viewQuery;if(null!==u&&CD(2,u,r),!o)if(s){const l=e.viewCheckHooks;null!==l&&Ey(t,l)}else{const l=e.viewHooks;null!==l&&Dy(t,l,2),xE(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),o||(t[2]&=-73),1024&t[2]&&(t[2]&=-1025,mE(t[3],-1))}finally{wy()}}function tre(e,t,n,r){const i=t[10],o=!vy(),s=function(e){return 4==(4&e[2])}(t);try{o&&!s&&i.begin&&i.begin(),s&&Up(e,t,r),Kf(e,t,n,r)}finally{o&&!s&&i.end&&i.end()}}function TL(e,t,n,r,i){const o=ge.lFrame.selectedIndex,s=2&r;try{vu(-1),s&&t.length>20&&function(e,t,n,r){if(!r)if(3==(3&t[2])){const o=e.preOrderCheckHooks;null!==o&&Ey(t,o,n)}else{const o=e.preOrderHooks;null!==o&&Dy(t,o,0,n)}vu(n)}(e,t,20,vy()),n(r,i)}finally{vu(o)}}function IL(e){const t=e.tView;return null===t||t.incompleteFirstPass?e.tView=qy(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts):t}function qy(e,t,n,r,i,o,s,a,u,l){const c=20+r,f=c+i,d=function(e,t){const n=[];for(let r=0;r<t;r++)n.push(r<e?null:be);return n}(c,f),h="function"==typeof l?l():l;return d[1]={type:e,blueprint:d,template:n,queries:null,viewQuery:a,declTNode:t,data:d.slice().fill(null,c),bindingStartIndex:c,expandoStartIndex:f,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof s?s():s,firstChild:null,schemas:u,consts:h,incompleteFirstPass:!1}}function PL(e,t,n){for(let r in e)if(e.hasOwnProperty(r)){const i=e[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(t,i):n[r]=[t,i]}return n}function jL(e,t,n,r,i,o){const s=o.hostBindings;if(s){let a=e.hostBindingOpCodes;null===a&&(a=e.hostBindingOpCodes=[]);const u=~t.index;(function(e){let t=e.length;for(;t>0;){const n=e[--t];if("number"==typeof n&&n<0)return n}return 0})(a)!=u&&a.push(u),a.push(r,i,s)}}function $L(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function BL(e,t){t.flags|=2,(e.components||(e.components=[])).push(t.index)}function pre(e,t,n){if(n){if(t.exportAs)for(let r=0;r<t.exportAs.length;r++)n[t.exportAs[r]]=e;bo(t)&&(n[""]=e)}}function zL(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}function UL(e,t,n,r,i){e.data[r]=i;const o=i.factory||(i.factory=Jl(i.type)),s=new xp(o,bo(i),null);e.blueprint[r]=s,n[r]=s,jL(e,t,0,r,Qf(e,n,i.hostVars,be),i)}function gre(e,t,n){const r=zi(t,e),i=IL(n),o=e[10],s=Wy(e,zp(e,i,null,n.onPush?64:16,r,t,o,o.createRenderer(r,n),null,null));e[t.index]=s}function mre(e,t,n,r,i,o){const s=o[t];if(null!==s){const a=r.setInput;for(let u=0;u<s.length;){const l=s[u++],c=s[u++],f=s[u++];null!==a?r.setInput(n,f,l,c):n[c]=f}}}function yre(e,t){let n=null,r=0;for(;r<t.length;){const i=t[r];if(0!==i)if(5!==i){if("number"==typeof i)break;e.hasOwnProperty(i)&&(null===n&&(n=[]),n.push(i,e[i],t[r+1])),r+=2}else r+=2;else r+=4}return n}function _re(e,t){const n=mi(t,e);if(gE(n)){const r=n[1];80&n[2]?Kf(r,n,r.template,n[8]):n[5]>0&&wD(n)}}function wD(e){for(let r=XE(e);null!==r;r=QE(r))for(let i=10;i<r.length;i++){const o=r[i];if(1024&o[2]){const s=o[1];Kf(s,o,s.template,o[8])}else o[5]>0&&wD(o)}const n=e[1].components;if(null!==n)for(let r=0;r<n.length;r++){const i=mi(n[r],e);gE(i)&&i[5]>0&&wD(i)}}function wre(e,t){const n=mi(t,e),r=n[1];(function(e,t){for(let n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])})(r,n),Up(r,n,n[8])}function Wy(e,t){return e[13]?e[14][4]=t:e[13]=t,e[14]=t,t}function DD(e,t,n){const r=t[10];r.begin&&r.begin();try{Kf(e,t,e.template,n)}catch(i){throw function(e,t){const n=e[9],r=n?n.get(Wf,null):null;r&&r.handleError(t)}(t,i),i}finally{r.end&&r.end()}}function VL(e){!function(e){for(let t=0;t<e.components.length;t++){const n=e.components[t],r=VE(n),i=r[1];tre(i,r,i.template,n)}}(e[8])}function CD(e,t,n){wE(0),t(e,n)}const Sre=(()=>Promise.resolve(null))();function Gy(e,t,n){let r=n?e.styles:null,i=n?e.classes:null,o=0;if(null!==t)for(let s=0;s<t.length;s++){const a=t[s];"number"==typeof a?o=a:1==o?i=Jx(i,a):2==o&&(r=Jx(r,a+": "+t[++s]+";"))}n?e.styles=r:e.stylesWithoutHost=r,n?e.classes=i:e.classesWithoutHost=i}const SD=new Qe("INJECTOR",-1);class QL{get(t,n=Tp){if(n===Tp){const r=new Error(`NullInjectorError: No provider for ${Ue(t)}!`);throw r.name="NullInjectorError",r}return n}}const AD=new Qe("Set Injector scope."),Hp={},Mre={};let OD;function KL(){return void 0===OD&&(OD=new QL),OD}function ZL(e,t=null,n=null,r){const i=JL(e,t,n,r);return i._resolveInjectorDefTypes(),i}function JL(e,t=null,n=null,r){return new Tre(e,n,t||KL(),r)}class Tre{constructor(t,n,r,i=null){this.parent=r,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const o=[];n&&ps(n,a=>this.processProvider(a,t,n)),ps([t],a=>this.processInjectorType(a,[],o)),this.records.set(SD,Zf(void 0,this));const s=this.records.get(AD);this.scope=null!=s?s.value:null,this.source=i||("object"==typeof t?null:Ue(t))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(t=>t.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(t,n=Tp,r=_e.Default){this.assertNotDestroyed();const i=xP(this),o=pu(void 0);try{if(!(r&_e.SkipSelf)){let a=this.records.get(t);if(void 0===a){const u=("function"==typeof(e=t)||"object"==typeof e&&e instanceof Qe)&&nE(t);a=u&&this.injectableDefInScope(u)?Zf(MD(t),Hp):null,this.records.set(t,a)}if(null!=a)return this.hydrate(t,a)}return(r&_e.Self?KL():this.parent).get(t,n=r&_e.Optional&&n===Tp?null:n)}catch(s){if("NullInjectorError"===s.name){if((s[Fy]=s[Fy]||[]).unshift(Ue(t)),i)throw s;return function(e,t,n,r){const i=e[Fy];throw t[wP]&&i.unshift(t[wP]),e.message=function(e,t,n,r=null){e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.substr(2):e;let i=Ue(t);if(Array.isArray(t))i=t.map(Ue).join(" -> ");else if("object"==typeof t){let o=[];for(let s in t)if(t.hasOwnProperty(s)){let a=t[s];o.push(s+":"+("string"==typeof a?JSON.stringify(a):Ue(a)))}i=`{${o.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${e.replace(ote,"\n  ")}`}("\n"+e.message,i,n,r),e.ngTokenPath=i,e[Fy]=null,e}(s,t,"R3InjectorError",this.source)}throw s}finally{pu(o),xP(i)}var e}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(t=>this.get(t))}toString(){const t=[];return this.records.forEach((r,i)=>t.push(Ue(i))),`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(t,n,r){if(!(t=De(t)))return!1;let i=TN(t);const o=null==i&&t.ngModule||void 0,s=void 0===o?t:o,a=-1!==r.indexOf(s);if(void 0!==o&&(i=TN(o)),null==i)return!1;if(null!=i.imports&&!a){let c;r.push(s);try{ps(i.imports,f=>{this.processInjectorType(f,n,r)&&(void 0===c&&(c=[]),c.push(f))})}finally{}if(void 0!==c)for(let f=0;f<c.length;f++){const{ngModule:d,providers:h}=c[f];ps(h,p=>this.processProvider(p,d,h||yt))}}this.injectorDefTypes.add(s);const u=Jl(s)||(()=>new s);this.records.set(s,Zf(u,Hp));const l=i.providers;if(null!=l&&!a){const c=t;ps(l,f=>this.processProvider(f,c,l))}return void 0!==o&&void 0!==t.providers}processProvider(t,n,r){let i=Jf(t=De(t))?t:De(t&&t.provide);const o=function(e,t,n){return tj(e)?Zf(void 0,e.useValue):Zf(function(e,t,n){let r;if(Jf(e)){const i=De(e);return Jl(i)||MD(i)}if(tj(e))r=()=>De(e.useValue);else if(function(e){return!(!e||!e.useFactory)}(e))r=()=>e.useFactory(...RE(e.deps||[]));else if(function(e){return!(!e||!e.useExisting)}(e))r=()=>he(De(e.useExisting));else{const i=De(e&&(e.useClass||e.provide));if(!function(e){return!!e.deps}(e))return Jl(i)||MD(i);r=()=>new i(...RE(e.deps))}return r}(e),Hp)}(t);if(Jf(t)||!0!==t.multi)this.records.get(i);else{let s=this.records.get(i);s||(s=Zf(void 0,Hp,!0),s.factory=()=>RE(s.multi),this.records.set(i,s)),i=t,s.multi.push(t)}this.records.set(i,o)}hydrate(t,n){return n.value===Hp&&(n.value=Mre,n.value=n.factory()),"object"==typeof n.value&&n.value&&null!==(e=n.value)&&"object"==typeof e&&"function"==typeof e.ngOnDestroy&&this.onDestroy.add(n.value),n.value;var e}injectableDefInScope(t){if(!t.providedIn)return!1;const n=De(t.providedIn);return"string"==typeof n?"any"===n||n===this.scope:this.injectorDefTypes.has(n)}}function MD(e){const t=nE(e),n=null!==t?t.factory:Jl(e);if(null!==n)return n;if(e instanceof Qe)throw new Error(`Token ${Ue(e)} is missing a \u0275prov definition.`);if(e instanceof Function)return function(e){const t=e.length;if(t>0){const r=function(e,t){const n=[];for(let r=0;r<e;r++)n.push(t);return n}(t,"?");throw new Error(`Can't resolve all parameters for ${Ue(e)}: (${r.join(", ")}).`)}const n=function(e){const t=e&&(e[ly]||e[kN]);if(t){const n=function(e){if(e.hasOwnProperty("name"))return e.name;const t=(""+e).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(e);return console.warn(`DEPRECATED: DI is instantiating a token "${n}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${n}" class.`),t}return null}(e);return null!==n?()=>n.factory(e):()=>new e}(e);throw new Error("unreachable")}function Zf(e,t,n=!1){return{factory:e,value:t,multi:n?[]:void 0}}function tj(e){return null!==e&&"object"==typeof e&&ate in e}function Jf(e){return"function"==typeof e}let _r=(()=>{class e{static create(n,r){var i;if(Array.isArray(n))return ZL({name:""},r,n,"");{const o=null!==(i=n.name)&&void 0!==i?i:"";return ZL({name:o},n.parent,n.providers,o)}}}return e.THROW_IF_NOT_FOUND=Tp,e.NULL=new QL,e.\u0275prov=Xe({token:e,providedIn:"any",factory:()=>he(SD)}),e.__NG_ELEMENT_ID__=-1,e})();function Wre(e,t){xy(VE(e)[1],ln())}let Yy=null;function ed(){if(!Yy){const e=ct.Symbol;if(e&&e.iterator)Yy=e.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let n=0;n<t.length;++n){const r=t[n];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(Yy=r)}}}return Yy}function Vp(e){return!!FD(e)&&(Array.isArray(e)||!(e instanceof Map)&&ed()in e)}function FD(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function ae(e,t=_e.Default){const n=j();return null===n?he(e,t):fP(ln(),n,De(e),t)}function $D(){throw new Error("invalid")}function BD(e,t,n,r,i){const s=i?"class":"style";!function(e,t,n,r,i){for(let o=0;o<n.length;){const s=n[o++],a=n[o++],u=t[s],l=e.data[s];null!==l.setInput?l.setInput(u,i,r,a):u[a]=i}}(e,n,t.inputs[s],s,r)}function Nj(e,t,n,r){const i=j(),o=He(),s=20+e,a=i[11],u=i[s]=ZE(a,t,ge.lFrame.currentNamespace),l=o.firstCreatePass?function(e,t,n,r,i,o,s){const a=t.consts,l=Xf(t,e,2,i,yu(a,o));return function(e,t,n,r){let i=!1;if(GN()){const o=function(e,t,n){const r=e.directiveRegistry;let i=null;if(r)for(let o=0;o<r.length;o++){const s=r[o];mL(n,s.selectors,!1)&&(i||(i=[]),My(Dp(n,t),e,s.type),bo(s)?(BL(e,n),i.unshift(s)):i.push(s))}return i}(e,t,n),s=null===r?null:{"":-1};if(null!==o){i=!0,zL(n,e.data.length,o.length);for(let c=0;c<o.length;c++){const f=o[c];f.providersResolver&&f.providersResolver(f)}let a=!1,u=!1,l=Qf(e,t,o.length,null);for(let c=0;c<o.length;c++){const f=o[c];n.mergedAttrs=Sy(n.mergedAttrs,f.hostAttrs),UL(e,n,t,l,f),pre(l,f,s),null!==f.contentQueries&&(n.flags|=8),(null!==f.hostBindings||null!==f.hostAttrs||0!==f.hostVars)&&(n.flags|=128);const d=f.type.prototype;!a&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n.index),a=!0),!u&&(d.ngOnChanges||d.ngDoCheck)&&((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n.index),u=!0),l++}!function(e,t){const r=t.directiveEnd,i=e.data,o=t.attrs,s=[];let a=null,u=null;for(let l=t.directiveStart;l<r;l++){const c=i[l],f=c.inputs,d=null===o||gL(t)?null:yre(f,o);s.push(d),a=PL(f,l,a),u=PL(c.outputs,l,u)}null!==a&&(a.hasOwnProperty("class")&&(t.flags|=16),a.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=s,t.inputs=a,t.outputs=u}(e,n)}s&&function(e,t,n){if(t){const r=e.localNames=[];for(let i=0;i<t.length;i+=2){const o=n[t[i+1]];if(null==o)throw new di("301",`Export of name '${t[i+1]}' not found!`);r.push(t[i],o)}}}(n,r,s)}n.mergedAttrs=Sy(n.mergedAttrs,n.attrs)}(t,n,l,yu(a,s)),null!==l.attrs&&Gy(l,l.attrs,!1),null!==l.mergedAttrs&&Gy(l,l.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,l),l}(s,o,i,0,t,n,r):o.data[s];hs(l,!0);const c=l.mergedAttrs;null!==c&&Cy(a,u,c);const f=l.classes;null!==f&&iD(a,u,f);const d=l.styles;null!==d&&dL(a,u,d),64!=(64&l.flags)&&By(o,i,u,l),0===ge.lFrame.elementDepthCount&&Qn(u,i),ge.lFrame.elementDepthCount++,function(e){return 1==(1&e.flags)}(l)&&(function(e,t,n){!GN()||(function(e,t,n,r){const i=n.directiveStart,o=n.directiveEnd;e.firstCreatePass||Dp(n,t),Qn(r,t);const s=n.initialInputs;for(let a=i;a<o;a++){const u=e.data[a],l=bo(u);l&&gre(t,n,u);const c=Cp(t,e,a,n);Qn(c,t),null!==s&&mre(0,a-i,c,u,0,s),l&&(mi(n.index,t)[8]=c)}}(e,t,n,zi(n,t)),128==(128&n.flags)&&function(e,t,n){const r=n.directiveStart,i=n.directiveEnd,s=n.index,a=ge.lFrame.currentDirectiveIndex;try{vu(s);for(let u=r;u<i;u++){const l=e.data[u],c=t[u];bE(u),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&$L(l,c)}}finally{vu(-1),bE(a)}}(e,t,n))}(o,i,l),function(e,t,n){if(lE(t)){const i=t.directiveEnd;for(let o=t.directiveStart;o<i;o++){const s=e.data[o];s.contentQueries&&s.contentQueries(1,n[o],o)}}}(o,l,i)),null!==r&&function(e,t,n=zi){const r=t.localNames;if(null!==r){let i=t.index+1;for(let o=0;o<r.length;o+=2){const s=r[o+1],a=-1===s?n(t,e):e[s];e[i++]=a}}}(i,l)}function Pj(){let e=ln();yE()?ge.lFrame.isParent=!1:(e=e.parent,hs(e,!1));const t=e;ge.lFrame.elementDepthCount--;const n=He();n.firstCreatePass&&(xy(n,e),lE(e)&&n.queries.elementEnd(e)),null!=t.classesWithoutHost&&function(e){return 0!=(16&e.flags)}(t)&&BD(n,t,j(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function(e){return 0!=(32&e.flags)}(t)&&BD(n,t,j(),t.stylesWithoutHost,!1)}function Wp(e,t,n,r){Nj(e,t,n,r),Pj()}function Ky(e){return!!e&&"function"==typeof e.then}const Bj=function(e){return!!e&&"function"==typeof e.subscribe},rc=void 0;var boe=["en",[["a","p"],["AM","PM"],rc],[["AM","PM"],rc,rc],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],rc,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],rc,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",rc,"{1} 'at' {0}",rc],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(e){const n=Math.floor(Math.abs(e)),r=e.toString().replace(/^[^.]*\.?/,"").length;return 1===n&&0===r?1:5}];let dd={};function N3(e){return e in dd||(dd[e]=ct.ng&&ct.ng.common&&ct.ng.common.locales&&ct.ng.common.locales[e]),dd[e]}var K=(()=>((K=K||{})[K.LocaleId=0]="LocaleId",K[K.DayPeriodsFormat=1]="DayPeriodsFormat",K[K.DayPeriodsStandalone=2]="DayPeriodsStandalone",K[K.DaysFormat=3]="DaysFormat",K[K.DaysStandalone=4]="DaysStandalone",K[K.MonthsFormat=5]="MonthsFormat",K[K.MonthsStandalone=6]="MonthsStandalone",K[K.Eras=7]="Eras",K[K.FirstDayOfWeek=8]="FirstDayOfWeek",K[K.WeekendRange=9]="WeekendRange",K[K.DateFormat=10]="DateFormat",K[K.TimeFormat=11]="TimeFormat",K[K.DateTimeFormat=12]="DateTimeFormat",K[K.NumberSymbols=13]="NumberSymbols",K[K.NumberFormats=14]="NumberFormats",K[K.CurrencyCode=15]="CurrencyCode",K[K.CurrencySymbol=16]="CurrencySymbol",K[K.CurrencyName=17]="CurrencyName",K[K.Currencies=18]="Currencies",K[K.Directionality=19]="Directionality",K[K.PluralCase=20]="PluralCase",K[K.ExtraData=21]="ExtraData",K))();const ev="en-US";let P3=ev;class a${}class xse{resolveComponentFactory(t){throw function(e){const t=Error(`No component factory found for ${Ue(e)}. Did you add it to @NgModule.entryComponents?`);return t.ngComponent=e,t}(t)}}let pd=(()=>{class e{}return e.NULL=new xse,e})();function Ese(){return gd(ln(),j())}function gd(e,t){return new Eu(zi(e,t))}let Eu=(()=>{class e{constructor(n){this.nativeElement=n}}return e.__NG_ELEMENT_ID__=Ese,e})();class l${}let Ase=(()=>{class e{}return e.\u0275prov=Xe({token:e,providedIn:"root",factory:()=>null}),e})();class sv{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const Ose=new sv("13.1.0"),KD={};function av(e,t,n,r,i=!1){for(;null!==n;){const o=t[n.index];if(null!==o&&r.push(en(o)),vo(o))for(let a=10;a<o.length;a++){const u=o[a],l=u[1].firstChild;null!==l&&av(u[1],u,l,r)}const s=n.type;if(8&s)av(e,t,n.child,r);else if(32&s){const a=YE(n,t);let u;for(;u=a();)r.push(u)}else if(16&s){const a=lL(t,n);if(Array.isArray(a))r.push(...a);else{const u=$p(t[16]);av(u[1],u,a,r,!0)}}n=i?n.projectionNext:n.next}return r}class Zp{constructor(t,n){this._lView=t,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const t=this._lView,n=t[1];return av(n,t,n.firstChild,[])}get context(){return this._lView[8]}set context(t){this._lView[8]=t}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[3];if(vo(t)){const n=t[8],r=n?n.indexOf(this):-1;r>-1&&(JE(t,r),ky(n,r))}this._attachedToViewContainer=!1}eL(this._lView[1],this._lView)}onDestroy(t){!function(e,t,n,r){const i=function(e){return e[7]||(e[7]=[])}(t);null===n?i.push(r):(i.push(n),e.firstCreatePass&&function(e){return e.cleanup||(e.cleanup=[])}(e).push(r,i.length-1))}(this._lView[1],this._lView,null,t)}markForCheck(){!function(e){for(;e;){e[2]|=64;const t=$p(e);if(ree(e)&&!t)return e;e=t}}(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){DD(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(e,t,n){by(!0);try{DD(e,t,n)}finally{by(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){var t;this._appRef=null,Bp(this._lView[1],t=this._lView,t[11],2,null,null)}attachToAppRef(t){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=t}}class Mse extends Zp{constructor(t){super(t),this._view=t}detectChanges(){VL(this._view)}checkNoChanges(){!function(e){by(!0);try{VL(e)}finally{by(!1)}}(this._view)}get context(){return null}}class c$ extends pd{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const n=Yn(t);return new ZD(n,this.ngModule)}}function f$(e){const t=[];for(let n in e)e.hasOwnProperty(n)&&t.push({propName:e[n],templateName:n});return t}const kse=new Qe("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>WP});class ZD extends a${constructor(t,n){super(),this.componentDef=t,this.ngModule=n,this.componentType=t.type,this.selector=t.selectors.map(jne).join(","),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!n}get inputs(){return f$(this.componentDef.inputs)}get outputs(){return f$(this.componentDef.outputs)}create(t,n,r,i){const o=(i=i||this.ngModule)?function(e,t){return{get:(n,r,i)=>{const o=e.get(n,KD,i);return o!==KD||r===KD?o:t.get(n,r,i)}}}(t,i.injector):t,s=o.get(l$,VN),a=o.get(Ase,null),u=s.createRenderer(null,this.componentDef),l=this.componentDef.selectors[0][0]||"div",c=r?function(e,t,n){if(Pt(e))return e.selectRootElement(t,n===fs.ShadowDom);let r="string"==typeof t?e.querySelector(t):t;return r.textContent="",r}(u,r,this.componentDef.encapsulation):ZE(s.createRenderer(null,this.componentDef),l,function(e){const t=e.toLowerCase();return"svg"===t?"http://www.w3.org/2000/svg":"math"===t?"http://www.w3.org/1998/MathML/":null}(l)),f=this.componentDef.onPush?576:528,d=function(e,t){return{components:[],scheduler:e||WP,clean:Sre,playerHandler:t||null,flags:0}}(),h=qy(0,null,null,1,0,null,null,null,null,null),p=zp(null,h,d,f,null,null,s,u,a,o);let g,m;_y(p);try{const v=function(e,t,n,r,i,o){const s=n[1];n[20]=e;const u=Xf(s,20,2,"#host",null),l=u.mergedAttrs=t.hostAttrs;null!==l&&(Gy(u,l,!0),null!==e&&(Cy(i,e,l),null!==u.classes&&iD(i,e,u.classes),null!==u.styles&&dL(i,e,u.styles)));const c=r.createRenderer(e,t),f=zp(n,IL(t),null,t.onPush?64:16,n[20],u,r,c,o||null,null);return s.firstCreatePass&&(My(Dp(u,n),s,t.type),BL(s,u),zL(u,n.length,1)),Wy(n,f),n[20]=f}(c,this.componentDef,p,s,u);if(c)if(r)Cy(u,c,["ng-version",Ose.full]);else{const{attrs:y,classes:b}=function(e){const t=[],n=[];let r=1,i=2;for(;r<e.length;){let o=e[r];if("string"==typeof o)2===i?""!==o&&t.push(o,e[++r]):8===i&&n.push(o);else{if(!_o(i))break;i=o}r++}return{attrs:t,classes:n}}(this.componentDef.selectors[0]);y&&Cy(u,c,y),b&&b.length>0&&iD(u,c,b.join(" "))}if(m=function(e,t){return e.data[t]}(h,20),void 0!==n){const y=m.projection=[];for(let b=0;b<this.ngContentSelectors.length;b++){const _=n[b];y.push(null!=_?Array.from(_):null)}}g=function(e,t,n,r,i){const o=n[1],s=function(e,t,n){const r=ln();e.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),UL(e,r,t,Qf(e,t,1,null),n));const i=Cp(t,e,r.directiveStart,r);Qn(i,t);const o=zi(r,t);return o&&Qn(o,t),i}(o,n,t);if(r.components.push(s),e[8]=s,i&&i.forEach(u=>u(s,t)),t.contentQueries){const u=ln();t.contentQueries(1,s,u.directiveStart)}const a=ln();return!o.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(vu(a.index),jL(n[1],a,0,a.directiveStart,a.directiveEnd,t),$L(t,s)),s}(v,this.componentDef,p,d,[Wre]),Up(h,p,null)}finally{wy()}return new Rse(this.componentType,g,gd(m,p),p,m)}}class Rse extends class{}{constructor(t,n,r,i,o){super(),this.location=r,this._rootLView=i,this._tNode=o,this.instance=n,this.hostView=this.changeDetectorRef=new Mse(i),this.componentType=t}get injector(){return new Lf(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}class Oa{}class d${}const md=new Map;class g$ extends Oa{constructor(t,n){super(),this._parent=n,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new c$(this);const r=ji(t);this._bootstrapComponents=ys(r.bootstrap),this._r3Injector=JL(t,n,[{provide:Oa,useValue:this},{provide:pd,useValue:this.componentFactoryResolver}],Ue(t)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(t)}get(t,n=_r.THROW_IF_NOT_FOUND,r=_e.Default){return t===_r||t===Oa||t===SD?this:this._r3Injector.get(t,n,r)}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class JD extends d${constructor(t){super(),this.moduleType=t,null!==ji(t)&&function(e){const t=new Set;!function n(r){const i=ji(r,!0),o=i.id;null!==o&&(function(e,t,n){if(t&&t!==n)throw new Error(`Duplicate module registered for ${e} - ${Ue(t)} vs ${Ue(t.name)}`)}(o,md.get(o),r),md.set(o,r));const s=ys(i.imports);for(const a of s)t.has(a)||(t.add(a),n(a))}(e)}(t)}create(t){return new g$(this.moduleType,t)}}function eC(e){return t=>{setTimeout(e,void 0,t)}}const xr=class extends va{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,n,r){var i,o,s;let a=t,u=n||(()=>null),l=r;if(t&&"object"==typeof t){const f=t;a=null===(i=f.next)||void 0===i?void 0:i.bind(f),u=null===(o=f.error)||void 0===o?void 0:o.bind(f),l=null===(s=f.complete)||void 0===s?void 0:s.bind(f)}this.__isAsync&&(u=eC(u),a&&(a=eC(a)),l&&(l=eC(l)));const c=super.subscribe({next:a,error:u,complete:l});return t instanceof Jt&&t.add(c),c}};Symbol;let Co=(()=>{class e{}return e.__NG_ELEMENT_ID__=oae,e})();function oae(){return function(e,t){let n;const r=t[e.index];if(vo(r))n=r;else{let i;if(8&e.type)i=en(r);else{const o=t[11];i=o.createComment("");const s=zi(e,t);tc(o,$y(o,s),i,function(e,t){return Pt(e)?e.nextSibling(t):t.nextSibling}(o,s),!1)}t[e.index]=n=function(e,t,n,r){return new Array(e,!0,!1,t,null,0,r,n,null,null)}(r,t,i,e),Wy(t,n)}return new w$(n,e,t)}(ln(),j())}const sae=Co,w$=class extends sae{constructor(t,n,r){super(),this._lContainer=t,this._hostTNode=n,this._hostLView=r}get element(){return gd(this._hostTNode,this._hostLView)}get injector(){return new Lf(this._hostTNode,this._hostLView)}get parentInjector(){const t=Oy(this._hostTNode,this._hostLView);if(sP(t)){const n=Pf(t,this._hostLView),r=Nf(t);return new Lf(n[1].data[r+8],n)}return new Lf(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const n=x$(this._lContainer);return null!==n&&n[t]||null}get length(){return this._lContainer.length-10}createEmbeddedView(t,n,r){const i=t.createEmbeddedView(n||{});return this.insert(i,r),i}createComponent(t,n,r,i,o){const s=t&&!function(e){return"function"==typeof e}(t);let a;if(s)a=n;else{const f=n||{};a=f.index,r=f.injector,i=f.projectableNodes,o=f.ngModuleRef}const u=s?t:new ZD(Yn(t)),l=r||this.parentInjector;if(!o&&null==u.ngModule&&l){const f=l.get(Oa,null);f&&(o=f)}const c=u.create(l,i,void 0,o);return this.insert(c.hostView,a),c}insert(t,n){const r=t._lView,i=r[1];if(vo(r[3])){const c=this.indexOf(t);if(-1!==c)this.detach(c);else{const f=r[3],d=new w$(f,f[6],f[3]);d.detach(d.indexOf(t))}}const o=this._adjustIndex(n),s=this._lContainer;!function(e,t,n,r){const i=10+r,o=n.length;r>0&&(n[i-1][4]=t),r<o-10?(t[4]=n[i],mP(n,10+r,t)):(n.push(t),t[4]=null),t[3]=n;const s=t[17];null!==s&&n!==s&&function(e,t){const n=e[9];t[16]!==t[3][3][16]&&(e[2]=!0),null===n?e[9]=[t]:n.push(t)}(s,t);const a=t[19];null!==a&&a.insertView(e),t[2]|=128}(i,r,s,o);const a=nD(o,s),u=r[11],l=$y(u,s[7]);return null!==l&&function(e,t,n,r,i,o){r[0]=i,r[6]=t,Bp(e,r,n,1,i,o)}(i,s[6],u,r,l,a),t.attachToViewContainerRef(),mP(nC(s),o,t),t}move(t,n){return this.insert(t,n)}indexOf(t){const n=x$(this._lContainer);return null!==n?n.indexOf(t):-1}remove(t){const n=this._adjustIndex(t,-1),r=JE(this._lContainer,n);r&&(ky(nC(this._lContainer),n),eL(r[1],r))}detach(t){const n=this._adjustIndex(t,-1),r=JE(this._lContainer,n);return r&&null!=ky(nC(this._lContainer),n)?new Zp(r):null}_adjustIndex(t,n=0){return null==t?this.length+n:t}};function x$(e){return e[8]}function nC(e){return e[8]||(e[8]=[])}function fv(...e){}const dv=new Qe("Application Initializer");let vd=(()=>{class e{constructor(n){this.appInits=n,this.resolve=fv,this.reject=fv,this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i})}runInitializers(){if(this.initialized)return;const n=[],r=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let i=0;i<this.appInits.length;i++){const o=this.appInits[i]();if(Ky(o))n.push(o);else if(Bj(o)){const s=new Promise((a,u)=>{o.subscribe({complete:a,error:u})});n.push(s)}}Promise.all(n).then(()=>{r()}).catch(i=>{this.reject(i)}),0===n.length&&r(),this.initialized=!0}}return e.\u0275fac=function(n){return new(n||e)(he(dv,8))},e.\u0275prov=Xe({token:e,factory:e.\u0275fac}),e})();const ng=new Qe("AppId"),Rae={provide:ng,useFactory:function(){return`${mC()}${mC()}${mC()}`},deps:[]};function mC(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const q$=new Qe("Platform Initializer"),yC=new Qe("Platform ID"),W$=new Qe("appBootstrapListener");let G$=(()=>{class e{log(n){console.log(n)}warn(n){console.warn(n)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Xe({token:e,factory:e.\u0275fac}),e})();const Du=new Qe("LocaleId"),Y$=new Qe("DefaultCurrencyCode");class Nae{constructor(t,n){this.ngModuleFactory=t,this.componentFactories=n}}let hv=(()=>{class e{compileModuleSync(n){return new JD(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){const r=this.compileModuleSync(n),o=ys(ji(n).declarations).reduce((s,a)=>{const u=Yn(a);return u&&s.push(new ZD(u)),s},[]);return new Nae(r,o)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Xe({token:e,factory:e.\u0275fac}),e})();const Lae=(()=>Promise.resolve(0))();function vC(e){"undefined"==typeof Zone?Lae.then(()=>{e&&e.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}class dn{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new xr(!1),this.onMicrotaskEmpty=new xr(!1),this.onStable=new xr(!1),this.onError=new xr(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=function(){let e=ct.requestAnimationFrame,t=ct.cancelAnimationFrame;if("undefined"!=typeof Zone&&e&&t){const n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function(e){const t=()=>{!function(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(ct,()=>{e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{e.lastRequestAnimationFrameId=-1,_C(e),e.isCheckStableRunning=!0,bC(e),e.isCheckStableRunning=!1},void 0,()=>{},()=>{})),e.fakeTopEventTask.invoke()}),_C(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,o,s,a)=>{try{return X$(e),n.invokeTask(i,o,s,a)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||e.shouldCoalesceRunChangeDetection)&&t(),Q$(e)}},onInvoke:(n,r,i,o,s,a,u)=>{try{return X$(e),n.invoke(i,o,s,a,u)}finally{e.shouldCoalesceRunChangeDetection&&t(),Q$(e)}},onHasTask:(n,r,i,o)=>{n.hasTask(i,o),r===i&&("microTask"==o.change?(e._hasPendingMicrotasks=o.microTask,_C(e),bC(e)):"macroTask"==o.change&&(e.hasPendingMacrotasks=o.macroTask))},onHandleError:(n,r,i,o)=>(n.handleError(i,o),e.runOutsideAngular(()=>e.onError.emit(o)),!1)})}(i)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!dn.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(dn.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(t,n,r){return this._inner.run(t,n,r)}runTask(t,n,r,i){const o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+i,t,$ae,fv,fv);try{return o.runTask(s,n,r)}finally{o.cancelTask(s)}}runGuarded(t,n,r){return this._inner.runGuarded(t,n,r)}runOutsideAngular(t){return this._outer.run(t)}}const $ae={};function bC(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function _C(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function X$(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function Q$(e){e._nesting--,bC(e)}class Uae{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new xr,this.onMicrotaskEmpty=new xr,this.onStable=new xr,this.onError=new xr}run(t,n,r){return t.apply(n,r)}runGuarded(t,n,r){return t.apply(n,r)}runOutsideAngular(t){return t()}runTask(t,n,r,i){return t.apply(n,r)}}let wC=(()=>{class e{constructor(n){this._ngZone=n,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{dn.assertNotInAngularZone(),vC(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())vC(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb(this._didWork)}this._didWork=!1});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(n)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,r,i){let o=-1;r&&r>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(s=>s.timeoutId!==o),n(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:n,timeoutId:o,updateCb:i})}whenStable(n,r,i){if(i&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,r,i),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(n,r,i){return[]}}return e.\u0275fac=function(n){return new(n||e)(he(dn))},e.\u0275prov=Xe({token:e,factory:e.\u0275fac}),e})(),K$=(()=>{class e{constructor(){this._applications=new Map,xC.addToWindow(this)}registerApplication(n,r){this._applications.set(n,r)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,r=!0){return xC.findTestabilityInTree(this,n,r)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Xe({token:e,factory:e.\u0275fac}),e})();class Hae{addToWindow(t){}findTestabilityInTree(t,n,r){return null}}let So,xC=new Hae;const Z$=new Qe("AllowMultipleToken");class J${constructor(t,n){this.name=t,this.token=n}}function e5(e,t,n=[]){const r=`Platform: ${t}`,i=new Qe(r);return(o=[])=>{let s=t5();if(!s||s.injector.get(Z$,!1))if(e)e(n.concat(o).concat({provide:i,useValue:!0}));else{const a=n.concat(o).concat({provide:i,useValue:!0},{provide:AD,useValue:"platform"});!function(e){if(So&&!So.destroyed&&!So.injector.get(Z$,!1))throw new di("400","");So=e.get(n5);const t=e.get(q$,null);t&&t.forEach(n=>n())}(_r.create({providers:a,name:r}))}return function(e){const t=t5();if(!t)throw new di("401","");return t}()}}function t5(){return So&&!So.destroyed?So:null}let n5=(()=>{class e{constructor(n){this._injector=n,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(n,r){const a=function(e,t){let n;return n="noop"===e?new Uae:("zone.js"===e?void 0:e)||new dn({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==t?void 0:t.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==t?void 0:t.ngZoneRunCoalescing)}),n}(r?r.ngZone:void 0,{ngZoneEventCoalescing:r&&r.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:r&&r.ngZoneRunCoalescing||!1}),u=[{provide:dn,useValue:a}];return a.run(()=>{const l=_r.create({providers:u,parent:this.injector,name:n.moduleType.name}),c=n.create(l),f=c.injector.get(Wf,null);if(!f)throw new di("402","");return a.runOutsideAngular(()=>{const d=a.onError.subscribe({next:h=>{f.handleError(h)}});c.onDestroy(()=>{EC(this._modules,c),d.unsubscribe()})}),function(e,t,n){try{const r=n();return Ky(r)?r.catch(i=>{throw t.runOutsideAngular(()=>e.handleError(i)),i}):r}catch(r){throw t.runOutsideAngular(()=>e.handleError(r)),r}}(f,a,()=>{const d=c.injector.get(vd);return d.runInitializers(),d.donePromise.then(()=>(function(e){pi(e,"Expected localeId to be defined"),"string"==typeof e&&(P3=e.toLowerCase().replace(/_/g,"-"))}(c.injector.get(Du,ev)||ev),this._moduleDoBootstrap(c),c))})})}bootstrapModule(n,r=[]){const i=r5({},r);return function(e,t,n){const r=new JD(n);return Promise.resolve(r)}(0,0,n).then(o=>this.bootstrapModuleFactory(o,i))}_moduleDoBootstrap(n){const r=n.injector.get(rg);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(i=>r.bootstrap(i));else{if(!n.instance.ngDoBootstrap)throw new di("403","");n.instance.ngDoBootstrap(r)}this._modules.push(n)}onDestroy(n){this._destroyListeners.push(n)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new di("404","");this._modules.slice().forEach(n=>n.destroy()),this._destroyListeners.forEach(n=>n()),this._destroyed=!0}get destroyed(){return this._destroyed}}return e.\u0275fac=function(n){return new(n||e)(he(_r))},e.\u0275prov=Xe({token:e,factory:e.\u0275fac}),e})();function r5(e,t){return Array.isArray(t)?t.reduce(r5,e):Object.assign(Object.assign({},e),t)}let rg=(()=>{class e{constructor(n,r,i,o,s){this._zone=n,this._injector=r,this._exceptionHandler=i,this._componentFactoryResolver=o,this._initStatus=s,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const a=new Nt(l=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{l.next(this._stable),l.complete()})}),u=new Nt(l=>{let c;this._zone.runOutsideAngular(()=>{c=this._zone.onStable.subscribe(()=>{dn.assertNotInAngularZone(),vC(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,l.next(!0))})})});const f=this._zone.onUnstable.subscribe(()=>{dn.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{l.next(!1)}))});return()=>{c.unsubscribe(),f.unsubscribe()}});this.isStable=function(...e){const t=mp(e),n=function(e,t){return"number"==typeof Qx(e)?e.pop():1/0}(e),r=e;return r.length?1===r.length?ba(r[0]):gp(n)(Nn(r,t)):wa}(a,u.pipe(function(e={}){const{connector:t=(()=>new va),resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=e;return o=>{let s=null,a=null,u=null,l=0,c=!1,f=!1;const d=()=>{null==a||a.unsubscribe(),a=null},h=()=>{d(),s=u=null,c=f=!1},p=()=>{const g=s;h(),null==g||g.unsubscribe()};return Fn((g,m)=>{l++,!f&&!c&&d();const v=u=null!=u?u:t();m.add(()=>{l--,0===l&&!f&&!c&&(a=Kx(p,i))}),v.subscribe(m),s||(s=new qx({next:y=>v.next(y),error:y=>{f=!0,d(),a=Kx(h,n,y),v.error(y)},complete:()=>{c=!0,d(),a=Kx(h,r),v.complete()}}),Nn(g).subscribe(s))})(o)}}()))}bootstrap(n,r){if(!this._initStatus.done)throw new di("405","");let i;i=n instanceof a$?n:this._componentFactoryResolver.resolveComponentFactory(n),this.componentTypes.push(i.componentType);const o=function(e){return e.isBoundToModule}(i)?void 0:this._injector.get(Oa),a=i.create(_r.NULL,[],r||i.selector,o),u=a.location.nativeElement,l=a.injector.get(wC,null),c=l&&a.injector.get(K$);return l&&c&&c.registerApplication(u,l),a.onDestroy(()=>{this.detachView(a.hostView),EC(this.components,a),c&&c.unregisterApplication(u)}),this._loadComponent(a),a}tick(){if(this._runningTick)throw new di("101","");try{this._runningTick=!0;for(let n of this._views)n.detectChanges()}catch(n){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(n))}finally{this._runningTick=!1}}attachView(n){const r=n;this._views.push(r),r.attachToAppRef(this)}detachView(n){const r=n;EC(this._views,r),r.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n),this._injector.get(W$,[]).concat(this._bootstrapListeners).forEach(i=>i(n))}ngOnDestroy(){this._views.slice().forEach(n=>n.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return e.\u0275fac=function(n){return new(n||e)(he(dn),he(_r),he(Wf),he(pd),he(vd))},e.\u0275prov=Xe({token:e,factory:e.\u0275fac}),e})();function EC(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}let o5=!0,DC=(()=>{class e{}return e.__NG_ELEMENT_ID__=eue,e})();function eue(e){return function(e,t,n){if(gy(e)&&!n){const r=mi(e.index,t);return new Zp(r,r)}return 47&e.type?new Zp(t[16],t):null}(ln(),j(),16==(16&e))}class d5{constructor(){}supports(t){return Vp(t)}create(t){return new aue(t)}}const sue=(e,t)=>t;class aue{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||sue}forEachItem(t){let n;for(n=this._itHead;null!==n;n=n._next)t(n)}forEachOperation(t){let n=this._itHead,r=this._removalsHead,i=0,o=null;for(;n||r;){const s=!r||n&&n.currentIndex<p5(r,i,o)?n:r,a=p5(s,i,o),u=s.currentIndex;if(s===r)i--,r=r._nextRemoved;else if(n=n._next,null==s.previousIndex)i++;else{o||(o=[]);const l=a-i,c=u-i;if(l!=c){for(let d=0;d<l;d++){const h=d<o.length?o[d]:o[d]=0,p=h+d;c<=p&&p<l&&(o[d]=h+1)}o[s.previousIndex]=c-l}}a!==u&&t(s,a,u)}}forEachPreviousItem(t){let n;for(n=this._previousItHead;null!==n;n=n._nextPrevious)t(n)}forEachAddedItem(t){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)t(n)}forEachMovedItem(t){let n;for(n=this._movesHead;null!==n;n=n._nextMoved)t(n)}forEachRemovedItem(t){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)t(n)}forEachIdentityChange(t){let n;for(n=this._identityChangesHead;null!==n;n=n._nextIdentityChange)t(n)}diff(t){if(null==t&&(t=[]),!Vp(t))throw new Error(`Error trying to diff '${Ue(t)}'. Only arrays and iterables are allowed`);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let i,o,s,n=this._itHead,r=!1;if(Array.isArray(t)){this.length=t.length;for(let a=0;a<this.length;a++)o=t[a],s=this._trackByFn(a,o),null!==n&&Object.is(n.trackById,s)?(r&&(n=this._verifyReinsertion(n,o,s,a)),Object.is(n.item,o)||this._addIdentityChange(n,o)):(n=this._mismatch(n,o,s,a),r=!0),n=n._next}else i=0,function(e,t){if(Array.isArray(e))for(let n=0;n<e.length;n++)t(e[n]);else{const n=e[ed()]();let r;for(;!(r=n.next()).done;)t(r.value)}}(t,a=>{s=this._trackByFn(i,a),null!==n&&Object.is(n.trackById,s)?(r&&(n=this._verifyReinsertion(n,a,s,i)),Object.is(n.item,a)||this._addIdentityChange(n,a)):(n=this._mismatch(n,a,s,i),r=!0),n=n._next,i++}),this.length=i;return this._truncate(n),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,n,r,i){let o;return null===t?o=this._itTail:(o=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null))?(Object.is(t.item,n)||this._addIdentityChange(t,n),this._reinsertAfter(t,o,i)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(r,i))?(Object.is(t.item,n)||this._addIdentityChange(t,n),this._moveAfter(t,o,i)):t=this._addAfter(new uue(n,r),o,i),t}_verifyReinsertion(t,n,r,i){let o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null);return null!==o?t=this._reinsertAfter(o,t._prev,i):t.currentIndex!=i&&(t.currentIndex=i,this._addToMoves(t,i)),t}_truncate(t){for(;null!==t;){const n=t._next;this._addToRemovals(this._unlink(t)),t=n}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,n,r){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const i=t._prevRemoved,o=t._nextRemoved;return null===i?this._removalsHead=o:i._nextRemoved=o,null===o?this._removalsTail=i:o._prevRemoved=i,this._insertAfter(t,n,r),this._addToMoves(t,r),t}_moveAfter(t,n,r){return this._unlink(t),this._insertAfter(t,n,r),this._addToMoves(t,r),t}_addAfter(t,n,r){return this._insertAfter(t,n,r),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,n,r){const i=null===n?this._itHead:n._next;return t._next=i,t._prev=n,null===i?this._itTail=t:i._prev=t,null===n?this._itHead=t:n._next=t,null===this._linkedRecords&&(this._linkedRecords=new h5),this._linkedRecords.put(t),t.currentIndex=r,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const n=t._prev,r=t._next;return null===n?this._itHead=r:n._next=r,null===r?this._itTail=n:r._prev=n,t}_addToMoves(t,n){return t.previousIndex===n||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new h5),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,n){return t.item=n,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class uue{constructor(t,n){this.item=t,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class lue{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,n){let r;for(r=this._head;null!==r;r=r._nextDup)if((null===n||n<=r.currentIndex)&&Object.is(r.trackById,t))return r;return null}remove(t){const n=t._prevDup,r=t._nextDup;return null===n?this._head=r:n._nextDup=r,null===r?this._tail=n:r._prevDup=n,null===this._head}}class h5{constructor(){this.map=new Map}put(t){const n=t.trackById;let r=this.map.get(n);r||(r=new lue,this.map.set(n,r)),r.add(t)}get(t,n){const i=this.map.get(t);return i?i.get(t,n):null}remove(t){const n=t.trackById;return this.map.get(n).remove(t)&&this.map.delete(n),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function p5(e,t,n){const r=e.previousIndex;if(null===r)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+t+i}class g5{constructor(){}supports(t){return t instanceof Map||FD(t)}create(){return new cue}}class cue{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let n;for(n=this._mapHead;null!==n;n=n._next)t(n)}forEachPreviousItem(t){let n;for(n=this._previousMapHead;null!==n;n=n._nextPrevious)t(n)}forEachChangedItem(t){let n;for(n=this._changesHead;null!==n;n=n._nextChanged)t(n)}forEachAddedItem(t){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)t(n)}forEachRemovedItem(t){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)t(n)}diff(t){if(t){if(!(t instanceof Map||FD(t)))throw new Error(`Error trying to diff '${Ue(t)}'. Only maps and objects are allowed`)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let n=this._mapHead;if(this._appendAfter=null,this._forEach(t,(r,i)=>{if(n&&n.key===i)this._maybeAddToChanges(n,r),this._appendAfter=n,n=n._next;else{const o=this._getOrCreateRecordForKey(i,r);n=this._insertBeforeOrAppend(n,o)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(let r=n;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,n){if(t){const r=t._prev;return n._next=t,n._prev=r,t._prev=n,r&&(r._next=n),t===this._mapHead&&(this._mapHead=n),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=n,n._prev=this._appendAfter):this._mapHead=n,this._appendAfter=n,null}_getOrCreateRecordForKey(t,n){if(this._records.has(t)){const i=this._records.get(t);this._maybeAddToChanges(i,n);const o=i._prev,s=i._next;return o&&(o._next=s),s&&(s._prev=o),i._next=null,i._prev=null,i}const r=new fue(t);return this._records.set(t,r),r.currentValue=n,this._addToAdditions(r),r}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,n){Object.is(n,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=n,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,n){t instanceof Map?t.forEach(n):Object.keys(t).forEach(r=>n(t[r],r))}}class fue{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function m5(){return new ig([new d5])}let ig=(()=>{class e{constructor(n){this.factories=n}static create(n,r){if(null!=r){const i=r.factories.slice();n=n.concat(i)}return new e(n)}static extend(n){return{provide:e,useFactory:r=>e.create(n,r||m5()),deps:[[e,new Hf,new gs]]}}find(n){const r=this.factories.find(i=>i.supports(n));if(null!=r)return r;throw new Error(`Cannot find a differ supporting object '${n}' of type '${function(e){return e.name||typeof e}(n)}'`)}}return e.\u0275prov=Xe({token:e,providedIn:"root",factory:m5}),e})();function y5(){return new bd([new g5])}let bd=(()=>{class e{constructor(n){this.factories=n}static create(n,r){if(r){const i=r.factories.slice();n=n.concat(i)}return new e(n)}static extend(n){return{provide:e,useFactory:r=>e.create(n,r||y5()),deps:[[e,new Hf,new gs]]}}find(n){const r=this.factories.find(i=>i.supports(n));if(r)return r;throw new Error(`Cannot find a differ supporting object '${n}'`)}}return e.\u0275prov=Xe({token:e,providedIn:"root",factory:y5}),e})();const hue=[new g5],gue=new ig([new d5]),mue=new bd(hue),yue=e5(null,"core",[{provide:yC,useValue:"unknown"},{provide:n5,deps:[_r]},{provide:K$,deps:[]},{provide:G$,deps:[]}]),xue=[{provide:rg,useClass:rg,deps:[dn,_r,Wf,pd,vd]},{provide:kse,deps:[dn],useFactory:function(e){let t=[];return e.onStable.subscribe(()=>{for(;t.length;)t.pop()()}),function(n){t.push(n)}}},{provide:vd,useClass:vd,deps:[[new gs,dv]]},{provide:hv,useClass:hv,deps:[]},Rae,{provide:ig,useFactory:function(){return gue},deps:[]},{provide:bd,useFactory:function(){return mue},deps:[]},{provide:Du,useFactory:function(e){return e||"undefined"!=typeof $localize&&$localize.locale||ev},deps:[[new Fp(Du),new gs,new Hf]]},{provide:Y$,useValue:"USD"}];let Due=(()=>{class e{constructor(n){}}return e.\u0275fac=function(n){return new(n||e)(he(rg))},e.\u0275mod=Yl({type:e}),e.\u0275inj=hu({providers:xue}),e})(),gv=null;function Cu(){return gv}const Vi=new Qe("DocumentToken");let oc=(()=>{class e{historyGo(n){throw new Error("Not implemented")}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Xe({token:e,factory:function(){return he(v5)},providedIn:"platform"}),e})();const Mue=new Qe("Location Initialized");let v5=(()=>{class e extends oc{constructor(n){super(),this._doc=n,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Cu().getBaseHref(this._doc)}onPopState(n){const r=Cu().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",n,!1),()=>r.removeEventListener("popstate",n)}onHashChange(n){const r=Cu().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",n,!1),()=>r.removeEventListener("hashchange",n)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(n){this.location.pathname=n}pushState(n,r,i){b5()?this._history.pushState(n,r,i):this.location.hash=i}replaceState(n,r,i){b5()?this._history.replaceState(n,r,i):this.location.hash=i}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}}return e.\u0275fac=function(n){return new(n||e)(he(Vi))},e.\u0275prov=Xe({token:e,factory:function(){return new v5(he(Vi))},providedIn:"platform"}),e})();function b5(){return!!window.history.pushState}function MC(e,t){if(0==e.length)return t;if(0==t.length)return e;let n=0;return e.endsWith("/")&&n++,t.startsWith("/")&&n++,2==n?e+t.substring(1):1==n?e+t:e+"/"+t}function _5(e){const t=e.match(/#|\?|$/),n=t&&t.index||e.length;return e.slice(0,n-("/"===e[n-1]?1:0))+e.slice(n)}function Ta(e){return e&&"?"!==e[0]?"?"+e:e}let _d=(()=>{class e{historyGo(n){throw new Error("Not implemented")}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Xe({token:e,factory:function(){return function(e){const t=he(Vi).location;return new w5(he(oc),t&&t.origin||"")}()},providedIn:"root"}),e})();const TC=new Qe("appBaseHref");let w5=(()=>{class e extends _d{constructor(n,r){if(super(),this._platformLocation=n,this._removeListenerFns=[],null==r&&(r=this._platformLocation.getBaseHrefFromDOM()),null==r)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=r}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return MC(this._baseHref,n)}path(n=!1){const r=this._platformLocation.pathname+Ta(this._platformLocation.search),i=this._platformLocation.hash;return i&&n?`${r}${i}`:r}pushState(n,r,i,o){const s=this.prepareExternalUrl(i+Ta(o));this._platformLocation.pushState(n,r,s)}replaceState(n,r,i,o){const s=this.prepareExternalUrl(i+Ta(o));this._platformLocation.replaceState(n,r,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(n=0){var r,i;null===(i=(r=this._platformLocation).historyGo)||void 0===i||i.call(r,n)}}return e.\u0275fac=function(n){return new(n||e)(he(oc),he(TC,8))},e.\u0275prov=Xe({token:e,factory:e.\u0275fac}),e})(),Iue=(()=>{class e extends _d{constructor(n,r){super(),this._platformLocation=n,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}path(n=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(n){const r=MC(this._baseHref,n);return r.length>0?"#"+r:r}pushState(n,r,i,o){let s=this.prepareExternalUrl(i+Ta(o));0==s.length&&(s=this._platformLocation.pathname),this._platformLocation.pushState(n,r,s)}replaceState(n,r,i,o){let s=this.prepareExternalUrl(i+Ta(o));0==s.length&&(s=this._platformLocation.pathname),this._platformLocation.replaceState(n,r,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(n=0){var r,i;null===(i=(r=this._platformLocation).historyGo)||void 0===i||i.call(r,n)}}return e.\u0275fac=function(n){return new(n||e)(he(oc),he(TC,8))},e.\u0275prov=Xe({token:e,factory:e.\u0275fac}),e})(),kC=(()=>{class e{constructor(n,r){this._subject=new xr,this._urlChangeListeners=[],this._platformStrategy=n;const i=this._platformStrategy.getBaseHref();this._platformLocation=r,this._baseHref=_5(x5(i)),this._platformStrategy.onPopState(o=>{this._subject.emit({url:this.path(!0),pop:!0,state:o.state,type:o.type})})}path(n=!1){return this.normalize(this._platformStrategy.path(n))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(n,r=""){return this.path()==this.normalize(n+Ta(r))}normalize(n){return e.stripTrailingSlash(function(e,t){return e&&t.startsWith(e)?t.substring(e.length):t}(this._baseHref,x5(n)))}prepareExternalUrl(n){return n&&"/"!==n[0]&&(n="/"+n),this._platformStrategy.prepareExternalUrl(n)}go(n,r="",i=null){this._platformStrategy.pushState(i,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+Ta(r)),i)}replaceState(n,r="",i=null){this._platformStrategy.replaceState(i,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+Ta(r)),i)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(n=0){var r,i;null===(i=(r=this._platformStrategy).historyGo)||void 0===i||i.call(r,n)}onUrlChange(n){this._urlChangeListeners.push(n),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}))}_notifyUrlChangeListeners(n="",r){this._urlChangeListeners.forEach(i=>i(n,r))}subscribe(n,r,i){return this._subject.subscribe({next:n,error:r,complete:i})}}return e.normalizeQueryParams=Ta,e.joinWithSlash=MC,e.stripTrailingSlash=_5,e.\u0275fac=function(n){return new(n||e)(he(_d),he(oc))},e.\u0275prov=Xe({token:e,factory:function(){return new kC(he(_d),he(oc))},providedIn:"root"}),e})();function x5(e){return e.replace(/\/index.html$/,"")}var nn=(()=>((nn=nn||{})[nn.Zero=0]="Zero",nn[nn.One=1]="One",nn[nn.Two=2]="Two",nn[nn.Few=3]="Few",nn[nn.Many=4]="Many",nn[nn.Other=5]="Other",nn))();const zue=function(e){return function(e){const t=function(e){return e.toLowerCase().replace(/_/g,"-")}(e);let n=N3(t);if(n)return n;const r=t.split("-")[0];if(n=N3(r),n)return n;if("en"===r)return boe;throw new Error(`Missing locale data for the locale "${e}".`)}(e)[K.PluralCase]};class Cv{}let mle=(()=>{class e extends Cv{constructor(n){super(),this.locale=n}getPluralCategory(n,r){switch(zue(r||this.locale)(n)){case nn.Zero:return"zero";case nn.One:return"one";case nn.Two:return"two";case nn.Few:return"few";case nn.Many:return"many";default:return"other"}}}return e.\u0275fac=function(n){return new(n||e)(he(Du))},e.\u0275prov=Xe({token:e,factory:e.\u0275fac}),e})(),Qle=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Yl({type:e}),e.\u0275inj=hu({providers:[{provide:Cv,useClass:mle}]}),e})();let ece=(()=>{class e{}return e.\u0275prov=Xe({token:e,providedIn:"root",factory:()=>new tce(he(Vi),window)}),e})();class tce{constructor(t,n){this.document=t,this.window=n,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(!this.supportsScrolling())return;const n=function(e,t){const n=e.getElementById(t)||e.getElementsByName(t)[0];if(n)return n;if("function"==typeof e.createTreeWalker&&e.body&&(e.body.createShadowRoot||e.body.attachShadow)){const r=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT);let i=r.currentNode;for(;i;){const o=i.shadowRoot;if(o){const s=o.getElementById(t)||o.querySelector(`[name="${t}"]`);if(s)return s}i=r.nextNode()}}return null}(this.document,t);n&&(this.scrollToElement(n),this.attemptFocus(n))}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const n=this.window.history;n&&n.scrollRestoration&&(n.scrollRestoration=t)}}scrollToElement(t){const n=t.getBoundingClientRect(),r=n.left+this.window.pageXOffset,i=n.top+this.window.pageYOffset,o=this.offset();this.window.scrollTo(r-o[0],i-o[1])}attemptFocus(t){return t.focus(),this.document.activeElement===t}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const t=P5(this.window.history)||P5(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch(t){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(t){return!1}}}function P5(e){return Object.getOwnPropertyDescriptor(e,"scrollRestoration")}class VC extends class extends class{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){var e;e=new VC,gv||(gv=e)}onAndCancel(t,n,r){return t.addEventListener(n,r,!1),()=>{t.removeEventListener(n,r,!1)}}dispatchEvent(t,n){t.dispatchEvent(n)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,n){return(n=n||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,n){return"window"===n?window:"document"===n?t:"body"===n?t.body:null}getBaseHref(t){const n=(ag=ag||document.querySelector("base"),ag?ag.getAttribute("href"):null);return null==n?null:function(e){Sv=Sv||document.createElement("a"),Sv.setAttribute("href",e);const t=Sv.pathname;return"/"===t.charAt(0)?t:`/${t}`}(n)}resetBaseElement(){ag=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return function(e,t){t=encodeURIComponent(t);for(const n of e.split(";")){const r=n.indexOf("="),[i,o]=-1==r?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===t)return decodeURIComponent(o)}return null}(document.cookie,t)}}let Sv,ag=null;const L5=new Qe("TRANSITION_ID"),uce=[{provide:dv,useFactory:function(e,t,n){return()=>{n.get(vd).donePromise.then(()=>{const r=Cu(),i=t.querySelectorAll(`style[ng-transition="${e}"]`);for(let o=0;o<i.length;o++)r.remove(i[o])})}},deps:[L5,Vi,_r],multi:!0}];class qC{static init(){var e;e=new qC,xC=e}addToWindow(t){ct.getAngularTestability=(r,i=!0)=>{const o=t.findTestabilityInTree(r,i);if(null==o)throw new Error("Could not find testability for element.");return o},ct.getAllAngularTestabilities=()=>t.getAllTestabilities(),ct.getAllAngularRootElements=()=>t.getAllRootElements(),ct.frameworkStabilizers||(ct.frameworkStabilizers=[]),ct.frameworkStabilizers.push(r=>{const i=ct.getAllAngularTestabilities();let o=i.length,s=!1;const a=function(u){s=s||u,o--,0==o&&r(s)};i.forEach(function(u){u.whenStable(a)})})}findTestabilityInTree(t,n,r){if(null==n)return null;const i=t.getTestability(n);return null!=i?i:r?Cu().isShadowRoot(n)?this.findTestabilityInTree(t,n.host,!0):this.findTestabilityInTree(t,n.parentElement,!0):null}}let lce=(()=>{class e{build(){return new XMLHttpRequest}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Xe({token:e,factory:e.\u0275fac}),e})();const Av=new Qe("EventManagerPlugins");let Ov=(()=>{class e{constructor(n,r){this._zone=r,this._eventNameToPlugin=new Map,n.forEach(i=>i.manager=this),this._plugins=n.slice().reverse()}addEventListener(n,r,i){return this._findPluginFor(r).addEventListener(n,r,i)}addGlobalEventListener(n,r,i){return this._findPluginFor(r).addGlobalEventListener(n,r,i)}getZone(){return this._zone}_findPluginFor(n){const r=this._eventNameToPlugin.get(n);if(r)return r;const i=this._plugins;for(let o=0;o<i.length;o++){const s=i[o];if(s.supports(n))return this._eventNameToPlugin.set(n,s),s}throw new Error(`No event manager plugin found for event ${n}`)}}return e.\u0275fac=function(n){return new(n||e)(he(Av),he(dn))},e.\u0275prov=Xe({token:e,factory:e.\u0275fac}),e})();class j5{constructor(t){this._doc=t}addGlobalEventListener(t,n,r){const i=Cu().getGlobalEventTarget(this._doc,t);if(!i)throw new Error(`Unsupported event target ${i} for event ${n}`);return this.addEventListener(i,n,r)}}let $5=(()=>{class e{constructor(){this._stylesSet=new Set}addStyles(n){const r=new Set;n.forEach(i=>{this._stylesSet.has(i)||(this._stylesSet.add(i),r.add(i))}),this.onStylesAdded(r)}onStylesAdded(n){}getAllStyles(){return Array.from(this._stylesSet)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Xe({token:e,factory:e.\u0275fac}),e})(),ug=(()=>{class e extends $5{constructor(n){super(),this._doc=n,this._hostNodes=new Map,this._hostNodes.set(n.head,[])}_addStylesToHost(n,r,i){n.forEach(o=>{const s=this._doc.createElement("style");s.textContent=o,i.push(r.appendChild(s))})}addHost(n){const r=[];this._addStylesToHost(this._stylesSet,n,r),this._hostNodes.set(n,r)}removeHost(n){const r=this._hostNodes.get(n);r&&r.forEach(B5),this._hostNodes.delete(n)}onStylesAdded(n){this._hostNodes.forEach((r,i)=>{this._addStylesToHost(n,i,r)})}ngOnDestroy(){this._hostNodes.forEach(n=>n.forEach(B5))}}return e.\u0275fac=function(n){return new(n||e)(he(Vi))},e.\u0275prov=Xe({token:e,factory:e.\u0275fac}),e})();function B5(e){Cu().remove(e)}const WC={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},GC=/%COMP%/g;function Mv(e,t,n){for(let r=0;r<t.length;r++){let i=t[r];Array.isArray(i)?Mv(e,i,n):(i=i.replace(GC,e),n.push(i))}return n}function H5(e){return t=>{if("__ngUnwrap__"===t)return e;!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}let YC=(()=>{class e{constructor(n,r,i){this.eventManager=n,this.sharedStylesHost=r,this.appId=i,this.rendererByCompId=new Map,this.defaultRenderer=new XC(n)}createRenderer(n,r){if(!n||!r)return this.defaultRenderer;switch(r.encapsulation){case fs.Emulated:{let i=this.rendererByCompId.get(r.id);return i||(i=new gce(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,i)),i.applyToHost(n),i}case 1:case fs.ShadowDom:return new mce(this.eventManager,this.sharedStylesHost,n,r);default:if(!this.rendererByCompId.has(r.id)){const i=Mv(r.id,r.styles,[]);this.sharedStylesHost.addStyles(i),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return e.\u0275fac=function(n){return new(n||e)(he(Ov),he(ug),he(ng))},e.\u0275prov=Xe({token:e,factory:e.\u0275fac}),e})();class XC{constructor(t){this.eventManager=t,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,n){return n?document.createElementNS(WC[n]||n,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,n){t.appendChild(n)}insertBefore(t,n,r){t&&t.insertBefore(n,r)}removeChild(t,n){t&&t.removeChild(n)}selectRootElement(t,n){let r="string"==typeof t?document.querySelector(t):t;if(!r)throw new Error(`The selector "${t}" did not match any elements`);return n||(r.textContent=""),r}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,n,r,i){if(i){n=i+":"+n;const o=WC[i];o?t.setAttributeNS(o,n,r):t.setAttribute(n,r)}else t.setAttribute(n,r)}removeAttribute(t,n,r){if(r){const i=WC[r];i?t.removeAttributeNS(i,n):t.removeAttribute(`${r}:${n}`)}else t.removeAttribute(n)}addClass(t,n){t.classList.add(n)}removeClass(t,n){t.classList.remove(n)}setStyle(t,n,r,i){i&(vi.DashCase|vi.Important)?t.style.setProperty(n,r,i&vi.Important?"important":""):t.style[n]=r}removeStyle(t,n,r){r&vi.DashCase?t.style.removeProperty(n):t.style[n]=""}setProperty(t,n,r){t[n]=r}setValue(t,n){t.nodeValue=n}listen(t,n,r){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,n,H5(r)):this.eventManager.addEventListener(t,n,H5(r))}}class gce extends XC{constructor(t,n,r,i){super(t),this.component=r;const o=Mv(i+"-"+r.id,r.styles,[]);n.addStyles(o),this.contentAttr="_ngcontent-%COMP%".replace(GC,i+"-"+r.id),this.hostAttr=function(e){return"_nghost-%COMP%".replace(GC,e)}(i+"-"+r.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,n){const r=super.createElement(t,n);return super.setAttribute(r,this.contentAttr,""),r}}class mce extends XC{constructor(t,n,r,i){super(t),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const o=Mv(i.id,i.styles,[]);for(let s=0;s<o.length;s++){const a=document.createElement("style");a.textContent=o[s],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,n){return super.appendChild(this.nodeOrShadowRoot(t),n)}insertBefore(t,n,r){return super.insertBefore(this.nodeOrShadowRoot(t),n,r)}removeChild(t,n){return super.removeChild(this.nodeOrShadowRoot(t),n)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let yce=(()=>{class e extends j5{constructor(n){super(n)}supports(n){return!0}addEventListener(n,r,i){return n.addEventListener(r,i,!1),()=>this.removeEventListener(n,r,i)}removeEventListener(n,r,i){return n.removeEventListener(r,i)}}return e.\u0275fac=function(n){return new(n||e)(he(Vi))},e.\u0275prov=Xe({token:e,factory:e.\u0275fac}),e})();const q5=["alt","control","meta","shift"],bce={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},W5={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},_ce={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey};let wce=(()=>{class e extends j5{constructor(n){super(n)}supports(n){return null!=e.parseEventName(n)}addEventListener(n,r,i){const o=e.parseEventName(r),s=e.eventCallback(o.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Cu().onAndCancel(n,o.domEventName,s))}static parseEventName(n){const r=n.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const o=e._normalizeKey(r.pop());let s="";if(q5.forEach(u=>{const l=r.indexOf(u);l>-1&&(r.splice(l,1),s+=u+".")}),s+=o,0!=r.length||0===o.length)return null;const a={};return a.domEventName=i,a.fullKey=s,a}static getEventFullKey(n){let r="",i=function(e){let t=e.key;if(null==t){if(t=e.keyIdentifier,null==t)return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&W5.hasOwnProperty(t)&&(t=W5[t]))}return bce[t]||t}(n);return i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),q5.forEach(o=>{o!=i&&_ce[o](n)&&(r+=o+".")}),r+=i,r}static eventCallback(n,r,i){return o=>{e.getEventFullKey(o)===n&&i.runGuarded(()=>r(o))}}static _normalizeKey(n){return"esc"===n?"escape":n}}return e.\u0275fac=function(n){return new(n||e)(he(Vi))},e.\u0275prov=Xe({token:e,factory:e.\u0275fac}),e})();const Sce=e5(yue,"browser",[{provide:yC,useValue:"browser"},{provide:q$,useValue:function(){VC.makeCurrent(),qC.init()},multi:!0},{provide:Vi,useFactory:function(){return e=document,dE=e,document;var e},deps:[]}]),Ace=[{provide:AD,useValue:"root"},{provide:Wf,useFactory:function(){return new Wf},deps:[]},{provide:Av,useClass:yce,multi:!0,deps:[Vi,dn,yC]},{provide:Av,useClass:wce,multi:!0,deps:[Vi]},{provide:YC,useClass:YC,deps:[Ov,ug,ng]},{provide:l$,useExisting:YC},{provide:$5,useExisting:ug},{provide:ug,useClass:ug,deps:[Vi]},{provide:wC,useClass:wC,deps:[dn]},{provide:Ov,useClass:Ov,deps:[Av,dn]},{provide:class{},useClass:lce,deps:[]}];let Oce=(()=>{class e{constructor(n){if(n)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(n){return{ngModule:e,providers:[{provide:ng,useValue:n.appId},{provide:L5,useExisting:ng},uce]}}}return e.\u0275fac=function(n){return new(n||e)(he(e,12))},e.\u0275mod=Yl({type:e}),e.\u0275inj=hu({providers:Ace,imports:[Qle,Due]}),e})();function Ae(...e){return Nn(e,mp(e))}"undefined"!=typeof window&&window;class Mo extends va{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const n=super._subscribe(t);return!n.closed&&t.next(this._value),n}getValue(){const{hasError:t,thrownError:n,_value:r}=this;if(t)throw n;return this._throwIfClosed(),r}next(t){super.next(this._value=t)}}const{isArray:$ce}=Array,{getPrototypeOf:Bce,prototype:zce,keys:Uce}=Object;const{isArray:qce}=Array;function Xce(...e){const t=mp(e),n=function(e){return Pe(Qx(e))?e.pop():void 0}(e),{args:r,keys:i}=function(e){if(1===e.length){const t=e[0];if($ce(t))return{args:t,keys:null};if(function(e){return e&&"object"==typeof e&&Bce(e)===zce}(t)){const n=Uce(t);return{args:n.map(r=>t[r]),keys:n}}}return{args:e,keys:null}}(e);if(0===r.length)return Nn([],t);const o=new Nt(function(e,t,n=Wl){return r=>{X5(t,()=>{const{length:i}=e,o=new Array(i);let s=i,a=i;for(let u=0;u<i;u++)X5(t,()=>{const l=Nn(e[u],t);let c=!1;l.subscribe(new Rn(r,f=>{o[u]=f,c||(c=!0,a--),a||r.next(n(o.slice()))},()=>{--s||r.complete()}))},r)},r)}}(r,t,i?s=>function(e,t){return e.reduce((n,r,i)=>(n[r]=t[i],n),{})}(i,s):Wl));return n?o.pipe(function(e){return Ct(t=>function(e,t){return qce(t)?e(...t):e(t)}(e,t))}(n)):o}function X5(e,t,n){e?_a(n,e,t):t()}const Tv=me(e=>function(){e(this),this.name="EmptyError",this.message="no elements in sequence"});function KC(...e){return gp(1)(Nn(e,mp(e)))}function Q5(e){return new Nt(t=>{ba(e()).subscribe(t)})}function K5(){return Fn((e,t)=>{let n=null;e._refCount++;const r=new Rn(t,void 0,void 0,void 0,()=>{if(!e||e._refCount<=0||0<--e._refCount)return void(n=null);const i=e._connection,o=n;n=null,i&&(!o||i===o)&&i.unsubscribe(),t.unsubscribe()});e.subscribe(r),r.closed||(n=e.connect())})}class Zce extends Nt{constructor(t,n){super(),this.source=t,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,fN(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,null==t||t.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new Jt;const n=this.getSubject();t.add(this.source.subscribe(new Rn(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),t.closed&&(this._connection=null,t=Jt.EMPTY)}return t}refCount(){return K5()(this)}}function sc(e,t){return Fn((n,r)=>{let i=null,o=0,s=!1;const a=()=>s&&!i&&r.complete();n.subscribe(new Rn(r,u=>{null==i||i.unsubscribe();let l=0;const c=o++;ba(e(u,c)).subscribe(i=new Rn(r,f=>r.next(t?t(u,f,c,l++):f),()=>{i=null,a()}))},()=>{s=!0,a()}))})}function efe(e,t,n,r,i){return(o,s)=>{let a=n,u=t,l=0;o.subscribe(new Rn(s,c=>{const f=l++;u=a?e(u,c,f):(a=!0,c),r&&s.next(u)},i&&(()=>{a&&s.next(u),s.complete()})))}}function Z5(e,t){return Fn(efe(e,t,arguments.length>=2,!0))}function wd(e,t){return Fn((n,r)=>{let i=0;n.subscribe(new Rn(r,o=>e.call(t,o,i++)&&r.next(o)))})}function Au(e){return Fn((t,n)=>{let o,r=null,i=!1;r=t.subscribe(new Rn(n,void 0,void 0,s=>{o=ba(e(s,Au(e)(t))),r?(r.unsubscribe(),r=null,o.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,o.subscribe(n))})}function lg(e,t){return Pe(t)?_n(e,t,1):_n(e,1)}function ZC(e){return e<=0?()=>wa:Fn((t,n)=>{let r=[];t.subscribe(new Rn(n,i=>{r.push(i),e<r.length&&r.shift()},()=>{for(const i of r)n.next(i);n.complete()},void 0,()=>{r=null}))})}function J5(e=tfe){return Fn((t,n)=>{let r=!1;t.subscribe(new Rn(n,i=>{r=!0,n.next(i)},()=>r?n.complete():n.error(e())))})}function tfe(){return new Tv}function e8(e){return Fn((t,n)=>{let r=!1;t.subscribe(new Rn(n,i=>{r=!0,n.next(i)},()=>{r||n.next(e),n.complete()}))})}function xd(e,t){const n=arguments.length>=2;return r=>r.pipe(e?wd((i,o)=>e(i,o,r)):Wl,ay(1),n?e8(t):J5(()=>new Tv))}function _i(e,t,n){const r=Pe(e)||t||n?{next:e,error:t,complete:n}:e;return r?Fn((i,o)=>{var s;null===(s=r.subscribe)||void 0===s||s.call(r);let a=!0;i.subscribe(new Rn(o,u=>{var l;null===(l=r.next)||void 0===l||l.call(r,u),o.next(u)},()=>{var u;a=!1,null===(u=r.complete)||void 0===u||u.call(r),o.complete()},u=>{var l;a=!1,null===(l=r.error)||void 0===l||l.call(r,u),o.error(u)},()=>{var u,l;a&&(null===(u=r.unsubscribe)||void 0===u||u.call(r)),null===(l=r.finalize)||void 0===l||l.call(r)}))}):Wl}class Ia{constructor(t,n){this.id=t,this.url=n}}class JC extends Ia{constructor(t,n,r="imperative",i=null){super(t,n),this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class cg extends Ia{constructor(t,n,r){super(t,n),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class t8 extends Ia{constructor(t,n,r){super(t,n),this.reason=r}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class ife extends Ia{constructor(t,n,r){super(t,n),this.error=r}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class ofe extends Ia{constructor(t,n,r,i){super(t,n),this.urlAfterRedirects=r,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class sfe extends Ia{constructor(t,n,r,i){super(t,n),this.urlAfterRedirects=r,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class afe extends Ia{constructor(t,n,r,i,o){super(t,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class ufe extends Ia{constructor(t,n,r,i){super(t,n),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class lfe extends Ia{constructor(t,n,r,i){super(t,n),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class n8{constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class r8{constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class cfe{constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ffe{constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class dfe{constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class hfe{constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class i8{constructor(t,n,r){this.routerEvent=t,this.position=n,this.anchor=r}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const Fe="primary";class pfe{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const n=this.params[t];return Array.isArray(n)?n[0]:n}return null}getAll(t){if(this.has(t)){const n=this.params[t];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}}function Ed(e){return new pfe(e)}const o8="ngNavigationCancelingError";function eS(e){const t=Error("NavigationCancelingError: "+e);return t[o8]=!0,t}function mfe(e,t,n){const r=n.path.split("/");if(r.length>e.length||"full"===n.pathMatch&&(t.hasChildren()||r.length<e.length))return null;const i={};for(let o=0;o<r.length;o++){const s=r[o],a=e[o];if(s.startsWith(":"))i[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:e.slice(0,r.length),posParams:i}}function xs(e,t){const n=e?Object.keys(e):void 0,r=t?Object.keys(t):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let o=0;o<n.length;o++)if(i=n[o],!s8(e[i],t[i]))return!1;return!0}function s8(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;const n=[...e].sort(),r=[...t].sort();return n.every((i,o)=>r[o]===i)}return e===t}function a8(e){return Array.prototype.concat.apply([],e)}function u8(e){return e.length>0?e[e.length-1]:null}function Pn(e,t){for(const n in e)e.hasOwnProperty(n)&&t(e[n],n)}function Es(e){return Bj(e)?e:Ky(e)?Nn(Promise.resolve(e)):Ae(e)}const bfe={exact:function f8(e,t,n){if(!uc(e.segments,t.segments)||!kv(e.segments,t.segments,n)||e.numberOfChildren!==t.numberOfChildren)return!1;for(const r in t.children)if(!e.children[r]||!f8(e.children[r],t.children[r],n))return!1;return!0},subset:d8},l8={exact:function(e,t){return xs(e,t)},subset:function(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(n=>s8(e[n],t[n]))},ignored:()=>!0};function c8(e,t,n){return bfe[n.paths](e.root,t.root,n.matrixParams)&&l8[n.queryParams](e.queryParams,t.queryParams)&&!("exact"===n.fragment&&e.fragment!==t.fragment)}function d8(e,t,n){return h8(e,t,t.segments,n)}function h8(e,t,n,r){if(e.segments.length>n.length){const i=e.segments.slice(0,n.length);return!(!uc(i,n)||t.hasChildren()||!kv(i,n,r))}if(e.segments.length===n.length){if(!uc(e.segments,n)||!kv(e.segments,n,r))return!1;for(const i in t.children)if(!e.children[i]||!d8(e.children[i],t.children[i],r))return!1;return!0}{const i=n.slice(0,e.segments.length),o=n.slice(e.segments.length);return!!(uc(e.segments,i)&&kv(e.segments,i,r)&&e.children[Fe])&&h8(e.children[Fe],t,o,r)}}function kv(e,t,n){return t.every((r,i)=>l8[n](e[i].parameters,r.parameters))}class ac{constructor(t,n,r){this.root=t,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Ed(this.queryParams)),this._queryParamMap}toString(){return Dfe.serialize(this)}}class Le{constructor(t,n){this.segments=t,this.children=n,this.parent=null,Pn(n,(r,i)=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Iv(this)}}class fg{constructor(t,n){this.path=t,this.parameters=n}get parameterMap(){return this._parameterMap||(this._parameterMap=Ed(this.parameters)),this._parameterMap}toString(){return v8(this)}}function uc(e,t){return e.length===t.length&&e.every((n,r)=>n.path===t[r].path)}class p8{}class g8{parse(t){const n=new Ffe(t);return new ac(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(t){const n=`/${dg(t.root,!0)}`,r=function(e){const t=Object.keys(e).map(n=>{const r=e[n];return Array.isArray(r)?r.map(i=>`${Fv(n)}=${Fv(i)}`).join("&"):`${Fv(n)}=${Fv(r)}`}).filter(n=>!!n);return t.length?`?${t.join("&")}`:""}(t.queryParams);var e;return`${n}${r}${"string"==typeof t.fragment?`#${e=t.fragment,encodeURI(e)}`:""}`}}const Dfe=new g8;function Iv(e){return e.segments.map(t=>v8(t)).join("/")}function dg(e,t){if(!e.hasChildren())return Iv(e);if(t){const n=e.children[Fe]?dg(e.children[Fe],!1):"",r=[];return Pn(e.children,(i,o)=>{o!==Fe&&r.push(`${o}:${dg(i,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}{const n=function(e,t){let n=[];return Pn(e.children,(r,i)=>{i===Fe&&(n=n.concat(t(r,i)))}),Pn(e.children,(r,i)=>{i!==Fe&&(n=n.concat(t(r,i)))}),n}(e,(r,i)=>i===Fe?[dg(e.children[Fe],!1)]:[`${i}:${dg(r,!1)}`]);return 1===Object.keys(e.children).length&&null!=e.children[Fe]?`${Iv(e)}/${n[0]}`:`${Iv(e)}/(${n.join("//")})`}}function m8(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Fv(e){return m8(e).replace(/%3B/gi,";")}function tS(e){return m8(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Rv(e){return decodeURIComponent(e)}function y8(e){return Rv(e.replace(/\+/g,"%20"))}function v8(e){return`${tS(e.path)}${function(e){return Object.keys(e).map(t=>`;${tS(t)}=${tS(e[t])}`).join("")}(e.parameters)}`}const Ofe=/^[^\/()?;=#]+/;function Nv(e){const t=e.match(Ofe);return t?t[0]:""}const Mfe=/^[^=?&#]+/,kfe=/^[^&#]+/;class Ffe{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Le([],{}):new Le([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(t.length>0||Object.keys(n).length>0)&&(r[Fe]=new Le(t,n)),r}parseSegment(){const t=Nv(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(t),new fg(Rv(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const n=Nv(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){const i=Nv(this.remaining);i&&(r=i,this.capture(r))}t[Rv(n)]=Rv(r)}parseQueryParam(t){const n=function(e){const t=e.match(Mfe);return t?t[0]:""}(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){const s=function(e){const t=e.match(kfe);return t?t[0]:""}(this.remaining);s&&(r=s,this.capture(r))}const i=y8(n),o=y8(r);if(t.hasOwnProperty(i)){let s=t[i];Array.isArray(s)||(s=[s],t[i]=s),s.push(o)}else t[i]=o}parseParens(t){const n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=Nv(this.remaining),i=this.remaining[r.length];if("/"!==i&&")"!==i&&";"!==i)throw new Error(`Cannot parse url '${this.url}'`);let o;r.indexOf(":")>-1?(o=r.substr(0,r.indexOf(":")),this.capture(o),this.capture(":")):t&&(o=Fe);const s=this.parseChildren();n[o]=1===Object.keys(s).length?s[Fe]:new Le([],s),this.consumeOptional("//")}return n}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Error(`Expected "${t}".`)}}class b8{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const n=this.pathFromRoot(t);return n.length>1?n[n.length-2]:null}children(t){const n=nS(t,this._root);return n?n.children.map(r=>r.value):[]}firstChild(t){const n=nS(t,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(t){const n=rS(t,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==t)}pathFromRoot(t){return rS(t,this._root).map(n=>n.value)}}function nS(e,t){if(e===t.value)return t;for(const n of t.children){const r=nS(e,n);if(r)return r}return null}function rS(e,t){if(e===t.value)return[t];for(const n of t.children){const r=rS(e,n);if(r.length)return r.unshift(t),r}return[]}class Fa{constructor(t,n){this.value=t,this.children=n}toString(){return`TreeNode(${this.value})`}}function Dd(e){const t={};return e&&e.children.forEach(n=>t[n.value.outlet]=n),t}class _8 extends b8{constructor(t,n){super(t),this.snapshot=n,iS(this,t)}toString(){return this.snapshot.toString()}}function w8(e,t){const n=function(e,t){const s=new Pv([],{},{},"",{},Fe,t,null,e.root,-1,{});return new E8("",new Fa(s,[]))}(e,t),r=new Mo([new fg("",{})]),i=new Mo({}),o=new Mo({}),s=new Mo({}),a=new Mo(""),u=new Cd(r,i,s,a,o,Fe,t,n.root);return u.snapshot=n.root,new _8(new Fa(u,[]),n)}class Cd{constructor(t,n,r,i,o,s,a,u){this.url=t,this.params=n,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=s,this.component=a,this._futureSnapshot=u}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Ct(t=>Ed(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Ct(t=>Ed(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function x8(e,t="emptyOnly"){const n=e.pathFromRoot;let r=0;if("always"!==t)for(r=n.length-1;r>=1;){const i=n[r],o=n[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(o.component)break;r--}}return function(e){return e.reduce((t,n)=>({params:Object.assign(Object.assign({},t.params),n.params),data:Object.assign(Object.assign({},t.data),n.data),resolve:Object.assign(Object.assign({},t.resolve),n._resolvedData)}),{params:{},data:{},resolve:{}})}(n.slice(r))}class Pv{constructor(t,n,r,i,o,s,a,u,l,c,f){this.url=t,this.params=n,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=s,this.component=a,this.routeConfig=u,this._urlSegment=l,this._lastPathIndex=c,this._resolve=f}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Ed(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Ed(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class E8 extends b8{constructor(t,n){super(n),this.url=t,iS(this,n)}toString(){return D8(this._root)}}function iS(e,t){t.value._routerState=e,t.children.forEach(n=>iS(e,n))}function D8(e){const t=e.children.length>0?` { ${e.children.map(D8).join(", ")} } `:"";return`${e.value}${t}`}function oS(e){if(e.snapshot){const t=e.snapshot,n=e._futureSnapshot;e.snapshot=n,xs(t.queryParams,n.queryParams)||e.queryParams.next(n.queryParams),t.fragment!==n.fragment&&e.fragment.next(n.fragment),xs(t.params,n.params)||e.params.next(n.params),function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(!xs(e[n],t[n]))return!1;return!0}(t.url,n.url)||e.url.next(n.url),xs(t.data,n.data)||e.data.next(n.data)}else e.snapshot=e._futureSnapshot,e.data.next(e._futureSnapshot.data)}function sS(e,t){const n=xs(e.params,t.params)&&function(e,t){return uc(e,t)&&e.every((n,r)=>xs(n.parameters,t[r].parameters))}(e.url,t.url);return n&&!(!e.parent!=!t.parent)&&(!e.parent||sS(e.parent,t.parent))}function hg(e,t,n){if(n&&e.shouldReuseRoute(t.value,n.value.snapshot)){const r=n.value;r._futureSnapshot=t.value;const i=function(e,t,n){return t.children.map(r=>{for(const i of n.children)if(e.shouldReuseRoute(r.value,i.value.snapshot))return hg(e,r,i);return hg(e,r)})}(e,t,n);return new Fa(r,i)}{if(e.shouldAttach(t.value)){const o=e.retrieve(t.value);if(null!==o){const s=o.route;return s.value._futureSnapshot=t.value,s.children=t.children.map(a=>hg(e,a)),s}}const r=function(e){return new Cd(new Mo(e.url),new Mo(e.params),new Mo(e.queryParams),new Mo(e.fragment),new Mo(e.data),e.outlet,e.component,e)}(t.value),i=t.children.map(o=>hg(e,o));return new Fa(r,i)}}function Lv(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function pg(e){return"object"==typeof e&&null!=e&&e.outlets}function aS(e,t,n,r,i){let o={};return r&&Pn(r,(s,a)=>{o[a]=Array.isArray(s)?s.map(u=>`${u}`):`${s}`}),new ac(n.root===e?t:C8(n.root,e,t),o,i)}function C8(e,t,n){const r={};return Pn(e.children,(i,o)=>{r[o]=i===t?n:C8(i,t,n)}),new Le(e.segments,r)}class S8{constructor(t,n,r){if(this.isAbsolute=t,this.numberOfDoubleDots=n,this.commands=r,t&&r.length>0&&Lv(r[0]))throw new Error("Root segment cannot have matrix parameters");const i=r.find(pg);if(i&&i!==u8(r))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class uS{constructor(t,n,r){this.segmentGroup=t,this.processChildren=n,this.index=r}}function A8(e,t,n){if(e||(e=new Le([],{})),0===e.segments.length&&e.hasChildren())return jv(e,t,n);const r=function(e,t,n){let r=0,i=t;const o={match:!1,pathIndex:0,commandIndex:0};for(;i<e.segments.length;){if(r>=n.length)return o;const s=e.segments[i],a=n[r];if(pg(a))break;const u=`${a}`,l=r<n.length-1?n[r+1]:null;if(i>0&&void 0===u)break;if(u&&l&&"object"==typeof l&&void 0===l.outlets){if(!M8(u,l,s))return o;r+=2}else{if(!M8(u,{},s))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(e,t,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){const o=new Le(e.segments.slice(0,r.pathIndex),{});return o.children[Fe]=new Le(e.segments.slice(r.pathIndex),e.children),jv(o,0,i)}return r.match&&0===i.length?new Le(e.segments,{}):r.match&&!e.hasChildren()?lS(e,t,n):r.match?jv(e,0,i):lS(e,t,n)}function jv(e,t,n){if(0===n.length)return new Le(e.segments,{});{const r=function(e){return pg(e[0])?e[0].outlets:{[Fe]:e}}(n),i={};return Pn(r,(o,s)=>{"string"==typeof o&&(o=[o]),null!==o&&(i[s]=A8(e.children[s],t,o))}),Pn(e.children,(o,s)=>{void 0===r[s]&&(i[s]=o)}),new Le(e.segments,i)}}function lS(e,t,n){const r=e.segments.slice(0,t);let i=0;for(;i<n.length;){const o=n[i];if(pg(o)){const u=qfe(o.outlets);return new Le(r,u)}if(0===i&&Lv(n[0])){r.push(new fg(e.segments[t].path,O8(n[0]))),i++;continue}const s=pg(o)?o.outlets[Fe]:`${o}`,a=i<n.length-1?n[i+1]:null;s&&a&&Lv(a)?(r.push(new fg(s,O8(a))),i+=2):(r.push(new fg(s,{})),i++)}return new Le(r,{})}function qfe(e){const t={};return Pn(e,(n,r)=>{"string"==typeof n&&(n=[n]),null!==n&&(t[r]=lS(new Le([],{}),0,n))}),t}function O8(e){const t={};return Pn(e,(n,r)=>t[r]=`${n}`),t}function M8(e,t,n){return e==n.path&&xs(t,n.parameters)}class Gfe{constructor(t,n,r,i){this.routeReuseStrategy=t,this.futureState=n,this.currState=r,this.forwardEvent=i}activate(t){const n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,t),oS(this.futureState.root),this.activateChildRoutes(n,r,t)}deactivateChildRoutes(t,n,r){const i=Dd(n);t.children.forEach(o=>{const s=o.value.outlet;this.deactivateRoutes(o,i[s],r),delete i[s]}),Pn(i,(o,s)=>{this.deactivateRouteAndItsChildren(o,r)})}deactivateRoutes(t,n,r){const i=t.value,o=n?n.value:null;if(i===o)if(i.component){const s=r.getContext(i.outlet);s&&this.deactivateChildRoutes(t,n,s.children)}else this.deactivateChildRoutes(t,n,r);else o&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(t,n){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,n):this.deactivateRouteAndOutlet(t,n)}detachAndStoreRouteSubtree(t,n){const r=n.getContext(t.value.outlet),i=r&&t.value.component?r.children:n,o=Dd(t);for(const s of Object.keys(o))this.deactivateRouteAndItsChildren(o[s],i);if(r&&r.outlet){const s=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:s,route:t,contexts:a})}}deactivateRouteAndOutlet(t,n){const r=n.getContext(t.value.outlet),i=r&&t.value.component?r.children:n,o=Dd(t);for(const s of Object.keys(o))this.deactivateRouteAndItsChildren(o[s],i);r&&r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated(),r.attachRef=null,r.resolver=null,r.route=null)}activateChildRoutes(t,n,r){const i=Dd(n);t.children.forEach(o=>{this.activateRoutes(o,i[o.value.outlet],r),this.forwardEvent(new hfe(o.value.snapshot))}),t.children.length&&this.forwardEvent(new ffe(t.value.snapshot))}activateRoutes(t,n,r){const i=t.value,o=n?n.value:null;if(oS(i),i===o)if(i.component){const s=r.getOrCreateContext(i.outlet);this.activateChildRoutes(t,n,s.children)}else this.activateChildRoutes(t,n,r);else if(i.component){const s=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),oS(a.route.value),this.activateChildRoutes(t,null,s.children)}else{const a=function(e){for(let t=e.parent;t;t=t.parent){const n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig;if(n&&n.component)return null}return null}(i.snapshot),u=a?a.module.componentFactoryResolver:null;s.attachRef=null,s.route=i,s.resolver=u,s.outlet&&s.outlet.activateWith(i,u),this.activateChildRoutes(t,null,s.children)}}else this.activateChildRoutes(t,null,r)}}class cS{constructor(t,n){this.routes=t,this.module=n}}function Ou(e){return"function"==typeof e}function lc(e){return e instanceof ac}const gg=Symbol("INITIAL_VALUE");function mg(){return sc(e=>Xce(e.map(t=>t.pipe(ay(1),function(...e){const t=mp(e);return Fn((n,r)=>{(t?KC(e,n,t):KC(e,n)).subscribe(r)})}(gg)))).pipe(Z5((t,n)=>{let r=!1;return n.reduce((i,o,s)=>i!==gg?i:(o===gg&&(r=!0),r||!1!==o&&s!==n.length-1&&!lc(o)?i:o),t)},gg),wd(t=>t!==gg),Ct(t=>lc(t)?t:!0===t),ay(1)))}class ede{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new yg,this.attachRef=null}}class yg{constructor(){this.contexts=new Map}onChildOutletCreated(t,n){const r=this.getOrCreateContext(t);r.outlet=n,this.contexts.set(t,r)}onChildOutletDestroyed(t){const n=this.getContext(t);n&&(n.outlet=null,n.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let n=this.getContext(t);return n||(n=new ede,this.contexts.set(t,n)),n}getContext(t){return this.contexts.get(t)||null}}let T8=(()=>{class e{constructor(n,r,i,o,s){this.parentContexts=n,this.location=r,this.resolver=i,this.changeDetector=s,this.activated=null,this._activatedRoute=null,this.activateEvents=new xr,this.deactivateEvents=new xr,this.attachEvents=new xr,this.detachEvents=new xr,this.name=o||Fe,n.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const n=this.parentContexts.getContext(this.name);n&&n.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,r){this.activated=n,this._activatedRoute=r,this.location.insert(n.hostView),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){const n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,r){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=n;const s=(r=r||this.resolver).resolveComponentFactory(n._futureSnapshot.routeConfig.component),a=this.parentContexts.getOrCreateContext(this.name).children,u=new tde(n,a,this.location.injector);this.activated=this.location.createComponent(s,this.location.length,u),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return e.\u0275fac=function(n){return new(n||e)(ae(yg),ae(Co),ae(pd),function(e){return function(e,t){if("class"===t)return e.classes;if("style"===t)return e.styles;const n=e.attrs;if(n){const r=n.length;let i=0;for(;i<r;){const o=n[i];if(iP(o))break;if(0===o)i+=2;else if("number"==typeof o)for(i++;i<r&&"string"==typeof n[i];)i++;else{if(o===t)return n[i+1];i+=2}}}return null}(ln(),e)}("name"),ae(DC))},e.\u0275dir=Gn({type:e,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),e})();class tde{constructor(t,n,r){this.route=t,this.childContexts=n,this.parent=r}get(t,n){return t===Cd?this.route:t===yg?this.childContexts:this.parent.get(t,n)}}let k8=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=fy({type:e,selectors:[["ng-component"]],decls:1,vars:0,template:function(n,r){1&n&&Wp(0,"router-outlet")},directives:[T8],encapsulation:2}),e})();function I8(e,t=""){for(let n=0;n<e.length;n++){const r=e[n];nde(r,rde(t,r))}}function nde(e,t){e.children&&I8(e.children,t)}function rde(e,t){return t?e||t.path?e&&!t.path?`${e}/`:!e&&t.path?t.path:`${e}/${t.path}`:"":e}function fS(e){const t=e.children&&e.children.map(fS),n=t?Object.assign(Object.assign({},e),{children:t}):Object.assign({},e);return!n.component&&(t||n.loadChildren)&&n.outlet&&n.outlet!==Fe&&(n.component=k8),n}function Gi(e){return e.outlet||Fe}function F8(e,t){const n=e.filter(r=>Gi(r)===t);return n.push(...e.filter(r=>Gi(r)!==t)),n}const R8={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function $v(e,t,n){var r;if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||n.length>0)?Object.assign({},R8):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};const o=(t.matcher||mfe)(n,e,t);if(!o)return Object.assign({},R8);const s={};Pn(o.posParams,(u,l)=>{s[l]=u.path});const a=o.consumed.length>0?Object.assign(Object.assign({},s),o.consumed[o.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:o.consumed,lastChild:o.consumed.length,parameters:a,positionalParamSegments:null!==(r=o.posParams)&&void 0!==r?r:{}}}function Bv(e,t,n,r,i="corrected"){if(n.length>0&&function(e,t,n){return n.some(r=>zv(e,t,r)&&Gi(r)!==Fe)}(e,n,r)){const s=new Le(t,function(e,t,n,r){const i={};i[Fe]=r,r._sourceSegment=e,r._segmentIndexShift=t.length;for(const o of n)if(""===o.path&&Gi(o)!==Fe){const s=new Le([],{});s._sourceSegment=e,s._segmentIndexShift=t.length,i[Gi(o)]=s}return i}(e,t,r,new Le(n,e.children)));return s._sourceSegment=e,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:[]}}if(0===n.length&&function(e,t,n){return n.some(r=>zv(e,t,r))}(e,n,r)){const s=new Le(e.segments,function(e,t,n,r,i,o){const s={};for(const a of r)if(zv(e,n,a)&&!i[Gi(a)]){const u=new Le([],{});u._sourceSegment=e,u._segmentIndexShift="legacy"===o?e.segments.length:t.length,s[Gi(a)]=u}return Object.assign(Object.assign({},i),s)}(e,t,n,r,e.children,i));return s._sourceSegment=e,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:n}}const o=new Le(e.segments,e.children);return o._sourceSegment=e,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:n}}function zv(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path}function N8(e,t,n,r){return!!(Gi(e)===r||r!==Fe&&zv(t,n,e))&&("**"===e.path||$v(t,e,n).matched)}function P8(e,t,n){return 0===t.length&&!e.children[n]}class vg{constructor(t){this.segmentGroup=t||null}}class L8{constructor(t){this.urlTree=t}}function Uv(e){return new Nt(t=>t.error(new vg(e)))}function j8(e){return new Nt(t=>t.error(new L8(e)))}function ude(e){return new Nt(t=>t.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${e}'`)))}class fde{constructor(t,n,r,i,o){this.configLoader=n,this.urlSerializer=r,this.urlTree=i,this.config=o,this.allowRedirects=!0,this.ngModule=t.get(Oa)}apply(){const t=Bv(this.urlTree.root,[],[],this.config).segmentGroup,n=new Le(t.segments,t.children);return this.expandSegmentGroup(this.ngModule,this.config,n,Fe).pipe(Ct(o=>this.createUrlTree(dS(o),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Au(o=>{if(o instanceof L8)return this.allowRedirects=!1,this.match(o.urlTree);throw o instanceof vg?this.noMatchError(o):o}))}match(t){return this.expandSegmentGroup(this.ngModule,this.config,t.root,Fe).pipe(Ct(i=>this.createUrlTree(dS(i),t.queryParams,t.fragment))).pipe(Au(i=>{throw i instanceof vg?this.noMatchError(i):i}))}noMatchError(t){return new Error(`Cannot match any routes. URL Segment: '${t.segmentGroup}'`)}createUrlTree(t,n,r){const i=t.segments.length>0?new Le([],{[Fe]:t}):t;return new ac(i,n,r)}expandSegmentGroup(t,n,r,i){return 0===r.segments.length&&r.hasChildren()?this.expandChildren(t,n,r).pipe(Ct(o=>new Le([],o))):this.expandSegment(t,r,n,r.segments,i,!0)}expandChildren(t,n,r){const i=[];for(const o of Object.keys(r.children))"primary"===o?i.unshift(o):i.push(o);return Nn(i).pipe(lg(o=>{const s=r.children[o],a=F8(n,o);return this.expandSegmentGroup(t,a,s,o).pipe(Ct(u=>({segment:u,outlet:o})))}),Z5((o,s)=>(o[s.outlet]=s.segment,o),{}),function(e,t){const n=arguments.length>=2;return r=>r.pipe(e?wd((i,o)=>e(i,o,r)):Wl,ZC(1),n?e8(t):J5(()=>new Tv))}())}expandSegment(t,n,r,i,o,s){return Nn(r).pipe(lg(a=>this.expandSegmentAgainstRoute(t,n,r,a,i,o,s).pipe(Au(l=>{if(l instanceof vg)return Ae(null);throw l}))),xd(a=>!!a),Au((a,u)=>{if(a instanceof Tv||"EmptyError"===a.name){if(P8(n,i,o))return Ae(new Le([],{}));throw new vg(n)}throw a}))}expandSegmentAgainstRoute(t,n,r,i,o,s,a){return N8(i,n,o,s)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(t,n,i,o,s):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,n,r,i,o,s):Uv(n):Uv(n)}expandSegmentAgainstRouteUsingRedirect(t,n,r,i,o,s){return"**"===i.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,r,i,s):this.expandRegularSegmentAgainstRouteUsingRedirect(t,n,r,i,o,s)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,n,r,i){const o=this.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?j8(o):this.lineralizeSegments(r,o).pipe(_n(s=>{const a=new Le(s,{});return this.expandSegment(t,a,n,s,i,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,n,r,i,o,s){const{matched:a,consumedSegments:u,lastChild:l,positionalParamSegments:c}=$v(n,i,o);if(!a)return Uv(n);const f=this.applyRedirectCommands(u,i.redirectTo,c);return i.redirectTo.startsWith("/")?j8(f):this.lineralizeSegments(i,f).pipe(_n(d=>this.expandSegment(t,n,r,d.concat(o.slice(l)),s,!1)))}matchSegmentAgainstRoute(t,n,r,i,o){if("**"===r.path)return r.loadChildren?(r._loadedConfig?Ae(r._loadedConfig):this.configLoader.load(t.injector,r)).pipe(Ct(d=>(r._loadedConfig=d,new Le(i,{})))):Ae(new Le(i,{}));const{matched:s,consumedSegments:a,lastChild:u}=$v(n,r,i);if(!s)return Uv(n);const l=i.slice(u);return this.getChildConfig(t,r,i).pipe(_n(f=>{const d=f.module,h=f.routes,{segmentGroup:p,slicedSegments:g}=Bv(n,a,l,h),m=new Le(p.segments,p.children);if(0===g.length&&m.hasChildren())return this.expandChildren(d,h,m).pipe(Ct(_=>new Le(a,_)));if(0===h.length&&0===g.length)return Ae(new Le(a,{}));const v=Gi(r)===o;return this.expandSegment(d,m,h,g,v?Fe:o,!0).pipe(Ct(b=>new Le(a.concat(b.segments),b.children)))}))}getChildConfig(t,n,r){return n.children?Ae(new cS(n.children,t)):n.loadChildren?void 0!==n._loadedConfig?Ae(n._loadedConfig):this.runCanLoadGuards(t.injector,n,r).pipe(_n(i=>{return i?this.configLoader.load(t.injector,n).pipe(Ct(o=>(n._loadedConfig=o,o))):(e=n,new Nt(t=>t.error(eS(`Cannot load children because the guard of the route "path: '${e.path}'" returned false`))));var e})):Ae(new cS([],t))}runCanLoadGuards(t,n,r){const i=n.canLoad;return i&&0!==i.length?Ae(i.map(s=>{const a=t.get(s);let u;if((e=a)&&Ou(e.canLoad))u=a.canLoad(n,r);else{if(!Ou(a))throw new Error("Invalid CanLoad guard");u=a(n,r)}var e;return Es(u)})).pipe(mg(),_i(s=>{if(!lc(s))return;const a=eS(`Redirecting to "${this.urlSerializer.serialize(s)}"`);throw a.url=s,a}),Ct(s=>!0===s)):Ae(!0)}lineralizeSegments(t,n){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),0===i.numberOfChildren)return Ae(r);if(i.numberOfChildren>1||!i.children[Fe])return ude(t.redirectTo);i=i.children[Fe]}}applyRedirectCommands(t,n,r){return this.applyRedirectCreatreUrlTree(n,this.urlSerializer.parse(n),t,r)}applyRedirectCreatreUrlTree(t,n,r,i){const o=this.createSegmentGroup(t,n.root,r,i);return new ac(o,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(t,n){const r={};return Pn(t,(i,o)=>{if("string"==typeof i&&i.startsWith(":")){const a=i.substring(1);r[o]=n[a]}else r[o]=i}),r}createSegmentGroup(t,n,r,i){const o=this.createSegments(t,n.segments,r,i);let s={};return Pn(n.children,(a,u)=>{s[u]=this.createSegmentGroup(t,a,r,i)}),new Le(o,s)}createSegments(t,n,r,i){return n.map(o=>o.path.startsWith(":")?this.findPosParam(t,o,i):this.findOrReturn(o,r))}findPosParam(t,n,r){const i=r[n.path.substring(1)];if(!i)throw new Error(`Cannot redirect to '${t}'. Cannot find '${n.path}'.`);return i}findOrReturn(t,n){let r=0;for(const i of n){if(i.path===t.path)return n.splice(r),i;r++}return t}}function dS(e){const t={};for(const r of Object.keys(e.children)){const o=dS(e.children[r]);(o.segments.length>0||o.hasChildren())&&(t[r]=o)}return function(e){if(1===e.numberOfChildren&&e.children[Fe]){const t=e.children[Fe];return new Le(e.segments.concat(t.segments),t.children)}return e}(new Le(e.segments,t))}class $8{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class Hv{constructor(t,n){this.component=t,this.route=n}}function pde(e,t,n){const r=e._root;return bg(r,t?t._root:null,n,[r.value])}function Vv(e,t,n){const r=function(e){if(!e)return null;for(let t=e.parent;t;t=t.parent){const n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig}return null}(t);return(r?r.module.injector:n).get(e)}function bg(e,t,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const o=Dd(t);return e.children.forEach(s=>{(function(e,t,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const o=e.value,s=t?t.value:null,a=n?n.getContext(e.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){const u=function(e,t,n){if("function"==typeof n)return n(e,t);switch(n){case"pathParamsChange":return!uc(e.url,t.url);case"pathParamsOrQueryParamsChange":return!uc(e.url,t.url)||!xs(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!sS(e,t)||!xs(e.queryParams,t.queryParams);default:return!sS(e,t)}}(s,o,o.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new $8(r)):(o.data=s.data,o._resolvedData=s._resolvedData),bg(e,t,o.component?a?a.children:null:n,r,i),u&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Hv(a.outlet.component,s))}else s&&_g(t,a,i),i.canActivateChecks.push(new $8(r)),bg(e,null,o.component?a?a.children:null:n,r,i)})(s,o[s.value.outlet],n,r.concat([s.value]),i),delete o[s.value.outlet]}),Pn(o,(s,a)=>_g(s,n.getContext(a),i)),i}function _g(e,t,n){const r=Dd(e),i=e.value;Pn(r,(o,s)=>{_g(o,i.component?t?t.children.getContext(s):null:t,n)}),n.canDeactivateChecks.push(new Hv(i.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,i))}class Ade{}function B8(e){return new Nt(t=>t.error(e))}class Mde{constructor(t,n,r,i,o,s){this.rootComponentType=t,this.config=n,this.urlTree=r,this.url=i,this.paramsInheritanceStrategy=o,this.relativeLinkResolution=s}recognize(){const t=Bv(this.urlTree.root,[],[],this.config.filter(s=>void 0===s.redirectTo),this.relativeLinkResolution).segmentGroup,n=this.processSegmentGroup(this.config,t,Fe);if(null===n)return null;const r=new Pv([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},Fe,this.rootComponentType,null,this.urlTree.root,-1,{}),i=new Fa(r,n),o=new E8(this.url,i);return this.inheritParamsAndData(o._root),o}inheritParamsAndData(t){const n=t.value,r=x8(n,this.paramsInheritanceStrategy);n.params=Object.freeze(r.params),n.data=Object.freeze(r.data),t.children.forEach(i=>this.inheritParamsAndData(i))}processSegmentGroup(t,n,r){return 0===n.segments.length&&n.hasChildren()?this.processChildren(t,n):this.processSegment(t,n,n.segments,r)}processChildren(t,n){const r=[];for(const o of Object.keys(n.children)){const s=n.children[o],a=F8(t,o),u=this.processSegmentGroup(a,s,o);if(null===u)return null;r.push(...u)}const i=z8(r);return i.sort((t,n)=>t.value.outlet===Fe?-1:n.value.outlet===Fe?1:t.value.outlet.localeCompare(n.value.outlet)),i}processSegment(t,n,r,i){for(const o of t){const s=this.processSegmentAgainstRoute(o,n,r,i);if(null!==s)return s}return P8(n,r,i)?[]:null}processSegmentAgainstRoute(t,n,r,i){if(t.redirectTo||!N8(t,n,r,i))return null;let o,s=[],a=[];if("**"===t.path){const h=r.length>0?u8(r).parameters:{};o=new Pv(r,h,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,V8(t),Gi(t),t.component,t,U8(n),H8(n)+r.length,q8(t))}else{const h=$v(n,t,r);if(!h.matched)return null;s=h.consumedSegments,a=r.slice(h.lastChild),o=new Pv(s,h.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,V8(t),Gi(t),t.component,t,U8(n),H8(n)+s.length,q8(t))}const u=(e=t).children?e.children:e.loadChildren?e._loadedConfig.routes:[],{segmentGroup:l,slicedSegments:c}=Bv(n,s,a,u.filter(h=>void 0===h.redirectTo),this.relativeLinkResolution);var e;if(0===c.length&&l.hasChildren()){const h=this.processChildren(u,l);return null===h?null:[new Fa(o,h)]}if(0===u.length&&0===c.length)return[new Fa(o,[])];const f=Gi(t)===i,d=this.processSegment(u,l,c,f?Fe:i);return null===d?null:[new Fa(o,d)]}}function Ide(e){const t=e.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}function z8(e){const t=[],n=new Set;for(const r of e){if(!Ide(r)){t.push(r);continue}const i=t.find(o=>r.value.routeConfig===o.value.routeConfig);void 0!==i?(i.children.push(...r.children),n.add(i)):t.push(r)}for(const r of n){const i=z8(r.children);t.push(new Fa(r.value,i))}return t.filter(r=>!n.has(r))}function U8(e){let t=e;for(;t._sourceSegment;)t=t._sourceSegment;return t}function H8(e){let t=e,n=t._segmentIndexShift?t._segmentIndexShift:0;for(;t._sourceSegment;)t=t._sourceSegment,n+=t._segmentIndexShift?t._segmentIndexShift:0;return n-1}function V8(e){return e.data||{}}function q8(e){return e.resolve||{}}function hS(e){return sc(t=>{const n=e(t);return n?Nn(n).pipe(Ct(()=>t)):Ae(t)})}class Bde extends class{shouldDetach(t){return!1}store(t,n){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,n){return t.routeConfig===n.routeConfig}}{}const pS=new Qe("ROUTES");class W8{constructor(t,n,r,i){this.injector=t,this.compiler=n,this.onLoadStartListener=r,this.onLoadEndListener=i}load(t,n){if(n._loader$)return n._loader$;this.onLoadStartListener&&this.onLoadStartListener(n);const i=this.loadModuleFactory(n.loadChildren).pipe(Ct(o=>{this.onLoadEndListener&&this.onLoadEndListener(n);const s=o.create(t);return new cS(a8(s.injector.get(pS,void 0,_e.Self|_e.Optional)).map(fS),s)}),Au(o=>{throw n._loader$=void 0,o}));return n._loader$=new Zce(i,()=>new va).pipe(K5()),n._loader$}loadModuleFactory(t){return Es(t()).pipe(_n(n=>n instanceof d$?Ae(n):Nn(this.compiler.compileModuleAsync(n))))}}class Ude{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,n){return t}}function Hde(e){throw e}function Vde(e,t,n){return t.parse("/")}function G8(e,t){return Ae(null)}const qde={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Wde={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let wi=(()=>{class e{constructor(n,r,i,o,s,a,u){this.rootComponentType=n,this.urlSerializer=r,this.rootContexts=i,this.location=o,this.config=u,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new va,this.errorHandler=Hde,this.malformedUriErrorHandler=Vde,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:G8,afterPreactivation:G8},this.urlHandlingStrategy=new Ude,this.routeReuseStrategy=new Bde,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=s.get(Oa),this.console=s.get(G$);const f=s.get(dn);this.isNgZoneEnabled=f instanceof dn&&dn.isInAngularZone(),this.resetConfig(u),this.currentUrlTree=new ac(new Le([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new W8(s,a,d=>this.triggerEvent(new n8(d)),d=>this.triggerEvent(new r8(d))),this.routerState=w8(this.currentUrlTree,this.rootComponentType),this.transitions=new Mo({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var n;return null===(n=this.location.getState())||void 0===n?void 0:n.\u0275routerPageId}setupNavigations(n){const r=this.events;return n.pipe(wd(i=>0!==i.id),Ct(i=>Object.assign(Object.assign({},i),{extractedUrl:this.urlHandlingStrategy.extract(i.rawUrl)})),sc(i=>{let o=!1,s=!1;return Ae(i).pipe(_i(a=>{this.currentNavigation={id:a.id,initialUrl:a.currentRawUrl,extractedUrl:a.extractedUrl,trigger:a.source,extras:a.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),sc(a=>{const u=this.browserUrlTree.toString(),l=!this.navigated||a.extractedUrl.toString()!==u||u!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||l)&&this.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return qv(a.source)&&(this.browserUrlTree=a.extractedUrl),Ae(a).pipe(sc(f=>{const d=this.transitions.getValue();return r.next(new JC(f.id,this.serializeUrl(f.extractedUrl),f.source,f.restoredState)),d!==this.transitions.getValue()?wa:Promise.resolve(f)}),function(e,t,n,r){return sc(i=>function(e,t,n,r,i){return new fde(e,t,n,r,i).apply()}(e,t,n,i.extractedUrl,r).pipe(Ct(o=>Object.assign(Object.assign({},i),{urlAfterRedirects:o}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),_i(f=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:f.urlAfterRedirects})}),function(e,t,n,r,i){return _n(o=>function(e,t,n,r,i="emptyOnly",o="legacy"){try{const s=new Mde(e,t,n,r,i,o).recognize();return null===s?B8(new Ade):Ae(s)}catch(s){return B8(s)}}(e,t,o.urlAfterRedirects,n(o.urlAfterRedirects),r,i).pipe(Ct(s=>Object.assign(Object.assign({},o),{targetSnapshot:s}))))}(this.rootComponentType,this.config,f=>this.serializeUrl(f),this.paramsInheritanceStrategy,this.relativeLinkResolution),_i(f=>{if("eager"===this.urlUpdateStrategy){if(!f.extras.skipLocationChange){const h=this.urlHandlingStrategy.merge(f.urlAfterRedirects,f.rawUrl);this.setBrowserUrl(h,f)}this.browserUrlTree=f.urlAfterRedirects}const d=new ofe(f.id,this.serializeUrl(f.extractedUrl),this.serializeUrl(f.urlAfterRedirects),f.targetSnapshot);r.next(d)}));if(l&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:d,extractedUrl:h,source:p,restoredState:g,extras:m}=a,v=new JC(d,this.serializeUrl(h),p,g);r.next(v);const y=w8(h,this.rootComponentType).snapshot;return Ae(Object.assign(Object.assign({},a),{targetSnapshot:y,urlAfterRedirects:h,extras:Object.assign(Object.assign({},m),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=a.rawUrl,a.resolve(null),wa}),hS(a=>{const{targetSnapshot:u,id:l,extractedUrl:c,rawUrl:f,extras:{skipLocationChange:d,replaceUrl:h}}=a;return this.hooks.beforePreactivation(u,{navigationId:l,appliedUrlTree:c,rawUrlTree:f,skipLocationChange:!!d,replaceUrl:!!h})}),_i(a=>{const u=new sfe(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot);this.triggerEvent(u)}),Ct(a=>Object.assign(Object.assign({},a),{guards:pde(a.targetSnapshot,a.currentSnapshot,this.rootContexts)})),function(e,t){return _n(n=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:s}}=n;return 0===s.length&&0===o.length?Ae(Object.assign(Object.assign({},n),{guardsResult:!0})):function(e,t,n,r){return Nn(e).pipe(_n(i=>function(e,t,n,r,i){const o=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return o&&0!==o.length?Ae(o.map(a=>{const u=Vv(a,t,i);let l;if(function(e){return e&&Ou(e.canDeactivate)}(u))l=Es(u.canDeactivate(e,t,n,r));else{if(!Ou(u))throw new Error("Invalid CanDeactivate guard");l=Es(u(e,t,n,r))}return l.pipe(xd())})).pipe(mg()):Ae(!0)}(i.component,i.route,n,t,r)),xd(i=>!0!==i,!0))}(s,r,i,e).pipe(_n(a=>a&&function(e){return"boolean"==typeof e}(a)?function(e,t,n,r){return Nn(t).pipe(lg(i=>KC(function(e,t){return null!==e&&t&&t(new cfe(e)),Ae(!0)}(i.route.parent,r),function(e,t){return null!==e&&t&&t(new dfe(e)),Ae(!0)}(i.route,r),function(e,t,n){const r=t[t.length-1],o=t.slice(0,t.length-1).reverse().map(s=>function(e){const t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(s)).filter(s=>null!==s).map(s=>Q5(()=>Ae(s.guards.map(u=>{const l=Vv(u,s.node,n);let c;if(function(e){return e&&Ou(e.canActivateChild)}(l))c=Es(l.canActivateChild(r,e));else{if(!Ou(l))throw new Error("Invalid CanActivateChild guard");c=Es(l(r,e))}return c.pipe(xd())})).pipe(mg())));return Ae(o).pipe(mg())}(e,i.path,n),function(e,t,n){const r=t.routeConfig?t.routeConfig.canActivate:null;if(!r||0===r.length)return Ae(!0);const i=r.map(o=>Q5(()=>{const s=Vv(o,t,n);let a;if(function(e){return e&&Ou(e.canActivate)}(s))a=Es(s.canActivate(t,e));else{if(!Ou(s))throw new Error("Invalid CanActivate guard");a=Es(s(t,e))}return a.pipe(xd())}));return Ae(i).pipe(mg())}(e,i.route,n))),xd(i=>!0!==i,!0))}(r,o,e,t):Ae(a)),Ct(a=>Object.assign(Object.assign({},n),{guardsResult:a})))})}(this.ngModule.injector,a=>this.triggerEvent(a)),_i(a=>{if(lc(a.guardsResult)){const l=eS(`Redirecting to "${this.serializeUrl(a.guardsResult)}"`);throw l.url=a.guardsResult,l}const u=new afe(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);this.triggerEvent(u)}),wd(a=>!!a.guardsResult||(this.restoreHistory(a),this.cancelNavigationTransition(a,""),!1)),hS(a=>{if(a.guards.canActivateChecks.length)return Ae(a).pipe(_i(u=>{const l=new ufe(u.id,this.serializeUrl(u.extractedUrl),this.serializeUrl(u.urlAfterRedirects),u.targetSnapshot);this.triggerEvent(l)}),sc(u=>{let l=!1;return Ae(u).pipe(function(e,t){return _n(n=>{const{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return Ae(n);let o=0;return Nn(i).pipe(lg(s=>function(e,t,n,r){return function(e,t,n,r){const i=Object.keys(e);if(0===i.length)return Ae({});const o={};return Nn(i).pipe(_n(s=>function(e,t,n,r){const i=Vv(e,t,r);return Es(i.resolve?i.resolve(t,n):i(t,n))}(e[s],t,n,r).pipe(_i(a=>{o[s]=a}))),ZC(1),_n(()=>Object.keys(o).length===i.length?Ae(o):wa))}(e._resolve,e,t,r).pipe(Ct(o=>(e._resolvedData=o,e.data=Object.assign(Object.assign({},e.data),x8(e,n).resolve),null)))}(s.route,r,e,t)),_i(()=>o++),ZC(1),_n(s=>o===i.length?Ae(n):wa))})}(this.paramsInheritanceStrategy,this.ngModule.injector),_i({next:()=>l=!0,complete:()=>{l||(this.restoreHistory(u),this.cancelNavigationTransition(u,"At least one route resolver didn't emit any value."))}}))}),_i(u=>{const l=new lfe(u.id,this.serializeUrl(u.extractedUrl),this.serializeUrl(u.urlAfterRedirects),u.targetSnapshot);this.triggerEvent(l)}))}),hS(a=>{const{targetSnapshot:u,id:l,extractedUrl:c,rawUrl:f,extras:{skipLocationChange:d,replaceUrl:h}}=a;return this.hooks.afterPreactivation(u,{navigationId:l,appliedUrlTree:c,rawUrlTree:f,skipLocationChange:!!d,replaceUrl:!!h})}),Ct(a=>{const u=function(e,t,n){const r=hg(e,t._root,n?n._root:void 0);return new _8(r,t)}(this.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);return Object.assign(Object.assign({},a),{targetRouterState:u})}),_i(a=>{this.currentUrlTree=a.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(a.urlAfterRedirects,a.rawUrl),this.routerState=a.targetRouterState,"deferred"===this.urlUpdateStrategy&&(a.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,a),this.browserUrlTree=a.urlAfterRedirects)}),((e,t,n)=>Ct(r=>(new Gfe(t,r.targetRouterState,r.currentRouterState,n).activate(e),r)))(this.rootContexts,this.routeReuseStrategy,a=>this.triggerEvent(a)),_i({next(){o=!0},complete(){o=!0}}),function(e){return Fn((t,n)=>{try{t.subscribe(n)}finally{n.add(e)}})}(()=>{var a;o||s||this.cancelNavigationTransition(i,`Navigation ID ${i.id} is not equal to the current navigation id ${this.navigationId}`),(null===(a=this.currentNavigation)||void 0===a?void 0:a.id)===i.id&&(this.currentNavigation=null)}),Au(a=>{if(s=!0,function(e){return e&&e[o8]}(a)){const u=lc(a.url);u||(this.navigated=!0,this.restoreHistory(i,!0));const l=new t8(i.id,this.serializeUrl(i.extractedUrl),a.message);r.next(l),u?setTimeout(()=>{const c=this.urlHandlingStrategy.merge(a.url,this.rawUrlTree),f={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||qv(i.source)};this.scheduleNavigation(c,"imperative",null,f,{resolve:i.resolve,reject:i.reject,promise:i.promise})},0):i.resolve(!1)}else{this.restoreHistory(i,!0);const u=new ife(i.id,this.serializeUrl(i.extractedUrl),a);r.next(u);try{i.resolve(this.errorHandler(a))}catch(l){i.reject(l)}}return wa}))}))}resetRootComponentType(n){this.rootComponentType=n,this.routerState.root.component=this.rootComponentType}setTransition(n){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),n))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(n=>{const r="popstate"===n.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{var i;const o={replaceUrl:!0},s=(null===(i=n.state)||void 0===i?void 0:i.navigationId)?n.state:null;if(s){const u=Object.assign({},s);delete u.navigationId,delete u.\u0275routerPageId,0!==Object.keys(u).length&&(o.state=u)}const a=this.parseUrl(n.url);this.scheduleNavigation(a,r,s,o)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(n){this.events.next(n)}resetConfig(n){I8(n),this.config=n.map(fS),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(n,r={}){const{relativeTo:i,queryParams:o,fragment:s,queryParamsHandling:a,preserveFragment:u}=r,l=i||this.routerState.root,c=u?this.currentUrlTree.fragment:s;let f=null;switch(a){case"merge":f=Object.assign(Object.assign({},this.currentUrlTree.queryParams),o);break;case"preserve":f=this.currentUrlTree.queryParams;break;default:f=o||null}return null!==f&&(f=this.removeEmptyProps(f)),function(e,t,n,r,i){if(0===n.length)return aS(t.root,t.root,t,r,i);const o=function(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new S8(!0,0,e);let t=0,n=!1;const r=e.reduce((i,o,s)=>{if("object"==typeof o&&null!=o){if(o.outlets){const a={};return Pn(o.outlets,(u,l)=>{a[l]="string"==typeof u?u.split("/"):u}),[...i,{outlets:a}]}if(o.segmentPath)return[...i,o.segmentPath]}return"string"!=typeof o?[...i,o]:0===s?(o.split("/").forEach((a,u)=>{0==u&&"."===a||(0==u&&""===a?n=!0:".."===a?t++:""!=a&&i.push(a))}),i):[...i,o]},[]);return new S8(n,t,r)}(n);if(o.toRoot())return aS(t.root,new Le([],{}),t,r,i);const s=function(e,t,n){if(e.isAbsolute)return new uS(t.root,!0,0);if(-1===n.snapshot._lastPathIndex){const o=n.snapshot._urlSegment;return new uS(o,o===t.root,0)}const r=Lv(e.commands[0])?0:1;return function(e,t,n){let r=e,i=t,o=n;for(;o>i;){if(o-=i,r=r.parent,!r)throw new Error("Invalid number of '../'");i=r.segments.length}return new uS(r,!1,i-o)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+r,e.numberOfDoubleDots)}(o,t,e),a=s.processChildren?jv(s.segmentGroup,s.index,o.commands):A8(s.segmentGroup,s.index,o.commands);return aS(s.segmentGroup,a,t,r,i)}(l,this.currentUrlTree,n,f,null!=c?c:null)}navigateByUrl(n,r={skipLocationChange:!1}){const i=lc(n)?n:this.parseUrl(n),o=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(o,"imperative",null,r)}navigate(n,r={skipLocationChange:!1}){return function(e){for(let t=0;t<e.length;t++){const n=e[t];if(null==n)throw new Error(`The requested path contains ${n} segment at index ${t}`)}}(n),this.navigateByUrl(this.createUrlTree(n,r),r)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){let r;try{r=this.urlSerializer.parse(n)}catch(i){r=this.malformedUriErrorHandler(i,this.urlSerializer,n)}return r}isActive(n,r){let i;if(i=!0===r?Object.assign({},qde):!1===r?Object.assign({},Wde):r,lc(n))return c8(this.currentUrlTree,n,i);const o=this.parseUrl(n);return c8(this.currentUrlTree,o,i)}removeEmptyProps(n){return Object.keys(n).reduce((r,i)=>{const o=n[i];return null!=o&&(r[i]=o),r},{})}processNavigations(){this.navigations.subscribe(n=>{this.navigated=!0,this.lastSuccessfulId=n.id,this.currentPageId=n.targetPageId,this.events.next(new cg(n.id,this.serializeUrl(n.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,n.resolve(!0)},n=>{this.console.warn(`Unhandled Navigation Error: ${n}`)})}scheduleNavigation(n,r,i,o,s){var a,u,l;if(this.disposed)return Promise.resolve(!1);const c=this.transitions.value,f=qv(r)&&c&&!qv(c.source),d=c.rawUrl.toString()===n.toString(),h=c.id===(null===(a=this.currentNavigation)||void 0===a?void 0:a.id);if(f&&d&&h)return Promise.resolve(!0);let g,m,v;s?(g=s.resolve,m=s.reject,v=s.promise):v=new Promise((_,w)=>{g=_,m=w});const y=++this.navigationId;let b;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(i=this.location.getState()),b=i&&i.\u0275routerPageId?i.\u0275routerPageId:o.replaceUrl||o.skipLocationChange?null!==(u=this.browserPageId)&&void 0!==u?u:0:(null!==(l=this.browserPageId)&&void 0!==l?l:0)+1):b=0,this.setTransition({id:y,targetPageId:b,source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:n,extras:o,resolve:g,reject:m,promise:v,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),v.catch(_=>Promise.reject(_))}setBrowserUrl(n,r){const i=this.urlSerializer.serialize(n),o=Object.assign(Object.assign({},r.extras.state),this.generateNgRouterState(r.id,r.targetPageId));this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl?this.location.replaceState(i,"",o):this.location.go(i,"",o)}restoreHistory(n,r=!1){var i,o;if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-n.targetPageId;"popstate"!==n.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(i=this.currentNavigation)||void 0===i?void 0:i.finalUrl)||0===s?this.currentUrlTree===(null===(o=this.currentNavigation)||void 0===o?void 0:o.finalUrl)&&0===s&&(this.resetState(n),this.browserUrlTree=n.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(s)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=n.currentRouterState,this.currentUrlTree=n.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(n,r){const i=new t8(n.id,this.serializeUrl(n.extractedUrl),r);this.triggerEvent(i),n.resolve(!1)}generateNgRouterState(n,r){return"computed"===this.canceledNavigationResolution?{navigationId:n,\u0275routerPageId:r}:{navigationId:n}}}return e.\u0275fac=function(n){$D()},e.\u0275prov=Xe({token:e,factory:e.\u0275fac}),e})();function qv(e){return"imperative"!==e}class Y8{}class X8{preload(t,n){return Ae(null)}}let Q8=(()=>{class e{constructor(n,r,i,o){this.router=n,this.injector=i,this.preloadingStrategy=o,this.loader=new W8(i,r,u=>n.triggerEvent(new n8(u)),u=>n.triggerEvent(new r8(u)))}setUpPreloading(){this.subscription=this.router.events.pipe(wd(n=>n instanceof cg),lg(()=>this.preload())).subscribe(()=>{})}preload(){const n=this.injector.get(Oa);return this.processRoutes(n,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(n,r){const i=[];for(const o of r)if(o.loadChildren&&!o.canLoad&&o._loadedConfig){const s=o._loadedConfig;i.push(this.processRoutes(s.module,s.routes))}else o.loadChildren&&!o.canLoad?i.push(this.preloadConfig(n,o)):o.children&&i.push(this.processRoutes(n,o.children));return Nn(i).pipe(gp(),Ct(o=>{}))}preloadConfig(n,r){return this.preloadingStrategy.preload(r,()=>(r._loadedConfig?Ae(r._loadedConfig):this.loader.load(n.injector,r)).pipe(_n(o=>(r._loadedConfig=o,this.processRoutes(o.module,o.routes)))))}}return e.\u0275fac=function(n){return new(n||e)(he(wi),he(hv),he(_r),he(Y8))},e.\u0275prov=Xe({token:e,factory:e.\u0275fac}),e})(),yS=(()=>{class e{constructor(n,r,i={}){this.router=n,this.viewportScroller=r,this.options=i,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},i.scrollPositionRestoration=i.scrollPositionRestoration||"disabled",i.anchorScrolling=i.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(n=>{n instanceof JC?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof cg&&(this.lastId=n.id,this.scheduleScrollEvent(n,this.router.parseUrl(n.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(n=>{n instanceof i8&&(n.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(n.position):n.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(n.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(n,r){this.router.triggerEvent(new i8(n,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return e.\u0275fac=function(n){$D()},e.\u0275prov=Xe({token:e,factory:e.\u0275fac}),e})();const cc=new Qe("ROUTER_CONFIGURATION"),K8=new Qe("ROUTER_FORROOT_GUARD"),Kde=[kC,{provide:p8,useClass:g8},{provide:wi,useFactory:function(e,t,n,r,i,o,s={},a,u){const l=new wi(null,e,t,n,r,i,a8(o));return a&&(l.urlHandlingStrategy=a),u&&(l.routeReuseStrategy=u),function(e,t){e.errorHandler&&(t.errorHandler=e.errorHandler),e.malformedUriErrorHandler&&(t.malformedUriErrorHandler=e.malformedUriErrorHandler),e.onSameUrlNavigation&&(t.onSameUrlNavigation=e.onSameUrlNavigation),e.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=e.paramsInheritanceStrategy),e.relativeLinkResolution&&(t.relativeLinkResolution=e.relativeLinkResolution),e.urlUpdateStrategy&&(t.urlUpdateStrategy=e.urlUpdateStrategy),e.canceledNavigationResolution&&(t.canceledNavigationResolution=e.canceledNavigationResolution)}(s,l),s.enableTracing&&l.events.subscribe(c=>{var f,d;null===(f=console.group)||void 0===f||f.call(console,`Router Event: ${c.constructor.name}`),console.log(c.toString()),console.log(c),null===(d=console.groupEnd)||void 0===d||d.call(console)}),l},deps:[p8,yg,kC,_r,hv,pS,cc,[class{},new gs],[class{},new gs]]},yg,{provide:Cd,useFactory:function(e){return e.routerState.root},deps:[wi]},Q8,X8,class{preload(t,n){return n().pipe(Au(()=>Ae(null)))}},{provide:cc,useValue:{enableTracing:!1}}];function Zde(){return new J$("Router",wi)}let Z8=(()=>{class e{constructor(n,r){}static forRoot(n,r){return{ngModule:e,providers:[Kde,J8(n),{provide:K8,useFactory:the,deps:[[wi,new gs,new Hf]]},{provide:cc,useValue:r||{}},{provide:_d,useFactory:ehe,deps:[oc,[new Fp(TC),new gs],cc]},{provide:yS,useFactory:Jde,deps:[wi,ece,cc]},{provide:Y8,useExisting:r&&r.preloadingStrategy?r.preloadingStrategy:X8},{provide:J$,multi:!0,useFactory:Zde},[vS,{provide:dv,multi:!0,useFactory:ohe,deps:[vS]},{provide:e6,useFactory:she,deps:[vS]},{provide:W$,multi:!0,useExisting:e6}]]}}static forChild(n){return{ngModule:e,providers:[J8(n)]}}}return e.\u0275fac=function(n){return new(n||e)(he(K8,8),he(wi,8))},e.\u0275mod=Yl({type:e}),e.\u0275inj=hu({}),e})();function Jde(e,t,n){return n.scrollOffset&&t.setOffset(n.scrollOffset),new yS(e,t,n)}function ehe(e,t,n={}){return n.useHash?new Iue(e,t):new w5(e,t)}function the(e){return"guarded"}function J8(e){return[{provide:Xee,multi:!0,useValue:e},{provide:pS,multi:!0,useValue:e}]}let vS=(()=>{class e{constructor(n){this.injector=n,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new va}appInitializer(){return this.injector.get(Mue,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let r=null;const i=new Promise(a=>r=a),o=this.injector.get(wi),s=this.injector.get(cc);return"disabled"===s.initialNavigation?(o.setUpLocationChangeListener(),r(!0)):"enabled"===s.initialNavigation||"enabledBlocking"===s.initialNavigation?(o.hooks.afterPreactivation=()=>this.initNavigation?Ae(null):(this.initNavigation=!0,r(!0),this.resultOfPreactivationDone),o.initialNavigation()):r(!0),i})}bootstrapListener(n){const r=this.injector.get(cc),i=this.injector.get(Q8),o=this.injector.get(yS),s=this.injector.get(wi),a=this.injector.get(rg);n===a.components[0]&&(("enabledNonBlocking"===r.initialNavigation||void 0===r.initialNavigation)&&s.initialNavigation(),i.setUpPreloading(),o.init(),s.resetRootComponentType(a.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return e.\u0275fac=function(n){return new(n||e)(he(_r))},e.\u0275prov=Xe({token:e,factory:e.\u0275fac}),e})();function ohe(e){return e.appInitializer.bind(e)}function she(e){return e.bootstrapListener.bind(e)}const e6=new Qe("Router Initializer"),uhe=[];let lhe=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Yl({type:e}),e.\u0275inj=hu({imports:[[Z8.forRoot(uhe)],Z8]}),e})();function t6(e,t,n,r,i,o,s){try{var a=e[o](s),u=a.value}catch(l){return void n(l)}a.done?t(u):Promise.resolve(u).then(r,i)}function Zn(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function s(u){t6(o,r,i,s,a,"next",u)}function a(u){t6(o,r,i,s,a,"throw",u)}s(void 0)})}}var e,che=(e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])})(t,n)},function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}),fhe=Object.prototype.hasOwnProperty;function Wv(e,t){return fhe.call(e,t)}function bS(e){if(Array.isArray(e)){for(var n=new Array(e.length),t=0;t<n.length;t++)n[t]=""+t;return n}if(Object.keys)return Object.keys(e);for(var r in n=[],e)Wv(e,r)&&n.push(r);return n}function xi(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function _S(e){for(var r,t=0,n=e.length;t<n;){if(!((r=e.charCodeAt(t))>=48&&r<=57))return!1;t++}return!0}function Ra(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function n6(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function wS(e){if(void 0===e)return!0;if(e)if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(wS(e[t]))return!0}else if("object"==typeof e){var r=bS(e),i=r.length;for(t=0;t<i;t++)if(wS(e[r[t]]))return!0}return!1}function i6(e,t){var n=[e];for(var r in t){var i="object"==typeof t[r]?JSON.stringify(t[r],null,2):t[r];void 0!==i&&n.push(r+": "+i)}return n.join("\n")}var o6=function(e){function t(n,r,i,o,s){var a=this.constructor,u=e.call(this,i6(n,{name:r,index:i,operation:o,tree:s}))||this;return u.name=r,u.index=i,u.operation=o,u.tree=s,Object.setPrototypeOf(u,a.prototype),u.message=i6(n,{name:r,index:i,operation:o,tree:s}),u}return che(t,e),t}(Error),$t=o6,dhe=xi,Ad={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=Gv(n,this.path);r&&(r=xi(r));var i=fc(n,{op:"remove",path:this.from}).removed;return fc(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=Gv(n,this.from);return fc(n,{op:"add",path:this.path,value:xi(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:wg(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},hhe={add:function(e,t,n){return _S(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){return{newDocument:n,removed:e.splice(t,1)[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:Ad.move,copy:Ad.copy,test:Ad.test,_get:Ad._get};function Gv(e,t){if(""==t)return e;var n={op:"_get",path:t};return fc(e,n),n.value}function fc(e,t,n,r,i,o){if(void 0===n&&(n=!1),void 0===r&&(r=!0),void 0===i&&(i=!0),void 0===o&&(o=0),n&&("function"==typeof n?n(t,0,e,t.path):Xv(t,0)),""===t.path){var s={newDocument:e};if("add"===t.op)return s.newDocument=t.value,s;if("replace"===t.op)return s.newDocument=t.value,s.removed=e,s;if("move"===t.op||"copy"===t.op)return s.newDocument=Gv(e,t.from),"move"===t.op&&(s.removed=e),s;if("test"===t.op){if(s.test=wg(e,t.value),!1===s.test)throw new $t("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return s.newDocument=e,s}if("remove"===t.op)return s.removed=e,s.newDocument=null,s;if("_get"===t.op)return t.value=e,s;if(n)throw new $t("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",o,t,e);return s}r||(e=xi(e));var u=(t.path||"").split("/"),l=e,c=1,f=u.length,d=void 0,h=void 0,p=void 0;for(p="function"==typeof n?n:Xv;;){if((h=u[c])&&-1!=h.indexOf("~")&&(h=n6(h)),i&&"__proto__"==h)throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&void 0===d&&(void 0===l[h]?d=u.slice(0,c).join("/"):c==f-1&&(d=t.path),void 0!==d&&p(t,0,e,d)),c++,Array.isArray(l)){if("-"===h)h=l.length;else{if(n&&!_S(h))throw new $t("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",o,t,e);_S(h)&&(h=~~h)}if(c>=f){if(n&&"add"===t.op&&h>l.length)throw new $t("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",o,t,e);if(!1===(s=hhe[t.op].call(t,l,h,e)).test)throw new $t("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return s}}else if(c>=f){if(!1===(s=Ad[t.op].call(t,l,h,e)).test)throw new $t("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return s}if(l=l[h],n&&c<f&&(!l||"object"!=typeof l))throw new $t("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",o,t,e)}}function Yv(e,t,n,r,i){if(void 0===r&&(r=!0),void 0===i&&(i=!0),n&&!Array.isArray(t))throw new $t("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=xi(e));for(var o=new Array(t.length),s=0,a=t.length;s<a;s++)o[s]=fc(e,t[s],n,!0,i,s),e=o[s].newDocument;return o.newDocument=e,o}function phe(e,t,n){var r=fc(e,t);if(!1===r.test)throw new $t("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function Xv(e,t,n,r){if("object"!=typeof e||null===e||Array.isArray(e))throw new $t("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(!Ad[e.op])throw new $t("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n);if("string"!=typeof e.path)throw new $t("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new $t('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new $t("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new $t("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&wS(e.value))throw new $t("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n)if("add"==e.op){var i=e.path.split("/").length,o=r.split("/").length;if(i!==o+1&&i!==o)throw new $t("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==r)throw new $t("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if("move"===e.op||"copy"===e.op){var a=s6([{op:"_get",path:e.from,value:void 0}],n);if(a&&"OPERATION_PATH_UNRESOLVABLE"===a.name)throw new $t("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}function s6(e,t,n){try{if(!Array.isArray(e))throw new $t("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)Yv(xi(t),xi(e),n||!0);else{n=n||Xv;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(i){if(i instanceof $t)return i;throw i}}function wg(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var i,o,s,n=Array.isArray(e),r=Array.isArray(t);if(n&&r){if((o=e.length)!=t.length)return!1;for(i=o;0!=i--;)if(!wg(e[i],t[i]))return!1;return!0}if(n!=r)return!1;var a=Object.keys(e);if((o=a.length)!==Object.keys(t).length)return!1;for(i=o;0!=i--;)if(!t.hasOwnProperty(a[i]))return!1;for(i=o;0!=i--;)if(!wg(e[s=a[i]],t[s]))return!1;return!0}return e!=e&&t!=t}var xS=new WeakMap,ghe=function(t){this.observers=new Map,this.obj=t},mhe=function(t,n){this.callback=t,this.observer=n};function _he(e,t){t.unobserve()}function whe(e,t){var r,i=function(e){return xS.get(e)}(e);if(i){var o=function(e,t){return e.observers.get(t)}(i,t);r=o&&o.observer}else i=new ghe(e),xS.set(e,i);if(r)return r;if(r={},i.value=xi(e),t){r.callback=t,r.next=null;var s=function(){ES(r)},a=function(){clearTimeout(r.next),r.next=setTimeout(s)};"undefined"!=typeof window&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return r.patches=[],r.object=e,r.unobserve=function(){ES(r),clearTimeout(r.next),function(e,t){e.observers.delete(t.callback)}(i,r),"undefined"!=typeof window&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},i.observers.set(t,new mhe(t,r)),r}function ES(e,t){void 0===t&&(t=!1);var n=xS.get(e.object);DS(n.value,e.object,e.patches,"",t),e.patches.length&&Yv(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function DS(e,t,n,r,i){if(t!==e){"function"==typeof t.toJSON&&(t=t.toJSON());for(var o=bS(t),s=bS(e),u=!1,l=s.length-1;l>=0;l--){var f=e[c=s[l]];if(!Wv(t,c)||void 0===t[c]&&void 0!==f&&!1===Array.isArray(t))Array.isArray(e)===Array.isArray(t)?(i&&n.push({op:"test",path:r+"/"+Ra(c),value:xi(f)}),n.push({op:"remove",path:r+"/"+Ra(c)}),u=!0):(i&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}));else{var d=t[c];"object"==typeof f&&null!=f&&"object"==typeof d&&null!=d&&Array.isArray(f)===Array.isArray(d)?DS(f,d,n,r+"/"+Ra(c),i):f!==d&&(i&&n.push({op:"test",path:r+"/"+Ra(c),value:xi(f)}),n.push({op:"replace",path:r+"/"+Ra(c),value:xi(d)}))}}if(u||o.length!=s.length)for(l=0;l<o.length;l++){var c;!Wv(e,c=o[l])&&void 0!==t[c]&&n.push({op:"add",path:r+"/"+Ra(c),value:xi(t[c])})}}}function xhe(e,t,n){void 0===n&&(n=!1);var r=[];return DS(e,t,r,"",n),r}Object.assign({},nt,ut,{JsonPatchError:o6,deepClone:xi,escapePathComponent:Ra,unescapePathComponent:n6});var Ehe=G(564),CS=G.n(Ehe);function Vr(e,t,n){return e.fields=t||[],e.fname=n,e}function Bt(e){return null==e?null:e.fname}function Jn(e){return null==e?null:e.fields}function a6(e){return 1===e.length?Dhe(e[0]):Che(e)}const Dhe=e=>function(t){return t[e]},Che=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function F(e){throw Error(e)}function Ds(e){const t=[],n=e.length;let s,a,u,r=null,i=0,o="";function l(){t.push(o+e.substring(s,a)),o="",s=a+1}for(e+="",s=a=0;a<n;++a)if(u=e[a],"\\"===u)o+=e.substring(s,a),o+=e.substring(++a,++a),s=a;else if(u===r)l(),r=null,i=-1;else{if(r)continue;s===i&&'"'===u||s===i&&"'"===u?(s=a+1,r=u):"."!==u||i?"["===u?(a>s&&l(),i=s=a+1):"]"===u&&(i||F("Access path missing open bracket: "+e),i>0&&l(),i=0,s=a+1):a>s?l():s=a+1}return i&&F("Access path missing closing bracket: "+e),r&&F("Access path missing closing quote: "+e),a>s&&(a++,l()),t}function qr(e,t,n){const r=Ds(e);return e=1===r.length?r[0]:e,Vr((n&&n.get||a6)(r),[e],t||e)}const xg=qr("id"),er=Vr(e=>e,[],"identity"),Mu=Vr(()=>0,[],"zero"),Od=Vr(()=>1,[],"one"),Yi=Vr(()=>!0,[],"true"),Tu=Vr(()=>!1,[],"false");function She(e,t,n){const r=[t].concat([].slice.call(n));console[e].apply(console,r)}const u6=0,SS=1,AS=2,l6=3,c6=4;function OS(e,t,n=She){let r=e||u6;return{level(i){return arguments.length?(r=+i,this):r},error(){return r>=SS&&n(t||"error","ERROR",arguments),this},warn(){return r>=AS&&n(t||"warn","WARN",arguments),this},info(){return r>=l6&&n(t||"log","INFO",arguments),this},debug(){return r>=c6&&n(t||"log","DEBUG",arguments),this}}}var R=Array.isArray;function J(e){return e===Object(e)}const f6=e=>"__proto__"!==e;function Md(...e){return e.reduce((t,n)=>{for(const r in n)"signals"===r?t.signals=Ahe(t.signals,n.signals):Td(t,r,n[r],"legend"===r?{layout:1}:"style"===r||null);return t},{})}function Td(e,t,n,r){if(!f6(t))return;let i,o;if(J(n)&&!R(n))for(i in o=J(e[t])?e[t]:e[t]={},n)r&&(!0===r||r[i])?Td(o,i,n[i]):f6(i)&&(o[i]=n[i]);else e[t]=n}function Ahe(e,t){if(null==e)return t;const n={},r=[];function i(o){n[o.name]||(n[o.name]=1,r.push(o))}return t.forEach(i),e.forEach(i),r}function je(e){return e[e.length-1]}function tr(e){return null==e||""===e?null:+e}const d6=e=>t=>e*Math.exp(t),h6=e=>t=>Math.log(e*t),p6=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),g6=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,Qv=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function Kv(e,t,n,r){const i=n(e[0]),o=n(je(e)),s=(o-i)*t;return[r(i-s),r(o-s)]}function m6(e,t){return Kv(e,t,tr,er)}function y6(e,t){var n=Math.sign(e[0]);return Kv(e,t,h6(n),d6(n))}function v6(e,t,n){return Kv(e,t,Qv(n),Qv(1/n))}function b6(e,t,n){return Kv(e,t,p6(n),g6(n))}function Zv(e,t,n,r,i){const o=r(e[0]),s=r(je(e)),a=null!=t?r(t):(o+s)/2;return[i(a+(o-a)*n),i(a+(s-a)*n)]}function MS(e,t,n){return Zv(e,t,n,tr,er)}function TS(e,t,n){const r=Math.sign(e[0]);return Zv(e,t,n,h6(r),d6(r))}function Jv(e,t,n,r){return Zv(e,t,n,Qv(r),Qv(1/r))}function kS(e,t,n,r){return Zv(e,t,n,p6(r),g6(r))}function _6(e){return 1+~~(new Date(e).getMonth()/3)}function w6(e){return 1+~~(new Date(e).getUTCMonth()/3)}function X(e){return null!=e?R(e)?e:[e]:[]}function x6(e,t,n){let o,r=e[0],i=e[1];return i<r&&(o=i,i=r,r=o),o=i-r,o>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-o),r+o]}function xe(e){return"function"==typeof e}function IS(e,t,n){n=n||{},t=X(t)||[];const r=[],i=[],o={},s=n.comparator||Mhe;return X(e).forEach((a,u)=>{null!=a&&(r.push("descending"===t[u]?-1:1),i.push(a=xe(a)?a:qr(a,null,n)),(Jn(a)||[]).forEach(l=>o[l]=1))}),0===i.length?null:Vr(s(i,r),Object.keys(o))}const e1=(e,t)=>(e<t||null==e)&&null!=t?-1:(e>t||null==t)&&null!=e?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t==t?-1:t!=t&&e==e?1:0),Mhe=(e,t)=>1===e.length?The(e[0],t[0]):khe(e,t,e.length),The=(e,t)=>function(n,r){return e1(e(n),e(r))*t},khe=(e,t,n)=>(t.push(0),function(r,i){let o,s=0,a=-1;for(;0===s&&++a<n;)o=e[a],s=e1(o(r),o(i));return s*t[a]});function nr(e){return xe(e)?e:()=>e}function FS(e,t){let n;return r=>{n&&clearTimeout(n),n=setTimeout(()=>(t(r),n=null),e)}}function Ee(e){for(let t,n,r=1,i=arguments.length;r<i;++r)for(n in t=arguments[r],t)e[n]=t[n];return e}function Cs(e,t){let r,i,o,s,n=0;if(e&&(r=e.length))if(null==t){for(i=e[n];n<r&&(null==i||i!=i);i=e[++n]);for(o=s=i;n<r;++n)i=e[n],null!=i&&(i<o&&(o=i),i>s&&(s=i))}else{for(i=t(e[n]);n<r&&(null==i||i!=i);i=t(e[++n]));for(o=s=i;n<r;++n)i=t(e[n]),null!=i&&(i<o&&(o=i),i>s&&(s=i))}return[o,s]}function E6(e,t){const n=e.length;let i,o,s,a,u,r=-1;if(null==t){for(;++r<n;)if(o=e[r],null!=o&&o>=o){i=s=o;break}if(r===n)return[-1,-1];for(a=u=r;++r<n;)o=e[r],null!=o&&(i>o&&(i=o,a=r),s<o&&(s=o,u=r))}else{for(;++r<n;)if(o=t(e[r],r,e),null!=o&&o>=o){i=s=o;break}if(r===n)return[-1,-1];for(a=u=r;++r<n;)o=t(e[r],r,e),null!=o&&(i>o&&(i=o,a=r),s<o&&(s=o,u=r))}return[a,u]}const Ihe=Object.prototype.hasOwnProperty;function ne(e,t){return Ihe.call(e,t)}const t1={};function kd(e){let n,t={};function r(o){return ne(t,o)&&t[o]!==t1}const i={size:0,empty:0,object:t,has:r,get:o=>r(o)?t[o]:void 0,set(o,s){return r(o)||(++i.size,t[o]===t1&&--i.empty),t[o]=s,this},delete(o){return r(o)&&(--i.size,++i.empty,t[o]=t1),this},clear(){i.size=i.empty=0,i.object=t={}},test(o){return arguments.length?(n=o,i):n},clean(){const o={};let s=0;for(const a in t){const u=t[a];u!==t1&&(!n||!n(u))&&(o[a]=u,++s)}i.size=s,i.empty=0,i.object=t=o}};return e&&Object.keys(e).forEach(o=>{i.set(o,e[o])}),i}function D6(e,t,n,r,i,o){if(!n&&0!==n)return o;const s=+n;let l,a=e[0],u=je(e);u<a&&(l=a,a=u,u=l),l=Math.abs(t-a);const c=Math.abs(u-t);return l<c&&l<=s?r:c<=s?i:o}function z(e,t,n){const r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),Ee(r,n)}function Id(e,t,n,r){let s,i=t[0],o=t[t.length-1];return i>o&&(s=i,i=o,o=s),r=void 0===r||r,((n=void 0===n||n)?i<=e:i<e)&&(r?e<=o:e<o)}function ku(e){return"boolean"==typeof e}function Iu(e){return"[object Date]"===Object.prototype.toString.call(e)}function C6(e){return e&&xe(e[Symbol.iterator])}function ft(e){return"number"==typeof e}function S6(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function Y(e){return"string"==typeof e}function RS(e,t,n){e&&(e=t?X(e).map(a=>a.replace(/\\(.)/g,"$1")):X(e));const r=e&&e.length,i=n&&n.get||a6,o=a=>i(t?[a]:Ds(a));let s;if(r)if(1===r){const a=o(e[0]);s=function(u){return""+a(u)}}else{const a=e.map(o);s=function(u){let l=""+a[0](u),c=0;for(;++c<r;)l+="|"+a[c](u);return l}}else s=function(){return""};return Vr(s,e,"key")}function A6(e,t){const n=e[0],r=je(e),i=+t;return i?1===i?r:n+i*(r-n):n}function O6(e){let t,n,r;e=+e||1e4;const i=()=>{t={},n={},r=0},o=(s,a)=>(++r>e&&(n=t,t={},r=1),t[s]=a);return i(),{clear:i,has:s=>ne(t,s)||ne(n,s),get:s=>ne(t,s)?t[s]:ne(n,s)?o(s,n[s]):void 0,set:(s,a)=>ne(t,s)?t[s]=a:o(s,a)}}function M6(e,t,n,r){const i=t.length,o=n.length;if(!o)return t;if(!i)return n;const s=r||new t.constructor(i+o);let a=0,u=0,l=0;for(;a<i&&u<o;++l)s[l]=e(t[a],n[u])>0?n[u++]:t[a++];for(;a<i;++a,++l)s[l]=t[a];for(;u<o;++u,++l)s[l]=n[u];return s}function Eg(e,t){let n="";for(;--t>=0;)n+=e;return n}function T6(e,t,n,r){const i=n||" ",o=e+"",s=t-o.length;return s<=0?o:"left"===r?Eg(i,s)+o:"center"===r?Eg(i,~~(s/2))+o+Eg(i,Math.ceil(s/2)):o+Eg(i,s)}function Dg(e){return e&&je(e)-e[0]||0}function H(e){return R(e)?"["+e.map(H)+"]":J(e)||Y(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function NS(e){return null==e||""===e?null:!(!e||"false"===e||"0"===e||!e)}const Rhe=e=>ft(e)||Iu(e)?e:Date.parse(e);function PS(e,t){return t=t||Rhe,null==e||""===e?null:t(e)}function LS(e){return null==e||""===e?null:e+""}function To(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function k6(e,t,n,r){const i=null!=r?r:"\u2026",o=e+"",s=o.length,a=Math.max(0,t-i.length);return s<=t?o:"left"===n?i+o.slice(s-a):"center"===n?o.slice(0,Math.ceil(a/2))+i+o.slice(s-~~(a/2)):o.slice(0,a)+i}function Fu(e,t,n){if(e)if(t){const r=e.length;for(let i=0;i<r;++i){const o=t(e[i]);o&&n(o,i,e)}}else e.forEach(n)}var I6={},jS={};function F6(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function R6(e){var t=Object.create(null),n=[];return e.forEach(function(r){for(var i in r)i in t||n.push(t[i]=i)}),n}function Wr(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function jhe(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function i(f,d){var v,h=[],p=f.length,g=0,m=0,y=p<=0,b=!1;function _(){if(y)return jS;if(b)return b=!1,I6;var E,D,x=g;if(34===f.charCodeAt(x)){for(;g++<p&&34!==f.charCodeAt(g)||34===f.charCodeAt(++g););return(E=g)>=p?y=!0:10===(D=f.charCodeAt(g++))?b=!0:13===D&&(b=!0,10===f.charCodeAt(g)&&++g),f.slice(x+1,E-1).replace(/""/g,'"')}for(;g<p;){if(10===(D=f.charCodeAt(E=g++)))b=!0;else if(13===D)b=!0,10===f.charCodeAt(g)&&++g;else if(D!==n)continue;return f.slice(x,E)}return y=!0,f.slice(x,p)}for(10===f.charCodeAt(p-1)&&--p,13===f.charCodeAt(p-1)&&--p;(v=_())!==jS;){for(var w=[];v!==I6&&v!==jS;)w.push(v),v=_();d&&null==(w=d(w,m++))||h.push(w)}return h}function o(f,d){return f.map(function(h){return d.map(function(p){return c(h[p])}).join(e)})}function l(f){return f.map(c).join(e)}function c(f){return null==f?"":f instanceof Date?function(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":function(e){return e<0?"-"+Wr(-e,6):e>9999?"+"+Wr(e,6):Wr(e,4)}(e.getUTCFullYear())+"-"+Wr(e.getUTCMonth()+1,2)+"-"+Wr(e.getUTCDate(),2)+(i?"T"+Wr(t,2)+":"+Wr(n,2)+":"+Wr(r,2)+"."+Wr(i,3)+"Z":r?"T"+Wr(t,2)+":"+Wr(n,2)+":"+Wr(r,2)+"Z":n||t?"T"+Wr(t,2)+":"+Wr(n,2)+"Z":"")}(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:function(f,d){var h,p,g=i(f,function(m,v){if(h)return h(m,v-1);p=m,h=d?function(e,t){var n=F6(e);return function(r,i){return t(n(r),i,e)}}(m,d):F6(m)});return g.columns=p||[],g},parseRows:i,format:function(f,d){return null==d&&(d=R6(f)),[d.map(c).join(e)].concat(o(f,d)).join("\n")},formatBody:function(f,d){return null==d&&(d=R6(f)),o(f,d).join("\n")},formatRows:function(f){return f.map(l).join("\n")},formatRow:l,formatValue:c}}function Bhe(e){return e}function Uhe(e,t){return"string"==typeof t&&(t=e.objects[t]),"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map(function(n){return N6(e,n)})}:N6(e,t)}function N6(e,t){var n=t.id,r=t.bbox,i=null==t.properties?{}:t.properties,o=P6(e,t);return null==n&&null==r?{type:"Feature",properties:i,geometry:o}:null==r?{type:"Feature",id:n,properties:i,geometry:o}:{type:"Feature",id:n,bbox:r,properties:i,geometry:o}}function P6(e,t){var n=function(e){if(null==e)return Bhe;var t,n,r=e.scale[0],i=e.scale[1],o=e.translate[0],s=e.translate[1];return function(a,u){u||(t=n=0);var l=2,c=a.length,f=new Array(c);for(f[0]=(t+=a[0])*r+o,f[1]=(n+=a[1])*i+s;l<c;)f[l]=a[l],++l;return f}}(e.transform),r=e.arcs;function i(c,f){f.length&&f.pop();for(var d=r[c<0?~c:c],h=0,p=d.length;h<p;++h)f.push(n(d[h],h));c<0&&function(e,t){for(var n,r=e.length,i=r-t;i<--r;)n=e[i],e[i++]=e[r],e[r]=n}(f,p)}function o(c){return n(c)}function s(c){for(var f=[],d=0,h=c.length;d<h;++d)i(c[d],f);return f.length<2&&f.push(f[0]),f}function a(c){for(var f=s(c);f.length<4;)f.push(f[0]);return f}function u(c){return c.map(a)}return function l(c){var d,f=c.type;switch(f){case"GeometryCollection":return{type:f,geometries:c.geometries.map(l)};case"Point":d=o(c.coordinates);break;case"MultiPoint":d=c.coordinates.map(o);break;case"LineString":d=s(c.arcs);break;case"MultiLineString":d=c.arcs.map(s);break;case"Polygon":d=u(c.arcs);break;case"MultiPolygon":d=c.arcs.map(u);break;default:return null}return{type:f,coordinates:d}}(t)}function Hhe(e,t){var n={},r={},i={},o=[],s=-1;function u(l,c){for(var f in l){var d=l[f];delete c[d.start],delete d.start,delete d.end,d.forEach(function(h){n[h<0?~h:h]=1}),o.push(d)}}return t.forEach(function(l,c){var d,f=e.arcs[l<0?~l:l];f.length<3&&!f[1][0]&&!f[1][1]&&(d=t[++s],t[s]=l,t[c]=d)}),t.forEach(function(l){var h,p,c=function(l){var d,c=e.arcs[l<0?~l:l],f=c[0];return e.transform?(d=[0,0],c.forEach(function(h){d[0]+=h[0],d[1]+=h[1]})):d=c[c.length-1],l<0?[d,f]:[f,d]}(l),f=c[0],d=c[1];if(h=i[f])if(delete i[h.end],h.push(l),h.end=d,p=r[d]){delete r[p.start];var g=p===h?h:h.concat(p);r[g.start=h.start]=i[g.end=p.end]=g}else r[h.start]=i[h.end]=h;else if(h=r[d])if(delete r[h.start],h.unshift(l),h.start=f,p=i[f]){delete i[p.end];var m=p===h?h:p.concat(h);r[m.start=p.start]=i[m.end=h.end]=m}else r[h.start]=i[h.end]=h;else r[(h=[l]).start=f]=i[h.end=d]=h}),u(i,r),u(r,i),t.forEach(function(l){n[l<0?~l:l]||o.push([l])}),o}function Vhe(e){return P6(e,qhe.apply(this,arguments))}function qhe(e,t,n){var r,i,o;if(arguments.length>1)r=Whe(0,t,n);else for(i=0,r=new Array(o=e.arcs.length);i<o;++i)r[i]=i;return{type:"MultiLineString",arcs:Hhe(e,r)}}function Whe(e,t,n){var o,r=[],i=[];function s(f){var d=f<0?~f:f;(i[d]||(i[d]=[])).push({i:f,g:o})}function a(f){f.forEach(s)}function u(f){f.forEach(a)}return function c(f){switch(o=f,f.type){case"GeometryCollection":f.geometries.forEach(c);break;case"LineString":a(f.arcs);break;case"MultiLineString":case"Polygon":u(f.arcs);break;case"MultiPolygon":!function(f){f.forEach(u)}(f.arcs)}}(t),i.forEach(null==n?function(f){r.push(f[0].i)}:function(f){n(f[0].g,f[f.length-1].g)&&r.push(f[0].i)}),r}var zS=Math.sqrt(50),US=Math.sqrt(10),HS=Math.sqrt(2);function VS(e,t,n){var r,o,s,a,i=-1;if(n=+n,(e=+e)==(t=+t)&&n>0)return[e];if((r=t<e)&&(o=e,e=t,t=o),0===(a=L6(e,t,n))||!isFinite(a))return[];if(a>0){let u=Math.round(e/a),l=Math.round(t/a);for(u*a<e&&++u,l*a>t&&--l,s=new Array(o=l-u+1);++i<o;)s[i]=(u+i)*a}else{a=-a;let u=Math.round(e*a),l=Math.round(t*a);for(u/a<e&&++u,l/a>t&&--l,s=new Array(o=l-u+1);++i<o;)s[i]=(u+i)/a}return r&&s.reverse(),s}function L6(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=zS?10:o>=US?5:o>=HS?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=zS?10:o>=US?5:o>=HS?2:1)}function Ru(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=zS?i*=10:o>=US?i*=5:o>=HS&&(i*=2),t<e?-i:i}var z6,Ghe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Fd(e){if(!(t=Ghe.exec(e)))throw new Error("invalid format: "+e);var t;return new qS({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function qS(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function n1(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Rd(e){return(e=n1(Math.abs(e)))?e[1]:NaN}function j6(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Rd(t)/3)))-Rd(Math.abs(e)))}function $6(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Rd(t)-Rd(e))+1}function B6(e){return Math.max(0,-Rd(Math.abs(e)))}function U6(e,t){var n=n1(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}Fd.prototype=qS.prototype,qS.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const H6={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>U6(100*e,t),r:U6,s:function(e,t){var n=n1(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(z6=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,s=r.length;return o===s?r:o>s?r+new Array(o-s+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+n1(e,Math.max(0,t+o-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function V6(e){return e}var r1,i1,WS,q6=Array.prototype.map,W6=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function G6(e){var t=void 0===e.grouping||void 0===e.thousands?V6:function(e,t){return function(n,r){for(var i=n.length,o=[],s=0,a=e[0],u=0;i>0&&a>0&&(u+a+1>r&&(a=Math.max(1,r-u)),o.push(n.substring(i-=a,i+a)),!((u+=a+1)>r));)a=e[s=(s+1)%e.length];return o.reverse().join(t)}}(q6.call(e.grouping,Number),e.thousands+""),n=void 0===e.currency?"":e.currency[0]+"",r=void 0===e.currency?"":e.currency[1]+"",i=void 0===e.decimal?".":e.decimal+"",o=void 0===e.numerals?V6:function(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}(q6.call(e.numerals,String)),s=void 0===e.percent?"%":e.percent+"",a=void 0===e.minus?"\u2212":e.minus+"",u=void 0===e.nan?"NaN":e.nan+"";function l(f){var d=(f=Fd(f)).fill,h=f.align,p=f.sign,g=f.symbol,m=f.zero,v=f.width,y=f.comma,b=f.precision,_=f.trim,w=f.type;"n"===w?(y=!0,w="g"):H6[w]||(void 0===b&&(b=12),_=!0,w="g"),(m||"0"===d&&"="===h)&&(m=!0,d="0",h="=");var E="$"===g?n:"#"===g&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",x="$"===g?r:/[%p]/.test(w)?s:"",D=H6[w],S=/[defgprs%]/.test(w);function C(A){var L,O,N,M=E,T=x;if("c"===w)T=D(A)+T,A="";else{var U=(A=+A)<0||1/A<0;if(A=isNaN(A)?u:D(Math.abs(A),b),_&&(A=function(e){e:for(var i,t=e.length,n=1,r=-1;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":0===r&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0)}return r>0?e.slice(0,r)+e.slice(i+1):e}(A)),U&&0==+A&&"+"!==p&&(U=!1),M=(U?"("===p?p:a:"-"===p||"("===p?"":p)+M,T=("s"===w?W6[8+z6/3]:"")+T+(U&&"("===p?")":""),S)for(L=-1,O=A.length;++L<O;)if(48>(N=A.charCodeAt(L))||N>57){T=(46===N?i+A.slice(L+1):A.slice(L))+T,A=A.slice(0,L);break}}y&&!m&&(A=t(A,1/0));var W=M.length+A.length+T.length,te=W<v?new Array(v-W+1).join(d):"";switch(y&&m&&(A=t(te+A,te.length?v-T.length:1/0),te=""),h){case"<":A=M+A+T+te;break;case"=":A=M+te+A+T;break;case"^":A=te.slice(0,W=te.length>>1)+M+A+T+te.slice(W);break;default:A=te+M+A+T}return o(A)}return b=void 0===b?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b)),C.toString=function(){return f+""},C}return{format:l,formatPrefix:function(f,d){var h=l(((f=Fd(f)).type="f",f)),p=3*Math.max(-8,Math.min(8,Math.floor(Rd(d)/3))),g=Math.pow(10,-p),m=W6[8+p/3];return function(v){return h(g*v)+m}}}}r1=G6({thousands:",",grouping:[3],currency:["$",""]}),i1=r1.format,WS=r1.formatPrefix;var GS=new Date,YS=new Date;function xn(e,t,n,r){function i(o){return e(o=0===arguments.length?new Date:new Date(+o)),o}return i.floor=function(o){return e(o=new Date(+o)),o},i.ceil=function(o){return e(o=new Date(o-1)),t(o,1),e(o),o},i.round=function(o){var s=i(o),a=i.ceil(o);return o-s<a-o?s:a},i.offset=function(o,s){return t(o=new Date(+o),null==s?1:Math.floor(s)),o},i.range=function(o,s,a){var l,u=[];if(o=i.ceil(o),a=null==a?1:Math.floor(a),!(o<s&&a>0))return u;do{u.push(l=new Date(+o)),t(o,a),e(o)}while(l<o&&o<s);return u},i.filter=function(o){return xn(function(s){if(s>=s)for(;e(s),!o(s);)s.setTime(s-1)},function(s,a){if(s>=s)if(a<0)for(;++a<=0;)for(;t(s,-1),!o(s););else for(;--a>=0;)for(;t(s,1),!o(s););})},n&&(i.count=function(o,s){return GS.setTime(+o),YS.setTime(+s),e(GS),e(YS),Math.floor(n(GS,YS))},i.every=function(o){return o=Math.floor(o),isFinite(o)&&o>0?o>1?i.filter(r?function(s){return r(s)%o==0}:function(s){return i.count(0,s)%o==0}):i:null}),i}const Na=1e3,Xi=6e4,Pa=60*Xi,dc=24*Pa,XS=7*dc,Y6=30*dc,QS=365*dc;var X6=xn(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Xi)/dc,e=>e.getDate()-1);const Nu=X6;function hc(e){return xn(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+7*n)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Xi)/XS})}var Nd=hc(0),o1=hc(1),Pd=(hc(2),hc(3),hc(4)),Q6=(hc(5),hc(6),xn(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/dc},function(e){return e.getUTCDate()-1}));const Pu=Q6;function pc(e){return xn(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+7*n)},function(t,n){return(n-t)/XS})}var Ld=pc(0),s1=pc(1),jd=(pc(2),pc(3),pc(4)),KS=(pc(5),pc(6),xn(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()}));KS.every=function(e){return isFinite(e=Math.floor(e))&&e>0?xn(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)}):null};const Lu=KS;var K6=xn(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())},function(e){return e.getMonth()});const a1=K6;var Z6=xn(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Na-e.getMinutes()*Xi)},function(e,t){e.setTime(+e+t*Pa)},function(e,t){return(t-e)/Pa},function(e){return e.getHours()});const ZS=Z6;var J6=xn(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Na)},function(e,t){e.setTime(+e+t*Xi)},function(e,t){return(t-e)/Xi},function(e){return e.getMinutes()});const JS=J6;var eB=xn(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*Na)},function(e,t){return(t-e)/Na},function(e){return e.getUTCSeconds()});const ju=eB;var u1=xn(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});u1.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?xn(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):u1:null};const eA=u1;var tA=xn(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});tA.every=function(e){return isFinite(e=Math.floor(e))&&e>0?xn(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)}):null};const $u=tA;var tB=xn(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())},function(e){return e.getUTCMonth()});const l1=tB;var nB=xn(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*Pa)},function(e,t){return(t-e)/Pa},function(e){return e.getUTCHours()});const nA=nB;var rB=xn(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*Xi)},function(e,t){return(t-e)/Xi},function(e){return e.getUTCMinutes()});const rA=rB;function $d(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Sg(e){let t=e,n=e;function r(s,a,u,l){for(null==u&&(u=0),null==l&&(l=s.length);u<l;){const c=u+l>>>1;n(s[c],a)<0?u=c+1:l=c}return u}return 1===e.length&&(t=(s,a)=>e(s)-a,n=function(e){return(t,n)=>$d(e(t),n)}(e)),{left:r,center:function(s,a,u,l){null==u&&(u=0),null==l&&(l=s.length);const c=r(s,a,u,l-1);return c>u&&t(s[c-1],a)>-t(s[c],a)?c-1:c},right:function(s,a,u,l){for(null==u&&(u=0),null==l&&(l=s.length);u<l;){const c=u+l>>>1;n(s[c],a)>0?l=c:u=c+1}return u}}}const Ln="year",Gr="quarter",rr="month",pn="week",Yr="date",ir="day",Ss="dayofyear",Ei="hours",Di="minutes",Qi="seconds",ko="milliseconds",iA=[Ln,Gr,rr,pn,Yr,ir,Ss,Ei,Di,Qi,ko],oA=iA.reduce((e,t,n)=>(e[t]=1+n,e),{});function sA(e){const t=X(e).slice(),n={};return t.length||F("Missing time unit."),t.forEach(i=>{ne(oA,i)?n[i]=1:F("Invalid time unit: ".concat(i,"."))}),(n[pn]||n[ir]?1:0)+(n[Gr]||n[rr]||n[Yr]?1:0)+(n[Ss]?1:0)>1&&F("Incompatible time units: ".concat(e)),t.sort((i,o)=>oA[i]-oA[o]),t}const lpe={[Ln]:"%Y ",[Gr]:"Q%q ",[rr]:"%b ",[Yr]:"%d ",[pn]:"W%U ",[ir]:"%a ",[Ss]:"%j ",[Ei]:"%H:00",[Di]:"00:%M",[Qi]:":%S",[ko]:".%L",["".concat(Ln,"-").concat(rr)]:"%Y-%m ",["".concat(Ln,"-").concat(rr,"-").concat(Yr)]:"%Y-%m-%d ",["".concat(Ei,"-").concat(Di)]:"%H:%M"};function iB(e,t){const n=Ee({},lpe,t),r=sA(e),i=r.length;let a,u,o="",s=0;for(s=0;s<i;)for(a=r.length;a>s;--a)if(u=r.slice(s,a).join("-"),null!=n[u]){o+=n[u],s=a;break}return o.trim()}const gc=new Date;function aA(e){return gc.setFullYear(e),gc.setMonth(0),gc.setDate(1),gc.setHours(0,0,0,0),gc}function oB(e){return aB(new Date(e))}function sB(e){return uA(new Date(e))}function aB(e){return Nu.count(aA(e.getFullYear())-1,e)}function uA(e){return Nd.count(aA(e.getFullYear())-1,e)}function lA(e){return aA(e).getDay()}function cpe(e,t,n,r,i,o,s){if(0<=e&&e<100){const a=new Date(-1,t,n,r,i,o,s);return a.setFullYear(e),a}return new Date(e,t,n,r,i,o,s)}function uB(e){return cB(new Date(e))}function lB(e){return cA(new Date(e))}function cB(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return Pu.count(t-1,e)}function cA(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return Ld.count(t-1,e)}function fA(e){return gc.setTime(Date.UTC(e,0,1)),gc.getUTCDay()}function fpe(e,t,n,r,i,o,s){if(0<=e&&e<100){const a=new Date(Date.UTC(-1,t,n,r,i,o,s));return a.setUTCFullYear(n.y),a}return new Date(Date.UTC(e,t,n,r,i,o,s))}function fB(e,t,n,r,i){const o=t||1,s=je(e),a=(v,y,b)=>function(e,t,n,r){const i=n<=1?e:r?(o,s)=>r+n*Math.floor((e(o,s)-r)/n):(o,s)=>n*Math.floor(e(o,s)/n);return t?(o,s)=>t(i(o,s),s):i}(n[b=b||v],r[b],v===s&&o,y),u=new Date,l=To(e),c=l[Ln]?a(Ln):nr(2012),f=l[rr]?a(rr):l[Gr]?a(Gr):Mu,d=l[pn]&&l[ir]?a(ir,1,pn+ir):l[pn]?a(pn,1):l[ir]?a(ir,1):l[Yr]?a(Yr,1):l[Ss]?a(Ss,1):Od,h=l[Ei]?a(Ei):Mu,p=l[Di]?a(Di):Mu,g=l[Qi]?a(Qi):Mu,m=l[ko]?a(ko):Mu;return function(v){u.setTime(+v);const y=c(u);return i(y,f(u),d(u,y),h(u),p(u),g(u),m(u))}}function Bd(e,t,n){return t+7*e-(n+6)%7}const hpe={[Ln]:e=>e.getFullYear(),[Gr]:e=>Math.floor(e.getMonth()/3),[rr]:e=>e.getMonth(),[Yr]:e=>e.getDate(),[Ei]:e=>e.getHours(),[Di]:e=>e.getMinutes(),[Qi]:e=>e.getSeconds(),[ko]:e=>e.getMilliseconds(),[Ss]:e=>aB(e),[pn]:e=>uA(e),[pn+ir]:(e,t)=>Bd(uA(e),e.getDay(),lA(t)),[ir]:(e,t)=>Bd(1,e.getDay(),lA(t))},ppe={[Gr]:e=>3*e,[pn]:(e,t)=>Bd(e,0,lA(t))};function dB(e,t){return fB(e,t||1,hpe,ppe,cpe)}const gpe={[Ln]:e=>e.getUTCFullYear(),[Gr]:e=>Math.floor(e.getUTCMonth()/3),[rr]:e=>e.getUTCMonth(),[Yr]:e=>e.getUTCDate(),[Ei]:e=>e.getUTCHours(),[Di]:e=>e.getUTCMinutes(),[Qi]:e=>e.getUTCSeconds(),[ko]:e=>e.getUTCMilliseconds(),[Ss]:e=>cB(e),[pn]:e=>cA(e),[ir]:(e,t)=>Bd(1,e.getUTCDay(),fA(t)),[pn+ir]:(e,t)=>Bd(cA(e),e.getUTCDay(),fA(t))},mpe={[Gr]:e=>3*e,[pn]:(e,t)=>Bd(e,0,fA(t))};function hB(e,t){return fB(e,t||1,gpe,mpe,fpe)}const ype={[Ln]:Lu,[Gr]:a1.every(3),[rr]:a1,[pn]:Nd,[Yr]:Nu,[ir]:Nu,[Ss]:Nu,[Ei]:ZS,[Di]:JS,[Qi]:ju,[ko]:eA},vpe={[Ln]:$u,[Gr]:l1.every(3),[rr]:l1,[pn]:Ld,[Yr]:Pu,[ir]:Pu,[Ss]:Pu,[Ei]:nA,[Di]:rA,[Qi]:ju,[ko]:eA};function zd(e){return ype[e]}function Ud(e){return vpe[e]}function pB(e,t,n){return e?e.offset(t,n):void 0}function gB(e,t,n){return pB(zd(e),t,n)}function mB(e,t,n){return pB(Ud(e),t,n)}function yB(e,t,n,r){return e?e.range(t,n,r):void 0}function vB(e,t,n,r){return yB(zd(e),t,n,r)}function bB(e,t,n,r){return yB(Ud(e),t,n,r)}const Og=6e4,Mg=60*Og,c1=24*Mg,_B=30*c1,dA=365*c1,wB=[Ln,rr,Yr,Ei,Di,Qi,ko],Tg=wB.slice(0,-1),kg=Tg.slice(0,-1),Ig=kg.slice(0,-1),_pe=Ig.slice(0,-1),xB=[Ln,rr],EB=[Ln],Fg=[[Tg,1,1e3],[Tg,5,5e3],[Tg,15,15e3],[Tg,30,3e4],[kg,1,Og],[kg,5,5*Og],[kg,15,15*Og],[kg,30,30*Og],[Ig,1,Mg],[Ig,3,3*Mg],[Ig,6,6*Mg],[Ig,12,12*Mg],[_pe,1,c1],[[Ln,pn],1,6048e5],[xB,1,_B],[xB,3,3*_B],[EB,1,dA]];function DB(e){const t=e.extent,n=e.maxbins||40,r=Math.abs(Dg(t))/n;let o,s,i=Sg(a=>a[2]).right(Fg,r);return i===Fg.length?(o=EB,s=Ru(t[0]/dA,t[1]/dA,n)):i?(i=Fg[r/Fg[i-1][2]<Fg[i][2]/r?i-1:i],o=i[0],s=i[1]):(o=wB,s=Math.max(Ru(t[0],t[1],n),1)),{units:o,step:s}}function hA(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function pA(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Rg(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function CB(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,o=e.days,s=e.shortDays,a=e.months,u=e.shortMonths,l=Ng(i),c=Pg(i),f=Ng(o),d=Pg(o),h=Ng(s),p=Pg(s),g=Ng(a),m=Pg(a),v=Ng(u),y=Pg(u),b={a:function(Z){return s[Z.getDay()]},A:function(Z){return o[Z.getDay()]},b:function(Z){return u[Z.getMonth()]},B:function(Z){return a[Z.getMonth()]},c:null,d:kB,e:kB,f:Vpe,g:ege,G:nge,H:zpe,I:Upe,j:Hpe,L:IB,m:qpe,M:Wpe,p:function(Z){return i[+(Z.getHours()>=12)]},q:function(Z){return 1+~~(Z.getMonth()/3)},Q:jB,s:$B,S:Gpe,u:Ype,U:Xpe,V:Qpe,w:Kpe,W:Zpe,x:null,X:null,y:Jpe,Y:tge,Z:rge,"%":LB},_={a:function(Z){return s[Z.getUTCDay()]},A:function(Z){return o[Z.getUTCDay()]},b:function(Z){return u[Z.getUTCMonth()]},B:function(Z){return a[Z.getUTCMonth()]},c:null,d:RB,e:RB,f:age,g:yge,G:bge,H:ige,I:oge,j:sge,L:NB,m:uge,M:lge,p:function(Z){return i[+(Z.getUTCHours()>=12)]},q:function(Z){return 1+~~(Z.getUTCMonth()/3)},Q:jB,s:$B,S:cge,u:fge,U:dge,V:hge,w:pge,W:gge,x:null,X:null,y:mge,Y:vge,Z:_ge,"%":LB},w={a:function(Z,de,Me){var B=h.exec(de.slice(Me));return B?(Z.w=p.get(B[0].toLowerCase()),Me+B[0].length):-1},A:function(Z,de,Me){var B=f.exec(de.slice(Me));return B?(Z.w=d.get(B[0].toLowerCase()),Me+B[0].length):-1},b:function(Z,de,Me){var B=v.exec(de.slice(Me));return B?(Z.m=y.get(B[0].toLowerCase()),Me+B[0].length):-1},B:function(Z,de,Me){var B=g.exec(de.slice(Me));return B?(Z.m=m.get(B[0].toLowerCase()),Me+B[0].length):-1},c:function(Z,de,Me){return D(Z,t,de,Me)},d:MB,e:MB,f:Lpe,g:OB,G:AB,H:TB,I:TB,j:Fpe,L:Ppe,m:Ipe,M:Rpe,p:function(Z,de,Me){var B=l.exec(de.slice(Me));return B?(Z.p=c.get(B[0].toLowerCase()),Me+B[0].length):-1},q:kpe,Q:$pe,s:Bpe,S:Npe,u:Spe,U:Ape,V:Ope,w:Cpe,W:Mpe,x:function(Z,de,Me){return D(Z,n,de,Me)},X:function(Z,de,Me){return D(Z,r,de,Me)},y:OB,Y:AB,Z:Tpe,"%":jpe};function E(Z,de){return function(Me){var Vt,da,du,B=[],un=-1,ze=0,Zt=Z.length;for(Me instanceof Date||(Me=new Date(+Me));++un<Zt;)37===Z.charCodeAt(un)&&(B.push(Z.slice(ze,un)),null!=(da=SB[Vt=Z.charAt(++un)])?Vt=Z.charAt(++un):da="e"===Vt?" ":"0",(du=de[Vt])&&(Vt=du(Me,da)),B.push(Vt),ze=un+1);return B.push(Z.slice(ze,un)),B.join("")}}function x(Z,de){return function(Me){var ze,Zt,B=Rg(1900,void 0,1);if(D(B,Z,Me+="",0)!=Me.length)return null;if("Q"in B)return new Date(B.Q);if("s"in B)return new Date(1e3*B.s+("L"in B?B.L:0));if(de&&!("Z"in B)&&(B.Z=0),"p"in B&&(B.H=B.H%12+12*B.p),void 0===B.m&&(B.m="q"in B?B.q:0),"V"in B){if(B.V<1||B.V>53)return null;"w"in B||(B.w=1),"Z"in B?(Zt=(ze=pA(Rg(B.y,0,1))).getUTCDay(),ze=Zt>4||0===Zt?s1.ceil(ze):s1(ze),ze=Pu.offset(ze,7*(B.V-1)),B.y=ze.getUTCFullYear(),B.m=ze.getUTCMonth(),B.d=ze.getUTCDate()+(B.w+6)%7):(Zt=(ze=hA(Rg(B.y,0,1))).getDay(),ze=Zt>4||0===Zt?o1.ceil(ze):o1(ze),ze=Nu.offset(ze,7*(B.V-1)),B.y=ze.getFullYear(),B.m=ze.getMonth(),B.d=ze.getDate()+(B.w+6)%7)}else("W"in B||"U"in B)&&("w"in B||(B.w="u"in B?B.u%7:"W"in B?1:0),Zt="Z"in B?pA(Rg(B.y,0,1)).getUTCDay():hA(Rg(B.y,0,1)).getDay(),B.m=0,B.d="W"in B?(B.w+6)%7+7*B.W-(Zt+5)%7:B.w+7*B.U-(Zt+6)%7);return"Z"in B?(B.H+=B.Z/100|0,B.M+=B.Z%100,pA(B)):hA(B)}}function D(Z,de,Me,B){for(var Vt,da,un=0,ze=de.length,Zt=Me.length;un<ze;){if(B>=Zt)return-1;if(37===(Vt=de.charCodeAt(un++))){if(Vt=de.charAt(un++),!(da=w[Vt in SB?de.charAt(un++):Vt])||(B=da(Z,Me,B))<0)return-1}else if(Vt!=Me.charCodeAt(B++))return-1}return B}return b.x=E(n,b),b.X=E(r,b),b.c=E(t,b),_.x=E(n,_),_.X=E(r,_),_.c=E(t,_),{format:function(Z){var de=E(Z+="",b);return de.toString=function(){return Z},de},parse:function(Z){var de=x(Z+="",!1);return de.toString=function(){return Z},de},utcFormat:function(Z){var de=E(Z+="",_);return de.toString=function(){return Z},de},utcParse:function(Z){var de=x(Z+="",!0);return de.toString=function(){return Z},de}}}var Hd,gA,BB,mA,zB,SB={"-":"",_:" ",0:"0"},En=/^\s*\d+/,xpe=/^%/,Epe=/[\\^$*+?|[\]().{}]/g;function Ze(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(t)+i:i)}function Dpe(e){return e.replace(Epe,"\\$&")}function Ng(e){return new RegExp("^(?:"+e.map(Dpe).join("|")+")","i")}function Pg(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function Cpe(e,t,n){var r=En.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function Spe(e,t,n){var r=En.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function Ape(e,t,n){var r=En.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function Ope(e,t,n){var r=En.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function Mpe(e,t,n){var r=En.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function AB(e,t,n){var r=En.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function OB(e,t,n){var r=En.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Tpe(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function kpe(e,t,n){var r=En.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function Ipe(e,t,n){var r=En.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function MB(e,t,n){var r=En.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function Fpe(e,t,n){var r=En.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function TB(e,t,n){var r=En.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function Rpe(e,t,n){var r=En.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function Npe(e,t,n){var r=En.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function Ppe(e,t,n){var r=En.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function Lpe(e,t,n){var r=En.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function jpe(e,t,n){var r=xpe.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function $pe(e,t,n){var r=En.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function Bpe(e,t,n){var r=En.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function kB(e,t){return Ze(e.getDate(),t,2)}function zpe(e,t){return Ze(e.getHours(),t,2)}function Upe(e,t){return Ze(e.getHours()%12||12,t,2)}function Hpe(e,t){return Ze(1+Nu.count(Lu(e),e),t,3)}function IB(e,t){return Ze(e.getMilliseconds(),t,3)}function Vpe(e,t){return IB(e,t)+"000"}function qpe(e,t){return Ze(e.getMonth()+1,t,2)}function Wpe(e,t){return Ze(e.getMinutes(),t,2)}function Gpe(e,t){return Ze(e.getSeconds(),t,2)}function Ype(e){var t=e.getDay();return 0===t?7:t}function Xpe(e,t){return Ze(Nd.count(Lu(e)-1,e),t,2)}function FB(e){var t=e.getDay();return t>=4||0===t?Pd(e):Pd.ceil(e)}function Qpe(e,t){return e=FB(e),Ze(Pd.count(Lu(e),e)+(4===Lu(e).getDay()),t,2)}function Kpe(e){return e.getDay()}function Zpe(e,t){return Ze(o1.count(Lu(e)-1,e),t,2)}function Jpe(e,t){return Ze(e.getFullYear()%100,t,2)}function ege(e,t){return Ze((e=FB(e)).getFullYear()%100,t,2)}function tge(e,t){return Ze(e.getFullYear()%1e4,t,4)}function nge(e,t){var n=e.getDay();return Ze((e=n>=4||0===n?Pd(e):Pd.ceil(e)).getFullYear()%1e4,t,4)}function rge(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Ze(t/60|0,"0",2)+Ze(t%60,"0",2)}function RB(e,t){return Ze(e.getUTCDate(),t,2)}function ige(e,t){return Ze(e.getUTCHours(),t,2)}function oge(e,t){return Ze(e.getUTCHours()%12||12,t,2)}function sge(e,t){return Ze(1+Pu.count($u(e),e),t,3)}function NB(e,t){return Ze(e.getUTCMilliseconds(),t,3)}function age(e,t){return NB(e,t)+"000"}function uge(e,t){return Ze(e.getUTCMonth()+1,t,2)}function lge(e,t){return Ze(e.getUTCMinutes(),t,2)}function cge(e,t){return Ze(e.getUTCSeconds(),t,2)}function fge(e){var t=e.getUTCDay();return 0===t?7:t}function dge(e,t){return Ze(Ld.count($u(e)-1,e),t,2)}function PB(e){var t=e.getUTCDay();return t>=4||0===t?jd(e):jd.ceil(e)}function hge(e,t){return e=PB(e),Ze(jd.count($u(e),e)+(4===$u(e).getUTCDay()),t,2)}function pge(e){return e.getUTCDay()}function gge(e,t){return Ze(s1.count($u(e)-1,e),t,2)}function mge(e,t){return Ze(e.getUTCFullYear()%100,t,2)}function yge(e,t){return Ze((e=PB(e)).getUTCFullYear()%100,t,2)}function vge(e,t){return Ze(e.getUTCFullYear()%1e4,t,4)}function bge(e,t){var n=e.getUTCDay();return Ze((e=n>=4||0===n?jd(e):jd.ceil(e)).getUTCFullYear()%1e4,t,4)}function _ge(){return"+0000"}function LB(){return"%"}function jB(e){return+e}function $B(e){return Math.floor(+e/1e3)}function Lg(e){const t={};return n=>t[n]||(t[n]=e(n))}function UB(e){const t=Lg(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(r){const i=Fd(r||",");if(null==i.precision){switch(i.precision=12,i.type){case"%":i.precision-=2;break;case"e":i.precision-=1}return function(e,t){return n=>{const r=e(n),i=r.indexOf(t);if(i<0)return r;let o=function(e,t){let r,n=e.lastIndexOf("e");if(n>0)return n;for(n=e.length;--n>t;)if(r=e.charCodeAt(n),r>=48&&r<=57)return n+1}(r,i);const s=o<r.length?r.slice(o):"";for(;--o>i;)if("0"!==r[o]){++o;break}return r.slice(0,o)+s}}(t(i),t(".1f")(1)[1])}return t(i)},formatSpan(r,i,o,s){s=Fd(null==s?",f":s);const a=Ru(r,i,o),u=Math.max(Math.abs(r),Math.abs(i));let l;if(null==s.precision)switch(s.type){case"s":return isNaN(l=j6(a,u))||(s.precision=l),n(s,u);case"":case"e":case"g":case"p":case"r":isNaN(l=$6(a,u))||(s.precision=l-("e"===s.type));break;case"f":case"%":isNaN(l=B6(a))||(s.precision=l-2*("%"===s.type))}return t(s)}}}let yA,vA;function HB(){return yA=UB({format:i1,formatPrefix:WS})}function VB(e){return UB(G6(e))}function f1(e){return arguments.length?yA=VB(e):yA}function qB(e,t,n){J(n=n||{})||F("Invalid time multi-format specifier: ".concat(n));const r=t(Qi),i=t(Di),o=t(Ei),s=t(Yr),a=t(pn),u=t(rr),l=t(Gr),c=t(Ln),f=e(n[ko]||".%L"),d=e(n[Qi]||":%S"),h=e(n[Di]||"%I:%M"),p=e(n[Ei]||"%I %p"),g=e(n[Yr]||n[ir]||"%a %d"),m=e(n[pn]||"%b %d"),v=e(n[rr]||"%B"),y=e(n[Gr]||"%B"),b=e(n[Ln]||"%Y");return _=>(r(_)<_?f:i(_)<_?d:o(_)<_?h:s(_)<_?p:u(_)<_?a(_)<_?g:m:c(_)<_?l(_)<_?v:y:b)(_)}function WB(e){const t=Lg(e.format),n=Lg(e.utcFormat);return{timeFormat:r=>Y(r)?t(r):qB(t,zd,r),utcFormat:r=>Y(r)?n(r):qB(n,Ud,r),timeParse:Lg(e.parse),utcParse:Lg(e.utcParse)}}function GB(){return vA=WB({format:gA,parse:BB,utcFormat:mA,utcParse:zB})}function YB(e){return WB(CB(e))}function jg(e){return arguments.length?vA=YB(e):vA}Hd=CB({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),gA=Hd.format,BB=Hd.parse,mA=Hd.utcFormat,zB=Hd.utcParse,HB(),GB();const bA=(e,t)=>Ee({},e,t);function XB(e,t){const n=e?VB(e):f1(),r=t?YB(t):jg();return bA(n,r)}function _A(e,t){const n=arguments.length;return n&&2!==n&&F("defaultLocale expects either zero or two arguments."),n?bA(f1(e),jg(t)):bA(f1(),jg())}function Dge(){return HB(),GB(),_A()}const Cge=/^(data:|([A-Za-z]+:)?\/\/)/,Sge=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,Age=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,QB="file://";function Mge(e,t){return wA.apply(this,arguments)}function wA(){return wA=Zn(function*(e,t){const n=yield this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)}),wA.apply(this,arguments)}function Tge(e,t){return xA.apply(this,arguments)}function xA(){return xA=Zn(function*(e,t){t=Ee({},this.options,t);const n=this.fileAccess,r={href:null};let i,o,s;const a=Sge.test(e.replace(Age,""));(null==e||"string"!=typeof e||!a)&&F("Sanitize failure, invalid URI: "+H(e));const u=Cge.test(e);return(s=t.baseURL)&&!u&&(!e.startsWith("/")&&!s.endsWith("/")&&(e="/"+e),e=s+e),o=(i=e.startsWith(QB))||"file"===t.mode||"http"!==t.mode&&!u&&n,i?e=e.slice(QB.length):e.startsWith("//")&&("file"===t.defaultProtocol?(e=e.slice(2),o=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!o}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),"image"===t.context&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r}),xA.apply(this,arguments)}function kge(e){return e?t=>new Promise((n,r)=>{e.readFile(t,(i,o)=>{i?r(i):n(o)})}):Ige}function Ige(){return EA.apply(this,arguments)}function EA(){return(EA=Zn(function*(){F("No file system access.")})).apply(this,arguments)}function Fge(e){return e?function(){var t=Zn(function*(n,r){const i=Ee({},this.options.http,r),o=r&&r.response,s=yield e(n,i);return s.ok?xe(s[o])?s[o]():s.text():F(s.status+""+s.statusText)});return function(n,r){return t.apply(this,arguments)}}():Rge}function Rge(){return DA.apply(this,arguments)}function DA(){return(DA=Zn(function*(){F("No HTTP fetch method available.")})).apply(this,arguments)}const Nge=e=>null!=e&&e==e,KB=e=>!(Number.isNaN(+e)||e instanceof Date),CA={boolean:NS,integer:tr,number:tr,date:PS,string:LS,unknown:er},d1=[e=>"true"===e||"false"===e||!0===e||!1===e,e=>KB(e)&&Number.isInteger(+e),KB,e=>!Number.isNaN(Date.parse(e))],$ge=["boolean","integer","number","date"];function ZB(e,t){if(!e||!e.length)return"unknown";const n=e.length,r=d1.length,i=d1.map((o,s)=>s+1);for(let a,u,o=0,s=0;o<n;++o)for(u=t?e[o][t]:e[o],a=0;a<r;++a)if(i[a]&&Nge(u)&&!d1[a](u)&&(i[a]=0,++s,s===d1.length))return"string";return $ge[i.reduce((o,s)=>0===o?s:o,0)-1]}function JB(e,t){return t.reduce((n,r)=>(n[r]=ZB(e,r),n),{})}function e4(e){const t=function(n,r){const i={delimiter:e};return SA(n,r?Ee(r,i):i)};return t.responseType="text",t}function SA(e,t){return t.header&&(e=t.header.map(H).join(t.delimiter)+"\n"+e),jhe(t.delimiter).parse(e+"")}function AA(e,t){const n=t&&t.property?qr(t.property):er;return J(e)&&!function(e){return!("function"!=typeof Buffer||!xe(Buffer.isBuffer))&&Buffer.isBuffer(e)}(e)?function(e,t){return!R(e)&&C6(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}(n(e),t):n(JSON.parse(e))}SA.responseType="text",AA.responseType="json";const Uge={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function t4(e,t){let n,r,i,o;return e=AA(e,t),t&&t.feature?(n=Uhe,i=t.feature):t&&t.mesh?(n=Vhe,i=t.mesh,o=Uge[t.filter]):F("Missing TopoJSON feature or mesh parameter."),r=(r=e.objects[i])?n(e,r,o):F("Invalid TopoJSON object: "+i),r&&r.features||[r]}t4.responseType="json";const h1={dsv:SA,csv:e4(","),tsv:e4("\t"),json:AA,topojson:t4};function OA(e,t){return arguments.length>1?(h1[e]=t,this):ne(h1,e)?h1[e]:null}function n4(e){const t=OA(e);return t&&t.responseType||"text"}function r4(e,t,n,r){const i=OA((t=t||{}).type||"json");return i||F("Unknown data format type: "+t.type),e=i(e,t),t.parse&&function(e,t,n,r){if(!e.length)return;const i=jg();n=n||i.timeParse,r=r||i.utcParse;let s,a,u,l,c,f,o=e.columns||Object.keys(e[0]);"auto"===t&&(t=JB(e,o)),o=Object.keys(t);const d=o.map(h=>{const p=t[h];let g,m;if(p&&(p.startsWith("date:")||p.startsWith("utc:")))return g=p.split(/:(.+)?/,2),m=g[1],("'"===m[0]&&"'"===m[m.length-1]||'"'===m[0]&&'"'===m[m.length-1])&&(m=m.slice(1,-1)),("utc"===g[0]?r:n)(m);if(!CA[p])throw Error("Illegal format pattern: "+h+":"+p);return CA[p]});for(u=0,c=e.length,f=o.length;u<c;++u)for(s=e[u],l=0;l<f;++l)a=o[l],s[a]=d[l](s[a])}(e,t.parse,n,r),ne(e,"columns")&&delete e.columns,e}const p1=function(e,t){return n=>({options:n||{},sanitize:Tge,load:Mge,fileAccess:!1,file:kge(null),http:Fge(e)})}("undefined"!=typeof fetch&&fetch);function g1(e){const t=e||er,n=[],r={};return n.add=i=>{const o=t(i);return r[o]||(r[o]=1,n.push(i)),n},n.remove=i=>{const o=t(i);if(r[o]){r[o]=0;const s=n.indexOf(i);s>=0&&n.splice(s,1)}return n},n}function m1(e,t){return MA.apply(this,arguments)}function MA(){return MA=Zn(function*(e,t){try{yield t(e)}catch(n){e.error(n)}}),MA.apply(this,arguments)}const i4=Symbol("vega_id");let Vge=1;function y1(e){return!(!e||!oe(e))}function oe(e){return e[i4]}function o4(e,t){return e[i4]=t,e}function it(e){const t=e===Object(e)?e:{data:e};return oe(t)?t:o4(t,Vge++)}function TA(e){return v1(e,it({}))}function v1(e,t){for(const n in e)t[n]=e[n];return t}function s4(e,t){return o4(t,oe(e))}function mc(e,t){return e?t?(n,r)=>e(n,r)||oe(t(n))-oe(t(r)):(n,r)=>e(n,r)||oe(n)-oe(r):null}function a4(e){return e&&e.constructor===yc}function yc(){const e=[],t=[],n=[],r=[],i=[];let o=null,s=!1;return{constructor:yc,insert(a){const u=X(a),l=u.length;for(let c=0;c<l;++c)e.push(u[c]);return this},remove(a){const u=xe(a)?r:t,l=X(a),c=l.length;for(let f=0;f<c;++f)u.push(l[f]);return this},modify(a,u,l){const c={field:u,value:nr(l)};return xe(a)?(c.filter=a,i.push(c)):(c.tuple=a,n.push(c)),this},encode(a,u){return xe(a)?i.push({filter:a,field:u}):n.push({tuple:a,field:u}),this},clean(a){return o=a,this},reflow(){return s=!0,this},pulse(a,u){const l={},c={};let f,d,h,p,g,m;for(f=0,d=u.length;f<d;++f)l[oe(u[f])]=1;for(f=0,d=t.length;f<d;++f)g=t[f],l[oe(g)]=-1;for(f=0,d=r.length;f<d;++f)p=r[f],u.forEach(y=>{p(y)&&(l[oe(y)]=-1)});for(f=0,d=e.length;f<d;++f)g=e[f],m=oe(g),l[m]?l[m]=1:a.add.push(it(e[f]));for(f=0,d=u.length;f<d;++f)g=u[f],l[oe(g)]<0&&a.rem.push(g);function v(y,b,_){_?y[b]=_(y):a.encode=b,s||(c[oe(y)]=y)}for(f=0,d=n.length;f<d;++f)h=n[f],g=h.tuple,p=h.field,m=l[oe(g)],m>0&&(v(g,p,h.value),a.modifies(p));for(f=0,d=i.length;f<d;++f)h=i[f],p=h.filter,u.forEach(y=>{p(y)&&l[oe(y)]>0&&v(y,h.field,h.value)}),a.modifies(h.field);if(s)a.mod=t.length||r.length?u.filter(y=>l[oe(y)]>0):u.slice();else for(m in c)a.mod.push(c[m]);return(o||null==o&&(t.length||r.length))&&a.clean(!0),a}}}const b1="_:mod:_";function _1(){Object.defineProperty(this,b1,{writable:!0,value:{}})}_1.prototype={set(e,t,n,r){const i=this,o=i[e],s=i[b1];return null!=t&&t>=0?(o[t]!==n||r)&&(o[t]=n,s[t+":"+e]=-1,s[e]=-1):(o!==n||r)&&(i[e]=n,s[e]=R(n)?1+n.length:-1),i},modified(e,t){const n=this[b1];if(!arguments.length){for(const r in n)if(n[r])return!0;return!1}if(R(e)){for(let r=0;r<e.length;++r)if(n[e[r]])return!0;return!1}return null!=t&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[b1]={},this}};let qge=0;const Gge=new _1;function vt(e,t,n,r){this.id=++qge,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,r)}function u4(e){return function(t){const n=this.flags;return 0===arguments.length?!!(n&e):(this.flags=t?n|e:n&~e,this)}}vt.prototype={targets(){return this._targets||(this._targets=g1(xg))},set(e){return this.value!==e?(this.value=e,1):0},skip:u4(1),modified:u4(2),parameters(e,t,n){t=!1!==t;const r=this._argval=this._argval||new _1,i=this._argops=this._argops||[],o=[];let s,a,u,l;const c=(f,d,h)=>{h instanceof vt?(h!==this&&(t&&h.targets().add(this),o.push(h)),i.push({op:h,name:f,index:d})):r.set(f,d,h)};for(s in e)if(a=e[s],"pulse"===s)X(a).forEach(f=>{f instanceof vt?f!==this&&(f.targets().add(this),o.push(f)):F("Pulse parameters must be operator instances.")}),this.source=a;else if(R(a))for(r.set(s,-1,Array(u=a.length)),l=0;l<u;++l)c(s,l,a[l]);else c(s,-1,a);return this.marshall().clear(),n&&(i.initonly=!0),o},marshall(e){const t=this._argval||Gge,n=this._argops;let r,i,o,s;if(n){const a=n.length;for(i=0;i<a;++i)r=n[i],o=r.op,s=o.modified()&&o.stamp===e,t.set(r.name,r.index,o.value,s);if(n.initonly){for(i=0;i<a;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,r,i;if(e)for(t=0,n=e.length;t<n;++t)r=e[t],i=r.op,i._targets&&i._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),r=t.call(this,n,e);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};let Zge=0;function w1(e,t,n){this.id=++Zge,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function Bu(e,t,n){return new w1(e,t,n)}function kA(){return kA=Zn(function*(e,t){const n=this;let i,r=0;try{i=yield n.loader().load(e,{context:"dataflow",response:n4(t&&t.type)});try{i=n.parse(i,t)}catch(o){r=-2,n.warn("Data ingestion failed",e,o)}}catch(o){r=-1,n.warn("Loading failed",e,o)}return{data:i,status:r}}),kA.apply(this,arguments)}function IA(){return IA=Zn(function*(e,t,n){const r=this,i=r._pending||ime(r);i.requests+=1;const o=yield r.request(t,n);return r.pulse(e,r.changeset().remove(Yi).insert(o.data||[])),i.done(),o}),IA.apply(this,arguments)}function ime(e){let t;const n=new Promise(r=>t=r);return n.requests=0,n.done=()=>{0==--n.requests&&(e._pending=null,t(e))},e._pending=n}w1.prototype={_filter:Yi,_apply:er,targets(){return this._targets||(this._targets=g1(xg))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,r=n?n.length:0;for(let i=0;i<r;++i)n[i].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=Bu(e);return this.targets().add(t),t},apply(e){const t=Bu(null,e);return this.targets().add(t),t},merge(){const e=Bu();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{const n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){const t=Bu();return this.targets().add(Bu(null,null,FS(e,n=>{const r=n.dataflow;t.receive(n),r&&r.run&&r.run()}))),t},between(e,t){let n=!1;return e.targets().add(Bu(null,null,()=>n=!0)),t.targets().add(Bu(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=Yi,this._targets=null}};const ome={skip:!0};function ame(e,t,n,r,i,o){const s=Ee({},o,ome);let a,u;xe(n)||(n=nr(n)),void 0===r?a=l=>e.touch(n(l)):xe(r)?(u=new vt(null,r,i,!1),a=l=>{u.evaluate(l);const c=n(l),f=u.value;a4(f)?e.pulse(c,f,o):e.update(c,f,s)}):a=l=>e.update(n(l),r,s),t.apply(a)}function ume(e,t,n,r,i,o){if(void 0===r)t.targets().add(n);else{const s=o||{},a=new vt(null,function(e,t){return t=xe(t)?t:nr(t),e?function(n,r){const i=t(n,r);return e.skip()||(e.skip(i!==this.value).value=i),i}:t}(n,r),i,!1);a.modified(s.force),a.rank=t.rank,t.targets().add(a),n&&(a.skip(!0),a.value=n.value,a.targets().add(n),e.connect(n,[a]))}}const x1={};function Uu(e,t,n){this.dataflow=e,this.stamp=null==t?-1:t,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function FA(e,t){const n=[];return Fu(e,t,r=>n.push(r)),n}function h4(e,t){const n={};return e.visit(t,r=>{n[oe(r)]=1}),r=>n[oe(r)]?null:r}function E1(e,t){return e?(n,r)=>e(n,r)&&t(n,r):t}function RA(e,t,n,r){const i=this,o=n.length;let s=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=r||null,this.pulses=n;for(let a=0;a<o;++a){const u=n[a];if(u.stamp===t){if(u.fields){const l=i.fields||(i.fields={});for(const c in u.fields)l[c]=1}u.changed(i.ADD)&&(s|=i.ADD),u.changed(i.REM)&&(s|=i.REM),u.changed(i.MOD)&&(s|=i.MOD)}}this.changes=s}function NA(){return NA=Zn(function*(e,t,n){const r=this,i=[];if(r._pulse)return p4(r);if(r._pending&&(yield r._pending),t&&(yield m1(r,t)),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;const o=++r._clock;r._pulse=new Uu(r,o,e),r._touched.forEach(c=>r._enqueue(c,!0)),r._touched=g1(xg);let a,u,l,s=0;try{for(;r._heap.size()>0;)a=r._heap.pop(),a.rank===a.qrank?(u=a.run(r._getPulse(a,e)),u.then?u=yield u:u.async&&(i.push(u.async),u=x1),u!==x1&&a._targets&&a._targets.forEach(c=>r._enqueue(c)),++s):r._enqueue(a,!0)}catch(c){r._heap.clear(),l=c}if(r._input={},r._pulse=null,r.debug(`Pulse ${o}: ${s} operators`),l&&(r._postrun=[],r.error(l)),r._postrun.length){const c=r._postrun.sort((f,d)=>d.priority-f.priority);r._postrun=[];for(let f=0;f<c.length;++f)yield m1(r,c[f].callback)}return n&&(yield m1(r,n)),i.length&&Promise.all(i).then(c=>r.runAsync(null,()=>{c.forEach(f=>{try{f(r)}catch(d){r.error(d)}})})),r}),NA.apply(this,arguments)}function PA(){return PA=Zn(function*(e,t,n){for(;this._running;)yield this._running;const r=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(r,r),this._running}),PA.apply(this,arguments)}function p4(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}Uu.prototype={StopPropagation:x1,ADD:1,REM:2,MOD:4,ADD_REM:3,ADD_MOD:5,ALL:7,REFLOW:8,SOURCE:16,NO_SOURCE:32,NO_FIELDS:64,fork(e){return new Uu(this.dataflow).init(this,e)},clone(){const e=this.fork(7);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(23)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new Uu(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(64&t)&&(n.fields=e.fields),1&t?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),2&t?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),4&t?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),32&t?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||7;return 1&t&&this.add.length||2&t&&this.rem.length||4&t&&this.mod.length},reflow(e){if(e)return this.fork(7).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(4,h4(this,1))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return R(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return!(!t&&!this.mod.length||!n)&&(arguments.length?R(e)?e.some(r=>n[r]):n[e]:!!n)},filter(e,t){const n=this;return 1&e&&(n.addF=E1(n.addF,t)),2&e&&(n.remF=E1(n.remF,t)),4&e&&(n.modF=E1(n.modF,t)),16&e&&(n.srcF=E1(n.srcF,t)),n},materialize(e){const t=this;return 1&(e=e||7)&&t.addF&&(t.add=FA(t.add,t.addF),t.addF=null),2&e&&t.remF&&(t.rem=FA(t.rem,t.remF),t.remF=null),4&e&&t.modF&&(t.mod=FA(t.mod,t.modF),t.modF=null),16&e&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,r=t;if(16&e)return Fu(n.source,n.srcF,r),n;1&e&&Fu(n.add,n.addF,r),2&e&&Fu(n.rem,n.remF,r),4&e&&Fu(n.mod,n.modF,r);const i=n.source;if(8&e&&i){const o=n.add.length+n.mod.length;o===i.length||Fu(i,o?h4(n,5):n.srcF,r)}return n}},z(RA,Uu,{fork(e){const t=new Uu(this.dataflow).init(this,e&this.NO_FIELDS);return void 0!==e&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?R(e)?e.some(r=>n[r]):n[e]:0},filter(){F("MultiPulse does not support filtering.")},materialize(){F("MultiPulse does not support materialization.")},visit(e,t){const n=this,r=n.pulses,i=r.length;let o=0;if(e&n.SOURCE)for(;o<i;++o)r[o].visit(e,t);else for(;o<i;++o)r[o].stamp===n.stamp&&r[o].visit(e,t);return n}});const LA={skip:!1,force:!1};function g4(e,t,n,r){let i,o;const s=e[n];for(;n>t&&(o=n-1>>1,i=e[o],r(s,i)<0);)e[n]=i,n=o;return e[n]=s}function qd(){this.logger(OS()),this.logLevel(SS),this._clock=0,this._rank=0,this._locale=_A();try{this._loader=p1()}catch(e){}this._touched=g1(xg),this._input={},this._pulse=null,this._heap=function(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),g4(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let r;return t.length?(r=t[0],t[0]=n,function(e,t,n){const r=t,i=e.length,o=e[t];let a,s=1+(t<<1);for(;s<i;)a=s+1,a<i&&n(e[s],e[a])>=0&&(s=a),e[t]=e[s],s=1+((t=s)<<1);e[t]=o,g4(e,r,t,n)}(t,0,e)):r=n,r}}}((e,t)=>e.qrank-t.qrank),this._postrun=[]}function Bg(e){return function(){return this._log[e].apply(this,arguments)}}function k(e,t){vt.call(this,e,null,t)}qd.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:Bg("error"),warn:Bg("warn"),info:Bg("info"),debug:Bg("debug"),logLevel:Bg("level"),cleanThreshold:1e4,add:function(e,t,n,r){let o,i=1;return e instanceof vt?o=e:e&&e.prototype instanceof vt?o=new e:xe(e)?o=new vt(null,e):(i=0,o=new vt(e,t)),this.rank(o),i&&(r=n,n=t),n&&this.connect(o,o.parameters(n,r)),this.touch(o),o},connect:function(e,t){const n=e.rank,r=t.length;for(let i=0;i<r;++i)if(n<t[i].rank)return void this.rerank(e)},rank:function(e){e.rank=++this._rank},rerank:function(e){const t=[e];let n,r,i;for(;t.length;)if(this.rank(n=t.pop()),r=n._targets)for(i=r.length;--i>=0;)t.push(n=r[i]),n===e&&F("Cycle detected in dataflow graph.")},pulse:function(e,t,n){this.touch(e,n||LA);const r=new Uu(this,this._clock+(this._pulse?0:1)),i=e.pulse&&e.pulse.source||[];return r.target=e,this._input[e.id]=t.pulse(r,i),this},touch:function(e,t){const n=t||LA;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this},update:function(e,t,n){const r=n||LA;return(e.set(t)||r.force)&&this.touch(e,r),this},changeset:yc,ingest:function(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))},parse:function(e,t){const n=this.locale();return r4(e,t,n.timeParse,n.utcParse)},preload:function(e,t,n){return IA.apply(this,arguments)},request:function(e,t){return kA.apply(this,arguments)},events:function(e,t,n,r){const i=this,o=Bu(n,r),s=function(l){l.dataflow=i;try{o.receive(l)}catch(c){i.error(c)}finally{i.run()}};let a;a="string"==typeof e&&"undefined"!=typeof document?document.querySelectorAll(e):X(e);const u=a.length;for(let l=0;l<u;++l)a[l].addEventListener(t,s);return o},on:function(e,t,n,r,i){return(e instanceof vt?ume:ame)(this,e,t,n,r,i),this},evaluate:function(e,t,n){return NA.apply(this,arguments)},run:function(e,t,n){return this._pulse?p4(this):(this.evaluate(e,t,n),this)},runAsync:function(e,t,n){return PA.apply(this,arguments)},runAfter:function(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(r){this.error(r)}},_enqueue:function(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))},_getPulse:function(e,t){const n=e.source,r=this._clock;return n&&R(n)?new RA(this,r,n.map(i=>i.pulse),t):this._input[e.id]||function(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==x1&&(e.source=t.source),e)}(this._pulse,n&&n.pulse)}},z(k,vt,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const Wd={};function m4(e){const t=y4(e);return t&&t.Definition||null}function y4(e){return e=e&&e.toLowerCase(),ne(Wd,e)?Wd[e]:null}function vc(e,t){let n;if(void 0===t)for(const r of e)null!=r&&(n<r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function jA(e,t){let n;if(void 0===t)for(const r of e)null!=r&&(n>r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function v4(e,t,n=0,r=e.length-1,i=$d){for(;r>n;){if(r-n>600){const u=r-n+1,l=t-n+1,c=Math.log(u),f=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*f*(u-f)/u)*(l-u/2<0?-1:1);v4(e,t,Math.max(n,Math.floor(t-l*f/u+d)),Math.min(r,Math.floor(t+(u-l)*f/u+d)),i)}const o=e[t];let s=n,a=r;for(zg(e,n,t),i(e[r],o)>0&&zg(e,n,r);s<a;){for(zg(e,s,a),++s,--a;i(e[s],o)<0;)++s;for(;i(e[a],o)>0;)--a}0===i(e[n],o)?zg(e,n,a):(++a,zg(e,a,r)),a<=t&&(n=a+1),t<=a&&(r=a-1)}return e}function zg(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function b4(e){return null===e?NaN:+e}function $A(e,t,n){if(e=Float64Array.from(function*(e,t){if(void 0===t)for(let n of e)null!=n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)null!=(r=t(r,++n,e))&&(r=+r)>=r&&(yield r)}}(e,n)),r=e.length){if((t=+t)<=0||r<2)return jA(e);if(t>=1)return vc(e);var r,i=(r-1)*t,o=Math.floor(i),s=vc(v4(e,o).subarray(0,o+1));return s+(jA(e.subarray(o+1))-s)*(i-o)}}function _4(e,t,n=b4){if(r=e.length){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),s=+n(e[o],o,e);return s+(+n(e[o+1],o+1,e)-s)*(i-o)}}function w4(e,t){return $A(e,.5,t)}function*x4(e,t){if(null==t)for(let n of e)null!=n&&""!==n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)r=t(r,++n,e),null!=r&&""!==r&&(r=+r)>=r&&(yield r)}}function BA(e,t,n){const r=Float64Array.from(x4(e,n));return r.sort($d),t.map(i=>_4(r,i))}function zA(e,t){return BA(e,[.25,.5,.75],t)}function UA(e,t){const n=e.length,r=function(e,t){const n=function(e,t){let r,n=0,i=0,o=0;if(void 0===t)for(let s of e)null!=s&&(s=+s)>=s&&(r=s-i,i+=r/++n,o+=r*(s-i));else{let s=-1;for(let a of e)null!=(a=t(a,++s,e))&&(a=+a)>=a&&(r=a-i,i+=r/++n,o+=r*(a-i))}if(n>1)return o/(n-1)}(e,t);return n&&Math.sqrt(n)}(e,t),i=zA(e,t);return 1.06*(Math.min(r,(i[2]-i[0])/1.34)||r||Math.abs(i[0])||1)*Math.pow(n,-.2)}function E4(e){const t=e.maxbins||20,n=e.base||10,r=Math.log(n),i=e.divide||[5,2];let a,u,l,c,f,d,o=e.extent[0],s=e.extent[1];const h=e.span||s-o||Math.abs(o)||1;if(e.step)a=e.step;else if(e.steps){for(c=h/t,f=0,d=e.steps.length;f<d&&e.steps[f]<c;++f);a=e.steps[Math.max(0,f-1)]}else{for(u=Math.ceil(Math.log(t)/r),l=e.minstep||0,a=Math.max(l,Math.pow(n,Math.round(Math.log(h)/r)-u));Math.ceil(h/a)>t;)a*=n;for(f=0,d=i.length;f<d;++f)c=a/i[f],c>=l&&h/c<=t&&(a=c)}c=Math.log(a);const g=Math.pow(n,-(c>=0?0:1+~~(-c/r))-1);return(e.nice||void 0===e.nice)&&(c=Math.floor(o/a+g)*a,o=o<c?c-a:c,s=Math.ceil(s/a)*a),{start:o,stop:s===o?o+a:s,step:a}}var Ki=Math.random;function Ome(e){Ki=e}function D4(e,t,n,r){if(!e.length)return[void 0,void 0];const i=Float64Array.from(x4(e,r)),o=i.length,s=t;let a,u,l,c;for(l=0,c=Array(s);l<s;++l){for(a=0,u=0;u<o;++u)a+=i[~~(Ki()*o)];c[l]=a/o}return c.sort($d),[$A(c,n/2),$A(c,1-n/2)]}function C4(e,t,n,r){r=r||(d=>d);const i=e.length,o=new Float64Array(i);let f,s=0,a=1,u=r(e[0]),l=u,c=u+t;for(;a<i;++a){if(f=r(e[a]),f>=c){for(l=(u+l)/2;s<a;++s)o[s]=l;c=f+t,u=f}l=f}for(l=(u+l)/2;s<a;++s)o[s]=l;return n?function(e,t){const n=e.length;let o,s,r=0,i=1;for(;e[r]===e[i];)++i;for(;i<n;){for(o=i+1;e[i]===e[o];)++o;if(e[i]-e[i-1]<t){for(s=i+(r+o-i-i>>1);s<i;)e[s++]=e[i];for(;s>i;)e[s--]=e[r]}r=i,i=o}return e}(o,t+t/4):o}function Tme(e){return function(){return(e=(1103515245*e+12345)%2147483647)/2147483647}}function kme(e,t){let n,r,i;null==t&&(t=e,e=0);const o={min(s){return arguments.length?(n=s||0,i=r-n,o):n},max(s){return arguments.length?(r=s||0,i=r-n,o):r},sample:()=>n+Math.floor(i*Ki()),pdf:s=>s===Math.floor(s)&&s>=n&&s<r?1/i:0,cdf(s){const a=Math.floor(s);return a<n?0:a>=r?1:(a-n+1)/i},icdf:s=>s>=0&&s<=1?n-1+Math.floor(s*i):NaN};return o.min(e).max(t)}const S4=Math.sqrt(2*Math.PI),Ime=Math.SQRT2;let Ug=NaN;function D1(e,t){e=e||0,t=null==t?1:t;let i,o,n=0,r=0;if(Ug==Ug)n=Ug,Ug=NaN;else{do{n=2*Ki()-1,r=2*Ki()-1,i=n*n+r*r}while(0===i||i>1);o=Math.sqrt(-2*Math.log(i)/i),n*=o,Ug=r*o}return e+n*t}function HA(e,t,n){const r=(e-(t||0))/(n=null==n?1:n);return Math.exp(-.5*r*r)/(n*S4)}function C1(e,t,n){const r=(e-(t=t||0))/(n=null==n?1:n),i=Math.abs(r);let o;if(i>37)o=0;else{const s=Math.exp(-i*i/2);let a;i<7.07106781186547?(a=.0352624965998911*i+.700383064443688,a=a*i+6.37396220353165,a=a*i+33.912866078383,a=a*i+112.079291497871,a=a*i+221.213596169931,a=a*i+220.206867912376,o=s*a,a=.0883883476483184*i+1.75566716318264,a=a*i+16.064177579207,a=a*i+86.7807322029461,a=a*i+296.564248779674,a=a*i+637.333633378831,a=a*i+793.826512519948,a=a*i+440.413735824752,o/=a):(a=i+.65,a=i+4/a,a=i+3/a,a=i+2/a,a=i+1/a,o=s/a/2.506628274631)}return r>0?1-o:o}function S1(e,t,n){return e<0||e>1?NaN:(t||0)+(null==n?1:n)*Ime*function(e){let n,t=-Math.log((1-e)*(1+e));return t<6.25?(t-=3.125,n=-364441206401782e-35,n=n*t-16850591381820166e-35,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=n*t-1333171662854621e-31,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=n*t-4054566272975207e-29,n=n*t-8151934197605472e-29,n=26335093153082323e-28+n*t,n=n*t-12975133253453532e-27,n=n*t-5415412054294628e-26,n=1.0512122733215323e-9+n*t,n=n*t-4.112633980346984e-9,n=n*t-2.9070369957882005e-8,n=4.2347877827932404e-7+n*t,n=n*t-13654692000834679e-22,n=n*t-13882523362786469e-21,n=.00018673420803405714+n*t,n=n*t-.000740702534166267,n=n*t-.006033670871430149,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=2.2137376921775787e-9,n=9.075656193888539e-8+n*t,n=n*t-2.7517406297064545e-7,n=1.8239629214389228e-8+n*t,n=15027403968909828e-22+n*t,n=n*t-4013867526981546e-21,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=n*t-47318229009055734e-21,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=n*t-.0003550375203628475,n=.0009532893797373805+n*t,n=n*t-.0016882755560235047,n=.002491442096107851+n*t,n=n*t-.003751208507569241,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=n*t-2.555641816996525e-10,n=1.5076572693500548e-9+n*t,n=n*t-3.789465440126737e-9,n=7.61570120807834e-9+n*t,n=n*t-1.496002662714924e-8,n=2.914795345090108e-8+n*t,n=n*t-6.771199775845234e-8,n=2.2900482228026655e-7+n*t,n=n*t-9.9298272942317e-7,n=4526062597223154e-21+n*t,n=n*t-1968177810553167e-20,n=7599527703001776e-20+n*t,n=n*t-.00021503011930044477,n=n*t-.00013871931833623122,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}(2*e-1)}function VA(e,t){let n,r;const i={mean(o){return arguments.length?(n=o||0,i):n},stdev(o){return arguments.length?(r=null==o?1:o,i):r},sample:()=>D1(n,r),pdf:o=>HA(o,n,r),cdf:o=>C1(o,n,r),icdf:o=>S1(o,n,r)};return i.mean(e).stdev(t)}function qA(e,t){const n=VA();let r=0;const i={data(o){return arguments.length?(e=o,r=o?o.length:0,i.bandwidth(t)):e},bandwidth(o){return arguments.length?(!(t=o)&&e&&(t=UA(e)),i):t},sample:()=>e[~~(Ki()*r)]+t*n.sample(),pdf(o){let s=0,a=0;for(;a<r;++a)s+=n.pdf((o-e[a])/t);return s/t/r},cdf(o){let s=0,a=0;for(;a<r;++a)s+=n.cdf((o-e[a])/t);return s/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(e)}function WA(e,t){return e=e||0,t=null==t?1:t,Math.exp(e+D1()*t)}function GA(e,t,n){if(e<=0)return 0;t=t||0,n=null==n?1:n;const r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*S4*e)}function YA(e,t,n){return C1(Math.log(e),t,n)}function XA(e,t,n){return Math.exp(S1(e,t,n))}function A4(e,t){let n,r;const i={mean(o){return arguments.length?(n=o||0,i):n},stdev(o){return arguments.length?(r=null==o?1:o,i):r},sample:()=>WA(n,r),pdf:o=>GA(o,n,r),cdf:o=>YA(o,n,r),icdf:o=>XA(o,n,r)};return i.mean(e).stdev(t)}function O4(e,t){let r,n=0;const o={weights(s){return arguments.length?(r=function(s){const a=[];let l,u=0;for(l=0;l<n;++l)u+=a[l]=null==s[l]?1:+s[l];for(l=0;l<n;++l)a[l]/=u;return a}(t=s||[]),o):t},distributions(s){return arguments.length?(s?(n=s.length,e=s):(n=0,e=[]),o.weights(t)):e},sample(){const s=Ki();let a=e[n-1],u=r[0],l=0;for(;l<n-1;u+=r[++l])if(s<u){a=e[l];break}return a.sample()},pdf(s){let a=0,u=0;for(;u<n;++u)a+=r[u]*e[u].pdf(s);return a},cdf(s){let a=0,u=0;for(;u<n;++u)a+=r[u]*e[u].cdf(s);return a},icdf(){throw Error("Mixture icdf not supported.")}};return o.distributions(e).weights(t)}function QA(e,t){return null==t&&(t=null==e?1:e,e=0),e+(t-e)*Ki()}function KA(e,t,n){return null==n&&(n=null==t?1:t,t=0),e>=t&&e<=n?1/(n-t):0}function ZA(e,t,n){return null==n&&(n=null==t?1:t,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function JA(e,t,n){return null==n&&(n=null==t?1:t,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function M4(e,t){let n,r;const i={min(o){return arguments.length?(n=o||0,i):n},max(o){return arguments.length?(r=null==o?1:o,i):r},sample:()=>QA(n,r),pdf:o=>KA(o,n,r),cdf:o=>ZA(o,n,r),icdf:o=>JA(o,n,r)};return null==t&&(t=null==e?1:e,e=0),i.min(e).max(t)}function Hg(e,t,n,r){const i=r-e*e,o=Math.abs(i)<1e-24?0:(n-e*t)/i;return[t-o*e,o]}function A1(e,t,n,r){e=e.filter(h=>{let p=t(h),g=n(h);return null!=p&&(p=+p)>=p&&null!=g&&(g=+g)>=g}),r&&e.sort((h,p)=>t(h)-t(p));const i=e.length,o=new Float64Array(i),s=new Float64Array(i);let c,f,d,a=0,u=0,l=0;for(d of e)o[a]=c=+t(d),s[a]=f=+n(d),++a,u+=(c-u)/a,l+=(f-l)/a;for(a=0;a<i;++a)o[a]-=u,s[a]-=l;return[o,s,u,l]}function Vg(e,t,n,r){let o,s,i=-1;for(const a of e)o=t(a),s=n(a),null!=o&&(o=+o)>=o&&null!=s&&(s=+s)>=s&&r(o,s,++i)}function Gd(e,t,n,r,i){let o=0,s=0;return Vg(e,t,n,(a,u)=>{const l=u-i(a),c=u-r;o+=l*l,s+=c*c}),1-o/s}function eO(e,t,n){let r=0,i=0,o=0,s=0,a=0;Vg(e,t,n,(c,f)=>{++a,r+=(c-r)/a,i+=(f-i)/a,o+=(c*f-o)/a,s+=(c*c-s)/a});const u=Hg(r,i,o,s),l=c=>u[0]+u[1]*c;return{coef:u,predict:l,rSquared:Gd(e,t,n,i,l)}}function T4(e,t,n){let r=0,i=0,o=0,s=0,a=0;Vg(e,t,n,(c,f)=>{++a,c=Math.log(c),r+=(c-r)/a,i+=(f-i)/a,o+=(c*f-o)/a,s+=(c*c-s)/a});const u=Hg(r,i,o,s),l=c=>u[0]+u[1]*Math.log(c);return{coef:u,predict:l,rSquared:Gd(e,t,n,i,l)}}function k4(e,t,n){const[r,i,o,s]=A1(e,t,n);let d,h,p,a=0,u=0,l=0,c=0,f=0;Vg(e,t,n,(y,b)=>{d=r[f++],h=Math.log(b),p=d*b,a+=(b*h-a)/f,u+=(p-u)/f,l+=(p*h-l)/f,c+=(d*p-c)/f});const[g,m]=Hg(u/s,a/s,l/s,c/s),v=y=>Math.exp(g+m*(y-o));return{coef:[Math.exp(g-m*o),m],predict:v,rSquared:Gd(e,t,n,s,v)}}function I4(e,t,n){let r=0,i=0,o=0,s=0,a=0,u=0;Vg(e,t,n,(f,d)=>{const h=Math.log(f),p=Math.log(d);++u,r+=(h-r)/u,i+=(p-i)/u,o+=(h*p-o)/u,s+=(h*h-s)/u,a+=(d-a)/u});const l=Hg(r,i,o,s),c=f=>l[0]*Math.pow(f,l[1]);return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:Gd(e,t,n,a,c)}}function tO(e,t,n){const[r,i,o,s]=A1(e,t,n),a=r.length;let h,p,g,m,u=0,l=0,c=0,f=0,d=0;for(h=0;h<a;)p=r[h],g=i[h++],m=p*p,u+=(m-u)/h,l+=(m*p-l)/h,c+=(m*m-c)/h,f+=(p*g-f)/h,d+=(m*g-d)/h;const v=c-u*u,y=u*v-l*l,b=(d*u-f*l)/y,_=(f*v-d*l)/y,w=-b*u,E=x=>b*(x-=o)*x+_*x+w+s;return{coef:[w-_*o+b*o*o+s,_-2*b*o,b],predict:E,rSquared:Gd(e,t,n,s,E)}}function F4(e,t,n,r){if(1===r)return eO(e,t,n);if(2===r)return tO(e,t,n);const[i,o,s,a]=A1(e,t,n),u=i.length,l=[],c=[],f=r+1;let d,h,p,g,m;for(d=0;d<f;++d){for(p=0,g=0;p<u;++p)g+=Math.pow(i[p],d)*o[p];for(l.push(g),m=new Float64Array(f),h=0;h<f;++h){for(p=0,g=0;p<u;++p)g+=Math.pow(i[p],d+h);m[h]=g}c.push(m)}c.push(l);const v=function(e){const t=e.length-1,n=[];let r,i,o,s,a;for(r=0;r<t;++r){for(s=r,i=r+1;i<t;++i)Math.abs(e[r][i])>Math.abs(e[r][s])&&(s=i);for(o=r;o<t+1;++o)a=e[o][r],e[o][r]=e[o][s],e[o][s]=a;for(i=r+1;i<t;++i)for(o=t;o>=r;o--)e[o][i]-=e[o][r]*e[r][i]/e[r][r]}for(i=t-1;i>=0;--i){for(a=0,o=i+1;o<t;++o)a+=e[o][i]*n[o];n[i]=(e[t][i]-a)/e[i][i]}return n}(c),y=b=>{let _=a+v[0]+v[1]*(b-=s)+v[2]*b*b;for(d=3;d<f;++d)_+=v[d]*Math.pow(b,d);return _};return{coef:Rme(f,v,-s,a),predict:y,rSquared:Gd(e,t,n,a,y)}}function Rme(e,t,n,r){const i=Array(e);let o,s,a,u;for(o=0;o<e;++o)i[o]=0;for(o=e-1;o>=0;--o)for(a=t[o],u=1,i[o]+=a,s=1;s<=o;++s)u*=(o+1-s)/s,i[o-s]+=a*Math.pow(n,s)*u;return i[0]+=r,i}function P4(e,t,n,r){const[i,o,s,a]=A1(e,t,n,!0),u=i.length,l=Math.max(2,~~(r*u)),c=new Float64Array(u),f=new Float64Array(u),d=new Float64Array(u).fill(1);for(let h=-1;++h<=2;){const p=[0,l-1];for(let m=0;m<u;++m){const v=i[m],y=p[0],b=p[1];let w=0,E=0,x=0,D=0,S=0;const C=1/Math.abs(i[v-i[y]>i[b]-v?y:b]-v||1);for(let T=y;T<=b;++T){const L=i[T],O=o[T],N=Pme(Math.abs(v-L)*C)*d[T],U=L*N;w+=N,E+=U,x+=O*N,D+=O*U,S+=L*U}const[A,M]=Hg(E/w,x/w,D/w,S/w);c[m]=A+M*v,f[m]=Math.abs(o[m]-c[m]),Lme(i,m+1,p)}if(2===h)break;const g=w4(f);if(Math.abs(g)<1e-12)break;for(let v,y,m=0;m<u;++m)v=f[m]/(6*g),d[m]=v>=1?1e-12:(y=1-v*v)*y}return function(e,t,n,r){const i=e.length,o=[];let l,s=0,a=0,u=[];for(;s<i;++s)l=e[s]+n,u[0]===l?u[1]+=(t[s]-u[1])/++a:(a=0,u[1]+=r,u=[l,t[s]],o.push(u));return u[1]+=r,o}(i,c,s,a)}function Pme(e){return(e=1-e*e*e)*e*e}function Lme(e,t,n){const r=e[t];let i=n[0],o=n[1]+1;if(!(o>=e.length))for(;t>i&&e[o]-r<=r-e[i];)n[0]=++i,n[1]=o,++o}const $me=.5*Math.PI/180;function O1(e,t,n,r){n=n||25,r=Math.max(n,r||200);const i=g=>[g,e(g)],o=t[0],s=t[1],a=s-o,u=a/r,l=[i(o)],c=[];if(n===r){for(let g=1;g<r;++g)l.push(i(o+g/n*a));return l.push(i(s)),l}c.push(i(s));for(let g=n;--g>0;)c.push(i(o+g/n*a));let f=l[0],d=c[c.length-1];const h=1/a,p=function(e,t){let n=e,r=e;const i=t.length;for(let o=0;o<i;++o){const s=t[o][1];s<n&&(n=s),s>r&&(r=s)}return 1/(r-n)}(f[1],c);for(;d;){const g=i((f[0]+d[0])/2);g[0]-f[0]>=u&&zme(f,g,d,h,p)>$me?c.push(g):(f=d,l.push(d),c.pop()),d=c[c.length-1]}return l}function zme(e,t,n,r,i){const o=Math.atan2(i*(n[1]-e[1]),r*(n[0]-e[0])),s=Math.atan2(i*(t[1]-e[1]),r*(t[0]-e[0]));return Math.abs(o-s)}function Ci(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((t-e)/n)),o=new Array(i);++r<i;)o[r]=e+r*n;return o}function nO(e){return e&&e.length?1===e.length?e[0]:function(e){return t=>{const n=e.length;let r=1,i=String(e[0](t));for(;r<n;++r)i+="|"+e[r](t);return i}}(e):function(){return""}}function L4(e,t,n){return n||e+(t?"_"+t:"")}const rO=()=>{},Vme={init:rO,add:rO,rem:rO,idx:0},qg={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.sum,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||void 0===e.min)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||void 0===e.max)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},Wg=Object.keys(qg);function j4(e,t){return qg[e](t)}function $4(e,t){return e.idx-t.idx}function Gme(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.init(this))}function Yme(e,t){null!=e&&""!==e?e==e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t))):++this.missing}function Xme(e,t){null!=e&&""!==e?e==e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t))):--this.missing}function Qme(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function B4(e,t){const n=t||er,r=function(e){const t={};e.forEach(r=>t[r.name]=r);const n=r=>{!r.req||r.req.forEach(i=>{t[i]||n(t[i]=qg[i]())})};return e.forEach(n),Object.values(t).sort($4)}(e),i=e.slice().sort($4);function o(s){this._ops=r,this._out=i,this.cell=s,this.init()}return o.prototype.init=Gme,o.prototype.add=Yme,o.prototype.rem=Xme,o.prototype.set=Qme,o.prototype.get=n,o.fields=e.map(s=>s.out),o}function iO(e){this._key=e?qr(e):oe,this.reset()}Wg.forEach(e=>{qg[e]=function(e,t){return n=>Ee({name:e,out:n||e},Vme,t)}(e,qg[e])});const jn=iO.prototype;function Hu(e){k.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}function oO(e){k.call(this,null,e)}function z4(e,t,n){const r=e;let i=t||[],o=n||[],s={},a=0;return{add:u=>o.push(u),remove:u=>s[r(u)]=++a,size:()=>i.length,data:(u,l)=>(a&&(i=i.filter(c=>!s[r(c)]),s={},a=0),l&&u&&i.sort(u),o.length&&(i=u?M6(u,i,o.sort(u)):i.concat(o),o=[]),i)}}function sO(e){k.call(this,[],e)}function U4(e){vt.call(this,null,Zme,e)}function Zme(e){return this.value&&!e.modified()?this.value:IS(e.fields,e.orders)}function aO(e){k.call(this,null,e)}function uO(e){k.call(this,null,e)}jn.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},jn.add=function(e){this._add.push(e)},jn.rem=function(e){this._rem.push(e)},jn.values=function(){if(this._get=null,0===this._rem.length)return this._add;const e=this._add,t=this._rem,n=this._key,r=e.length,i=t.length,o=Array(r-i),s={};let a,u,l;for(a=0;a<i;++a)s[n(t[a])]=1;for(a=0,u=0;a<r;++a)s[n(l=e[a])]?s[n(l)]=0:o[u++]=l;return this._rem=[],this._add=o},jn.distinct=function(e){const t=this.values(),n={};let o,r=t.length,i=0;for(;--r>=0;)o=e(t[r])+"",ne(n,o)||(n[o]=1,++i);return i},jn.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=E6(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext},jn.argmin=function(e){return this.extent(e)[0]||{}},jn.argmax=function(e){return this.extent(e)[1]||{}},jn.min=function(e){const t=this.extent(e)[0];return null!=t?e(t):void 0},jn.max=function(e){const t=this.extent(e)[1];return null!=t?e(t):void 0},jn.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=zA(this.values(),e),this._get=e),this._q},jn.q1=function(e){return this.quartile(e)[0]},jn.q2=function(e){return this.quartile(e)[1]},jn.q3=function(e){return this.quartile(e)[2]},jn.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=D4(this.values(),1e3,.05,e),this._get=e),this._ci},jn.ci0=function(e){return this.ci(e)[0]},jn.ci1=function(e){return this.ci(e)[1]},Hu.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Wg},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]},z(Hu,k,{transform(e,t){const n=this,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.modified();return n.stamp=r.stamp,n.value&&(i||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(e):{},t.visit(t.SOURCE,o=>n.add(o))):(n.value=n.value||n.init(e),t.visit(t.REM,o=>n.rem(o)),t.visit(t.ADD,o=>n.add(o))),r.modifies(n._outputs),n._drop=!1!==e.drop,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&r.clean(!0).runAfter(()=>this.clean()),n.changes(r)},cross(){const e=this,t=e.value,n=e._dnames,r=n.map(()=>({})),i=n.length;function o(a){let u,l,c,f;for(u in a)for(c=a[u].tuple,l=0;l<i;++l)r[l][f=c[n[l]]]=f}o(e._prev),o(t),function s(a,u,l){const c=n[l],f=r[l++];for(const d in f){const h=a?a+"|"+d:d;u[c]=f[d],l<i?s(h,u,l):t[h]||e.cell(h,u)}}("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],r={};function i(m){const v=X(Jn(m)),y=v.length;let _,b=0;for(;b<y;++b)r[_=v[b]]||(r[_]=1,t.push(_))}this._dims=X(e.groupby),this._dnames=this._dims.map(m=>{const v=Bt(m);return i(m),n.push(v),v}),this.cellkey=e.key?e.key:nO(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const o=e.fields||[null],s=e.ops||["count"],a=e.as||[],u=o.length,l={};let c,f,d,h,p,g;for(u!==s.length&&F("Unmatched number of fields and aggregate ops."),g=0;g<u;++g)c=o[g],f=s[g],null==c&&"count"!==f&&F("Null aggregate field specified."),h=Bt(c),p=L4(f,h,a[g]),n.push(p),"count"!==f?(d=l[h],d||(i(c),d=l[h]=[],d.field=c,this._measures.push(d)),"count"!==f&&(this._countOnly=!1),d.push(j4(f,p))):this._counts.push(p);return this._measures=this._measures.map(m=>B4(m,m.field)),{}},cellkey:nO(),cell(e,t){let n=this.value[e];return n?0===n.num&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const r=this._measures,i=r.length;n.agg=Array(i);for(let o=0;o<i;++o)n.agg[o]=new r[o](n)}return n.store&&(n.data=new iO),n},newtuple(e,t){const n=this._dnames,r=this._dims,i=r.length,o={};for(let s=0;s<i;++s)o[n[s]]=r[s](e);return t?s4(t.tuple,o):it(o)},clean(){const e=this.value;for(const t in e)0===e[t].num&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].add(r[i].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].rem(r[i].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let r=0,i=n.length;r<i;++r)t[n[r]]=e.num;if(!this._countOnly){const r=e.agg;for(let i=0,o=r.length;i<o;++i)r[i].set(t)}return t},changes(e){const t=this._adds,n=this._mods,r=this._prev,i=this._drop,o=e.add,s=e.rem,a=e.mod;let u,l,c,f;if(r)for(l in r)u=r[l],(!i||u.num)&&s.push(u.tuple);for(c=0,f=this._alen;c<f;++c)o.push(this.celltuple(t[c])),t[c]=null;for(c=0,f=this._mlen;c<f;++c)u=n[c],(0===u.num&&i?s:a).push(this.celltuple(u)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}}),oO.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]},z(oO,k,{transform(e,t){const n=!1!==e.interval,r=this._bins(e),i=r.start,o=r.step,s=e.as||["bin0","bin1"],a=s[0],u=s[1];let l;return l=e.modified()?(t=t.reflow(!0)).SOURCE:t.modified(Jn(e.field))?t.ADD_MOD:t.ADD,t.visit(l,n?c=>{const f=r(c);c[a]=f,c[u]=null==f?null:i+o*(1+(f-i)/o)}:c=>c[a]=r(c)),t.modifies(n?s:a)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=E4(e),r=n.step;let s,a,i=n.start,o=i+Math.ceil((n.stop-i)/r)*r;null!=(s=e.anchor)&&(a=s-(i+r*Math.floor((s-i)/r)),i+=a,o+=a);const u=function(l){let c=tr(t(l));return null==c?null:c<i?-1/0:c>o?1/0:(c=Math.max(i,Math.min(c,o-r)),i+r*Math.floor(1e-14+(c-i)/r))};return u.start=i,u.stop=n.stop,u.step=r,this.value=Vr(u,Jn(t),e.name||"bin_"+Bt(t))}}),sO.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},z(sO,k,{transform(e,t){const n=t.fork(t.ALL),r=z4(oe,this.value,n.materialize(n.ADD).add),i=e.sort,o=t.changed()||i&&(e.modified("sort")||t.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(o),this.value=n.source=r.data(mc(i),o),t.source&&t.source.root&&(this.value.root=t.source.root),n}}),z(U4,vt),aO.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]},z(aO,k,{transform(e,t){const n=f=>d=>{for(var p,h=function(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase()}return e.match(n)}(a(d),e.case,o)||[],g=0,m=h.length;g<m;++g)s.test(p=h[g])||f(p)},r=this._parameterCheck(e,t),i=this._counts,o=this._match,s=this._stop,a=e.field,u=e.as||["text","count"],l=n(f=>i[f]=1+(i[f]||0)),c=n(f=>i[f]-=1);return r?t.visit(t.SOURCE,l):(t.visit(t.ADD,l),t.visit(t.REM,c)),this._finish(t,u)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,r=this._tuples||(this._tuples={}),i=t[0],o=t[1],s=e.fork(e.NO_SOURCE|e.NO_FIELDS);let a,u,l;for(a in n)u=r[a],l=n[a]||0,!u&&l?(r[a]=u=it({}),u[i]=a,u[o]=l,s.add.push(u)):0===l?(u&&s.rem.push(u),n[a]=null,r[a]=null):u[o]!==l&&(u[o]=l,s.mod.push(u));return s.modifies(t)}}),uO.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},z(uO,k,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.as||["a","b"],i=r[0],o=r[1],s=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let a=this.value;return s?(a&&(n.rem=a),a=t.materialize(t.SOURCE).source,n.add=this.value=function(e,t,n,r){for(var u,l,i=[],o={},s=e.length,a=0;a<s;++a)for(o[t]=l=e[a],u=0;u<s;++u)o[n]=e[u],r(o)&&(i.push(it(o)),(o={})[t]=l);return i}(a,i,o,e.filter||Yi)):n.mod=a,n.source=this.value,n.modifies(r)}});const H4={kde:qA,mixture:O4,normal:VA,lognormal:A4,uniform:M4},V4="function";function q4(e,t){const n=e[V4];ne(H4,n)||F("Unknown distribution function: "+n);const r=H4[n]();for(const i in e)"field"===i?r.data((e.from||t()).map(e[i])):"distributions"===i?r[i](e[i].map(o=>q4(o,t))):typeof r[i]===V4&&r[i](e[i]);return r}function lO(e){k.call(this,null,e)}const W4=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}];function G4(e,t){return e?e.map((n,r)=>t[r]||Bt(n)):null}function cO(e,t,n){const r=[],i=f=>f(u);let o,s,a,u,l,c;if(null==t)r.push(e.map(n));else for(o={},s=0,a=e.length;s<a;++s)u=e[s],l=t.map(i),c=o[l],c||(o[l]=c=[],c.dims=l,r.push(c)),c.push(n(u));return r}function fO(e){k.call(this,null,e)}function X4(e){vt.call(this,null,s0e,e),this.modified(!0)}function s0e(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:Vr(n=>t(n,e),Jn(t),Bt(t))}function dO(e){k.call(this,[void 0,void 0],e)}function hO(e,t){vt.call(this,e),this.parent=t,this.count=0}function M1(e){k.call(this,{},e),this._keys=kd();const t=this._targets=[];t.active=0,t.forEach=n=>{for(let r=0,i=t.active;r<i;++r)n(t[r],r,t)}}function Q4(e){vt.call(this,null,a0e,e)}function a0e(e){return this.value&&!e.modified()?this.value:R(e.name)?X(e.name).map(t=>qr(t)):qr(e.name,e.as)}function pO(e){k.call(this,kd(),e)}function gO(e){k.call(this,[],e)}function mO(e){k.call(this,[],e)}function yO(e){k.call(this,null,e)}function K4(e){k.call(this,[],e)}lO.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:W4.concat({key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:W4},{name:"weights",type:"number",array:!0}]})},{name:"as",type:"string",array:!0,default:["value","density"]}]},z(lO,k,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=q4(e.distribution,function(e){return()=>e.materialize(e.SOURCE).source}(t)),i=e.steps||e.minsteps||25,o=e.steps||e.maxsteps||200;let s=e.method||"pdf";"pdf"!==s&&"cdf"!==s&&F("Invalid density method: "+s),!e.extent&&!r.data&&F("Missing density extent parameter."),s=r[s];const a=e.as||["value","density"],l=O1(s,e.extent||Cs(r.data()),i,o).map(c=>{const f={};return f[a[0]]=c[0],f[a[1]]=c[1],it(f)});this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}}),fO.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:"bin"}]},z(fO,k,{transform(e,t){if(this.value&&!e.modified()&&!t.changed())return t;const n=t.materialize(t.SOURCE).source,r=cO(t.source,e.groupby,er),i=e.smooth||!1,o=e.field,s=e.step||((e,t)=>Dg(Cs(e,t))/30)(n,o),a=mc((p,g)=>o(p)-o(g)),u=e.as||"bin",l=r.length;let h,c=1/0,f=-1/0,d=0;for(;d<l;++d){const p=r[d].sort(a);h=-1;for(const g of C4(p,s,i,o))g<c&&(c=g),g>f&&(f=g),p[++h][u]=g}return this.value={start:c,stop:f,step:s},t.reflow(!0).modifies(u)}}),z(X4,vt),dO.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},z(dO,k,{transform(e,t){const n=this.value,r=e.field,i=t.changed()||t.modified(r.fields)||e.modified("field");let o=n[0],s=n[1];if((i||null==o)&&(o=1/0,s=-1/0),t.visit(i?t.SOURCE:t.ADD,a=>{const u=tr(r(a));null!=u&&(u<o&&(o=u),u>s&&(s=u))}),!Number.isFinite(o)||!Number.isFinite(s)){let a=Bt(r);a&&(a=` for field "${a}"`),t.dataflow.warn(`Infinite extent${a}: [${o}, ${s}]`),o=s=void 0}this.value=[o,s]}}),z(hO,vt,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}}),z(M1,k,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,r){const i=this.value;let s,a,o=ne(i,e)&&i[e];return o?o.value.stamp<n.stamp&&(o.init(n),this.activate(o)):(a=r||(a=this._group[e])&&a.tuple,s=n.dataflow,o=new hO(n.fork(n.NO_SOURCE),this),s.add(o).connect(t(s,e,a)),i[e]=o,this.activate(o)),o},clean(){const e=this.value;let t=0;for(const n in e)if(0===e[n].count){const r=e[n].detachSubflow;r&&r(),delete e[n],++t}if(t){const n=this._targets.filter(r=>r&&r.count>0);this.initTargets(n)}},initTargets(e){const t=this._targets,n=t.length,r=e?e.length:0;let i=0;for(;i<r;++i)t[i]=e[i];for(;i<n&&null!=t[i];++i)t[i]=null;t.active=r},transform(e,t){const n=t.dataflow,r=e.key,i=e.subflow,o=this._keys,s=e.modified("key"),a=u=>this.subflow(u,i,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,u=>{const l=oe(u),c=o.get(l);void 0!==c&&(o.delete(l),a(c).rem(u))}),t.visit(t.ADD,u=>{const l=r(u);o.set(oe(u),l),a(l).add(u)}),s||t.modified(r.fields)?t.visit(t.MOD,u=>{const l=oe(u),c=o.get(l),f=r(u);c===f?a(f).mod(u):(o.set(l,f),a(c).rem(u),a(f).add(u))}):t.changed(t.MOD)&&t.visit(t.MOD,u=>{a(o.get(oe(u))).mod(u)}),s&&t.visit(t.REFLOW,u=>{const l=oe(u),c=o.get(l),f=r(u);c!==f&&(o.set(l,f),a(c).rem(u),a(f).add(u))}),t.clean()?n.runAfter(()=>{this.clean(),o.clean()}):o.empty>n.cleanThreshold&&n.runAfter(o.clean),t}}),z(Q4,vt),pO.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},z(pO,k,{transform(e,t){const n=t.dataflow,r=this.value,i=t.fork(),o=i.add,s=i.rem,a=i.mod,u=e.expr;let l=!0;function c(f){const d=oe(f),h=u(f,e),p=r.get(d);h&&p?(r.delete(d),o.push(f)):h||p?l&&h&&!p&&a.push(f):(r.set(d,1),s.push(f))}return t.visit(t.REM,f=>{const d=oe(f);r.has(d)?r.delete(d):s.push(f)}),t.visit(t.ADD,f=>{u(f,e)?o.push(f):r.set(oe(f),1)}),t.visit(t.MOD,c),e.modified()&&(l=!1,t.visit(t.REFLOW,c)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}}),gO.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},z(gO,k,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=G4(r,e.as||[]),o=e.index||null,s=i.length;return n.rem=this.value,t.visit(t.SOURCE,a=>{const u=r.map(p=>p(a)),l=u.reduce((p,g)=>Math.max(p,g.length),0);let f,d,h,c=0;for(;c<l;++c){for(d=TA(a),f=0;f<s;++f)d[i[f]]=null==(h=u[f][c])?null:h;o&&(d[o]=c),n.add.push(d)}}),this.value=n.source=n.add,o&&n.modifies(o),n.modifies(i)}}),mO.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},z(mO,k,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=r.map(Bt),o=e.as||["key","value"],s=o[0],a=o[1],u=r.length;return n.rem=this.value,t.visit(t.SOURCE,l=>{for(let f,c=0;c<u;++c)f=TA(l),f[s]=i[c],f[a]=r[c](l),n.add.push(f)}),this.value=n.source=n.add,n.modifies(o)}}),yO.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},z(yO,k,{transform(e,t){const n=e.expr,r=e.as,i=e.modified(),o=e.initonly?t.ADD:i?t.SOURCE:t.modified(n.fields)||t.modified(r)?t.ADD_MOD:t.ADD;return i&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(r),t.visit(o,s=>s[r]=n(s,e))}}),z(K4,k,{transform(e,t){const n=t.fork(t.ALL),r=e.generator;let s,a,u,i=this.value,o=e.size-i.length;if(o>0){for(s=[];--o>=0;)s.push(u=it(r(e))),i.push(u);n.add=n.add.length?n.materialize(n.ADD).add.concat(s):s}else a=i.slice(0,-o),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(a):a,i=i.slice(-o);return n.source=this.value=i,n}});const T1={value:"value",median:w4,mean:function(e,t){let n=0,r=0;if(void 0===t)for(let i of e)null!=i&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let o of e)null!=(o=t(o,++i,e))&&(o=+o)>=o&&(++n,r+=o)}if(n)return r/n},min:jA,max:vc},u0e=[];function vO(e){k.call(this,[],e)}function bO(e){Hu.call(this,e)}function _O(e){k.call(this,null,e)}function Z4(e){vt.call(this,null,d0e,e)}function d0e(e){return this.value&&!e.modified()?this.value:RS(e.fields,e.flat)}function J4(e){k.call(this,[],e),this._pending=null}function wO(e,t,n){n.forEach(it);const r=t.fork(t.NO_FIELDS&t.NO_SOURCE);return r.rem=e.value,e.value=r.source=r.add=n,e._pending=null,r.rem.length&&r.clean(!0),r}function xO(e){k.call(this,{},e)}function ez(e){vt.call(this,null,p0e,e)}function p0e(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let o,s,r=1/0,i=-1/0;for(o=0;o<n;++o)s=t[o],s[0]<r&&(r=s[0]),s[1]>i&&(i=s[1]);return[r,i]}function tz(e){vt.call(this,null,g0e,e)}function g0e(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function nz(e){k.call(this,null,e)}function EO(e){Hu.call(this,e)}function rz(e){M1.call(this,e)}function DO(e){k.call(this,null,e)}function iz(e){k.call(this,null,e)}function CO(e){k.call(this,null,e)}function oz(e){k.call(this,null,e)}function SO(e){k.call(this,[],e),this.count=0}function AO(e){k.call(this,null,e)}function sz(e){k.call(this,null,e),this.modified(!0)}function OO(e){k.call(this,null,e)}vO.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]},z(vO,k,{transform(e,t){var d,h,p,g,m,v,y,b,_,w,n=t.fork(t.ALL),r=function(e){var n,t=e.method||T1.value;if(null!=T1[t])return t===T1.value?(n=void 0!==e.value?e.value:0,()=>n):T1[t];F("Unrecognized imputation method: "+t)}(e),i=function(e){const t=e.field;return n=>n?t(n):NaN}(e),o=Bt(e.field),s=Bt(e.key),a=(e.groupby||[]).map(Bt),u=function(e,t,n,r){var l,c,f,d,h,p,g,m,i=v=>v(m),o=[],s=r?r.slice():[],a={},u={};for(s.forEach((v,y)=>a[v]=y+1),d=0,g=e.length;d<g;++d)p=n(m=e[d]),h=a[p]||(a[p]=s.push(p)),(f=u[c=(l=t?t.map(i):u0e)+""])||(f=u[c]=[],o.push(f),f.values=l),f[h-1]=m;return o.domain=s,o}(t.source,e.groupby,e.key,e.keyvals),l=[],c=this.value,f=u.domain.length;for(m=0,b=u.length;m<b;++m)for(p=(d=u[m]).values,h=NaN,y=0;y<f;++y)if(null==d[y]){for(g=u.domain[y],w={_impute:!0},v=0,_=p.length;v<_;++v)w[a[v]]=p[v];w[s]=g,w[o]=Number.isNaN(h)?h=r(d,i):h,l.push(it(w))}return l.length&&(n.add=n.materialize(n.ADD).add.concat(l)),c.length&&(n.rem=n.materialize(n.REM).rem.concat(c)),this.value=l,n}}),bO.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:Wg},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]},z(bO,Hu,{transform(e,t){const n=this,r=e.modified();let i;return n.value&&(r||t.modified(n._inputs,!0))?(i=n.value=r?n.init(e):{},t.visit(t.SOURCE,o=>n.add(o))):(i=n.value=n.value||this.init(e),t.visit(t.REM,o=>n.rem(o)),t.visit(t.ADD,o=>n.add(o))),n.changes(),t.visit(t.SOURCE,o=>{Ee(o,i[n.cellkey(o)].tuple)}),t.reflow(r).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(e[n]),e[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}}),_O.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},z(_O,k,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=cO(r,e.groupby,e.field),o=(e.groupby||[]).map(Bt),s=e.bandwidth,a=e.cumulative?"cdf":"pdf",u=e.as||["value","density"],l=[];let c=e.extent,f=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;"pdf"!==a&&"cdf"!==a&&F("Invalid density method: "+a),"shared"===e.resolve&&(c||(c=Cs(r,e.field)),f=d=e.steps||d),i.forEach(h=>{const p=qA(h,s)[a],g=e.counts?h.length:1;O1(p,c||Cs(h),f,d).forEach(v=>{const y={};for(let b=0;b<o.length;++b)y[o[b]]=h.dims[b];y[u[0]]=v[0],y[u[1]]=v[1]*g,l.push(it(y))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}}),z(Z4,vt),z(J4,k,{transform(e,t){const n=t.dataflow;return this._pending?wO(this,t,this._pending):function(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}(e)?t.StopPropagation:e.values?wO(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(i=>(this._pending=X(i.data),o=>o.touch(this)))}:n.request(e.url,e.format).then(r=>wO(this,t,X(r.data)))}}),xO.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},z(xO,k,{transform(e,t){const n=e.fields,r=e.index,i=e.values,o=null==e.default?null:e.default,s=e.modified(),a=n.length;let f,d,h,u=s?t.SOURCE:t.ADD,l=t,c=e.as;return i?(d=i.length,a>1&&!c&&F('Multi-field lookup requires explicit "as" parameter.'),c&&c.length!==a*d&&F('The "as" parameter has too few output field names.'),c=c||i.map(Bt),f=function(p){for(var v,y,g=0,m=0;g<a;++g)if(null==(y=r.get(n[g](p))))for(v=0;v<d;++v,++m)p[c[m]]=o;else for(v=0;v<d;++v,++m)p[c[m]]=i[v](y)}):(c||F("Missing output field names."),f=function(p){for(var m,g=0;g<a;++g)m=r.get(n[g](p)),p[c[g]]=null==m?o:m}),s?l=t.reflow(!0):(h=n.some(p=>t.modified(p.fields)),u|=h?t.MOD:0),t.visit(u,f),l.modifies(c)}}),z(ez,vt),z(tz,vt),z(nz,k,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}}),EO.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:Wg,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]},z(EO,Hu,{_transform:Hu.prototype.transform,transform(e,t){return this._transform(function(e,t){const n=e.field,r=e.value,i=("count"===e.op?"__count__":e.op)||"sum",o=Jn(n).concat(Jn(r)),s=function(e,t,n){const r={},i=[];return n.visit(n.SOURCE,o=>{const s=e(o);r[s]||(r[s]=1,i.push(s))}),i.sort(e1),t?i.slice(0,t):i}(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:s.map(()=>i),fields:s.map(a=>function(e,t,n,r){return Vr(i=>t(i)===e?n(i):NaN,r,e+"")}(a,n,r,o)),as:s.map(a=>a+""),modified:e.modified.bind(e)}}(e,t),t)}}),z(rz,M1,{transform(e,t){const n=e.subflow,r=e.field,i=o=>this.subflow(oe(o),n,t,o);return(e.modified("field")||r&&t.modified(Jn(r)))&&F("PreFacet does not support field modification."),this.initTargets(),r?(t.visit(t.MOD,o=>{const s=i(o);r(o).forEach(a=>s.mod(a))}),t.visit(t.ADD,o=>{const s=i(o);r(o).forEach(a=>s.add(it(a)))}),t.visit(t.REM,o=>{const s=i(o);r(o).forEach(a=>s.rem(a))})):(t.visit(t.MOD,o=>i(o).mod(o)),t.visit(t.ADD,o=>i(o).add(o)),t.visit(t.REM,o=>i(o).rem(o))),t.clean()&&t.runAfter(()=>this.clean()),t}}),DO.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},z(DO,k,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=G4(e.fields,e.as||[]),o=r?(a,u)=>function(e,t,n,r){for(let i=0,o=n.length;i<o;++i)t[r[i]]=n[i](e);return t}(a,u,r,i):v1;let s;return this.value?s=this.value:(t=t.addAll(),s=this.value={}),t.visit(t.REM,a=>{const u=oe(a);n.rem.push(s[u]),s[u]=null}),t.visit(t.ADD,a=>{const u=o(a,it({}));s[oe(a)]=u,n.add.push(u)}),t.visit(t.MOD,a=>{n.mod.push(o(a,s[oe(a)]))}),n}}),z(iz,k,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}}),CO.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]},z(CO,k,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const o=cO(t.materialize(t.SOURCE).source,e.groupby,e.field),s=(e.groupby||[]).map(Bt),a=[],u=e.step||.01,l=e.probs||Ci(u/2,1-1e-14,u),c=l.length;return o.forEach(f=>{const d=BA(f,l);for(let h=0;h<c;++h){const p={};for(let g=0;g<s.length;++g)p[s[g]]=f.dims[g];p[r[0]]=l[h],p[r[1]]=d[h],a.push(it(p))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=a,n}}),z(oz,k,{transform(e,t){let n,r;return this.value?r=this.value:(n=t=t.addAll(),r=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,i=>{const o=oe(i);n.rem.push(r[o]),r[o]=null}),t.visit(t.ADD,i=>{const o=TA(i);r[oe(i)]=o,n.add.push(o)}),t.visit(t.MOD,i=>{const o=r[oe(i)];for(const s in i)o[s]=i[s],n.modifies(s);n.mod.push(o)})),n}}),SO.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},z(SO,k,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.modified("size"),i=e.size,o=this.value.reduce((c,f)=>(c[oe(f)]=1,c),{});let s=this.value,a=this.count,u=0;function l(c){let f,d;s.length<i?s.push(c):(d=~~((a+1)*Ki()),d<s.length&&d>=u&&(f=s[d],o[oe(f)]&&n.rem.push(f),s[d]=c)),++a}if(t.rem.length&&(t.visit(t.REM,c=>{const f=oe(c);o[f]&&(o[f]=-1,n.rem.push(c)),--a}),s=s.filter(c=>-1!==o[oe(c)])),(t.rem.length||r)&&s.length<i&&t.source&&(u=a=s.length,t.visit(t.SOURCE,c=>{o[oe(c)]||l(c)}),u=-1),r&&s.length>i){const c=s.length-i;for(let f=0;f<c;++f)o[oe(s[f])]=-1,n.rem.push(s[f]);s=s.slice(c)}return t.mod.length&&t.visit(t.MOD,c=>{o[oe(c)]&&n.mod.push(c)}),t.add.length&&t.visit(t.ADD,l),(t.add.length||u<0)&&(n.add=s.filter(c=>!o[oe(c)])),this.count=a,this.value=n.source=s,n}}),AO.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},z(AO,k,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),r=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=Ci(e.start,e.stop,e.step||1).map(i=>{const o={};return o[r]=i,it(o)}),n.add=t.add.concat(this.value),n}}),z(sz,k,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});const az=["unit0","unit1"];function uz(e){k.call(this,kd(),e)}function lz(e){k.call(this,null,e)}OO.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:iA,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:az}]},z(OO,k,{transform(e,t){const n=e.field,r=!1!==e.interval,i="utc"===e.timezone,o=this._floor(e,t),s=(i?Ud:zd)(o.unit).offset,a=e.as||az,u=a[0],l=a[1],c=o.step;let f=o.start||1/0,d=o.stop||-1/0,h=t.ADD;return(e.modified()||t.modified(Jn(n)))&&(h=(t=t.reflow(!0)).SOURCE,f=1/0,d=-1/0),t.visit(h,p=>{const g=n(p);let m,v;null==g?(p[u]=null,r&&(p[l]=null)):(p[u]=m=v=o(g),r&&(p[l]=v=s(m,c)),m<f&&(f=m),v>d&&(d=v))}),o.start=f,o.stop=d,t.modifies(r?a:u)},_floor(e,t){const n="utc"===e.timezone,{units:r,step:i}=e.units?{units:e.units,step:e.step||1}:DB({extent:e.extent||Cs(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),o=sA(r),s=this.value||{},a=(n?hB:dB)(o,i);return a.unit=je(o),a.units=o,a.step=i,a.start=s.start,a.stop=s.stop,this.value=a}}),z(uz,k,{transform(e,t){const n=t.dataflow,r=e.field,i=this.value,o=a=>i.set(r(a),a);let s=!0;return e.modified("field")||t.modified(r.fields)?(i.clear(),t.visit(t.SOURCE,o)):t.changed()?(t.visit(t.REM,a=>i.delete(r(a))),t.visit(t.ADD,o)):s=!1,this.modified(s),i.empty>n.cleanThreshold&&n.runAfter(i.clean),t.fork()}}),z(lz,k,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(mc(e.sort)):t.source).map(e.field))}});const Gg={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?++e:e}}},percent_rank:function(){const e=Gg.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,r=t.compare;let i=t.index;if(e<i){for(;i+1<n.length&&!r(n[i],n[i+1]);)++i;e=i}return(1+e)/n.length}}},ntile:function(e,t){(t=+t)>0||F("ntile num must be greater than zero.");const n=Gg.cume_dist(),r=n.next;return{init:n.init,next:i=>Math.ceil(t*r(i))}},lag:function(e,t){return t=+t||1,{next:n=>{const r=n.index-t;return r>=0?e(n.data[r]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const r=n.index+t,i=n.data;return r<i.length?e(i[r]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return(t=+t)>0||F("nth_value nth must be greater than zero."),{next:n=>{const r=n.i0+(t-1);return r<n.i1?e(n.data[r]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const r=e(n.data[n.index]);return null!=r?t=r:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:r=>{const i=r.data;return r.index<=n?t:(n=function(e,t,n){for(let r=t.length;n<r;++n)if(null!=e(t[n]))return n;return-1}(e,i,r.index))<0?(n=i.length,t=null):t=e(i[n])}}}},E0e=Object.keys(Gg);function cz(e){const t=X(e.ops),n=X(e.fields),r=X(e.params),i=X(e.as),o=this.outputs=[],s=this.windows=[],a={},u={},l=[],c=[];let f=!0;function d(h){X(Jn(h)).forEach(p=>a[p]=1)}d(e.sort),t.forEach((h,p)=>{const g=n[p],m=Bt(g),v=L4(h,m,i[p]);if(d(g),o.push(v),ne(Gg,h))s.push(function(e,t,n,r){const i=Gg[e](t,n);return{init:i.init||Mu,update:function(o,s){s[r]=i.next(o)}}}(h,n[p],r[p],v));else{if(null==g&&"count"!==h&&F("Null aggregate field specified."),"count"===h)return void l.push(v);f=!1;let y=u[m];y||(y=u[m]=[],y.field=g,c.push(y)),y.push(j4(h,v))}}),(l.length||c.length)&&(this.cell=function(e,t,n){e=e.map(u=>B4(u,u.field));const r={num:0,agg:null,store:!1,count:t};if(!n)for(var i=e.length,o=r.agg=Array(i),s=0;s<i;++s)o[s]=new e[s](r);if(r.store)var a=r.data=new iO;return r.add=function(u){if(r.num+=1,!n){a&&a.add(u);for(let l=0;l<i;++l)o[l].add(o[l].get(u),u)}},r.rem=function(u){if(r.num-=1,!n){a&&a.rem(u);for(let l=0;l<i;++l)o[l].rem(o[l].get(u),u)}},r.set=function(u){let l,c;for(a&&a.values(),l=0,c=t.length;l<c;++l)u[t[l]]=r.num;if(!n)for(l=0,c=o.length;l<c;++l)o[l].set(u)},r.init=function(){r.num=0,a&&a.reset();for(let u=0;u<i;++u)o[u].init()},r}(c,l,f)),this.inputs=Object.keys(a)}const fz=cz.prototype;function MO(e){k.call(this,{},e),this._mlen=0,this._mods=[]}function C0e(e,t,n,r){const i=r.sort,o=i&&!r.ignorePeers,s=r.frame||[null,0],a=e.data(n),u=a.length,l=o?Sg(i):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:a,compare:i||nr(-1)};t.init();for(let f=0;f<u;++f)S0e(c,s,f,u),o&&A0e(c,l),t.update(c,a[f])}function S0e(e,t,n,r){e.p0=e.i0,e.p1=e.i1,e.i0=null==t[0]?0:Math.max(0,n-Math.abs(t[0])),e.i1=null==t[1]?r:Math.min(r,n+Math.abs(t[1])+1),e.index=n}function A0e(e,t){const n=e.i0,r=e.i1-1,i=e.compare,o=e.data,s=o.length-1;n>0&&!i(o[n],o[n-1])&&(e.i0=t.left(o,o[n])),r<s&&!i(o[r],o[r+1])&&(e.i1=t.right(o,o[r]))}function k1(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function I1(e){this._context=e}function Vu(){}function dz(e){this._context=e}function hz(e){this._context=e}function pz(e,t){this._basis=new I1(e),this._beta=t}fz.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()},fz.update=function(e,t){const n=this.cell,r=this.windows,i=e.data,o=r&&r.length;let s;if(n){for(s=e.p0;s<e.i0;++s)n.rem(i[s]);for(s=e.p1;s<e.i1;++s)n.add(i[s]);n.set(t)}for(s=0;s<o;++s)r[s].update(e,t)},MO.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:E0e.concat(Wg)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]},z(MO,k,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),r=mc(e.sort),i=nO(e.groupby),o=a=>this.group(i(a));let s=this.state;(!s||n)&&(s=this.state=new cz(e)),n||t.modified(s.inputs)?(this.value={},t.visit(t.SOURCE,a=>o(a).add(a))):(t.visit(t.REM,a=>o(a).remove(a)),t.visit(t.ADD,a=>o(a).add(a)));for(let a=0,u=this._mlen;a<u;++a)C0e(this._mods[a],s,r,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(s.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=z4(oe),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}}),I1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:k1(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:k1(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},dz.prototype={areaStart:Vu,areaEnd:Vu,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:k1(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},hz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:k1(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},pz.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var u,r=e[0],i=t[0],o=e[n]-r,s=t[n]-i,a=-1;++a<=n;)this._basis.point(this._beta*e[a]+(1-this._beta)*(r+(u=a/n)*o),this._beta*t[a]+(1-this._beta)*(i+u*s));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const k0e=function e(t){function n(r){return 1===t?new I1(r):new pz(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function F1(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function TO(e,t){this._context=e,this._k=(1-t)/6}TO.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:F1(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:F1(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const I0e=function e(t){function n(r){return new TO(r,t)}return n.tension=function(r){return e(+r)},n}(0);function kO(e,t){this._context=e,this._k=(1-t)/6}kO.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:F1(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const F0e=function e(t){function n(r){return new kO(r,t)}return n.tension=function(r){return e(+r)},n}(0);function IO(e,t){this._context=e,this._k=(1-t)/6}IO.prototype={areaStart:Vu,areaEnd:Vu,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:F1(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const R0e=function e(t){function n(r){return new IO(r,t)}return n.tension=function(r){return e(+r)},n}(0);var gz=Math.abs,or=Math.atan2,bc=Math.cos,N0e=Math.max,FO=Math.min,Os=Math.sin,Yd=Math.sqrt,sr=1e-12,qu=Math.PI,R1=qu/2,Yg=2*qu;function P0e(e){return e>1?0:e<-1?qu:Math.acos(e)}function mz(e){return e>=1?R1:e<=-1?-R1:Math.asin(e)}function RO(e,t,n){var r=e._x1,i=e._y1,o=e._x2,s=e._y2;if(e._l01_a>sr){var a=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,u=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*a-e._x0*e._l12_2a+e._x2*e._l01_2a)/u,i=(i*a-e._y0*e._l12_2a+e._y2*e._l01_2a)/u}if(e._l23_a>sr){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);o=(o*l+e._x1*e._l23_2a-t*e._l12_2a)/c,s=(s*l+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,o,s,e._x2,e._y2)}function yz(e,t){this._context=e,this._alpha=t}yz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:RO(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const L0e=function e(t){function n(r){return t?new yz(r,t):new TO(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function vz(e,t){this._context=e,this._alpha=t}vz.prototype={areaStart:Vu,areaEnd:Vu,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:RO(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const j0e=function e(t){function n(r){return t?new vz(r,t):new IO(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function bz(e,t){this._context=e,this._alpha=t}bz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:RO(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const $0e=function e(t){function n(r){return t?new bz(r,t):new kO(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function _z(e){this._context=e}function NO(e){return new _z(e)}function wz(e){this._context=e}function xz(e){return e<0?-1:1}function Ez(e,t,n){var r=e._x1-e._x0,i=t-e._x1,o=(e._y1-e._y0)/(r||i<0&&-0),s=(n-e._y1)/(i||r<0&&-0),a=(o*i+s*r)/(r+i);return(xz(o)+xz(s))*Math.min(Math.abs(o),Math.abs(s),.5*Math.abs(a))||0}function Dz(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function PO(e,t,n){var r=e._x0,o=e._x1,s=e._y1,a=(o-r)/3;e._context.bezierCurveTo(r+a,e._y0+a*t,o-a,s-a*n,o,s)}function N1(e){this._context=e}function Cz(e){this._context=new Sz(e)}function Sz(e){this._context=e}function Az(e){this._context=e}function Oz(e){var t,r,n=e.length-1,i=new Array(n),o=new Array(n),s=new Array(n);for(i[0]=0,o[0]=2,s[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,o[t]=4,s[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,o[n-1]=7,s[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)o[t]-=r=i[t]/o[t-1],s[t]-=r*s[t-1];for(i[n-1]=s[n-1]/o[n-1],t=n-2;t>=0;--t)i[t]=(s[t]-i[t+1])/o[t];for(o[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)o[t]=2*e[t+1]-i[t+1];return[i,o]}function P1(e,t){this._context=e,this._t=t}_z.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}},wz.prototype={areaStart:Vu,areaEnd:Vu,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},N1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:PO(this,this._t0,Dz(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,PO(this,Dz(this,n=Ez(this,e,t)),n);break;default:PO(this,this._t0,n=Ez(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(Cz.prototype=Object.create(N1.prototype)).point=function(e,t){N1.prototype.point.call(this,t,e)},Sz.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,o){this._context.bezierCurveTo(t,e,r,n,o,i)}},Az.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var r=Oz(e),i=Oz(t),o=0,s=1;s<n;++o,++s)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],e[s],t[s]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},P1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};const LO=Math.PI,jO=2*LO,_c=1e-6,G0e=jO-_c;function $O(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Mz(){return new $O}$O.prototype=Mz.prototype={constructor:$O,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,i,o){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(e,t,n,r,i){var o=this._x1,s=this._y1,a=(n=+n)-(e=+e),u=(r=+r)-(t=+t),l=o-e,c=s-t,f=l*l+c*c;if((i=+i)<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>_c)if(Math.abs(c*a-u*l)>_c&&i){var d=n-o,h=r-s,p=a*a+u*u,g=d*d+h*h,m=Math.sqrt(p),v=Math.sqrt(f),y=i*Math.tan((LO-Math.acos((p+f-g)/(2*m*v)))/2),b=y/v,_=y/m;Math.abs(b-1)>_c&&(this._+="L"+(e+b*l)+","+(t+b*c)),this._+="A"+i+","+i+",0,0,"+ +(c*d>l*h)+","+(this._x1=e+_*a)+","+(this._y1=t+_*u)}else this._+="L"+(this._x1=e)+","+(this._y1=t)},arc:function(e,t,n,r,i,o){e=+e,t=+t,o=!!o;var s=(n=+n)*Math.cos(r),a=n*Math.sin(r),u=e+s,l=t+a,c=1^o,f=o?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+u+","+l:(Math.abs(this._x1-u)>_c||Math.abs(this._y1-l)>_c)&&(this._+="L"+u+","+l),n&&(f<0&&(f=f%jO+jO),f>G0e?this._+="A"+n+","+n+",0,1,"+c+","+(e-s)+","+(t-a)+"A"+n+","+n+",0,1,"+c+","+(this._x1=u)+","+(this._y1=l):f>_c&&(this._+="A"+n+","+n+",0,"+ +(f>=LO)+","+c+","+(this._x1=e+n*Math.cos(i))+","+(this._y1=t+n*Math.sin(i))))},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};const Xd=Mz;function ot(e){return function(){return e}}function Y0e(e){return e.innerRadius}function X0e(e){return e.outerRadius}function Q0e(e){return e.startAngle}function K0e(e){return e.endAngle}function Z0e(e){return e&&e.padAngle}function J0e(e,t,n,r,i,o,s,a){var u=n-e,l=r-t,c=s-i,f=a-o,d=f*u-c*l;if(!(d*d<sr))return[e+(d=(c*(t-o)-f*(e-i))/d)*u,t+d*l]}function L1(e,t,n,r,i,o,s){var a=e-n,u=t-r,l=(s?o:-o)/Yd(a*a+u*u),c=l*u,f=-l*a,d=e+c,h=t+f,p=n+c,g=r+f,m=(d+p)/2,v=(h+g)/2,y=p-d,b=g-h,_=y*y+b*b,w=i-o,E=d*g-p*h,x=(b<0?-1:1)*Yd(N0e(0,w*w*_-E*E)),D=(E*b-y*x)/_,S=(-E*y-b*x)/_,C=(E*b+y*x)/_,A=(-E*y+b*x)/_,M=D-m,T=S-v,L=C-m,O=A-v;return M*M+T*T>L*L+O*O&&(D=C,S=A),{cx:D,cy:S,x01:-c,y01:-f,x11:D*(i/w-1),y11:S*(i/w-1)}}function Tz(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function kz(e){return e[0]}function Iz(e){return e[1]}function Fz(e,t){var n=ot(!0),r=null,i=NO,o=null;function s(a){var u,c,d,l=(a=Tz(a)).length,f=!1;for(null==r&&(o=i(d=Xd())),u=0;u<=l;++u)!(u<l&&n(c=a[u],u,a))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+e(c,u,a),+t(c,u,a));if(d)return o=null,d+""||null}return e="function"==typeof e?e:void 0===e?kz:ot(e),t="function"==typeof t?t:void 0===t?Iz:ot(t),s.x=function(a){return arguments.length?(e="function"==typeof a?a:ot(+a),s):e},s.y=function(a){return arguments.length?(t="function"==typeof a?a:ot(+a),s):t},s.defined=function(a){return arguments.length?(n="function"==typeof a?a:ot(!!a),s):n},s.curve=function(a){return arguments.length?(i=a,null!=r&&(o=i(r)),s):i},s.context=function(a){return arguments.length?(null==a?r=o=null:o=i(r=a),s):r},s}function Rz(e,t,n){var r=null,i=ot(!0),o=null,s=NO,a=null;function u(c){var f,d,h,g,v,p=(c=Tz(c)).length,m=!1,y=new Array(p),b=new Array(p);for(null==o&&(a=s(v=Xd())),f=0;f<=p;++f){if(!(f<p&&i(g=c[f],f,c))===m)if(m=!m)d=f,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),h=f-1;h>=d;--h)a.point(y[h],b[h]);a.lineEnd(),a.areaEnd()}m&&(y[f]=+e(g,f,c),b[f]=+t(g,f,c),a.point(r?+r(g,f,c):y[f],n?+n(g,f,c):b[f]))}if(v)return a=null,v+""||null}function l(){return Fz().defined(i).curve(s).context(o)}return e="function"==typeof e?e:void 0===e?kz:ot(+e),t="function"==typeof t?t:ot(void 0===t?0:+t),n="function"==typeof n?n:void 0===n?Iz:ot(+n),u.x=function(c){return arguments.length?(e="function"==typeof c?c:ot(+c),r=null,u):e},u.x0=function(c){return arguments.length?(e="function"==typeof c?c:ot(+c),u):e},u.x1=function(c){return arguments.length?(r=null==c?null:"function"==typeof c?c:ot(+c),u):r},u.y=function(c){return arguments.length?(t="function"==typeof c?c:ot(+c),n=null,u):t},u.y0=function(c){return arguments.length?(t="function"==typeof c?c:ot(+c),u):t},u.y1=function(c){return arguments.length?(n=null==c?null:"function"==typeof c?c:ot(+c),u):n},u.lineX0=u.lineY0=function(){return l().x(e).y(t)},u.lineY1=function(){return l().x(e).y(n)},u.lineX1=function(){return l().x(r).y(t)},u.defined=function(c){return arguments.length?(i="function"==typeof c?c:ot(!!c),u):i},u.curve=function(c){return arguments.length?(s=c,null!=o&&(a=s(o)),u):s},u.context=function(c){return arguments.length?(null==c?o=a=null:a=s(o=c),u):o},u}const Nz={draw:function(e,t){var n=Math.sqrt(t/qu);e.moveTo(n,0),e.arc(0,0,n,0,Yg)}};Math.sqrt(1/3);Math.sin(qu/10),Math.sin(7*qu/10);function Qd(e,t){if("undefined"!=typeof document&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}Math.sin(Yg/10),Math.cos(Yg/10),Math.sqrt(3),Math.sqrt(3),Math.sqrt(12);const jz=Sg($d),j1=jz.right,hye=jz.left,Xg=(Sg(b4),j1);function Ms(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function Wu(e,t){switch(arguments.length){case 0:break;case 1:"function"==typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"==typeof t?this.interpolator(t):this.range(t)}return this}const UO=Symbol("implicit");function HO(){var e=new Map,t=[],n=[],r=UO;function i(o){var s=o+"",a=e.get(s);if(!a){if(r!==UO)return r;e.set(s,a=t.push(o))}return n[(a-1)%n.length]}return i.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new Map;for(const s of o){const a=s+"";e.has(a)||e.set(a,t.push(s))}return i},i.range=function(o){return arguments.length?(n=Array.from(o),i):n.slice()},i.unknown=function(o){return arguments.length?(r=o,i):r},i.copy=function(){return HO(t,n).unknown(r)},Ms.apply(i,arguments),i}function $z(e,t,n,r){var o,i=Ru(e,t,n);switch((r=Fd(null==r?",f":r)).type){case"s":var s=Math.max(Math.abs(e),Math.abs(t));return null==r.precision&&!isNaN(o=j6(i,s))&&(r.precision=o),WS(r,s);case"":case"e":case"g":case"p":case"r":null==r.precision&&!isNaN(o=$6(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=o-("e"===r.type));break;case"f":case"%":null==r.precision&&!isNaN(o=B6(i))&&(r.precision=o-2*("%"===r.type))}return i1(r)}function Kd(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Qg(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Gu(){}var Zd=1/.7,Jd="\\s*([+-]?\\d+)\\s*",Kg="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ts="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",pye=/^#([0-9a-f]{3,8})$/,gye=new RegExp("^rgb\\("+[Jd,Jd,Jd]+"\\)$"),mye=new RegExp("^rgb\\("+[Ts,Ts,Ts]+"\\)$"),yye=new RegExp("^rgba\\("+[Jd,Jd,Jd,Kg]+"\\)$"),vye=new RegExp("^rgba\\("+[Ts,Ts,Ts,Kg]+"\\)$"),bye=new RegExp("^hsl\\("+[Kg,Ts,Ts]+"\\)$"),_ye=new RegExp("^hsla\\("+[Kg,Ts,Ts,Kg]+"\\)$"),Bz={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function zz(){return this.rgb().formatHex()}function Uz(){return this.rgb().formatRgb()}function Zg(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=pye.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?Hz(t):3===n?new $n(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?$1(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?$1(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=gye.exec(e))?new $n(t[1],t[2],t[3],1):(t=mye.exec(e))?new $n(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=yye.exec(e))?$1(t[1],t[2],t[3],t[4]):(t=vye.exec(e))?$1(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=bye.exec(e))?Wz(t[1],t[2]/100,t[3]/100,1):(t=_ye.exec(e))?Wz(t[1],t[2]/100,t[3]/100,t[4]):Bz.hasOwnProperty(e)?Hz(Bz[e]):"transparent"===e?new $n(NaN,NaN,NaN,0):null}function Hz(e){return new $n(e>>16&255,e>>8&255,255&e,1)}function $1(e,t,n,r){return r<=0&&(e=t=n=NaN),new $n(e,t,n,r)}function VO(e){return e instanceof Gu||(e=Zg(e)),e?new $n((e=e.rgb()).r,e.g,e.b,e.opacity):new $n}function Yu(e,t,n,r){return 1===arguments.length?VO(e):new $n(e,t,n,null==r?1:r)}function $n(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function Vz(){return"#"+qO(this.r)+qO(this.g)+qO(this.b)}function qz(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function qO(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function Wz(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new ks(e,t,n,r)}function Gz(e){if(e instanceof ks)return new ks(e.h,e.s,e.l,e.opacity);if(e instanceof Gu||(e=Zg(e)),!e)return new ks;if(e instanceof ks)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),s=NaN,a=o-i,u=(o+i)/2;return a?(s=t===o?(n-r)/a+6*(n<r):n===o?(r-t)/a+2:(t-n)/a+4,a/=u<.5?o+i:2-o-i,s*=60):a=u>0&&u<1?0:s,new ks(s,a,u,e.opacity)}function B1(e,t,n,r){return 1===arguments.length?Gz(e):new ks(e,t,n,null==r?1:r)}function ks(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function WO(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function Yz(e,t,n,r,i){var o=e*e,s=o*e;return((1-3*e+3*o-s)*t+(4-6*o+3*s)*n+(1+3*e+3*o-3*s)*r+s*i)/6}function Xz(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1];return Yz((n-r/t)*t,r>0?e[r-1]:2*i-o,i,o,r<t-1?e[r+2]:2*o-i)}}function Qz(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t);return Yz((n-r/t)*t,e[(r+t-1)%t],e[r%t],e[(r+1)%t],e[(r+2)%t])}}Kd(Gu,Zg,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:zz,formatHex:zz,formatHsl:function(){return Gz(this).formatHsl()},formatRgb:Uz,toString:Uz}),Kd($n,Yu,Qg(Gu,{brighter:function(e){return e=null==e?Zd:Math.pow(Zd,e),new $n(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new $n(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Vz,formatHex:Vz,formatRgb:qz,toString:qz})),Kd(ks,B1,Qg(Gu,{brighter:function(e){return e=null==e?Zd:Math.pow(Zd,e),new ks(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new ks(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new $n(WO(e>=240?e-240:e+120,i,r),WO(e,i,r),WO(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));const z1=e=>()=>e;function Kz(e,t){return function(n){return e+n*t}}function U1(e,t){var n=t-e;return n?Kz(e,n>180||n<-180?n-360*Math.round(n/360):n):z1(isNaN(e)?t:e)}function Dn(e,t){var n=t-e;return n?Kz(e,n):z1(isNaN(e)?t:e)}const GO=function e(t){var n=function(e){return 1==(e=+e)?Dn:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):z1(isNaN(t)?n:t)}}(t);function r(i,o){var s=n((i=Yu(i)).r,(o=Yu(o)).r),a=n(i.g,o.g),u=n(i.b,o.b),l=Dn(i.opacity,o.opacity);return function(c){return i.r=s(c),i.g=a(c),i.b=u(c),i.opacity=l(c),i+""}}return r.gamma=e,r}(1);function Zz(e){return function(t){var s,a,n=t.length,r=new Array(n),i=new Array(n),o=new Array(n);for(s=0;s<n;++s)a=Yu(t[s]),r[s]=a.r||0,i[s]=a.g||0,o[s]=a.b||0;return r=e(r),i=e(i),o=e(o),a.opacity=1,function(u){return a.r=r(u),a.g=i(u),a.b=o(u),a+""}}}var Dye=Zz(Xz),Cye=Zz(Qz);function YO(e,t){t||(t=[]);var i,n=e?Math.min(t.length,e.length):0,r=t.slice();return function(o){for(i=0;i<n;++i)r[i]=e[i]*(1-o)+t[i]*o;return r}}function Jz(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Sye(e,t){return(Jz(t)?YO:eU)(e,t)}function eU(e,t){var s,n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),o=new Array(n);for(s=0;s<r;++s)i[s]=Xu(e[s],t[s]);for(;s<n;++s)o[s]=t[s];return function(a){for(s=0;s<r;++s)o[s]=i[s](a);return o}}function tU(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Io(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function nU(e,t){var i,n={},r={};for(i in(null===e||"object"!=typeof e)&&(e={}),(null===t||"object"!=typeof t)&&(t={}),t)i in e?n[i]=Xu(e[i],t[i]):r[i]=t[i];return function(o){for(i in n)r[i]=n[i](o);return r}}var XO=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,QO=new RegExp(XO.source,"g");function rU(e,t){var r,i,o,n=XO.lastIndex=QO.lastIndex=0,s=-1,a=[],u=[];for(e+="",t+="";(r=XO.exec(e))&&(i=QO.exec(t));)(o=i.index)>n&&(o=t.slice(n,o),a[s]?a[s]+=o:a[++s]=o),(r=r[0])===(i=i[0])?a[s]?a[s]+=i:a[++s]=i:(a[++s]=null,u.push({i:s,x:Io(r,i)})),n=QO.lastIndex;return n<t.length&&(o=t.slice(n),a[s]?a[s]+=o:a[++s]=o),a.length<2?u[0]?function(e){return function(t){return e(t)+""}}(u[0].x):function(e){return function(){return e}}(t):(t=u.length,function(l){for(var f,c=0;c<t;++c)a[(f=u[c]).i]=f.x(l);return a.join("")})}function Xu(e,t){var r,n=typeof t;return null==t||"boolean"===n?z1(t):("number"===n?Io:"string"===n?(r=Zg(t))?(t=r,GO):rU:t instanceof Zg?GO:t instanceof Date?tU:Jz(t)?YO:Array.isArray(t)?eU:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?nU:Io)(e,t)}function Jg(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function KO(e){return+e}var iU=[0,1];function Xr(e){return e}function ZO(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:function(e){return function(){return e}}(isNaN(t)?NaN:.5)}function kye(e,t,n){var r=e[0],i=e[1],o=t[0],s=t[1];return i<r?(r=ZO(i,r),o=n(s,o)):(r=ZO(r,i),o=n(o,s)),function(a){return o(r(a))}}function Iye(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),o=new Array(r),s=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<r;)i[s]=ZO(e[s],e[s+1]),o[s]=n(t[s],t[s+1]);return function(a){var u=Xg(e,a,1,r)-1;return o[u](i[u](a))}}function em(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function H1(){var r,i,o,a,u,l,e=iU,t=iU,n=Xu,s=Xr;function c(){var d=Math.min(e.length,t.length);return s!==Xr&&(s=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}(e[0],e[d-1])),a=d>2?Iye:kye,u=l=null,f}function f(d){return null==d||isNaN(d=+d)?o:(u||(u=a(e.map(r),t,n)))(r(s(d)))}return f.invert=function(d){return s(i((l||(l=a(t,e.map(r),Io)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,KO),c()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),c()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),n=Jg,c()},f.clamp=function(d){return arguments.length?(s=!!d||Xr,c()):s!==Xr},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(o=d,f):o},function(d,h){return r=d,i=h,c()}}function oU(){return H1()(Xr,Xr)}function xc(e){var t=e.domain;return e.ticks=function(n){var r=t();return VS(r[0],r[r.length-1],null==n?10:n)},e.tickFormat=function(n,r){var i=t();return $z(i[0],i[i.length-1],null==n?10:n,r)},e.nice=function(n){null==n&&(n=10);var u,l,r=t(),i=0,o=r.length-1,s=r[i],a=r[o],c=10;for(a<s&&(l=s,s=a,a=l,l=i,i=o,o=l);c-- >0;){if((l=L6(s,a,n))===u)return r[i]=s,r[o]=a,t(r);if(l>0)s=Math.floor(s/l)*l,a=Math.ceil(a/l)*l;else{if(!(l<0))break;s=Math.ceil(s*l)/l,a=Math.floor(a*l)/l}u=l}return e},e}function uU(e,t){var s,n=0,r=(e=e.slice()).length-1,i=e[n],o=e[r];return o<i&&(s=n,n=r,r=s,s=i,i=o,o=s),e[n]=t.floor(i),e[r]=t.ceil(o),e}function lU(e){return Math.log(e)}function cU(e){return Math.exp(e)}function Fye(e){return-Math.log(-e)}function Rye(e){return-Math.exp(-e)}function Nye(e){return isFinite(e)?+("1e"+e):e<0?0:e}function fU(e){return function(t){return-e(-t)}}function JO(e){var i,o,t=e(lU,cU),n=t.domain,r=10;function s(){return i=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}(r),o=function(e){return 10===e?Nye:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}(r),n()[0]<0?(i=fU(i),o=fU(o),e(Fye,Rye)):e(lU,cU),t}return t.base=function(a){return arguments.length?(r=+a,s()):r},t.domain=function(a){return arguments.length?(n(a),s()):n()},t.ticks=function(a){var f,u=n(),l=u[0],c=u[u.length-1];(f=c<l)&&(d=l,l=c,c=d);var p,g,m,d=i(l),h=i(c),v=null==a?10:+a,y=[];if(!(r%1)&&h-d<v){if(d=Math.floor(d),h=Math.ceil(h),l>0){for(;d<=h;++d)for(g=1,p=o(d);g<r;++g)if(!((m=p*g)<l)){if(m>c)break;y.push(m)}}else for(;d<=h;++d)for(g=r-1,p=o(d);g>=1;--g)if(!((m=p*g)<l)){if(m>c)break;y.push(m)}2*y.length<v&&(y=VS(l,c,v))}else y=VS(d,h,Math.min(h-d,v)).map(o);return f?y.reverse():y},t.tickFormat=function(a,u){if(null==u&&(u=10===r?".0e":","),"function"!=typeof u&&(u=i1(u)),a===1/0)return u;null==a&&(a=10);var l=Math.max(1,r*a/t.ticks().length);return function(c){var f=c/o(Math.round(i(c)));return f*r<r-.5&&(f*=r),f<=l?u(c):""}},t.nice=function(){return n(uU(n(),{floor:function(a){return o(Math.floor(i(a)))},ceil:function(a){return o(Math.ceil(i(a)))}}))},t}function hU(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function jye(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function $ye(e){return e<0?-e*e:e*e}function e2(e){var t=e(Xr,Xr),n=1;function r(){return 1===n?e(Xr,Xr):.5===n?e(jye,$ye):e(hU(n),hU(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},xc(t)}function t2(){var e=e2(H1());return e.copy=function(){return em(e,t2()).exponent(e.exponent())},Ms.apply(e,arguments),e}function pU(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function gU(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function n2(e){var t=1,n=e(pU(t),gU(t));return n.constant=function(r){return arguments.length?e(pU(t=+r),gU(t)):t},xc(n)}function yU(e,t,n,r,i,o){const s=[[ju,1,Na],[ju,5,5e3],[ju,15,15e3],[ju,30,3e4],[o,1,Xi],[o,5,5*Xi],[o,15,15*Xi],[o,30,30*Xi],[i,1,Pa],[i,3,3*Pa],[i,6,6*Pa],[i,12,12*Pa],[r,1,dc],[r,2,2*dc],[n,1,XS],[t,1,Y6],[t,3,3*Y6],[e,1,QS]];function u(l,c,f){const d=Math.abs(c-l)/f,h=Sg(([,,m])=>m).right(s,d);if(h===s.length)return e.every(Ru(l/QS,c/QS,f));if(0===h)return eA.every(Math.max(Ru(l,c,f),1));const[p,g]=s[d/s[h-1][2]<s[h][2]/d?h-1:h];return p.every(g)}return[function(l,c,f){const d=c<l;d&&([l,c]=[c,l]);const h=f&&"function"==typeof f.range?f:u(l,c,f),p=h?h.range(l,+c+1):[];return d?p.reverse():p},u]}const[zye,Uye]=yU($u,l1,Ld,Pu,nA,rA),[Hye,Vye]=yU(Lu,a1,Nd,Nu,ZS,JS);function qye(e){return new Date(e)}function Wye(e){return e instanceof Date?+e:+new Date(+e)}function r2(e,t,n,r,i,o,s,a,u,l){var c=oU(),f=c.invert,d=c.domain,h=l(".%L"),p=l(":%S"),g=l("%I:%M"),m=l("%I %p"),v=l("%a %d"),y=l("%b %d"),b=l("%B"),_=l("%Y");function w(E){return(u(E)<E?h:a(E)<E?p:s(E)<E?g:o(E)<E?m:r(E)<E?i(E)<E?v:y:n(E)<E?b:_)(E)}return c.invert=function(E){return new Date(f(E))},c.domain=function(E){return arguments.length?d(Array.from(E,Wye)):d().map(qye)},c.ticks=function(E){var x=d();return e(x[0],x[x.length-1],null==E?10:E)},c.tickFormat=function(E,x){return null==x?w:l(x)},c.nice=function(E){var x=d();return(!E||"function"!=typeof E.range)&&(E=t(x[0],x[x.length-1],null==E?10:E)),E?d(uU(x,E)):c},c.copy=function(){return em(c,r2(e,t,n,r,i,o,s,a,u,l))},c}function V1(){var n,r,i,o,u,e=0,t=1,s=Xr,a=!1;function l(f){return null==f||isNaN(f=+f)?u:s(0===i?.5:(f=(o(f)-n)*i,a?Math.max(0,Math.min(1,f)):f))}function c(f){return function(d){var h,p;return arguments.length?([h,p]=d,s=f(h,p),l):[s(0),s(1)]}}return l.domain=function(f){return arguments.length?([e,t]=f,n=o(e=+e),r=o(t=+t),i=n===r?0:1/(r-n),l):[e,t]},l.clamp=function(f){return arguments.length?(a=!!f,l):a},l.interpolator=function(f){return arguments.length?(s=f,l):s},l.range=c(Xu),l.rangeRound=c(Jg),l.unknown=function(f){return arguments.length?(u=f,l):u},function(f){return o=f,n=f(e),r=f(t),i=n===r?0:1/(r-n),l}}function Qu(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function i2(){var e=xc(V1()(Xr));return e.copy=function(){return Qu(e,i2())},Wu.apply(e,arguments)}function o2(){var e=e2(V1());return e.copy=function(){return Qu(e,o2()).exponent(e.exponent())},Wu.apply(e,arguments)}function s2(e,t){void 0===t&&(t=e,e=Xu);for(var n=0,r=t.length-1,i=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(i,i=t[++n]);return function(s){var a=Math.max(0,Math.min(r-1,Math.floor(s*=r)));return o[a](s-a)}}function q1(){var i,o,s,a,u,c,d,e=0,t=.5,n=1,r=1,l=Xr,f=!1;function h(g){return isNaN(g=+g)?d:(g=.5+((g=+c(g))-o)*(r*g<r*o?a:u),l(f?Math.max(0,Math.min(1,g)):g))}function p(g){return function(m){var v,y,b;return arguments.length?([v,y,b]=m,l=s2(g,[v,y,b]),h):[l(0),l(.5),l(1)]}}return h.domain=function(g){return arguments.length?([e,t,n]=g,i=c(e=+e),o=c(t=+t),s=c(n=+n),a=i===o?0:.5/(o-i),u=o===s?0:.5/(s-o),r=o<i?-1:1,h):[e,t,n]},h.clamp=function(g){return arguments.length?(f=!!g,h):f},h.interpolator=function(g){return arguments.length?(l=g,h):l},h.range=p(Xu),h.rangeRound=p(Jg),h.unknown=function(g){return arguments.length?(d=g,h):d},function(g){return c=g,i=g(e),o=g(t),s=g(n),a=i===o?0:.5/(o-i),u=o===s?0:.5/(s-o),r=o<i?-1:1,h}}function a2(){var e=e2(q1());return e.copy=function(){return Qu(e,a2()).exponent(e.exponent())},Wu.apply(e,arguments)}function Kye(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function Zye(e,t){var n=U1(+e,+t);return function(r){var i=n(r);return i-360*Math.floor(i/360)}}var W1,SU=180/Math.PI,u2={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function AU(e,t,n,r,i,o){var s,a,u;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,u/=a),e*r<t*n&&(e=-e,t=-t,u=-u,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*SU,skewX:Math.atan(u)*SU,scaleX:s,scaleY:a}}function OU(e,t,n,r){function i(l){return l.length?l.pop()+" ":""}return function(l,c){var f=[],d=[];return l=e(l),c=e(c),function(l,c,f,d,h,p){if(l!==f||c!==d){var g=h.push("translate(",null,t,null,n);p.push({i:g-4,x:Io(l,f)},{i:g-2,x:Io(c,d)})}else(f||d)&&h.push("translate("+f+t+d+n)}(l.translateX,l.translateY,c.translateX,c.translateY,f,d),function(l,c,f,d){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),d.push({i:f.push(i(f)+"rotate(",null,r)-2,x:Io(l,c)})):c&&f.push(i(f)+"rotate("+c+r)}(l.rotate,c.rotate,f,d),function(l,c,f,d){l!==c?d.push({i:f.push(i(f)+"skewX(",null,r)-2,x:Io(l,c)}):c&&f.push(i(f)+"skewX("+c+r)}(l.skewX,c.skewX,f,d),function(l,c,f,d,h,p){if(l!==f||c!==d){var g=h.push(i(h)+"scale(",null,",",null,")");p.push({i:g-4,x:Io(l,f)},{i:g-2,x:Io(c,d)})}else(1!==f||1!==d)&&h.push(i(h)+"scale("+f+","+d+")")}(l.scaleX,l.scaleY,c.scaleX,c.scaleY,f,d),l=c=null,function(h){for(var m,p=-1,g=d.length;++p<g;)f[(m=d[p]).i]=m.x(h);return f.join("")}}}var tve=OU(function(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?u2:AU(t.a,t.b,t.c,t.d,t.e,t.f)},"px, ","px)","deg)"),nve=OU(function(e){return null!=e&&(W1||(W1=document.createElementNS("http://www.w3.org/2000/svg","g")),W1.setAttribute("transform",e),e=W1.transform.baseVal.consolidate())?AU((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):u2},", ",")",")");function MU(e){return((e=Math.exp(e))+1/e)/2}const sve=function e(t,n,r){function i(o,s){var m,v,a=o[0],u=o[1],l=o[2],d=s[2],h=s[0]-a,p=s[1]-u,g=h*h+p*p;if(g<1e-12)v=Math.log(d/l)/t,m=function(x){return[a+x*h,u+x*p,l*Math.exp(t*x*v)]};else{var y=Math.sqrt(g),b=(d*d-l*l+r*g)/(2*l*n*y),_=(d*d-l*l-r*g)/(2*d*n*y),w=Math.log(Math.sqrt(b*b+1)-b),E=Math.log(Math.sqrt(_*_+1)-_);v=(E-w)/t,m=function(x){var D=x*v,S=MU(w),C=l/(n*y)*(S*function(e){return((e=Math.exp(2*e))-1)/(e+1)}(t*D+w)-function(e){return((e=Math.exp(e))-1/e)/2}(w));return[a+C*h,u+C*p,l*S/MU(t*D+w)]}}return m.duration=1e3*v*t/Math.SQRT2,m}return i.rho=function(o){var s=Math.max(.001,+o),a=s*s;return e(s,a,a*a)},i}(Math.SQRT2,2,4);function TU(e){return function(t,n){var r=e((t=B1(t)).h,(n=B1(n)).h),i=Dn(t.s,n.s),o=Dn(t.l,n.l),s=Dn(t.opacity,n.opacity);return function(a){return t.h=r(a),t.s=i(a),t.l=o(a),t.opacity=s(a),t+""}}}const ave=TU(U1);var uve=TU(Dn);const kU=Math.PI/180,IU=180/Math.PI,PU=4/29,eh=6/29,LU=3*eh*eh;function jU(e){if(e instanceof Fo)return new Fo(e.l,e.a,e.b,e.opacity);if(e instanceof Is)return BU(e);e instanceof $n||(e=VO(e));var o,s,t=d2(e.r),n=d2(e.g),r=d2(e.b),i=l2((.2225045*t+.7168786*n+.0606169*r)/1);return t===n&&n===r?o=s=i:(o=l2((.4360747*t+.3850649*n+.1430804*r)/.96422),s=l2((.0139322*t+.0971045*n+.7141733*r)/.82521)),new Fo(116*i-16,500*(o-i),200*(i-s),e.opacity)}function Y1(e,t,n,r){return 1===arguments.length?jU(e):new Fo(e,t,n,null==r?1:r)}function Fo(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}function l2(e){return e>.008856451679035631?Math.pow(e,1/3):e/LU+PU}function c2(e){return e>eh?e*e*e:LU*(e-PU)}function f2(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function d2(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function $U(e){if(e instanceof Is)return new Is(e.h,e.c,e.l,e.opacity);if(e instanceof Fo||(e=jU(e)),0===e.a&&0===e.b)return new Is(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*IU;return new Is(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function X1(e,t,n,r){return 1===arguments.length?$U(e):new Is(e,t,n,null==r?1:r)}function Is(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function BU(e){if(isNaN(e.h))return new Fo(e.l,0,0,e.opacity);var t=e.h*kU;return new Fo(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}function cve(e,t){var n=Dn((e=Y1(e)).l,(t=Y1(t)).l),r=Dn(e.a,t.a),i=Dn(e.b,t.b),o=Dn(e.opacity,t.opacity);return function(s){return e.l=n(s),e.a=r(s),e.b=i(s),e.opacity=o(s),e+""}}function zU(e){return function(t,n){var r=e((t=X1(t)).h,(n=X1(n)).h),i=Dn(t.c,n.c),o=Dn(t.l,n.l),s=Dn(t.opacity,n.opacity);return function(a){return t.h=r(a),t.c=i(a),t.l=o(a),t.opacity=s(a),t+""}}}Kd(Fo,Y1,Qg(Gu,{brighter:function(e){return new Fo(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new Fo(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new $n(f2(3.1338561*(t=.96422*c2(t))-1.6168667*(e=1*c2(e))-.4906146*(n=.82521*c2(n))),f2(-.9787684*t+1.9161415*e+.033454*n),f2(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),Kd(Is,X1,Qg(Gu,{brighter:function(e){return new Is(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function(e){return new Is(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function(){return BU(this).rgb()}}));const fve=zU(U1);var dve=zU(Dn),h2=1.78277,p2=-.29227,Q1=-.90649,tm=1.97294,HU=tm*Q1,VU=tm*h2,qU=h2*p2- -.14861*Q1;function hve(e){if(e instanceof Ec)return new Ec(e.h,e.s,e.l,e.opacity);e instanceof $n||(e=VO(e));var n=e.g/255,r=e.b/255,i=(qU*r+HU*(e.r/255)-VU*n)/(qU+HU-VU),o=r-i,s=(tm*(n-i)-p2*o)/Q1,a=Math.sqrt(s*s+o*o)/(tm*i*(1-i)),u=a?Math.atan2(s,o)*IU-120:NaN;return new Ec(u<0?u+360:u,a,i,e.opacity)}function g2(e,t,n,r){return 1===arguments.length?hve(e):new Ec(e,t,n,null==r?1:r)}function Ec(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function WU(e){return function t(n){function r(i,o){var s=e((i=g2(i)).h,(o=g2(o)).h),a=Dn(i.s,o.s),u=Dn(i.l,o.l),l=Dn(i.opacity,o.opacity);return function(c){return i.h=s(c),i.s=a(c),i.l=u(Math.pow(c,n)),i.opacity=l(c),i+""}}return n=+n,r.gamma=t,r}(1)}Kd(Ec,g2,Qg(Gu,{brighter:function(e){return e=null==e?Zd:Math.pow(Zd,e),new Ec(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new Ec(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*kU,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new $n(255*(t+n*(-.14861*r+h2*i)),255*(t+n*(p2*r+Q1*i)),255*(t+n*(tm*r)),this.opacity)}}));const pve=WU(U1);var gve=WU(Dn);function mve(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}function m2(e,t,n){const r=e-t+2*n;return e?r>0?r:1:0}const th="linear",ja="log",nm="pow",rm="sqrt",K1="symlog",Dc="time",Cc="utc",Fs="sequential",nh="diverging",rh="quantile",Z1="quantize",J1="threshold",y2="ordinal",v2="point",b2="bin-ordinal",gn="continuous",im="discrete",om="discretizing",eo="interpolating",_2="temporal";function w2(){const e=HO().unknown(void 0),t=e.domain,n=e.range;let i,o,r=[0,1],s=!1,a=0,u=0,l=.5;function c(){const f=t().length,d=r[1]<r[0],h=r[1-d],p=m2(f,a,u);let g=r[d-0];i=(h-g)/(p||1),s&&(i=Math.floor(i)),g+=(h-g-i*(f-a))*l,o=i*(1-a),s&&(g=Math.round(g),o=Math.round(o));const m=Ci(f).map(v=>g+i*v);return n(d?m.reverse():m)}return delete e.unknown,e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(r=[+f[0],+f[1]],c()):r.slice()},e.rangeRound=function(f){return r=[+f[0],+f[1]],s=!0,c()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(f){return arguments.length?(s=!!f,c()):s},e.padding=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),a=u,c()):a},e.paddingInner=function(f){return arguments.length?(a=Math.max(0,Math.min(1,f)),c()):a},e.paddingOuter=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.align=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.invertRange=function(f){if(null==f[0]||null==f[1])return;const d=r[1]<r[0],h=d?n().reverse():n(),p=h.length-1;let v,y,b,g=+f[0],m=+f[1];return g!=g||m!=m||(m<g&&(b=g,g=m,m=b),m<h[0]||g>r[1-d])?void 0:(v=Math.max(0,j1(h,g)-1),y=g===m?v:j1(h,m)-1,g-h[v]>o+1e-10&&++v,d&&(b=v,v=p-y,y=p-b),v>y?void 0:t().slice(v,y+1))},e.invert=function(f){const d=e.invertRange([f,f]);return d&&d[0]},e.copy=function(){return w2().domain(t()).range(r).round(s).paddingInner(a).paddingOuter(u).align(l)},c()}function YU(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return YU(t())},e}var wve=Array.prototype.map;function xve(e){return wve.call(e,tr)}const Eve=Array.prototype.slice,eb={};function Dve(e,t,n){const r=function(){const o=t();return o.invertRange||(o.invertRange=o.invert?function(e){return function(t){let i,n=t[0],r=t[1];return r<n&&(i=n,n=r,r=i),[e.invert(n),e.invert(r)]}}(o):o.invertExtent?function(e){return function(t){const n=e.range();let s,a,u,l,r=t[0],i=t[1],o=-1;for(i<r&&(a=r,r=i,i=a),u=0,l=n.length;u<l;++u)n[u]>=r&&n[u]<=i&&(o<0&&(o=u),s=u);if(!(o<0))return r=e.invertExtent(n[o]),i=e.invertExtent(n[s]),[void 0===r[0]?r[1]:r[0],void 0===i[1]?i[0]:i[1]]}}(o):void 0),o.type=e,o};return r.metadata=To(X(n)),r}function Je(e,t,n){return arguments.length>1?(eb[e]=Dve(e,t,n),this):QU(e)?eb[e]:void 0}function QU(e){return ne(eb,e)}function Sc(e,t){const n=eb[e];return n&&n.metadata[t]}function x2(e){return Sc(e,gn)}function ih(e){return Sc(e,im)}function E2(e){return Sc(e,om)}function KU(e){return Sc(e,ja)}function ZU(e){return Sc(e,eo)}function JU(e){return Sc(e,rh)}Je("identity",function aU(e){var t;function n(r){return null==r||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,KO),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return aU(e).unknown(t)},e=arguments.length?Array.from(e,KO):[0,1],xc(n)}),Je(th,function sU(){var e=oU();return e.copy=function(){return em(e,sU())},Ms.apply(e,arguments),xc(e)},gn),Je(ja,function dU(){var e=JO(H1()).domain([1,10]);return e.copy=function(){return em(e,dU()).base(e.base())},Ms.apply(e,arguments),e},[gn,ja]),Je(nm,t2,gn),Je(rm,function(){return t2.apply(null,arguments).exponent(.5)},gn),Je(K1,function mU(){var e=n2(H1());return e.copy=function(){return em(e,mU()).constant(e.constant())},Ms.apply(e,arguments)},gn),Je(Dc,function(){return Ms.apply(r2(Hye,Vye,Lu,a1,Nd,Nu,ZS,JS,ju,gA).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},[gn,_2]),Je(Cc,function(){return Ms.apply(r2(zye,Uye,$u,l1,Ld,Pu,nA,rA,ju,mA).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)},[gn,_2]),Je(Fs,i2,[gn,eo]),Je("".concat(Fs,"-").concat(th),i2,[gn,eo]),Je("".concat(Fs,"-").concat(ja),function vU(){var e=JO(V1()).domain([1,10]);return e.copy=function(){return Qu(e,vU()).base(e.base())},Wu.apply(e,arguments)},[gn,eo,ja]),Je("".concat(Fs,"-").concat(nm),o2,[gn,eo]),Je("".concat(Fs,"-").concat(rm),function(){return o2.apply(null,arguments).exponent(.5)},[gn,eo]),Je("".concat(Fs,"-").concat(K1),function bU(){var e=n2(V1());return e.copy=function(){return Qu(e,bU()).constant(e.constant())},Wu.apply(e,arguments)},[gn,eo]),Je("".concat(nh,"-").concat(th),function _U(){var e=xc(q1()(Xr));return e.copy=function(){return Qu(e,_U())},Wu.apply(e,arguments)},[gn,eo]),Je("".concat(nh,"-").concat(ja),function wU(){var e=JO(q1()).domain([.1,1,10]);return e.copy=function(){return Qu(e,wU()).base(e.base())},Wu.apply(e,arguments)},[gn,eo,ja]),Je("".concat(nh,"-").concat(nm),a2,[gn,eo]),Je("".concat(nh,"-").concat(rm),function(){return a2.apply(null,arguments).exponent(.5)},[gn,eo]),Je("".concat(nh,"-").concat(K1),function xU(){var e=n2(q1());return e.copy=function(){return Qu(e,xU()).constant(e.constant())},Wu.apply(e,arguments)},[gn,eo]),Je(rh,function EU(){var r,e=[],t=[],n=[];function i(){var s=0,a=Math.max(1,t.length);for(n=new Array(a-1);++s<a;)n[s-1]=_4(e,s/a);return o}function o(s){return null==s||isNaN(s=+s)?r:t[Xg(n,s)]}return o.invertExtent=function(s){var a=t.indexOf(s);return a<0?[NaN,NaN]:[a>0?n[a-1]:e[0],a<n.length?n[a]:e[e.length-1]]},o.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let a of s)null!=a&&!isNaN(a=+a)&&e.push(a);return e.sort($d),i()},o.range=function(s){return arguments.length?(t=Array.from(s),i()):t.slice()},o.unknown=function(s){return arguments.length?(r=s,o):r},o.quantiles=function(){return n.slice()},o.copy=function(){return EU().domain(e).range(t).unknown(r)},Ms.apply(o,arguments)},[om,rh]),Je(Z1,function DU(){var o,e=0,t=1,n=1,r=[.5],i=[0,1];function s(u){return null!=u&&u<=u?i[Xg(r,u,0,n)]:o}function a(){var u=-1;for(r=new Array(n);++u<n;)r[u]=((u+1)*t-(u-n)*e)/(n+1);return s}return s.domain=function(u){return arguments.length?([e,t]=u,e=+e,t=+t,a()):[e,t]},s.range=function(u){return arguments.length?(n=(i=Array.from(u)).length-1,a()):i.slice()},s.invertExtent=function(u){var l=i.indexOf(u);return l<0?[NaN,NaN]:l<1?[e,r[0]]:l>=n?[r[n-1],t]:[r[l-1],r[l]]},s.unknown=function(u){return arguments.length&&(o=u),s},s.thresholds=function(){return r.slice()},s.copy=function(){return DU().domain([e,t]).range(i).unknown(o)},Ms.apply(xc(s),arguments)},om),Je(J1,function CU(){var n,e=[.5],t=[0,1],r=1;function i(o){return null!=o&&o<=o?t[Xg(e,o,0,r)]:n}return i.domain=function(o){return arguments.length?(e=Array.from(o),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(o){return arguments.length?(t=Array.from(o),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(o){var s=t.indexOf(o);return[e[s-1],e[s]]},i.unknown=function(o){return arguments.length?(n=o,i):n},i.copy=function(){return CU().domain(e).range(t).unknown(n)},Ms.apply(i,arguments)},om),Je(b2,function XU(){let e=[],t=[];function n(r){return null==r||r!=r?void 0:t[(Xg(e,r)-1)%t.length]}return n.domain=function(r){return arguments.length?(e=xve(r),n):e.slice()},n.range=function(r){return arguments.length?(t=Eve.call(r),n):t.slice()},n.tickFormat=function(r,i){return $z(e[0],je(e),null==r?10:r,i)},n.copy=function(){return XU().domain(n.domain()).range(n.range())},n},[im,om]),Je(y2,HO,im),Je("band",w2,im),Je(v2,function(){return YU(w2().paddingInner(1))},im);const Sve=["clamp","base","constant","exponent"];function e9(e,t){const n=t[0],r=je(t)-n;return function(i){return e(n+i*r)}}function tb(e,t,n){return s2(D2(t||"rgb",n),e)}function t9(e,t){const n=new Array(t),r=t+1;for(let i=0;i<t;)n[i]=e(++i/r);return n}function n9(e,t,n){const r=n-t;let i,o,s;return r&&Number.isFinite(r)?(i=(o=e.type).indexOf("-"),o=i<0?o:o.slice(i+1),s=Je(o)().domain([t,n]).range([0,1]),Sve.forEach(a=>e[a]?s[a](e[a]()):0),s):nr(.5)}function D2(e,t){const n=gt[function(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}(e)];return null!=t&&n&&n.gamma?n.gamma(t):n}function r9(e){const t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(6*r,6*++r);return n}function i9(e,t){for(const n in e)C2(n,t(e[n]))}const o9={};function C2(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(o9[e]=t,this):o9[e]}i9({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},r9),i9({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},e=>tb(r9(e)));const nb="symbol",Ive=e=>R(e)?e.map(t=>String(t)):String(e),Fve=(e,t)=>e[1]-t[1],Rve=(e,t)=>t[1]-e[1];function S2(e,t,n){let r;return ft(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),null!=n&&(t=Math.min(t,Math.floor(Dg(e.domain())/n||1)))),J(t)&&(r=t.step,t=t.interval),Y(t)&&(t=e.type===Dc?zd(t):e.type==Cc?Ud(t):F("Only time and utc scales accept interval strings."),r&&(t=t.every(r))),t}function s9(e,t,n){let r=e.range(),i=r[0],o=je(r),s=Fve;if(i>o&&(r=o,o=i,i=r,s=Rve),i=Math.floor(i),o=Math.ceil(o),t=t.map(a=>[a,e(a)]).filter(a=>i<=a[1]&&a[1]<=o).sort(s).map(a=>a[0]),n>0&&t.length>1){const a=[t[0],je(t)];for(;t.length>n&&t.length>=3;)t=t.filter((u,l)=>!(l%2));t.length<3&&(t=a)}return t}function A2(e,t){return e.bins?s9(e,e.bins):e.ticks?e.ticks(t):e.domain()}function a9(e,t,n,r,i,o){const s=t.type;let a=Ive;if(s===Dc||i===Dc)a=e.timeFormat(r);else if(s===Cc||i===Cc)a=e.utcFormat(r);else if(KU(s)){const u=e.formatFloat(r);if(o||t.bins)a=u;else{const l=u9(t,n,!1);a=c=>l(c)?u(c):""}}else if(t.tickFormat){const u=t.domain();a=e.formatSpan(u[0],u[u.length-1],n,r)}else r&&(a=e.format(r));return a}function u9(e,t,n){const r=A2(e,t),i=e.base(),o=Math.log(i),s=Math.max(1,i*t/r.length),a=u=>{let l=u/Math.pow(i,Math.round(Math.log(u)/o));return l*i<i-.5&&(l*=i),l<=s};return n?r.filter(a):a}const O2={[rh]:"quantiles",[Z1]:"thresholds",[J1]:"domain"},l9={[rh]:"quantiles",[Z1]:"domain"};function c9(e,t){return e.bins?function(e){const t=e.slice(0,-1);return t.max=je(e),t}(e.bins):e.type===ja?u9(e,t,!0):O2[e.type]?function(e){const t=[-1/0].concat(e);return t.max=1/0,t}(e[O2[e.type]]()):A2(e,t)}function f9(e,t,n,r,i,o,s){const a=l9[t.type]&&o!==Dc&&o!==Cc?function(e,t,n){const r=t[l9[t.type]](),i=r.length;let s,o=i>1?r[1]-r[0]:r[0];for(s=1;s<i;++s)o=Math.min(o,r[s]-r[s-1]);return e.formatSpan(0,o,30,n)}(e,t,i):a9(e,t,n,i,o,s);return r===nb&&(e=>O2[e.type]||e.bins)(t)?$ve(a):"discrete"===r?Bve(a):zve(a)}const $ve=e=>(t,n,r)=>{const i=d9(r[n+1],d9(r.max,1/0)),o=h9(t,e),s=h9(i,e);return o&&s?o+" \u2013 "+s:s?"< "+s:"\u2265 "+o},d9=(e,t)=>null!=e?e:t,Bve=e=>(t,n)=>n?e(t):null,zve=e=>t=>e(t),h9=(e,t)=>Number.isFinite(e)?t(e):null;function p9(e,t,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=function(e,t,n,r){const i=r||t.type;return Y(n)&&function(e){return Sc(e,_2)}(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||i!==Dc?n||i!==Cc?f9(e,t,5,null,n,r,!0):e.utcFormat("%A, %d %B %Y, %X UTC"):e.timeFormat("%A, %d %B %Y, %X")}(e,t,n.format,n.formatType);if(E2(t.type)){const o=c9(t).slice(1).map(i),s=o.length;return"".concat(s," boundar").concat(1===s?"y":"ies",": ").concat(o.join(", "))}if(ih(t.type)){const o=t.domain(),s=o.length,a=s>r?o.slice(0,r-2).map(i).join(", ")+", ending with "+o.slice(-1).map(i):o.map(i).join(", ");return"".concat(s," value").concat(1===s?"":"s",": ").concat(a)}{const o=t.domain();return"values from ".concat(i(o[0])," to ").concat(i(je(o)))}}let g9=0;function M2(e){return e&&e.gradient}function m9(e,t,n){const r=e.gradient;let i=e.id,o="radial"===r?"p_":"";return i||(i=e.id="gradient_"+g9++,"radial"===r?(e.x1=Rs(e.x1,.5),e.y1=Rs(e.y1,.5),e.r1=Rs(e.r1,0),e.x2=Rs(e.x2,.5),e.y2=Rs(e.y2,.5),e.r2=Rs(e.r2,.5),o="p_"):(e.x1=Rs(e.x1,0),e.y1=Rs(e.y1,0),e.x2=Rs(e.x2,1),e.y2=Rs(e.y2,0))),t[i]=e,"url("+(n||"")+"#"+o+i+")"}function Rs(e,t){return null!=e?e:t}function y9(e,t){var r,n=[];return r={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(i,o){return n.push({offset:i,color:o}),r}}}const v9={basis:{curve:function(e){return new I1(e)}},"basis-closed":{curve:function(e){return new dz(e)}},"basis-open":{curve:function(e){return new hz(e)}},bundle:{curve:k0e,tension:"beta",value:.85},cardinal:{curve:I0e,tension:"tension",value:0},"cardinal-open":{curve:F0e,tension:"tension",value:0},"cardinal-closed":{curve:R0e,tension:"tension",value:0},"catmull-rom":{curve:L0e,tension:"alpha",value:.5},"catmull-rom-closed":{curve:j0e,tension:"alpha",value:.5},"catmull-rom-open":{curve:$0e,tension:"alpha",value:.5},linear:{curve:NO},"linear-closed":{curve:function(e){return new wz(e)}},monotone:{horizontal:function(e){return new Cz(e)},vertical:function(e){return new N1(e)}},natural:{curve:function(e){return new Az(e)}},step:{curve:function(e){return new P1(e,.5)}},"step-after":{curve:function(e){return new P1(e,1)}},"step-before":{curve:function(e){return new P1(e,0)}}};function T2(e,t,n){var r=ne(v9,e)&&v9[e],i=null;return r&&(i=r.curve||r[t||"vertical"],r.tension&&null!=n&&(i=i[r.tension](n))),i}const qve={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},sm=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];function oh(e){const t=[];let n,r,i,o,s,a,u,l,c,f;const d=e.slice().replace(sm[0],"###$1").split(sm[1]).slice(1);for(u=0,c=d.length;u<c;++u){for(n=d[u],r=n.slice(1).trim().replace(sm[2],"$1###$2").replace(sm[3],"$1###$2").split(sm[4]),s=n.charAt(0),i=[s],l=0,f=r.length;l<f;++l)(o=+r[l])===o&&i.push(o);if(a=qve[s.toLowerCase()],i.length-1>a){const h=i.length;for(l=1,t.push([s].concat(i.slice(l,l+=a))),s="M"===s?"L":"m"===s?"l":s;l<h;l+=a)t.push([s].concat(i.slice(l,l+a)))}else t.push(i)}return t}const Ku=Math.PI/180,Ac=Math.PI/2,Ns=2*Math.PI,sh=Math.sqrt(3)/2;var k2={},I2={},b9=[].join;function Yve(e){const t=b9.call(e);if(I2[t])return I2[t];var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],l=e[7];const c=l*s,f=-u*a,d=u*s,h=l*a,p=Math.cos(i),g=Math.sin(i),m=Math.cos(o),v=Math.sin(o),y=.5*(o-i),b=Math.sin(.5*y),_=8/3*b*b/Math.sin(y),w=n+p-_*g,E=r+g+_*p,x=n+m,D=r+v,S=x+_*v,C=D-_*m;return I2[t]=[c*w+f*E,d*w+h*E,c*S+f*C,d*S+h*C,c*x+f*D,d*x+h*D]}const to=["l",0,0,0,0,0,0,0];function Xve(e,t,n){const r=to[0]=e[0];if("a"===r||"A"===r)to[1]=t*e[1],to[2]=n*e[2],to[3]=e[3],to[4]=e[4],to[5]=e[5],to[6]=t*e[6],to[7]=n*e[7];else if("h"===r||"H"===r)to[1]=t*e[1];else if("v"===r||"V"===r)to[1]=n*e[1];else for(var i=1,o=e.length;i<o;++i)to[i]=(i%2==1?t:n)*e[i];return to}function am(e,t,n,r,i,o){var s,d,h,p,g,a=null,u=0,l=0,c=0,f=0;null==n&&(n=0),null==r&&(r=0),null==i&&(i=1),null==o&&(o=i),e.beginPath&&e.beginPath();for(var m=0,v=t.length;m<v;++m){switch(s=t[m],(1!==i||1!==o)&&(s=Xve(s,i,o)),s[0]){case"l":e.lineTo((u+=s[1])+n,(l+=s[2])+r);break;case"L":e.lineTo((u=s[1])+n,(l=s[2])+r);break;case"h":e.lineTo((u+=s[1])+n,l+r);break;case"H":e.lineTo((u=s[1])+n,l+r);break;case"v":e.lineTo(u+n,(l+=s[1])+r);break;case"V":e.lineTo(u+n,(l=s[1])+r);break;case"m":e.moveTo((u+=s[1])+n,(l+=s[2])+r);break;case"M":e.moveTo((u=s[1])+n,(l=s[2])+r);break;case"c":e.bezierCurveTo(u+s[1]+n,l+s[2]+r,(c=u+s[3])+n,(f=l+s[4])+r,(d=u+s[5])+n,(h=l+s[6])+r),u=d,l=h;break;case"C":e.bezierCurveTo(s[1]+n,s[2]+r,(c=s[3])+n,(f=s[4])+r,(u=s[5])+n,(l=s[6])+r);break;case"s":e.bezierCurveTo((c=2*u-c)+n,(f=2*l-f)+r,u+s[1]+n,l+s[2]+r,(d=u+s[3])+n,(h=l+s[4])+r),c=u+s[1],f=l+s[2],u=d,l=h;break;case"S":e.bezierCurveTo((c=2*u-c)+n,(f=2*l-f)+r,s[1]+n,s[2]+r,(d=s[3])+n,(h=s[4])+r),u=d,l=h,c=s[1],f=s[2];break;case"q":e.quadraticCurveTo((c=u+s[1])+n,(f=l+s[2])+r,(d=u+s[3])+n,(h=l+s[4])+r),u=d,l=h;break;case"Q":e.quadraticCurveTo(s[1]+n,s[2]+r,(d=s[3])+n,(h=s[4])+r),u=d,l=h,c=s[1],f=s[2];break;case"t":d=u+s[1],h=l+s[2],null===a[0].match(/[QqTt]/)?(c=u,f=l):"t"===a[0]?(c=2*u-p,f=2*l-g):"q"===a[0]&&(c=2*u-c,f=2*l-f),p=c,g=f,e.quadraticCurveTo(c+n,f+r,d+n,h+r),c=(u=d)+s[1],f=(l=h)+s[2];break;case"T":e.quadraticCurveTo((c=2*u-c)+n,(f=2*l-f)+r,(d=s[1])+n,(h=s[2])+r),u=d,l=h;break;case"a":_9(e,u+n,l+r,[s[1],s[2],s[3],s[4],s[5],s[6]+u+n,s[7]+l+r]),u+=s[6],l+=s[7];break;case"A":_9(e,u+n,l+r,[s[1],s[2],s[3],s[4],s[5],s[6]+n,s[7]+r]),u=s[6],l=s[7];break;case"z":case"Z":e.closePath()}a=s}}function _9(e,t,n,r){const i=function(e,t,n,r,i,o,s,a,u){const l=b9.call(arguments);if(k2[l])return k2[l];const c=s*Ku,f=Math.sin(c),d=Math.cos(c),h=d*(a-e)*.5+f*(u-t)*.5,p=d*(u-t)*.5-f*(a-e)*.5;let g=h*h/((n=Math.abs(n))*n)+p*p/((r=Math.abs(r))*r);g>1&&(g=Math.sqrt(g),n*=g,r*=g);const m=d/n,v=f/n,y=-f/r,b=d/r,_=m*a+v*u,w=y*a+b*u,E=m*e+v*t,x=y*e+b*t;let S=1/((E-_)*(E-_)+(x-w)*(x-w))-.25;S<0&&(S=0);let C=Math.sqrt(S);o==i&&(C=-C);const A=.5*(_+E)-C*(x-w),M=.5*(w+x)+C*(E-_),T=Math.atan2(w-M,_-A);let O=Math.atan2(x-M,E-A)-T;O<0&&1===o?O+=Ns:O>0&&0===o&&(O-=Ns);const N=Math.ceil(Math.abs(O/(Ac+.001))),U=[];for(let W=0;W<N;++W)U[W]=[A,M,T+W*O/N,T+(W+1)*O/N,n,r,f,d];return k2[l]=U}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(let o=0;o<i.length;++o){const s=Yve(i[o]);e.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5])}}const w9=.5773502691896257,x9={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,Ns)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,o=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-o),e.lineTo(i,-o),e.lineTo(0,-n),e.lineTo(-i,-o),e.lineTo(-r,-o),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=sh*n,i=r-n*w9,o=n/4;e.moveTo(0,-r-i),e.lineTo(-o,r-i),e.lineTo(o,r-i),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=sh*n,i=r-n*w9;e.moveTo(0,-r-i),e.lineTo(-n,r-i),e.lineTo(n,r-i),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=sh*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=sh*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=sh*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=sh*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function E9(e){return ne(x9,e)?x9[e]:function(e){if(!ne(F2,e)){const t=oh(e);F2[e]={draw:function(n,r){am(n,t,0,0,Math.sqrt(r)/2)}}}return F2[e]}(e)}var F2={};const Zu=.448084975506;function Kve(e){return e.x}function Zve(e){return e.y}function Jve(e){return e.width}function e1e(e){return e.height}function $a(e){return"function"==typeof e?e:()=>+e}function ib(e,t,n){return Math.max(t,Math.min(e,n))}function D9(){var e=Kve,t=Zve,n=Jve,r=e1e,i=$a(0),o=i,s=i,a=i,u=null;function l(c,f,d){var h,p=null!=f?f:+e.call(this,c),g=null!=d?d:+t.call(this,c),m=+n.call(this,c),v=+r.call(this,c),y=Math.min(m,v)/2,b=ib(+i.call(this,c),0,y),_=ib(+o.call(this,c),0,y),w=ib(+s.call(this,c),0,y),E=ib(+a.call(this,c),0,y);if(u||(u=h=Xd()),b<=0&&_<=0&&w<=0&&E<=0)u.rect(p,g,m,v);else{var x=p+m,D=g+v;u.moveTo(p+b,g),u.lineTo(x-_,g),u.bezierCurveTo(x-Zu*_,g,x,g+Zu*_,x,g+_),u.lineTo(x,D-E),u.bezierCurveTo(x,D-Zu*E,x-Zu*E,D,x-E,D),u.lineTo(p+w,D),u.bezierCurveTo(p+Zu*w,D,p,D-Zu*w,p,D-w),u.lineTo(p,g+b),u.bezierCurveTo(p,g+Zu*b,p+Zu*b,g,p+b,g),u.closePath()}if(h)return u=null,h+""||null}return l.x=function(c){return arguments.length?(e=$a(c),l):e},l.y=function(c){return arguments.length?(t=$a(c),l):t},l.width=function(c){return arguments.length?(n=$a(c),l):n},l.height=function(c){return arguments.length?(r=$a(c),l):r},l.cornerRadius=function(c,f,d,h){return arguments.length?(i=$a(c),o=null!=f?$a(f):i,a=null!=d?$a(d):i,s=null!=h?$a(h):o,l):i},l.context=function(c){return arguments.length?(u=null==c?null:c,l):u},l}function C9(){var e,t,n,r,o,s,a,u,i=null;function l(f,d,h){const p=h/2;if(o){var g=a-d,m=f-s;if(g||m){var v=Math.sqrt(g*g+m*m),y=(g/=v)*u,b=(m/=v)*u,_=Math.atan2(m,g);i.moveTo(s-y,a-b),i.lineTo(f-g*p,d-m*p),i.arc(f,d,p,_-Math.PI,_),i.lineTo(s+y,a+b),i.arc(s,a,u,_,_+Math.PI)}else i.arc(f,d,p,0,Ns);i.closePath()}else o=1;s=f,a=d,u=p}function c(f){var d,p,m,h=f.length,g=!1;for(null==i&&(i=m=Xd()),d=0;d<=h;++d)!(d<h&&r(p=f[d],d,f))===g&&(g=!g)&&(o=0),g&&l(+e(p,d,f),+t(p,d,f),+n(p,d,f));if(m)return i=null,m+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(r=f,c):r},c.context=function(f){return arguments.length?(i=null==f?null:f,c):i},c}function um(e,t){return null!=e?e:t}const lm=e=>e.x||0,cm=e=>e.y||0,ob=e=>!1!==e.defined,v1e=function(){var e=Y0e,t=X0e,n=ot(0),r=null,i=Q0e,o=K0e,s=Z0e,a=null;function u(){var l,c,f=+e.apply(this,arguments),d=+t.apply(this,arguments),h=i.apply(this,arguments)-R1,p=o.apply(this,arguments)-R1,g=gz(p-h),m=p>h;if(a||(a=l=Xd()),d<f&&(c=d,d=f,f=c),d>sr)if(g>Yg-sr)a.moveTo(d*bc(h),d*Os(h)),a.arc(0,0,d,h,p,!m),f>sr&&(a.moveTo(f*bc(p),f*Os(p)),a.arc(0,0,f,p,h,m));else{var M,T,v=h,y=p,b=h,_=p,w=g,E=g,x=s.apply(this,arguments)/2,D=x>sr&&(r?+r.apply(this,arguments):Yd(f*f+d*d)),S=FO(gz(d-f)/2,+n.apply(this,arguments)),C=S,A=S;if(D>sr){var L=mz(D/f*Os(x)),O=mz(D/d*Os(x));(w-=2*L)>sr?(b+=L*=m?1:-1,_-=L):(w=0,b=_=(h+p)/2),(E-=2*O)>sr?(v+=O*=m?1:-1,y-=O):(E=0,v=y=(h+p)/2)}var N=d*bc(v),U=d*Os(v),W=f*bc(_),te=f*Os(_);if(S>sr){var _t,pe=d*bc(y),We=d*Os(y),Ge=f*bc(b),Ht=f*Os(b);if(g<qu&&(_t=J0e(N,U,Ge,Ht,pe,We,W,te))){var Kt=N-_t[0],$r=U-_t[1],ss=pe-_t[0],as=We-_t[1],Z=1/Os(P0e((Kt*ss+$r*as)/(Yd(Kt*Kt+$r*$r)*Yd(ss*ss+as*as)))/2),de=Yd(_t[0]*_t[0]+_t[1]*_t[1]);C=FO(S,(f-de)/(Z-1)),A=FO(S,(d-de)/(Z+1))}}E>sr?A>sr?(M=L1(Ge,Ht,N,U,d,A,m),T=L1(pe,We,W,te,d,A,m),a.moveTo(M.cx+M.x01,M.cy+M.y01),A<S?a.arc(M.cx,M.cy,A,or(M.y01,M.x01),or(T.y01,T.x01),!m):(a.arc(M.cx,M.cy,A,or(M.y01,M.x01),or(M.y11,M.x11),!m),a.arc(0,0,d,or(M.cy+M.y11,M.cx+M.x11),or(T.cy+T.y11,T.cx+T.x11),!m),a.arc(T.cx,T.cy,A,or(T.y11,T.x11),or(T.y01,T.x01),!m))):(a.moveTo(N,U),a.arc(0,0,d,v,y,!m)):a.moveTo(N,U),f>sr&&w>sr?C>sr?(M=L1(W,te,pe,We,f,-C,m),T=L1(N,U,Ge,Ht,f,-C,m),a.lineTo(M.cx+M.x01,M.cy+M.y01),C<S?a.arc(M.cx,M.cy,C,or(M.y01,M.x01),or(T.y01,T.x01),!m):(a.arc(M.cx,M.cy,C,or(M.y01,M.x01),or(M.y11,M.x11),!m),a.arc(0,0,f,or(M.cy+M.y11,M.cx+M.x11),or(T.cy+T.y11,T.cx+T.x11),m),a.arc(T.cx,T.cy,C,or(T.y11,T.x11),or(T.y01,T.x01),!m))):a.arc(0,0,f,_,b,m):a.lineTo(W,te)}else a.moveTo(0,0);if(a.closePath(),l)return a=null,l+""||null}return u.centroid=function(){var l=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,c=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-qu/2;return[bc(c)*l,Os(c)*l]},u.innerRadius=function(l){return arguments.length?(e="function"==typeof l?l:ot(+l),u):e},u.outerRadius=function(l){return arguments.length?(t="function"==typeof l?l:ot(+l),u):t},u.cornerRadius=function(l){return arguments.length?(n="function"==typeof l?l:ot(+l),u):n},u.padRadius=function(l){return arguments.length?(r=null==l?null:"function"==typeof l?l:ot(+l),u):r},u.startAngle=function(l){return arguments.length?(i="function"==typeof l?l:ot(+l),u):i},u.endAngle=function(l){return arguments.length?(o="function"==typeof l?l:ot(+l),u):o},u.padAngle=function(l){return arguments.length?(s="function"==typeof l?l:ot(+l),u):s},u.context=function(l){return arguments.length?(a=null==l?null:l,u):a},u}().startAngle(e=>e.startAngle||0).endAngle(e=>e.endAngle||0).padAngle(e=>e.padAngle||0).innerRadius(e=>e.innerRadius||0).outerRadius(e=>e.outerRadius||0).cornerRadius(e=>e.cornerRadius||0),b1e=Rz().x(lm).y1(cm).y0(e=>(e.y||0)+(e.height||0)).defined(ob),_1e=Rz().y(cm).x1(lm).x0(e=>(e.x||0)+(e.width||0)).defined(ob),w1e=Fz().x(lm).y(cm).defined(ob),x1e=D9().x(lm).y(cm).width(e=>e.width||0).height(e=>e.height||0).cornerRadius(e=>um(e.cornerRadiusTopLeft,e.cornerRadius)||0,e=>um(e.cornerRadiusTopRight,e.cornerRadius)||0,e=>um(e.cornerRadiusBottomRight,e.cornerRadius)||0,e=>um(e.cornerRadiusBottomLeft,e.cornerRadius)||0),E1e=function(e,t){var n=null;function r(){var i;if(n||(n=i=Xd()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),i)return n=null,i+""||null}return e="function"==typeof e?e:ot(e||Nz),t="function"==typeof t?t:ot(void 0===t?64:+t),r.type=function(i){return arguments.length?(e="function"==typeof i?i:ot(i),r):e},r.size=function(i){return arguments.length?(t="function"==typeof i?i:ot(+i),r):t},r.context=function(i){return arguments.length?(n=null==i?null:i,r):n},r}().type(e=>E9(e.shape||"circle")).size(e=>um(e.size,64)),D1e=C9().x(lm).y(cm).defined(ob).size(e=>e.size||1);function R2(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function ah(e,t,n,r){return x1e.context(e)(t,n,r)}var S9=1;function A9(){S9=1}function N2(e,t,n){var r=t.clip,i=e._defs,o=t.clip_id||(t.clip_id="clip"+S9++),s=i.clipping[o]||(i.clipping[o]={id:o});return xe(r)?s.path=r(null):R2(n)?s.path=ah(null,n,0,0):(s.width=n.width||0,s.height=n.height||0),"url(#"+o+")"}function mn(e){this.clear(),e&&this.union(e)}function sb(e){this.mark=e,this.bounds=this.bounds||new mn}function ab(e){sb.call(this,e),this.items=this.items||[]}function P2(e){this._pending=0,this._loader=e||p1()}function O9(e){e._pending+=1}function fm(e){e._pending-=1}function Ba(e,t,n){if(t.stroke&&0!==t.opacity&&0!==t.strokeOpacity){const r=null!=t.strokeWidth?+t.strokeWidth:1;e.expand(r+(n?function(e,t){return e.strokeJoin&&"miter"!==e.strokeJoin?0:t}(t,r):0))}return e}mn.prototype={clone(){return new mn(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(e,t,n){var{x1:r,y1:i,x2:o,y2:s}=this,a=Math.cos(e),u=Math.sin(e),l=t-t*a+n*u,c=n-t*u-n*a;return[a*r-u*i+l,u*r+a*i+c,a*r-u*s+l,u*r+a*s+c,a*o-u*i+l,u*o+a*i+c,a*o-u*s+l,u*o+a*s+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}},z(ab,sb),P2.prototype={pending(){return this._pending},sanitizeURL(e){const t=this;return O9(t),t._loader.sanitize(e,{context:"href"}).then(n=>(fm(t),n)).catch(()=>(fm(t),null))},loadImage(e){const t=this,n="undefined"!=typeof Image?Image:null;return O9(t),t._loader.sanitize(e,{context:"image"}).then(r=>{const i=r.href;if(!i||!n)throw{url:i};const o=new n,s=ne(r,"crossOrigin")?r.crossOrigin:"anonymous";return null!=s&&(o.crossOrigin=s),o.onload=()=>fm(t),o.onerror=()=>fm(t),o.src=i,o}).catch(r=>(fm(t),{complete:!1,width:0,height:0,src:r&&r.url||""}))},ready(){const e=this;return new Promise(t=>{!function n(r){e.pending()?setTimeout(()=>{n(!0)},10):t(r)}(!1)})}};const I1e=Ns-1e-8;let ub,lb,cb,Oc,L2,fb,j2,$2;const Ju=(e,t)=>ub.add(e,t),db=(e,t)=>Ju(lb=e,cb=t),M9=e=>Ju(e,ub.y1),T9=e=>Ju(ub.x1,e),Mc=(e,t)=>L2*e+j2*t,Tc=(e,t)=>fb*e+$2*t,B2=(e,t)=>Ju(Mc(e,t),Tc(e,t)),z2=(e,t)=>db(Mc(e,t),Tc(e,t));function dm(e,t){return ub=e,t?(Oc=t*Ku,L2=$2=Math.cos(Oc),fb=Math.sin(Oc),j2=-fb):(L2=$2=1,Oc=fb=j2=0),F1e}const F1e={beginPath(){},closePath(){},moveTo:z2,lineTo:z2,rect(e,t,n,r){Oc?(B2(e+n,t),B2(e+n,t+r),B2(e,t+r),z2(e,t)):(Ju(e+n,t+r),db(e,t))},quadraticCurveTo(e,t,n,r){const i=Mc(e,t),o=Tc(e,t),s=Mc(n,r),a=Tc(n,r);k9(lb,i,s,M9),k9(cb,o,a,T9),db(s,a)},bezierCurveTo(e,t,n,r,i,o){const s=Mc(e,t),a=Tc(e,t),u=Mc(n,r),l=Tc(n,r),c=Mc(i,o),f=Tc(i,o);I9(lb,s,u,c,M9),I9(cb,a,l,f,T9),db(c,f)},arc(e,t,n,r,i,o){if(r+=Oc,i+=Oc,lb=n*Math.cos(i)+e,cb=n*Math.sin(i)+t,Math.abs(i-r)>I1e)Ju(e-n,t-n),Ju(e+n,t+n);else{const s=l=>Ju(n*Math.cos(l)+e,n*Math.sin(l)+t);let a,u;if(s(r),s(i),i!==r)if((r%=Ns)<0&&(r+=Ns),(i%=Ns)<0&&(i+=Ns),i<r&&(o=!o,a=r,r=i,i=a),o)for(i-=Ns,a=r-r%Ac,u=0;u<4&&a>i;++u,a-=Ac)s(a);else for(a=r-r%Ac+Ac,u=0;u<4&&a<i;++u,a+=Ac)s(a)}}};function k9(e,t,n,r){const i=(e-t)/(e+n-2*t);0<i&&i<1&&r(e+(t-e)*i)}function I9(e,t,n,r,i){const o=r-e+3*t-3*n,s=e+n-2*t,a=e-t;let c,u=0,l=0;Math.abs(o)>1e-14?(c=s*s+a*o,c>=0&&(c=Math.sqrt(c),u=(-s+c)/o,l=(-s-c)/o)):u=.5*a/s,0<u&&u<1&&i(F9(u,e,t,n,r)),0<l&&l<1&&i(F9(l,e,t,n,r))}function F9(e,t,n,r,i){const o=1-e,s=o*o,a=e*e;return s*o*t+3*s*e*n+3*o*a*r+a*e*i}var el=(el=Qd(1,1))?el.getContext("2d"):null;const U2=new mn;function H2(e){return function(t,n){if(!el)return!0;e(el,t),U2.clear().union(t.bounds).intersect(n).round();const{x1:r,y1:i,x2:o,y2:s}=U2;for(let a=i;a<=s;++a)for(let u=r;u<=o;++u)if(el.isPointInPath(u,a))return!0;return!1}}function V2(e,t){return t.contains(e.x||0,e.y||0)}function R9(e,t){const n=e.x||0,r=e.y||0;return t.intersects(U2.set(n,r,n+(e.width||0),r+(e.height||0)))}function N9(e,t){const n=e.x||0,r=e.y||0;return uh(t,n,r,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r)}function uh(e,t,n,r,i){const{x1:o,y1:s,x2:a,y2:u}=e,l=r-t,c=i-n;let h,p,g,m,f=0,d=1;for(m=0;m<4;++m){if(0===m&&(h=-l,p=-(o-t)),1===m&&(h=l,p=a-t),2===m&&(h=-c,p=-(s-n)),3===m&&(h=c,p=u-n),Math.abs(h)<1e-10&&p<0)return!1;if(g=p/h,h<0){if(g>d)return!1;g>f&&(f=g)}else if(h>0){if(g<f)return!1;g<d&&(d=g)}}return!0}function lh(e,t){e.globalCompositeOperation=t.blend||"source-over"}function Ro(e,t){return null==e?t:e}function P9(e,t){const n=t.length;for(let r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function L9(e,t,n){return M2(n)?function(e,t,n){const r=n.width(),i=n.height();let o;if("radial"===t.gradient)o=e.createRadialGradient(n.x1+Ro(t.x1,.5)*r,n.y1+Ro(t.y1,.5)*i,Math.max(r,i)*Ro(t.r1,0),n.x1+Ro(t.x2,.5)*r,n.y1+Ro(t.y2,.5)*i,Math.max(r,i)*Ro(t.r2,.5));else{const s=Ro(t.x1,0),a=Ro(t.y1,0),u=Ro(t.x2,1),l=Ro(t.y2,0);if(s!==u&&a!==l&&r!==i){const c=Qd(Math.ceil(r),Math.ceil(i)),f=c.getContext("2d");return f.scale(r,i),f.fillStyle=P9(f.createLinearGradient(s,a,u,l),t.stops),f.fillRect(0,0,r,i),e.createPattern(c,"no-repeat")}o=e.createLinearGradient(n.x1+s*r,n.y1+a*i,n.x1+u*r,n.y1+l*i)}return P9(o,t.stops)}(e,n,t.bounds):n}function hb(e,t,n){return(n*=null==t.fillOpacity?1:t.fillOpacity)>0&&(e.globalAlpha=n,e.fillStyle=L9(e,t,t.fill),!0)}var N1e=[];function ch(e,t,n){var r=null!=(r=t.strokeWidth)?r:1;return!(r<=0)&&(n*=null==t.strokeOpacity?1:t.strokeOpacity)>0&&(e.globalAlpha=n,e.strokeStyle=L9(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||N1e),e.lineDashOffset=t.strokeDashOffset||0),!0)}function P1e(e,t){return e.zindex-t.zindex||e.index-t.index}function q2(e){if(!e.zdirty)return e.zitems;var r,i,o,t=e.items,n=[];for(i=0,o=t.length;i<o;++i)(r=t[i]).index=i,r.zindex&&n.push(r);return e.zdirty=!1,e.zitems=n.sort(P1e)}function No(e,t){var r,i,n=e.items;if(!n||!n.length)return;const o=q2(e);if(o&&o.length){for(r=0,i=n.length;r<i;++r)n[r].zindex||t(n[r]);n=o}for(r=0,i=n.length;r<i;++r)t(n[r])}function pb(e,t){var r,i,n=e.items;if(!n||!n.length)return null;const o=q2(e);for(o&&o.length&&(n=o),i=n.length;--i>=0;)if(r=t(n[i]))return r;if(n===o)for(i=(n=e.items).length;--i>=0;)if(!n[i].zindex&&(r=t(n[i])))return r;return null}function W2(e){return function(t,n,r){No(n,i=>{(!r||r.intersects(i.bounds))&&j9(e,t,i,i)})}}function L1e(e){return function(t,n,r){n.items.length&&(!r||r.intersects(n.bounds))&&j9(e,t,n.items[0],n.items)}}function j9(e,t,n,r){var i=null==n.opacity?1:n.opacity;0!==i&&(e(t,r)||(lh(t,n),n.fill&&hb(t,n,i)&&t.fill(),n.stroke&&ch(t,n,i)&&t.stroke()))}function gb(e){return e=e||Yi,function(t,n,r,i,o,s){return r*=t.pixelRatio,i*=t.pixelRatio,pb(n,a=>{const u=a.bounds;if((!u||u.contains(o,s))&&u&&e(t,a,r,i,o,s))return a})}}function hm(e,t){return function(n,r,i,o){var l,c,s=Array.isArray(r)?r[0]:r,a=null==t?s.fill:t,u=s.stroke&&n.isPointInStroke;return u&&(c=s.strokeCap,n.lineWidth=null!=(l=s.strokeWidth)?l:1,n.lineCap=null!=c?c:"butt"),!e(n,r)&&(a&&n.isPointInPath(i,o)||u&&n.isPointInStroke(i,o))}}function G2(e){return gb(hm(e))}function kc(e,t){return"translate("+e+","+t+")"}function Y2(e){return"rotate("+e+")"}function $9(e){return kc(e.x||0,e.y||0)}function X2(e,t,n){function o(s,a){var u=a.x||0,l=a.y||0,c=a.angle||0;s.translate(u,l),c&&s.rotate(c*=Ku),s.beginPath(),t(s,a),c&&s.rotate(-c),s.translate(-u,-l)}return{type:e,tag:"path",nested:!1,attr:function(s,a){s("transform",function(e){return kc(e.x||0,e.y||0)+(e.angle?" "+Y2(e.angle):"")}(a)),s("d",t(null,a))},bound:function(s,a){return t(dm(s,a.angle),a),Ba(s,a).translate(a.x||0,a.y||0)},draw:W2(o),pick:G2(o),isect:n||H2(o)}}var z1e=X2("arc",function(e,t){return v1e.context(e)(t)});function Q2(e,t,n){function o(u,l){u.beginPath(),t(u,l)}const s=hm(o);return{type:e,tag:"path",nested:!0,attr:function(u,l){var c=l.mark.items;c.length&&u("d",t(null,c))},bound:function(u,l){var c=l.items;return 0===c.length?u:(t(dm(u),c),Ba(u,c[0]))},draw:L1e(o),pick:function(u,l,c,f,d,h){var p=l.items,g=l.bounds;return!p||!p.length||g&&!g.contains(d,h)?null:s(u,p,c*=u.pixelRatio,f*=u.pixelRatio)?p[0]:null},isect:V2,tip:n}}var q1e=Q2("area",function(e,t){const n=t[0];return("horizontal"===n.orient?_1e:b1e).curve(T2(n.interpolate||"linear",n.orient,n.tension)).context(e)(t)},function(e,t){for(var s,a,n="horizontal"===e[0].orient?t[1]:t[0],r="horizontal"===e[0].orient?"y":"x",i=e.length,o=1/0;--i>=0;)!1!==e[i].defined&&(a=Math.abs(e[i][r]-n))<o&&(o=a,s=e[i]);return s});function B9(e,t){e.beginPath(),R2(t)?ah(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function z9(e){const t=Ro(e.strokeWidth,1);return null!=e.strokeOffset?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function U9(e,t){const n=z9(t);e("d",ah(null,t,n,n))}function pm(e,t,n,r){const i=z9(t);e.beginPath(),ah(e,t,(n||0)+i,(r||0)+i)}const Z1e=hm(pm),J1e=hm(pm,!1),ebe=hm(pm,!0);var ibe={type:"group",tag:"g",nested:!1,attr:function(e,t){e("transform",$9(t))},bound:function(e,t){if(!t.clip&&t.items){const n=t.items,r=n.length;for(let i=0;i<r;++i)e.union(n[i].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),Ba(e,t),e.translate(t.x||0,t.y||0)},draw:function(e,t,n){No(t,r=>{const i=r.x||0,o=r.y||0,s=r.strokeForeground,a=null==r.opacity?1:r.opacity;(r.stroke||r.fill)&&a&&(pm(e,r,i,o),lh(e,r),r.fill&&hb(e,r,a)&&e.fill(),r.stroke&&!s&&ch(e,r,a)&&e.stroke()),e.save(),e.translate(i,o),r.clip&&B9(e,r),n&&n.translate(-i,-o),No(r,u=>{this.draw(e,u,n)}),n&&n.translate(i,o),e.restore(),s&&r.stroke&&a&&(pm(e,r,i,o),lh(e,r),ch(e,r,a)&&e.stroke())})},pick:function(e,t,n,r,i,o){if(t.bounds&&!t.bounds.contains(i,o)||!t.items)return null;const s=n*e.pixelRatio,a=r*e.pixelRatio;return pb(t,u=>{let l,c,f;const d=u.bounds;if(d&&!d.contains(i,o))return;c=u.x||0,f=u.y||0;const g=u.clip;if(g&&(i<c||i>c+(u.width||0)||o<f||o>f+(u.height||0)))return;if(e.save(),e.translate(c,f),c=i-c,f=o-f,g&&R2(u)&&!ebe(e,u,s,a))return e.restore(),null;const m=u.strokeForeground,v=!1!==t.interactive;return v&&m&&u.stroke&&J1e(e,u,s,a)?(e.restore(),u):(l=pb(u,y=>function(e,t,n){return(!1!==e.interactive||"group"===e.marktype)&&e.bounds&&e.bounds.contains(t,n)}(y,c,f)?this.pick(y,n,r,c,f):null),!l&&v&&(u.fill||!m&&u.stroke)&&Z1e(e,u,s,a)&&(l=u),e.restore(),l||null)})},isect:R9,content:function(e,t,n){e("clip-path",t.clip?N2(n,t,t):null)},background:function(e,t){e("class","background"),e("aria-hidden",!0),U9(e,t)},foreground:function(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?U9(e,t):e("d","")}},gm={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function K2(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(r=>{e.image=r,e.image.url=e.url})),n}function Z2(e,t){return null!=e.width?e.width:t&&t.width?!1!==e.aspect&&e.height?e.height*t.width/t.height:t.width:0}function J2(e,t){return null!=e.height?e.height:t&&t.height?!1!==e.aspect&&e.width?e.width*t.height/t.width:t.height:0}function mb(e,t){return"center"===e?t/2:"right"===e?t:0}function yb(e,t){return"middle"===e?t/2:"bottom"===e?t:0}var ube={type:"image",tag:"image",nested:!1,attr:function(e,t,n){const r=K2(t,n),i=Z2(t,r),o=J2(t,r),s=(t.x||0)-mb(t.align,i),a=(t.y||0)-yb(t.baseline,o);e("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",gm["xmlns:xlink"],"xlink:href"),e("transform",kc(s,a)),e("width",i),e("height",o),e("preserveAspectRatio",!1===t.aspect?"none":"xMidYMid")},bound:function(e,t){const n=t.image,r=Z2(t,n),i=J2(t,n),o=(t.x||0)-mb(t.align,r),s=(t.y||0)-yb(t.baseline,i);return e.set(o,s,o+r,s+i)},draw:function(e,t,n){No(t,r=>{if(n&&!n.intersects(r.bounds))return;const i=K2(r,this);let o=Z2(r,i),s=J2(r,i);if(0===o||0===s)return;let l,c,f,d,a=(r.x||0)-mb(r.align,o),u=(r.y||0)-yb(r.baseline,s);!1!==r.aspect&&(c=i.width/i.height,f=r.width/r.height,c==c&&f==f&&c!==f&&(f<c?(d=o/c,u+=(s-d)/2,s=d):(d=s*c,a+=(o-d)/2,o=d))),(i.complete||i.toDataURL)&&(lh(e,r),e.globalAlpha=null!=(l=r.opacity)?l:1,e.imageSmoothingEnabled=!1!==r.smooth,e.drawImage(i,a,u,o,s))})},pick:gb(),isect:Yi,get:K2,xOffset:mb,yOffset:yb},lbe=Q2("line",function(e,t){const n=t[0];return w1e.curve(T2(n.interpolate||"linear",n.orient,n.tension)).context(e)(t)},function(e,t){for(var i,o,n=Math.pow(e[0].strokeWidth||1,2),r=e.length;--r>=0;)if(!1!==e[r].defined&&(i=e[r].x-t[0])*i+(o=e[r].y-t[1])*o<n)return e[r];return null});function vb(e,t){var n=t.path;if(null==n)return!0;var r=t.x||0,i=t.y||0,o=t.scaleX||1,s=t.scaleY||1,a=(t.angle||0)*Ku,u=t.pathCache;(!u||u.path!==n)&&((t.pathCache=u=oh(n)).path=n),a&&e.rotate&&e.translate?(e.translate(r,i),e.rotate(a),am(e,u,0,0,o,s),e.rotate(-a),e.translate(-r,-i)):am(e,u,r,i,o,s)}var dbe={type:"path",tag:"path",nested:!1,attr:function(e,t){(1!==(t.scaleX||1)||1!==(t.scaleY||1))&&e("vector-effect","non-scaling-stroke"),e("transform",function(e){return kc(e.x||0,e.y||0)+(e.angle?" "+Y2(e.angle):"")+(e.scaleX||e.scaleY?" "+function(e,t){return"scale("+e+","+t+")"}(e.scaleX||1,e.scaleY||1):"")}(t)),e("d",t.path)},bound:function(e,t){return vb(dm(e,t.angle),t)?e.set(0,0,0,0):Ba(e,t,!0)},draw:W2(vb),pick:G2(vb),isect:H2(vb)};function H9(e,t){e.beginPath(),ah(e,t)}var gbe={type:"rect",tag:"path",nested:!1,attr:function(e,t){e("d",ah(null,t))},bound:function(e,t){var n,r;return Ba(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)},draw:W2(H9),pick:G2(H9),isect:R9};function V9(e,t,n){var r,i,o,s;return!(!t.stroke||!ch(e,t,n)||(r=t.x||0,i=t.y||0,o=null!=t.x2?t.x2:r,s=null!=t.y2?t.y2:i,e.beginPath(),e.moveTo(r,i),e.lineTo(o,s),0))}var _be={type:"rule",tag:"line",nested:!1,attr:function(e,t){e("transform",$9(t)),e("x2",null!=t.x2?t.x2-(t.x||0):0),e("y2",null!=t.y2?t.y2-(t.y||0):0)},bound:function(e,t){var n,r;return Ba(e.set(n=t.x||0,r=t.y||0,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r),t)},draw:function(e,t,n){No(t,r=>{if(!n||n.intersects(r.bounds)){var i=null==r.opacity?1:r.opacity;i&&V9(e,r,i)&&(lh(e,r),e.stroke())}})},pick:gb(function(e,t,n,r){return!!e.isPointInStroke&&V9(e,t,1)&&e.isPointInStroke(n,r)}),isect:N9},wbe=X2("shape",function(e,t){return(t.mark.shape||t.shape).context(e)(t)}),xbe=X2("symbol",function(e,t){return E1e.context(e)(t)},V2);const q9=O6();var Ps={height:Ls,measureWidth:tM,estimateWidth:eM,width:eM,canvas:W9};function W9(e){Ps.width=e&&el?tM:eM}function eM(e,t){return G9(nl(e,t),Ls(e))}function G9(e,t){return~~(.8*e.length*t)}function tM(e,t){return Ls(e)<=0||!(t=nl(e,t))?0:Y9(t,bb(e))}function Y9(e,t){const n=`(${t}) ${e}`;let r=q9.get(n);return void 0===r&&(el.font=t,r=el.measureText(e).width,q9.set(n,r)),r}function Ls(e){return null!=e.fontSize?+e.fontSize||0:11}function tl(e){return null!=e.lineHeight?e.lineHeight:Ls(e)+2}function mm(e){return function(e){return R(e)?e.length>1?e:e[0]:e}(e.lineBreak&&e.text&&!R(e.text)?e.text.split(e.lineBreak):e.text)}function nM(e){const t=mm(e);return(R(t)?t.length-1:0)*tl(e)}function nl(e,t){const n=null==t?"":(t+"").trim();return e.limit>0&&n.length?function(e,t){var n=+e.limit,r=function(e){if(Ps.width===tM){const t=bb(e);return n=>Y9(n,t)}{const t=Ls(e);return n=>G9(n,t)}}(e);if(r(t)<n)return t;var u,i=e.ellipsis||"\u2026",o="rtl"===e.dir,s=0,a=t.length;if(n-=r(i),o){for(;s<a;)r(t.slice(u=s+a>>>1))>n?s=u+1:a=u;return i+t.slice(s)}for(;s<a;)r(t.slice(0,u=1+(s+a>>>1)))<n?s=u:a=u-1;return t.slice(0,s)+i}(e,n):n}function ym(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function bb(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+Ls(e)+"px "+ym(e,t)}function rM(e){var t=e.baseline,n=Ls(e);return Math.round("top"===t?.79*n:"middle"===t?.3*n:"bottom"===t?-.21*n:"line-top"===t?.29*n+.5*tl(e):"line-bottom"===t?.29*n-.5*tl(e):0)}W9(!0);const Sbe={left:"start",center:"middle",right:"end"},vm=new mn;function _b(e){var i,t=e.x||0,n=e.y||0,r=e.radius||0;return r&&(i=(e.theta||0)-Ac,t+=r*Math.cos(i),n+=r*Math.sin(i)),vm.x1=t,vm.y1=n,vm}function iM(e,t,n){var f,r=Ps.height(t),i=t.align,o=_b(t),s=o.x1,a=o.y1,u=t.dx||0,l=(t.dy||0)+rM(t)-Math.round(.8*r),c=mm(t);if(R(c)?(r+=tl(t)*(c.length-1),f=c.reduce((d,h)=>Math.max(d,Ps.width(t,h)),0)):f=Ps.width(t,c),"center"===i?u-=f/2:"right"===i&&(u-=f),e.set(u+=s,l+=a,u+f,l+r),t.angle&&!n)e.rotate(t.angle*Ku,s,a);else if(2===n)return e.rotatedPoints(t.angle*Ku,s,a);return e}var kbe={type:"text",tag:"text",nested:!1,attr:function(e,t){var u,n=t.dx||0,r=(t.dy||0)+rM(t),i=_b(t),o=i.x1,s=i.y1,a=t.angle||0;e("text-anchor",Sbe[t.align]||"start"),a?(u=kc(o,s)+" "+Y2(a),(n||r)&&(u+=" "+kc(n,r))):u=kc(o+n,s+r),e("transform",u)},bound:iM,draw:function(e,t,n){No(t,r=>{var o,s,a,u,l,c,f,i=null==r.opacity?1:r.opacity;if(!(n&&!n.intersects(r.bounds)||0===i||r.fontSize<=0||null==r.text||0===r.text.length)){if(e.font=bb(r),e.textAlign=r.align||"left",s=(o=_b(r)).x1,a=o.y1,r.angle&&(e.save(),e.translate(s,a),e.rotate(r.angle*Ku),s=a=0),s+=r.dx||0,a+=(r.dy||0)+rM(r),c=mm(r),lh(e,r),R(c))for(l=tl(r),u=0;u<c.length;++u)f=nl(r,c[u]),r.fill&&hb(e,r,i)&&e.fillText(f,s,a),r.stroke&&ch(e,r,i)&&e.strokeText(f,s,a),a+=l;else f=nl(r,c),r.fill&&hb(e,r,i)&&e.fillText(f,s,a),r.stroke&&ch(e,r,i)&&e.strokeText(f,s,a);r.angle&&e.restore()}})},pick:gb(function(e,t,n,r,i,o){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var s=_b(t),a=s.x1,u=s.y1,l=iM(vm,t,1),c=-t.angle*Ku,f=Math.cos(c),d=Math.sin(c);return l.contains(f*i-d*o+(a-f*a+d*u),d*i+f*o+(u-d*a-f*u))}),isect:function(e,t){const n=iM(vm,e,2);return uh(t,n[0],n[1],n[2],n[3])||uh(t,n[0],n[1],n[4],n[5])||uh(t,n[4],n[5],n[6],n[7])||uh(t,n[2],n[3],n[6],n[7])}},Ibe=Q2("trail",function(e,t){return D1e.context(e)(t)},function(e,t){for(var r,i,n=e.length;--n>=0;)if(!1!==e[n].defined&&(r=e[n].x-t[0])*r+(i=e[n].y-t[1])*i<(r=e[n].size||1)*r)return e[n];return null}),Si={arc:z1e,area:q1e,group:ibe,image:ube,line:lbe,path:dbe,rect:gbe,rule:_be,shape:wbe,symbol:xbe,text:kbe,trail:Ibe};function oM(e,t,n){var r=Si[e.mark.marktype];return r.nested&&(e=e.mark),(t||r.bound)(e.bounds||(e.bounds=new mn),e,n)}var X9={mark:null};function Q9(e,t,n){var a,u,l,c,r=Si[e.marktype],i=r.bound,o=e.items,s=o&&o.length;if(r.nested)return s?l=o[0]:(X9.mark=e,l=X9),c=oM(l,i,n),t&&t.union(c)||c;if(t=t||e.bounds&&e.bounds.clear()||new mn,s)for(a=0,u=o.length;a<u;++a)t.union(oM(o[a],i,n));return e.bounds=t}const Fbe=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function K9(e,t){return JSON.stringify(e,Fbe,t)}function Z9(e){return J9("string"==typeof e?JSON.parse(e):e)}function J9(e){var r,i,o,t=e.marktype,n=e.items;if(n)for(i=0,o=n.length;i<o;++i)n[i][r=t?"mark":"group"]=e,n[i].zindex&&(n[i][r].zdirty=!0),"group"===(t||r)&&J9(n[i]);return t&&Q9(e),e}function sM(e){arguments.length?this.root=Z9(e):(this.root=e7({marktype:"group",name:"root",role:"frame"}),this.root.items=[new ab(this.root)])}function e7(e,t){const n={bounds:new mn,clip:!!e.clip,group:t,interactive:!1!==e.interactive,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return null!=e.aria&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function rl(e,t,n){return!e&&"undefined"!=typeof document&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function aM(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function Qr(e,t,n,r){var o,i=e.childNodes[t];return(!i||i.tagName.toLowerCase()!==n.toLowerCase())&&(o=i||null,i=rl(e.ownerDocument,n,r),e.insertBefore(i,o)),i}function Po(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function t7(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function wb(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function il(e,t){this._active=null,this._handlers={},this._loader=e||p1(),this._tooltip=t||Nbe}function Nbe(e,t,n,r){e.element().setAttribute("title",r||"")}function js(e){this._el=null,this._bgcolor=null,this._loader=new P2(e)}sM.prototype={toJSON(e){return K9(this.root,e||0)},mark(e,t,n){const r=e7(e,t=t||this.root.items[0]);return t.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}},il.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let r=e?e.length:0;--r>=0;)if(e[r].type===t&&(!n||e[r].handler===n))return r;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const r in t)n.push(...t[r]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then(r=>{const i=new MouseEvent(e.type,e),o=rl(null,"a");for(const s in r)o.setAttribute(s,r[s]);o.dispatchEvent(i)}).catch(()=>{})},handleTooltip(e,t,n){t&&null!=t.tooltip&&(t=function(e,t,n,r){var o,s,i=e&&e.mark;if(i&&(o=Si[i.marktype]).tip){for((s=wb(t,n))[0]-=r[0],s[1]-=r[1];e=e.mark.group;)s[0]-=e.x||0,s[1]-=e.y||0;e=o.tip(i.items,s)}return e}(t,e,this.canvas(),this._origin),this._tooltip.call(this._obj,this,e,t,n&&t&&t.tooltip||null))},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),r=this._origin,i=e.bounds,o=i.width(),s=i.height();let a=i.x1+r[0]+n.left,u=i.y1+r[1]+n.top;for(;e.mark&&(e=e.mark.group);)a+=e.x||0,u+=e.y||0;return{x:a,y:u,width:o,height:s,left:a,top:u,right:a+o,bottom:u+s}}},js.prototype={initialize(e,t,n,r,i){return this._el=e,this.resize(t,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return 0===arguments.length?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,r){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(e){const t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){const t=this.render(e);return this._ready?this._ready.then(()=>t):Promise.resolve(t)},_load(e,t){var n=this,r=n._loader[e](t);if(!n._ready){const i=n._call;n._ready=n._loader.ready().then(o=>{o&&i(),n._ready=null})}return r},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const n7="dragenter",xb="dragleave",r7="dragover",uM="mousedown",Eb="mousemove",bm="mouseout",i7="mouseover",Db="click",o7="mousewheel",Cb="touchstart",Sb="touchmove",Ab="touchend",lM=Eb,_m=bm,cM=Db;function wm(e,t){il.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}function s7(e,t){(e=>e===Cb||e===Sb||e===Ab?[Cb,Sb,Ab]:[e])(t).forEach(n=>function(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?r=>e[t](r):r=>e.fire(t,r)))}(e,n))}function a7(e,t,n){return function(r){const i=this._active,o=this.pickEvent(r);o===i||((!i||!i.exit)&&this.fire(n,r),this._active=o,this.fire(t,r)),this.fire(e,r)}}function u7(e){return function(t){this.fire(e,t),this._active=null}}z(wm,il,{initialize(e,t,n){return this._canvas=e&&aM(e,"canvas"),[Db,uM,Eb,bm,xb].forEach(r=>s7(this,r)),il.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:["keydown","keypress","keyup",n7,xb,r7,uM,"mouseup",Eb,bm,i7,Db,"dblclick","wheel",o7,Cb,Sb,Ab],DOMMouseScroll(e){this.fire(o7,e)},mousemove:a7(Eb,i7,bm),dragover:a7(r7,n7,xb),mouseout:u7(bm),dragleave:u7(xb),mousedown(e){this._down=this._active,this.fire(uM,e)},click(e){this._down===this._active&&(this.fire(Db,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(Cb,e,!0)},touchmove(e){this.fire(Sb,e,!0)},touchend(e){this.fire(Ab,e,!0),this._touch=null},fire(e,t,n){const r=n?this._touch:this._active,i=this._handlers[e];if(t.vegaType=e,e===cM&&r&&r.href?this.handleHref(t,r,r.href):(e===lM||e===_m)&&this.handleTooltip(t,r,e!==_m),i)for(let o=0,s=i.length;o<s;++o)i[o].handler.call(this._obj,t,r)},on(e,t){const n=this.eventName(e),r=this._handlers;return this._handlerIndex(r[n],e,t)<0&&(s7(this,e),(r[n]||(r[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&r.splice(i,1),this},pickEvent(e){const t=wb(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,r,i){const o=this.context();return Si[e.marktype].pick.call(this,o,e,t,n,r,i)}});var Wbe="undefined"!=typeof window&&window.devicePixelRatio||1;function Ob(e){js.call(this,e),this._options={},this._redraw=!1,this._dirty=new mn,this._tempb=new mn}const l7=js.prototype;function fM(e,t){il.call(this,e,t);const n=this;n._hrefHandler=dM(n,(r,i)=>{i&&i.href&&n.handleHref(r,i,i.href)}),n._tooltipHandler=dM(n,(r,i)=>{n.handleTooltip(r,i,r.type!==_m)})}z(Ob,js,{initialize(e,t,n,r,i,o){return this._options=o||{},this._canvas=this._options.externalContext?null:Qd(1,1),e&&this._canvas&&(Po(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),l7.initialize.call(this,e,t,n,r,i)},resize(e,t,n,r){if(l7.resize.call(this,e,t,n,r),this._canvas)!function(e,t,n,r,i,o){const s="undefined"!=typeof HTMLElement&&e instanceof HTMLElement&&null!=e.parentNode,a=e.getContext("2d"),u=s?Wbe:i;e.width=t*u,e.height=n*u;for(const l in o)a[l]=o[l];s&&1!==u&&(e.style.width=t+"px",e.style.height=n+"px"),a.pixelRatio=u,a.setTransform(u,0,0,u,u*r[0],u*r[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const i=this._options.externalContext;i||F("CanvasRenderer is missing a valid canvas or context"),i.scale(this._scale,this._scale),i.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){const t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){const t=this.context(),n=this._origin,r=this._width,i=this._height,o=this._dirty,s=((e,t,n)=>(new mn).set(0,0,t,n).translate(-e[0],-e[1]))(n,r,i);t.save();const a=this._redraw||o.empty()?(this._redraw=!1,s.expand(1)):function(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-n[0]%1,-n[1]%1),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}(t,s.intersect(o),n);return this.clear(-n[0],-n[1],r,i),this.draw(t,e,a),t.restore(),o.clear(),this},draw(e,t,n){const r=Si[t.marktype];t.clip&&function(e,t){var n=t.clip;e.save(),xe(n)?(e.beginPath(),n(e),e.clip()):B9(e,t.group)}(e,t),r.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,r){const i=this._options,o=this.context();"pdf"!==i.type&&!i.externalContext&&o.clearRect(e,t,n,r),null!=this._bgcolor&&(o.fillStyle=this._bgcolor,o.fillRect(e,t,n,r))}});const dM=(e,t)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)};z(fM,il,{initialize(e,t,n){let r=this._svg;return r&&(r.removeEventListener(cM,this._hrefHandler),r.removeEventListener(lM,this._tooltipHandler),r.removeEventListener(_m,this._tooltipHandler)),this._svg=r=e&&aM(e,"svg"),r&&(r.addEventListener(cM,this._hrefHandler),r.addEventListener(lM,this._tooltipHandler),r.addEventListener(_m,this._tooltipHandler)),il.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),r=this._handlers;if(this._handlerIndex(r[n],e,t)<0){const o={type:e,handler:t,listener:dM(this,t)};(r[n]||(r[n]=[])).push(o),this._svg&&this._svg.addEventListener(n,o.listener)}return this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const c7="aria-hidden",hM="aria-label",pM="role",gM="aria-roledescription",f7="graphics-object",mM="graphics-symbol",d7=(e,t,n)=>({[pM]:e,[gM]:t,[hM]:n||void 0}),Qbe=To(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),h7={axis:{desc:"axis",caption:function(e){const t=e.datum,n=e.orient,r=t.title?v7(e):null,i=e.context,o=i.scales[t.scale].value,s=i.dataflow.locale(),a=o.type;return("left"===n||"right"===n?"Y":"X")+"-axis"+(r?` titled '${r}'`:"")+` for a ${ih(a)?"discrete":a} scale with ${p9(s,o,e)}`}},legend:{desc:"legend",caption:function(e){const t=e.datum,n=t.title?v7(e):null,r=`${t.type||""} legend`.trim(),i=t.scales,o=Object.keys(i),s=e.context,a=s.scales[i[o[0]]].value,u=s.dataflow.locale();return function(e){return e.length?e[0].toUpperCase()+e.slice(1):e}(r)+(n?` titled '${n}'`:"")+` for ${function(e){return e=e.map(t=>t+("fill"===t||"stroke"===t?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+je(e)}(o)} with ${p9(u,a,e)}`}},"title-text":{desc:"title",caption:e=>`Title text '${y7(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${y7(e)}'`}},p7={ariaRole:pM,ariaRoleDescription:gM,description:hM};function g7(e,t){const n=!1===t.aria;if(e(c7,n||void 0),n||null==t.description)for(const r in p7)e(p7[r],void 0);else{const r=t.mark.marktype;e(hM,t.description),e(pM,t.ariaRole||("group"===r?f7:mM)),e(gM,t.ariaRoleDescription||`${r} mark`)}}function m7(e){return!1===e.aria?{[c7]:!0}:Qbe[e.role]?null:h7[e.role]?function(e,t){try{const n=e.items[0],r=t.caption||(()=>"");return d7(t.role||mM,t.desc,n.description||r(n))}catch(n){return null}}(e,h7[e.role]):function(e){const t=e.marktype,n="group"===t||"text"===t||e.items.some(r=>null!=r.description&&!1!==r.aria);return d7(n?f7:mM,`${t} mark container`,e.description)}(e)}function y7(e){return X(e.text).join(" ")}function v7(e){try{return X(je(e.items).items[0].text).join(" ")}catch(t){return null}}const b7=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");function yM(){let e="",t="",n="";const r=[],i=()=>t=n="",s=(u,l)=>(null!=l&&(t+=` ${u}="${(e=>b7(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"))(l)}"`),a),a={open(u,...l){(u=>{t&&(e+=`${t}>${n}`,i()),r.push(u)})(u),t="<"+u;for(const c of l)for(const f in c)s(f,c[f]);return a},close(){const u=r.pop();return e+=t?t+(n?`>${n}</${u}>`:"/>"):`</${u}>`,i(),a},attr:s,text:u=>(n+=b7(u),a),toString:()=>e};return a}const _7=e=>w7(yM(),e)+"";function w7(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,r=n.length;for(let i=0;i<r;++i)e.attr(n[i].name,n[i].value)}if(t.hasChildNodes()){const n=t.childNodes,r=n.length;for(let i=0;i<r;i++){const o=n[i];3===o.nodeType?e.text(o.nodeValue):w7(e,o)}}return e.close()}const Mb={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},x7={fill:"none","stroke-miterlimit":10},E7="http://www.w3.org/2000/xmlns/",yn=gm.xmlns;function vM(e){js.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const bM=js.prototype;function D7(e,t){for(;e&&e.dirty!==t;e=e.mark.group){if(e.dirty=t,!e.mark||e.mark.dirty===t)return;e.mark.dirty=t}}function i_e(e,t,n){let r,i,o;if("radial"===t.gradient){let s=Qr(e,n++,"pattern",yn);ol(s,{id:"p_"+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),s=Qr(s,0,"rect",yn),ol(s,{width:1,height:1,fill:`url(${S7()}#${t.id})`}),ol(e=Qr(e,n++,"radialGradient",yn),{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else ol(e=Qr(e,n++,"linearGradient",yn),{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,i=t.stops.length;r<i;++r)o=Qr(e,r,"stop",yn),o.setAttribute("offset",t.stops[r].offset),o.setAttribute("stop-color",t.stops[r].color);return Po(e,r),n}function o_e(e,t,n){let r;return(e=Qr(e,n,"clipPath",yn)).setAttribute("id",t.id),t.path?(r=Qr(e,0,"path",yn),r.setAttribute("d",t.path)):(r=Qr(e,0,"rect",yn),ol(r,{x:0,y:0,width:t.width,height:t.height})),Po(e,1),n+1}function C7(e,t,n,r,i){let s,o=e._svg;if(!o&&(s=t.ownerDocument,o=rl(s,r,yn),e._svg=o,e.mark&&(o.__data__=e,o.__values__={fill:"default"},"g"===r))){const a=rl(s,"path",yn);o.appendChild(a),a.__data__=e;const u=rl(s,"g",yn);o.appendChild(u),u.__data__=e;const l=rl(s,"path",yn);o.appendChild(l),l.__data__=e,l.__values__={fill:"default"}}return(o.ownerSVGElement!==i||function(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}(o,n))&&t.insertBefore(o,n?n.nextSibling:t.firstChild),o}z(vM,js,{initialize(e,t,n,r,i){return this._defs={},this._clearDefs(),e&&(this._svg=Qr(e,0,"svg",yn),this._svg.setAttributeNS(E7,"xmlns",yn),this._svg.setAttributeNS(E7,"xmlns:xlink",gm["xmlns:xlink"]),this._svg.setAttribute("version",gm.version),this._svg.setAttribute("class","marks"),Po(e,1),this._root=Qr(this._svg,0,"g",yn),ol(this._root,x7),Po(this._svg,1)),this.background(this._bgcolor),bM.initialize.call(this,e,t,n,r,i)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),bM.background.apply(this,arguments)},resize(e,t,n,r){return bM.resize.call(this,e,t,n,r),this._svg&&(ol(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=Qr(e,0,"rect",yn),ol(n,{width:this._width,height:this._height,fill:t}));const r=_7(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),r},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),Po(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,r,i,o,s,a,u;for(s=0,a=e.length;s<a;++s)if(n=e[s],r=n.mark,r.marktype!==i&&(i=r.marktype,o=Si[i]),r.zdirty&&r.dirty!==t&&(this._dirtyAll=!1,D7(n,t),r.items.forEach(l=>{l.dirty=t})),!r.zdirty){if(n.exit){o.nested&&r.items.length?(u=r.items[0],u._svg&&this._update(o,u._svg,u)):n._svg&&(u=n._svg.parentNode,u&&u.removeChild(n._svg)),n._svg=null;continue}n=o.nested?r.items[0]:n,n._update!==t&&(n._svg&&n._svg.ownerSVGElement?this._update(o,n._svg,n):(this._dirtyAll=!1,D7(n,t)),n._update=t)}return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;const r=this._svg,i=Si[t.marktype],o=!1===t.interactive?"none":null,s="g"===i.tag;let a=null,u=0;const l=C7(t,e,n,"g",r);l.setAttribute("class",t7(t));const c=m7(t);for(const d in c)Dr(l,d,c[d]);s||Dr(l,"pointer-events",o),Dr(l,"clip-path",t.clip?N2(this,t,t.group):null);const f=d=>{const h=this.isDirty(d),p=C7(d,l,a,i.tag,r);h&&(this._update(i,p,d),s&&function(e,t,n){t=t.lastChild.previousSibling;let r,i=0;No(n,o=>{r=e.mark(t,o,r),++i}),Po(t,1+i)}(this,p,d)),a=p,++u};return i.nested?t.items.length&&f(t.items[0]):No(t,f),Po(l,u),l},_update(e,t,n){za=t,ar=t.__values__,g7(Em,n),e.attr(Em,n,this);const r=u_e[e.type];r&&r.call(this,e,t,n),za&&this.style(za,n)},style(e,t){if(null!=t)for(const n in Mb){let r="font"===n?ym(t):t[n];if(r===ar[n])continue;const i=Mb[n];null==r?e.removeAttribute(i):(M2(r)&&(r=m9(r,this._defs.gradient,S7())),e.setAttribute(i,r+"")),ar[n]=r}},defs(){const e=this._svg,t=this._defs;let n=t.el,r=0;for(const i in t.gradient)n||(t.el=n=Qr(e,1,"defs",yn)),r=i_e(n,t.gradient[i],r);for(const i in t.clipping)n||(t.el=n=Qr(e,1,"defs",yn)),r=o_e(n,t.clipping[i],r);n&&(0===r?(e.removeChild(n),t.el=null):Po(n,r))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});let za=null,ar=null;const u_e={group(e,t,n){const r=za=t.childNodes[2];ar=r.__values__,e.foreground(Em,n,this),ar=t.__values__,za=t.childNodes[1],e.content(Em,n,this);const i=za=t.childNodes[0];e.background(Em,n,this);const o=!1===n.mark.interactive?"none":null;if(o!==ar.events&&(Dr(r,"pointer-events",o),Dr(i,"pointer-events",o),ar.events=o),n.strokeForeground&&n.stroke){const s=n.fill;Dr(r,"display",null),this.style(i,n),Dr(i,"stroke",null),s&&(n.fill=null),ar=r.__values__,this.style(r,n),s&&(n.fill=s),za=null}else Dr(r,"display","none")},image(e,t,n){!1===n.smooth?(_M(t,"image-rendering","optimizeSpeed"),_M(t,"image-rendering","pixelated")):_M(t,"image-rendering",null)},text(e,t,n){const r=mm(n);let i,o,s,a;R(r)?(o=r.map(u=>nl(n,u)),i=o.join("\n"),i!==ar.text&&(Po(t,0),s=t.ownerDocument,a=tl(n),o.forEach((u,l)=>{const c=rl(s,"tspan",yn);c.__data__=n,c.textContent=u,l&&(c.setAttribute("x",0),c.setAttribute("dy",a)),t.appendChild(c)}),ar.text=i)):(o=nl(n,r),o!==ar.text&&(t.textContent=o,ar.text=o)),Dr(t,"font-family",ym(n)),Dr(t,"font-size",Ls(n)+"px"),Dr(t,"font-style",n.fontStyle),Dr(t,"font-variant",n.fontVariant),Dr(t,"font-weight",n.fontWeight)}};function Em(e,t,n){t!==ar[e]&&(n?function(e,t,n,r){null!=n?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}(za,e,t,n):Dr(za,e,t),ar[e]=t)}function _M(e,t,n){n!==ar[t]&&(null==n?e.style.removeProperty(t):e.style.setProperty(t,n+""),ar[t]=n)}function ol(e,t){for(const n in t)Dr(e,n,t[n])}function Dr(e,t,n){null!=n?e.setAttribute(t,n):e.removeAttribute(t)}function S7(){let e;return"undefined"==typeof window?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function wM(e){js.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}z(wM,js,{svg(){return this._text},_render(e){const t=yM();t.open("svg",Ee({},gm,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",x7,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=Si[t.marktype],r=n.tag,i=[g7,n.attr];e.open("g",{class:t7(t),"clip-path":t.clip?N2(this,t,t.group):null},m7(t),{"pointer-events":"g"!==r&&!1===t.interactive?"none":null});const o=s=>{const a=this.href(s);if(a&&e.open("a",a),e.open(r,this.attr(t,s,i,"g"!==r?r:null)),"text"===r){const u=mm(s);if(R(u)){const l={x:0,dy:tl(s)};for(let c=0;c<u.length;++c)e.open("tspan",c?l:null).text(nl(s,u[c])).close()}else e.text(nl(s,u))}else if("g"===r){const u=s.strokeForeground,l=s.fill,c=s.stroke;u&&c&&(s.stroke=null),e.open("path",this.attr(t,s,n.background,"bgrect")).close(),e.open("g",this.attr(t,s,n.content)),No(s,f=>this.mark(e,f)),e.close(),u&&c?(l&&(s.fill=null),s.stroke=c,e.open("path",this.attr(t,s,n.foreground,"bgrect")).close(),l&&(s.fill=l)):e.open("path",this.attr(t,s,n.foreground,"bgfore")).close()}e.close(),a&&e.close()};return n.nested?t.items&&t.items.length&&o(t.items[0]):No(t,o),e.close()},href(e){const t=e.href;let n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then(r=>{r["xlink:href"]=r.href,r.href=null,(this._hrefs||(this._hrefs={}))[t]=r})}return null},attr(e,t,n,r){const i={},o=(s,a,u,l)=>{i[l||s]=a};return Array.isArray(n)?n.forEach(s=>s(o,t,this)):n(o,t,this),r&&function(e,t,n,r,i){if(null==t||("bgrect"===r&&!1===n.interactive&&(e["pointer-events"]="none"),"bgfore"===r&&(!1===n.interactive&&(e["pointer-events"]="none"),e.display="none",null!==t.fill)))return e;"image"===r&&!1===t.smooth&&(e.style="image-rendering: optimizeSpeed; image-rendering: pixelated;"),"text"===r&&(e["font-family"]=ym(t),e["font-size"]=Ls(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const o in Mb){let s=t[o];const a=Mb[o];"transparent"===s&&("fill"===a||"stroke"===a)||null!=s&&(M2(s)&&(s=m9(s,i.gradient,"")),e[a]=s)}}(i,t,e,r,this._defs),i},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(Object.keys(t).length+Object.keys(n).length!==0){e.open("defs");for(const i in t){const o=t[i],s=o.stops;"radial"===o.gradient?(e.open("pattern",{id:"p_"+i,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+i+")"}).close(),e.close(),e.open("radialGradient",{id:i,fx:o.x1,fy:o.y1,fr:o.r1,cx:o.x2,cy:o.y2,r:o.r2})):e.open("linearGradient",{id:i,x1:o.x1,x2:o.x2,y1:o.y1,y2:o.y2});for(let a=0;a<s.length;++a)e.open("stop",{offset:s[a].offset,"stop-color":s[a].color}).close();e.close()}for(const i in n){const o=n[i];e.open("clipPath",{id:i}),o.path?e.open("path",{d:o.path}).close():e.open("rect",{x:0,y:0,width:o.width,height:o.height}).close(),e.close()}e.close()}}});const sl={Canvas:"canvas",PNG:"png",SVG:"svg",None:"none"},fh={};function Tb(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(fh[e]=t,this):fh[e]}function k7(e,t,n){const r=[],i=(new mn).union(t),o=e.marktype;return o?I7(e,i,n,r):"group"===o?F7(e,i,n,r):F("Intersect scene must be mark node or group item.")}function I7(e,t,n,r){if(function(e,t,n){return e.bounds&&t.intersects(e.bounds)&&("group"===e.marktype||!1!==e.interactive&&(!n||n(e)))}(e,t,n)){const i=e.items,o=e.marktype,s=i.length;let a=0;if("group"===o)for(;a<s;++a)F7(i[a],t,n,r);else for(const u=Si[o].isect;a<s;++a){const l=i[a];R7(l,t,u)&&r.push(l)}}return r}function F7(e,t,n,r){n&&n(e.mark)&&R7(e,t,Si.group.isect)&&r.push(e);const i=e.items,o=i&&i.length;if(o){const s=e.x||0,a=e.y||0;t.translate(-s,-a);for(let u=0;u<o;++u)I7(i[u],t,n,r);t.translate(s,a)}return r}function R7(e,t,n){const r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}fh.canvas=fh.png={renderer:Ob,headless:Ob,handler:wm},fh.svg={renderer:vM,headless:wM,handler:fM},fh.none={};const xM=new mn;function N7(e){const t=e.clip;if(xe(t))t(dm(xM.clear()));else{if(!t)return;xM.set(0,0,e.group.width,e.group.height)}e.bounds.intersect(xM)}function EM(e,t,n){return e===t||("path"===n?P7(e,t):e instanceof Date&&t instanceof Date?+e==+t:ft(e)&&ft(t)?Math.abs(e-t)<=1e-9:e&&t&&(J(e)||J(t))?function(e,t){var i,o,n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(n.sort(),r.sort(),o=n.length-1;o>=0;o--)if(n[o]!=r[o])return!1;for(o=n.length-1;o>=0;o--)if(!EM(e[i=n[o]],t[i],i))return!1;return typeof e==typeof t}(e,t):e==t)}function P7(e,t){return EM(oh(e),oh(t))}function p_e(){A9(),g9=0}const dh="top",Lo="left",jo="right",al="bottom",DM="start",CM="middle",Cr="end",kb="group",SM="axis",AM="title",OM="legend",L7="row-header",j7="row-footer",$7="row-title",B7="column-header",z7="column-footer",U7="column-title",MM="none",Ib="all",TM="each",kM="flush",ul="column",ll="row";function V7(e){k.call(this,null,e)}function Fb(e,t,n){return t(e.bounds.clear(),e,n)}z(V7,k,{transform(e,t){const n=t.dataflow,r=e.mark,i=r.marktype,o=Si[i],s=o.bound;let u,a=r.bounds;if(o.nested)r.items.length&&n.dirty(r.items[0]),a=Fb(r,s),r.items.forEach(l=>{l.bounds.clear().union(a)});else if(i===kb||e.modified())switch(t.visit(t.MOD,l=>n.dirty(l)),a.clear(),r.items.forEach(l=>a.union(Fb(l,s))),r.role){case SM:case OM:case AM:t.reflow()}else u=t.changed(t.REM),t.visit(t.ADD,l=>{a.union(Fb(l,s))}),t.visit(t.MOD,l=>{u=u||a.alignsWith(l.bounds),n.dirty(l),a.union(Fb(l,s))}),u&&(a.clear(),r.items.forEach(l=>a.union(l.bounds)));return N7(r),t.modifies("bounds")}});const q7=":vega_identifier:";function IM(e){k.call(this,0,e)}function W7(e){k.call(this,null,e)}function G7(e){k.call(this,null,e)}IM.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},z(IM,k,{transform(e,t){const n=function(e){return e._signals[q7]||(e._signals[q7]=e.add(0))}(t.dataflow),r=e.as;let i=n.value;return t.visit(t.ADD,o=>o[r]=o[r]||++i),n.set(this.value=i),t}}),z(W7,k,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,function(e){const t=e.groups,n=e.parent;return t&&1===t.size?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const r=n.marktype===kb?ab:sb;return t.visit(t.ADD,i=>r.call(i,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});const Y7={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((r,i)=>i&&X7(n.bounds,r.bounds,t)?r.opacity=0:(n=r,1))}},X7=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),Q7=(e,t)=>{for(var o,n=1,r=e.length,i=e[0].bounds;n<r;i=o,++n)if(X7(i,o=e[n].bounds,t))return!0},T_e=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},K7=e=>(e.forEach(t=>t.opacity=1),e),Z7=(e,t)=>e.reflow(t.modified()).modifies("opacity");function J7(e){k.call(this,null,e)}z(G7,k,{transform(e,t){const n=Y7[e.method]||Y7.parity,r=e.separation||0;let o,s,i=t.materialize(t.SOURCE).source;if(!i||!i.length)return;if(!e.method)return e.modified("method")&&(K7(i),t=Z7(t,e)),t;if(i=i.filter(T_e),!i.length)return;if(e.sort&&(i=i.slice().sort(e.sort)),o=K7(i),t=Z7(t,e),o.length>=3&&Q7(o,r)){do{o=n(o,r)}while(o.length>=3&&Q7(o,r));o.length<3&&!je(i).opacity&&(o.length>1&&(je(o).opacity=0),je(i).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(s=((e,t,n)=>{var r=e.range(),i=new mn;return t===dh||t===al?i.set(r[0],-1/0,r[1],1/0):i.set(-1/0,r[0],1/0,r[1]),i.expand(n||1),o=>i.encloses(o.bounds)})(e.boundScale,e.boundOrient,+e.boundTolerance),i.forEach(u=>{s(u)||(u.opacity=0)}));const a=o[0].mark.bounds.clear();return i.forEach(u=>{u.opacity&&a.union(u.bounds)}),t}}),z(J7,k,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,r=>n.dirty(r)),t.fields&&t.fields.zindex){const r=t.source&&t.source[0];r&&(r.mark.zdirty=!0)}}});const ur=new mn;function hh(e,t,n){return e[t]===n?0:(e[t]=n,1)}function I_e(e){var t=e.items[0].orient;return t===Lo||t===jo}function R_e(e,t,n,r){var _,w,i=t.items[0],o=i.datum,s=null!=i.translate?i.translate:.5,a=i.orient,u=function(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}(o),l=i.range,c=i.offset,f=i.position,d=i.minExtent,h=i.maxExtent,p=o.title&&i.items[u[2]].items[0],g=i.titlePadding,m=i.bounds,v=p&&nM(p),y=0,b=0;switch(ur.clear().union(m),m.clear(),(_=u[0])>-1&&m.union(i.items[_].bounds),(_=u[1])>-1&&m.union(i.items[_].bounds),a){case dh:y=f||0,b=-c,w=Math.max(d,Math.min(h,-m.y1)),m.add(0,-w).add(l,0),p&&Rb(e,p,w,g,v,0,-1,m);break;case Lo:y=-c,b=f||0,w=Math.max(d,Math.min(h,-m.x1)),m.add(-w,0).add(0,l),p&&Rb(e,p,w,g,v,1,-1,m);break;case jo:y=n+c,b=f||0,w=Math.max(d,Math.min(h,m.x2)),m.add(0,0).add(w,l),p&&Rb(e,p,w,g,v,1,1,m);break;case al:y=f||0,b=r+c,w=Math.max(d,Math.min(h,m.y2)),m.add(0,0).add(l,w),p&&Rb(e,p,w,g,0,0,1,m);break;default:y=i.x,b=i.y}return Ba(m.translate(y,b),i),hh(i,"x",y+s)|hh(i,"y",b+s)&&(i.bounds=ur,e.dirty(i),i.bounds=m,e.dirty(i)),i.mark.bounds.clear().union(m)}function Rb(e,t,n,r,i,o,s,a){const u=t.bounds;if(t.auto){const l=s*(n+i+r);let c=0,f=0;e.dirty(t),o?c=(t.x||0)-(t.x=l):f=(t.y||0)-(t.y=l),t.mark.bounds.clear().union(u.translate(-c,-f)),e.dirty(t)}a.union(u)}const eH=(e,t)=>Math.floor(Math.min(e,t)),tH=(e,t)=>Math.ceil(Math.max(e,t));function P_e(e){return(new mn).set(0,0,e.width||0,e.height||0)}function L_e(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function Tt(e,t,n){const r=J(e)?e[t]:e;return null!=r?r:void 0!==n?n:0}function nH(e){return e<0?Math.ceil(-e):0}function rH(e,t,n){var E,x,D,S,C,A,M,T,L,O,N,r=!n.nodirty,i=n.bounds===kM?P_e:L_e,o=ur.set(0,0,0,0),s=Tt(n.align,ul),a=Tt(n.align,ll),u=Tt(n.padding,ul),l=Tt(n.padding,ll),c=n.columns||t.length,f=c<=0?1:Math.ceil(t.length/c),d=t.length,h=Array(d),p=Array(c),g=0,m=Array(d),v=Array(f),y=0,b=Array(d),_=Array(d),w=Array(d);for(x=0;x<c;++x)p[x]=0;for(x=0;x<f;++x)v[x]=0;for(x=0;x<d;++x)C=w[x]=i(A=t[x]),A.x=A.x||0,b[x]=0,A.y=A.y||0,_[x]=0,D=x%c,S=~~(x/c),g=Math.max(g,M=Math.ceil(C.x2)),y=Math.max(y,T=Math.ceil(C.y2)),p[D]=Math.max(p[D],M),v[S]=Math.max(v[S],T),h[x]=u+nH(C.x1),m[x]=l+nH(C.y1),r&&e.dirty(t[x]);for(x=0;x<d;++x)x%c==0&&(h[x]=0),x<c&&(m[x]=0);if(s===TM)for(D=1;D<c;++D){for(N=0,x=D;x<d;x+=c)N<h[x]&&(N=h[x]);for(x=D;x<d;x+=c)h[x]=N+p[D-1]}else if(s===Ib){for(N=0,x=0;x<d;++x)x%c&&N<h[x]&&(N=h[x]);for(x=0;x<d;++x)x%c&&(h[x]=N+g)}else for(s=!1,D=1;D<c;++D)for(x=D;x<d;x+=c)h[x]+=p[D-1];if(a===TM)for(S=1;S<f;++S){for(N=0,E=(x=S*c)+c;x<E;++x)N<m[x]&&(N=m[x]);for(x=S*c;x<E;++x)m[x]=N+v[S-1]}else if(a===Ib){for(N=0,x=c;x<d;++x)N<m[x]&&(N=m[x]);for(x=c;x<d;++x)m[x]=N+y}else for(a=!1,S=1;S<f;++S)for(E=(x=S*c)+c;x<E;++x)m[x]+=v[S-1];for(L=0,x=0;x<d;++x)b[x]+=(L=h[x]+(x%c?L:0))-t[x].x;for(D=0;D<c;++D)for(O=0,x=D;x<d;x+=c)_[x]+=(O+=m[x])-t[x].y;if(s&&Tt(n.center,ul)&&f>1)for(x=0;x<d;++x)(L=(C=s===Ib?g:p[x%c])-w[x].x2-t[x].x-b[x])>0&&(b[x]+=L/2);if(a&&Tt(n.center,ll)&&1!==c)for(x=0;x<d;++x)(O=(C=a===Ib?y:v[~~(x/c)])-w[x].y2-t[x].y-_[x])>0&&(_[x]+=O/2);for(x=0;x<d;++x)o.union(w[x].translate(b[x],_[x]));switch(L=Tt(n.anchor,"x"),O=Tt(n.anchor,"y"),Tt(n.anchor,ul)){case Cr:L-=o.width();break;case CM:L-=o.width()/2}switch(Tt(n.anchor,ll)){case Cr:O-=o.height();break;case CM:O-=o.height()/2}for(L=Math.round(L),O=Math.round(O),o.clear(),x=0;x<d;++x)t[x].mark.bounds.clear();for(x=0;x<d;++x)(A=t[x]).x+=b[x]+=L,A.y+=_[x]+=O,o.union(A.mark.bounds.union(A.bounds.translate(b[x],_[x]))),r&&e.dirty(A);return o}function $_e(e,t){return"x1"===t?e.x||0:"y1"===t?e.y||0:"x2"===t?(e.x||0)+(e.width||0):"y2"===t?(e.y||0)+(e.height||0):void 0}function B_e(e,t){return e.bounds[t]}function Nb(e,t,n,r,i,o,s,a,u,l,c,f,d,h){var v,y,b,_,w,E,x,D,S,p=n.length,g=0,m=0;if(!p)return g;for(v=c;v<p;v+=f)n[v]&&(g=s(g,u(n[v],l)));if(!t.length)return g;for(t.length>i&&(e.warn("Grid headers exceed limit: "+i),t=t.slice(0,i)),g+=o,y=0,_=t.length;y<_;++y)e.dirty(t[y]),t[y].mark.bounds.clear();for(v=c,y=0,_=t.length;y<_;++y,v+=f){for(w=(E=t[y]).mark.bounds,b=v;b>=0&&null==(x=n[b]);b-=d);a?(D=null==h?x.x:Math.round(x.bounds.x1+h*x.bounds.width()),S=g):(D=g,S=null==h?x.y:Math.round(x.bounds.y1+h*x.bounds.height())),w.union(E.bounds.translate(D-(E.x||0),S-(E.y||0))),E.x=D,E.y=S,e.dirty(E),m=s(m,w[l])}return m}function iH(e,t,n,r,i,o){if(t){e.dirty(t);var s=n,a=n;r?s=Math.round(i.x1+o*i.width()):a=Math.round(i.y1+o*i.height()),t.bounds.translate(s-(t.x||0),a-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=s,t.y=a,e.dirty(t)}}function H_e(e,t,n,r,i,o,s){const a=function(e,t){const n=e[t]||{};return(r,i)=>null!=n[r]?n[r]:null!=e[r]?e[r]:i}(n,t),u=function(e,t){let n=-1/0;return e.forEach(r=>{null!=r.offset&&(n=Math.max(n,r.offset))}),n>-1/0?n:t}(e,a("offset",0)),l=a("anchor",DM),c=l===Cr?1:l===CM?.5:0,f={align:TM,bounds:a("bounds",kM),columns:"vertical"===a("direction")?1:e.length,padding:a("margin",8),center:a("center"),nodirty:!0};switch(t){case Lo:f.anchor={x:Math.floor(r.x1)-u,column:Cr,y:c*(s||r.height()+2*r.y1),row:l};break;case jo:f.anchor={x:Math.ceil(r.x2)+u,y:c*(s||r.height()+2*r.y1),row:l};break;case dh:f.anchor={y:Math.floor(i.y1)-u,row:Cr,x:c*(o||i.width()+2*i.x1),column:l};break;case al:f.anchor={y:Math.ceil(i.y2)+u,x:c*(o||i.width()+2*i.x1),column:l};break;case"top-left":f.anchor={x:u,y:u};break;case"top-right":f.anchor={x:o-u,y:u,column:Cr};break;case"bottom-left":f.anchor={x:u,y:s-u,row:Cr};break;case"bottom-right":f.anchor={x:o-u,y:s-u,column:Cr,row:Cr}}return f}function V_e(e,t){var u,l,n=t.items[0],r=n.datum,i=n.orient,o=n.bounds,s=n.x,a=n.y;return n._bounds?n._bounds.clear().union(o):n._bounds=o.clone(),o.clear(),function(e,t,n){var r=t.padding,i=r-n.x,o=r-n.y;if(t.datum.title){var s=t.items[1].items[0],a=s.anchor,u=t.titlePadding||0,l=r-s.x,c=r-s.y;switch(s.orient){case Lo:i+=Math.ceil(s.bounds.width())+u;break;case jo:case al:break;default:o+=s.bounds.height()+u}switch((i||o)&&Dm(e,n,i,o),s.orient){case Lo:c+=ph(t,n,s,a,1,1);break;case jo:l+=ph(t,n,s,Cr,0,0)+u,c+=ph(t,n,s,a,1,1);break;case al:l+=ph(t,n,s,a,0,0),c+=ph(t,n,s,Cr,-1,0,1)+u;break;default:l+=ph(t,n,s,a,0,0)}(l||c)&&Dm(e,s,l,c),(l=Math.round(s.bounds.x1-r))<0&&(Dm(e,n,-l,0),Dm(e,s,-l,0))}else(i||o)&&Dm(e,n,i,o)}(e,n,n.items[0].items[0]),o=function(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}(n,o),u=2*n.padding,l=2*n.padding,o.empty()||(u=Math.ceil(o.width()+u),l=Math.ceil(o.height()+l)),"symbol"===r.type&&function(e){const t=e.reduce((n,r)=>(n[r.column]=Math.max(r.bounds.x2-r.x,n[r.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}(n.items[0].items[0].items[0].items),i!==MM&&(n.x=s=0,n.y=a=0),n.width=u,n.height=l,Ba(o.set(s,a,s+u,a+l),n),n.mark.bounds.clear().union(o),n}function ph(e,t,n,r,i,o,s){const u=n.datum.vgrad,c=("symbol"===e.datum.type||!o&&u||s?t:t.items[0]).bounds[i?"y2":"x2"]-e.padding,f=u&&o?c:0,d=u&&o?0:c,h=i<=0?0:nM(n);return Math.round(r===DM?f:r===Cr?d-h:.5*(c-h))}function Dm(e,t,n,r){t.x+=n,t.y+=r,t.bounds.translate(n,r),t.mark.bounds.translate(n,r),e.dirty(t)}function oH(e){k.call(this,null,e)}function sH(e,t){let n=0;if(void 0===t)for(let r of e)(r=+r)&&(n+=r);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&(n+=i)}return n}function aH(e){k.call(this,null,e)}function uH(e){k.call(this,null,e)}function Z_e(){return it({})}function lH(e){k.call(this,null,e)}function cH(e){k.call(this,[],e)}z(oH,k,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach(r=>{e.layout&&function(e,t,n){var c,f,d,h,p,g,m,r=function(e){var i,o,t=e.items,n=t.length,r=0;const s={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;r<n;++r)if(o=(i=t[r]).items,i.marktype===kb)switch(i.role){case SM:case OM:case AM:break;case L7:s.rowheaders.push(...o);break;case j7:s.rowfooters.push(...o);break;case B7:s.colheaders.push(...o);break;case z7:s.colfooters.push(...o);break;case $7:s.rowtitle=o[0];break;case U7:s.coltitle=o[0];break;default:s.marks.push(...o)}return s}(t),i=r.marks,o=n.bounds===kM?$_e:B_e,s=n.offset,a=n.columns||i.length,u=a<=0?1:Math.ceil(i.length/a),l=u*a;const v=rH(e,i,n);v.empty()&&v.set(0,0,0,0),r.rowheaders&&(g=Tt(n.headerBand,ll,null),c=Nb(e,r.rowheaders,i,0,u,-Tt(s,"rowHeader"),eH,0,o,"x1",0,a,1,g)),r.colheaders&&(g=Tt(n.headerBand,ul,null),f=Nb(e,r.colheaders,i,0,a,-Tt(s,"columnHeader"),eH,1,o,"y1",0,1,a,g)),r.rowfooters&&(g=Tt(n.footerBand,ll,null),d=Nb(e,r.rowfooters,i,0,u,Tt(s,"rowFooter"),tH,0,o,"x2",a-1,a,1,g)),r.colfooters&&(g=Tt(n.footerBand,ul,null),h=Nb(e,r.colfooters,i,0,a,Tt(s,"columnFooter"),tH,1,o,"y2",l-a,1,a,g)),r.rowtitle&&(p=Tt(n.titleAnchor,ll),m=Tt(s,"rowTitle"),m=p===Cr?d+m:c-m,g=Tt(n.titleBand,ll,.5),iH(e,r.rowtitle,m,0,v,g)),r.coltitle&&(p=Tt(n.titleAnchor,ul),m=Tt(s,"columnTitle"),m=p===Cr?h+m:f-m,g=Tt(n.titleBand,ul,.5),iH(e,r.coltitle,m,1,v,g))}(n,r,e.layout),function(e,t,n){var c,f,d,p,g,r=t.items,i=Math.max(0,t.width||0),o=Math.max(0,t.height||0),s=(new mn).set(0,0,i,o),a=s.clone(),u=s.clone(),l=[];for(p=0,g=r.length;p<g;++p)switch(f=r[p],f.role){case SM:(I_e(f)?a:u).union(R_e(e,f,i,o));break;case AM:c=f;break;case OM:l.push(V_e(e,f));break;case"frame":case"scope":case L7:case j7:case $7:case B7:case z7:case U7:a.union(f.bounds),u.union(f.bounds);break;default:s.union(f.bounds)}if(l.length){const m={};l.forEach(v=>{(d=v.orient||jo)!==MM&&(m[d]||(m[d]=[])).push(v)});for(const v in m){const y=m[v];rH(e,y,H_e(y,v,n.legends,a,u,i,o))}l.forEach(v=>{const y=v.bounds;if(y.equals(v._bounds)||(v.bounds=v._bounds,e.dirty(v),v.bounds=y,e.dirty(v)),n.autosize&&"fit"===n.autosize.type)switch(v.orient){case Lo:case jo:s.add(y.x1,0).add(y.x2,0);break;case dh:case al:s.add(0,y.y1).add(0,y.y2)}else s.union(y)})}s.union(a).union(u),c&&s.union(function(e,t,n,r,i){var b,o=t.items[0],a=o.orient,u=o.anchor,l=o.offset,c=o.padding,f=o.items[0].items[0],d=o.items[1]&&o.items[1].items[0],h=a===Lo||a===jo?r:n,p=0,g=0,m=0,v=0,y=0;if(o.frame!==kb?a===Lo?(p=i.y2,h=i.y1):a===jo?(p=i.y1,h=i.y2):(p=i.x1,h=i.x2):a===Lo&&(p=r,h=0),b=u===DM?p:u===Cr?h:(p+h)/2,d&&d.text){switch(a){case dh:case al:y=f.bounds.height()+c;break;case Lo:v=f.bounds.width()+c;break;case jo:v=-f.bounds.width()-c}ur.clear().union(d.bounds),ur.translate(v-(d.x||0),y-(d.y||0)),hh(d,"x",v)|hh(d,"y",y)&&(e.dirty(d),d.bounds.clear().union(ur),d.mark.bounds.clear().union(ur),e.dirty(d)),ur.clear().union(d.bounds)}else ur.clear();switch(ur.union(f.bounds),a){case dh:g=b,m=i.y1-ur.height()-l;break;case Lo:g=i.x1-ur.width()-l,m=b;break;case jo:g=i.x2+ur.width()+l,m=b;break;case al:g=b,m=i.y2+l;break;default:g=o.x,m=o.y}return hh(o,"x",g)|hh(o,"y",m)&&(ur.translate(g,m),e.dirty(o),o.bounds.clear().union(ur),t.bounds.clear().union(ur),e.dirty(o)),o.bounds}(e,c,i,o,s)),t.clip&&s.set(0,0,t.width||0,t.height||0),function(e,t,n,r){const i=r.autosize||{},o=i.type;if(e._autosize<1||!o)return;let s=e._width,a=e._height,u=Math.max(0,t.width||0),l=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1));const d=Math.max(0,Math.ceil(n.x2-u)),h=Math.max(0,Math.ceil(n.y2-c));if("padding"===i.contains){const p=e.padding();s-=p.left+p.right,a-=p.top+p.bottom}o===MM?(l=0,f=0,u=s,c=a):"fit"===o?(u=Math.max(0,s-l-d),c=Math.max(0,a-f-h)):"fit-x"===o?(u=Math.max(0,s-l-d),a=c+f+h):"fit-y"===o?(s=u+l+d,c=Math.max(0,a-f-h)):"pad"===o&&(s=u+l+d,a=c+f+h),e._resizeView(s,a,u,c,[l,f],i.resize)}(e,t,s,n)}(n,r,e)}),function(e){return e&&"legend-entry"!==e.mark.role}(e.mark.group)?t.reflow():t}}),z(aH,k,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,o=e.scale,a=S2(o,null==e.count?e.values?e.values.length:10:e.count,e.minstep),u=e.format||a9(n,o,a,e.formatSpecifier,e.formatType,!!e.values),l=e.values?s9(o,e.values,a):A2(o,a);return i&&(r.rem=i),i=l.map((c,f)=>it({index:f/(l.length-1||1),value:c,label:u(c)})),e.extra&&i.length&&i.push(it({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}}),z(uH,k,{transform(e,t){var n=t.dataflow,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.item||Z_e,o=e.key||oe,s=this.value;return R(r.encode)&&(r.encode=null),s&&(e.modified("key")||t.modified(o))&&F("DataJoin does not support modified key function or fields."),s||(t=t.addAll(),this.value=s=function(e){const t=kd().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}(o)),t.visit(t.ADD,a=>{const u=o(a);let l=s.get(u);l?l.exit?(s.empty--,r.add.push(l)):r.mod.push(l):(l=i(a),s.set(u,l),r.add.push(l)),l.datum=a,l.exit=!1}),t.visit(t.MOD,a=>{const u=o(a),l=s.get(u);l&&(l.datum=a,r.mod.push(l))}),t.visit(t.REM,a=>{const u=o(a),l=s.get(u);a===l.datum&&!l.exit&&(r.rem.push(l),l.exit=!0,++s.empty)}),t.changed(t.ADD_MOD)&&r.modifies("datum"),(t.clean()||e.clean&&s.empty>n.cleanThreshold)&&n.runAfter(s.clean),r}}),z(lH,k,{transform(e,t){var n=t.fork(t.ADD_REM),r=e.mod||!1,i=e.encoders,o=t.encode;if(R(o)){if(!n.changed()&&!o.every(f=>i[f]))return t.StopPropagation;o=o[0],n.encode=null}var s="enter"===o,a=i.update||Tu,u=i.enter||Tu,l=i.exit||Tu,c=(o&&!s?i[o]:a)||Tu;if(t.changed(t.ADD)&&(t.visit(t.ADD,f=>{u(f,e),a(f,e)}),n.modifies(u.output),n.modifies(a.output),c!==Tu&&c!==a&&(t.visit(t.ADD,f=>{c(f,e)}),n.modifies(c.output))),t.changed(t.REM)&&l!==Tu&&(t.visit(t.REM,f=>{l(f,e)}),n.modifies(l.output)),s||c!==Tu){const f=t.MOD|(e.modified()?t.REFLOW:0);s?(t.visit(f,d=>{const h=u(d,e)||r;(c(d,e)||h)&&n.mod.push(d)}),n.mod.length&&n.modifies(u.output)):t.visit(f,d=>{(c(d,e)||r)&&n.mod.push(d)}),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}}),z(cH,k,{transform(e,t){if(null!=this.value&&!e.modified())return t.StopPropagation;var d,h,p,g,m,n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,o=e.type||nb,s=e.scale,a=+e.limit,u=S2(s,null==e.count?5:e.count,e.minstep),c=e.format||f9(n,s,u,o,e.formatSpecifier,e.formatType,!!e.values||o===nb),f=e.values||c9(s,u);return i&&(r.rem=i),o===nb?(a&&f.length>a?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),i=f.slice(0,a-1),m=!0):i=f,xe(p=e.size)?(!e.values&&0===s(i[0])&&(i=i.slice(1)),g=i.reduce((v,y)=>Math.max(v,p(y,e)),0)):p=nr(g=p||8),i=i.map((v,y)=>it({index:y,label:c(v,y,i),value:v,offset:g,size:p(v,e)})),m&&(m=f[i.length],i.push(it({index:i.length,label:"\u2026".concat(f.length-i.length," entries"),value:m,offset:g,size:p(m,e)})))):"gradient"===o?(d=s.domain(),h=n9(s,d[0],je(d)),f.length<3&&!e.values&&d[0]!==je(d)&&(f=[d[0],je(d)]),i=f.map((v,y)=>it({index:y,label:c(v,y,f),value:v,perc:h(v)}))):(p=f.length-1,h=function(e){const t=e.domain(),n=t.length-1;let r=+t[0],i=+je(t),o=i-r;if(e.type===J1){const s=n?o/n:.1;r-=s,i+=s,o=i-r}return s=>(s-r)/o}(s),i=f.map((v,y)=>it({index:y,label:c(v,y,f),value:v,perc:y?h(v):0,perc2:y===p?1:h(f[y+1])}))),r.source=i,r.add=i,this.value=i,r}});const ewe=e=>e.source.x,twe=e=>e.source.y,nwe=e=>e.target.x,rwe=e=>e.target.y;function FM(e){k.call(this,{},e)}FM.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},z(FM,k,{transform(e,t){var n=e.sourceX||ewe,r=e.sourceY||twe,i=e.targetX||nwe,o=e.targetY||rwe,s=e.as||"path",u=e.shape||"line",l=pH.get(u+"-"+(e.orient||"vertical"))||pH.get(u);return l||F("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,c=>{c[s]=l(n(c),r(c),i(c),o(c))}),t.reflow(e.modified()).modifies(s)}});const fH=(e,t,n,r)=>"M"+e+","+t+"L"+n+","+r,dH=(e,t,n,r)=>{var i=n-e,o=r-t,s=Math.sqrt(i*i+o*o)/2;return"M"+e+","+t+"A"+s+","+s+" "+180*Math.atan2(o,i)/Math.PI+" 0 1 "+n+","+r},hH=(e,t,n,r)=>{const i=n-e,o=r-t,s=.2*(i+o),a=.2*(o-i);return"M"+e+","+t+"C"+(e+s)+","+(t+a)+" "+(n+a)+","+(r-s)+" "+n+","+r},pH=kd({line:fH,"line-radial":(e,t,n,r)=>fH(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),arc:dH,"arc-radial":(e,t,n,r)=>dH(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),curve:hH,"curve-radial":(e,t,n,r)=>hH(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),"orthogonal-horizontal":(e,t,n,r)=>"M"+e+","+t+"V"+r+"H"+n,"orthogonal-vertical":(e,t,n,r)=>"M"+e+","+t+"H"+n+"V"+r,"orthogonal-radial":(e,t,n,r)=>{const i=Math.cos(e),o=Math.sin(e),s=Math.cos(n),a=Math.sin(n);return"M"+t*i+","+t*o+"A"+t+","+t+" 0 0,"+((Math.abs(n-e)>Math.PI?n<=e:n>e)?1:0)+" "+t*s+","+t*a+"L"+r*s+","+r*a},"diagonal-horizontal":(e,t,n,r)=>{const i=(e+n)/2;return"M"+e+","+t+"C"+i+","+t+" "+i+","+r+" "+n+","+r},"diagonal-vertical":(e,t,n,r)=>{const i=(t+r)/2;return"M"+e+","+t+"C"+e+","+i+" "+n+","+i+" "+n+","+r},"diagonal-radial":(e,t,n,r)=>{const i=Math.cos(e),o=Math.sin(e),s=Math.cos(n),a=Math.sin(n),u=(t+r)/2;return"M"+t*i+","+t*o+"C"+u*i+","+u*o+" "+u*s+","+u*a+" "+r*s+","+r*a}});function RM(e){k.call(this,null,e)}function gH(e){return x2(e)&&e!==Fs}RM.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},z(RM,k,{transform(e,t){var p,g,m,n=e.as||["startAngle","endAngle"],r=n[0],i=n[1],s=e.startAngle||0,a=null!=e.endAngle?e.endAngle:2*Math.PI,u=t.source,l=u.map(e.field||Od),c=l.length,f=s,d=(a-s)/sH(l),h=Ci(c);for(e.sort&&h.sort((v,y)=>l[v]-l[y]),p=0;p<c;++p)m=l[h[p]],(g=u[h[p]])[r]=f,g[i]=f+=m*d;return this.value=l,t.reflow(e.modified()).modifies(n)}});const uwe=To(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function mH(e){k.call(this,null,e),this.modified(!0)}function yH(e,t,n){return KU(e)&&Math.abs(t.reduce((i,o)=>i+(o<0?-1:o>0?1:0),0))!==t.length&&n.warn("Log scale domain includes zero: "+H(t)),t}function vH(e,t,n){return xe(e)&&(t||n)?e9(e,NM(t||[0,1],n)):e}function NM(e,t){return t?e.slice().reverse():e}function bH(e){k.call(this,null,e)}z(mH,k,{transform(e,t){var n=t.dataflow,r=this.value,i=function(e){var r,t=e.type,n="";return t===Fs?Fs+"-"+th:(function(e){const t=e.type;return x2(t)&&t!==Dc&&t!==Cc&&(e.scheme||e.range&&e.range.length&&e.range.every(Y))}(e)&&(n=2===(r=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(null!=e.domainMid):0)?Fs+"-":3===r?nh+"-":""),(n+t||th).toLowerCase())}(e);for(i in(!r||i!==r.type)&&(this.value=r=Je(i)()),e)if(!uwe[i]){if("padding"===i&&gH(r.type))continue;xe(r[i])?r[i](e[i]):n.warn("Unsupported scale property: "+i)}return function(e,t,n){var r=e.type,i=t.round||!1,o=t.range;if(null!=t.rangeStep)o=function(e,t,n){return"band"!==e&&e!==v2&&F("Only band and point scales support rangeStep."),[0,t.rangeStep*m2(n,e===v2?1:(null!=t.paddingInner?t.paddingInner:t.padding)||0,(null!=t.paddingOuter?t.paddingOuter:t.padding)||0)]}(r,t,n);else if(t.scheme&&xe(o=function(e,t,n){var o,r=t.schemeExtent;return R(t.scheme)?o=tb(t.scheme,t.interpolate,t.interpolateGamma):(o=C2(t.scheme.toLowerCase()))||F("Unrecognized scheme name: ".concat(t.scheme)),n=e===J1?n+1:e===b2?n-1:e===rh||e===Z1?+t.schemeCount||5:n,ZU(e)?vH(o,r,t.reverse):xe(o)?t9(vH(o,r),n):e===y2?o:o.slice(0,n)}(r,t,n))){if(e.interpolator)return e.interpolator(o);F("Scale type ".concat(r," does not support interpolating color schemes."))}if(o&&ZU(r))return e.interpolator(tb(NM(o,t.reverse),t.interpolate,t.interpolateGamma));o&&t.interpolate&&e.interpolate?e.interpolate(D2(t.interpolate,t.interpolateGamma)):xe(e.round)?e.round(i):xe(e.rangeRound)&&e.interpolate(i?Jg:Xu),o&&e.range(NM(o,t.reverse))}(r,e,function(e,t,n){let r=t.bins;if(r&&!R(r)){const i=e.domain(),o=i[0],s=je(i),a=r.step;let u=null==r.start?o:r.start,l=null==r.stop?s:r.stop;a||F("Scale bins parameter missing step property."),u<o&&(u=a*Math.ceil(o/a)),l>s&&(l=a*Math.floor(s/a)),r=Ci(u,l+a/2,a)}return r?e.bins=r:e.bins&&delete e.bins,e.type===b2&&(r?!t.domain&&!t.domainRaw&&(e.domain(r),n=r.length):e.bins=e.domain()),n}(r,e,function(e,t,n){const r=function(e,t,n){return t?(e.domain(yH(e.type,t,n)),t.length):-1}(e,t.domainRaw,n);if(r>-1)return r;var a,u,i=t.domain,o=e.type,s=t.zero||void 0===t.zero&&function(e){const t=e.type;return!e.bins&&(t===th||t===nm||t===rm)}(e);if(!i)return 0;if(gH(o)&&t.padding&&i[0]!==je(i)&&(i=function(e,t,n,r,i,o){var s=Math.abs(je(n)-n[0]),a=s/(s-2*r),u=e===ja?TS(t,null,a):e===rm?Jv(t,null,a,.5):e===nm?Jv(t,null,a,i||1):e===K1?kS(t,null,a,o||1):MS(t,null,a);return(t=t.slice())[0]=u[0],t[t.length-1]=u[1],t}(o,i,t.range,t.padding,t.exponent,t.constant)),(s||null!=t.domainMin||null!=t.domainMax||null!=t.domainMid)&&(a=(i=i.slice()).length-1||1,s&&(i[0]>0&&(i[0]=0),i[a]<0&&(i[a]=0)),null!=t.domainMin&&(i[0]=t.domainMin),null!=t.domainMax&&(i[a]=t.domainMax),null!=t.domainMid)){const l=(u=t.domainMid)>i[a]?a+1:u<i[0]?0:a;l!==a&&n.warn("Scale domainMid exceeds domain min or max.",u),i.splice(l,0,u)}return e.domain(yH(o,i,n)),o===y2&&e.unknown(t.domainImplicit?UO:void 0),t.nice&&e.nice&&e.nice(!0!==t.nice&&S2(e,t.nice)||null),i.length}(r,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}}),z(bH,k,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(mc(e.sort)),this.modified(n),t}});const xH="normalize",EH=["y0","y1"];function PM(e){k.call(this,null,e)}function vwe(e,t,n,r,i){for(var u,o=(t-e.sum)/2,s=e.length,a=0;a<s;++a)(u=e[a])[r]=o,u[i]=o+=Math.abs(n(u))}function bwe(e,t,n,r,i){for(var c,o=1/e.sum,s=0,a=e.length,u=0,l=0;u<a;++u)(c=e[u])[r]=s,c[i]=s=o*(l+=Math.abs(n(c)))}function _we(e,t,n,r,i){for(var l,c,o=0,s=0,a=e.length,u=0;u<a;++u)(l=+n(c=e[u]))<0?(c[r]=s,c[i]=s+=l):(c[r]=o,c[i]=o+=l)}PM.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:"zero",values:["zero","center",xH]},{name:"as",type:"string",array:!0,length:2,default:EH}]},z(PM,k,{transform(e,t){var u,l,c,f,n=e.as||EH,r=n[0],i=n[1],o=mc(e.sort),s=e.field||Od,a="center"===e.offset?vwe:e.offset===xH?bwe:_we;for(u=function(e,t,n,r){var s,a,u,l,c,f,d,h,p,i=[],o=g=>g(c);if(null==t)i.push(e.slice());else for(s={},a=0,u=e.length;a<u;++a)c=e[a],(d=s[f=t.map(o)])||(s[f]=d=[],i.push(d)),d.push(c);for(f=0,p=0,l=i.length;f<l;++f){for(a=0,h=0,u=(d=i[f]).length;a<u;++a)h+=Math.abs(r(d[a]));d.sum=h,h>p&&(p=h),n&&d.sort(n)}return i.max=p,i}(t.source,e.groupby,o,s),l=0,c=u.length,f=u.max;l<c;++l)a(u[l],f,s,r,i);return t.reflow(e.modified()).modifies(n)}});const Cm=e=>e;function Pb(e,t){e&&CH.hasOwnProperty(e.type)&&CH[e.type](e,t)}var DH={Feature:function(e,t){Pb(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)Pb(n[r].geometry,t)}},CH={Sphere:function(e,t){t.sphere()},Point:function(e,t){t.point((e=e.coordinates)[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)t.point((e=n[r])[0],e[1],e[2])},LineString:function(e,t){LM(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)LM(n[r],t,0)},Polygon:function(e,t){SH(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)SH(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)Pb(n[r],t)}};function LM(e,t,n){var o,r=-1,i=e.length-n;for(t.lineStart();++r<i;)t.point((o=e[r])[0],o[1],o[2]);t.lineEnd()}function SH(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)LM(e[n],t,1);t.polygonEnd()}function Ua(e,t){e&&DH.hasOwnProperty(e.type)?DH[e.type](e,t):Pb(e,t)}class Bn{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const o=n[i],s=t+o,a=Math.abs(t)<Math.abs(o)?t-(s-o):o-(s-t);a&&(n[r++]=a),t=s}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let r,i,o,n=this._n,s=0;if(n>0){for(s=t[--n];n>0&&(r=s,i=t[--n],s=r+i,o=i-(s-r),!o););n>0&&(o<0&&t[n-1]<0||o>0&&t[n-1]>0)&&(i=2*o,r=s+i,i==r-s&&(s=r))}return s}}var ue=1e-6,Lb=1e-12,Te=Math.PI,zt=Te/2,jb=Te/4,Sr=2*Te,Xt=180/Te,ke=Te/180,Ve=Math.abs,gh=Math.atan,no=Math.atan2,le=Math.cos,$b=Math.ceil,AH=Math.exp,jM=(Math,Math.hypot),Bb=Math.log,$M=Math.pow,re=Math.sin,ro=Math.sign||function(e){return e>0?1:e<0?-1:0},Ar=Math.sqrt,BM=Math.tan;function OH(e){return e>1?0:e<-1?Te:Math.acos(e)}function Kr(e){return e>1?zt:e<-1?-zt:Math.asin(e)}function zn(){}var MH,TH,HM,VM,zM=new Bn,UM=new Bn,cl={point:zn,lineStart:zn,lineEnd:zn,polygonStart:function(){cl.lineStart=xwe,cl.lineEnd=Dwe},polygonEnd:function(){cl.lineStart=cl.lineEnd=cl.point=zn,zM.add(Ve(UM)),UM=new Bn},result:function(){var e=zM/2;return zM=new Bn,e}};function xwe(){cl.point=Ewe}function Ewe(e,t){cl.point=kH,MH=HM=e,TH=VM=t}function kH(e,t){UM.add(VM*e-HM*t),HM=e,VM=t}function Dwe(){kH(MH,TH)}const IH=cl;var mh=1/0,zb=mh,Sm=-mh,Ub=Sm,Cwe={point:function(e,t){e<mh&&(mh=e),e>Sm&&(Sm=e),t<zb&&(zb=t),t>Ub&&(Ub=t)},lineStart:zn,lineEnd:zn,polygonStart:zn,polygonEnd:zn,result:function(){var e=[[mh,zb],[Sm,Ub]];return Sm=Ub=-(zb=mh=1/0),e}};const Hb=Cwe;var FH,RH,$s,Bs,qM=0,WM=0,Am=0,Vb=0,qb=0,yh=0,GM=0,YM=0,Om=0,$o={point:Ic,lineStart:NH,lineEnd:PH,polygonStart:function(){$o.lineStart=Mwe,$o.lineEnd=Twe},polygonEnd:function(){$o.point=Ic,$o.lineStart=NH,$o.lineEnd=PH},result:function(){var e=Om?[GM/Om,YM/Om]:yh?[Vb/yh,qb/yh]:Am?[qM/Am,WM/Am]:[NaN,NaN];return qM=WM=Am=Vb=qb=yh=GM=YM=Om=0,e}};function Ic(e,t){qM+=e,WM+=t,++Am}function NH(){$o.point=Awe}function Awe(e,t){$o.point=Owe,Ic($s=e,Bs=t)}function Owe(e,t){var n=e-$s,r=t-Bs,i=Ar(n*n+r*r);Vb+=i*($s+e)/2,qb+=i*(Bs+t)/2,yh+=i,Ic($s=e,Bs=t)}function PH(){$o.point=Ic}function Mwe(){$o.point=kwe}function Twe(){LH(FH,RH)}function kwe(e,t){$o.point=LH,Ic(FH=$s=e,RH=Bs=t)}function LH(e,t){var n=e-$s,r=t-Bs,i=Ar(n*n+r*r);Vb+=i*($s+e)/2,qb+=i*(Bs+t)/2,yh+=i,GM+=(i=Bs*e-$s*t)*($s+e),YM+=i*(Bs+t),Om+=3*i,Ic($s=e,Bs=t)}const jH=$o;function $H(e){this._context=e}$H.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._context.moveTo(e,t),this._point=1;break;case 1:this._context.lineTo(e,t);break;default:this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,Sr)}},result:zn};var QM,BH,zH,Mm,Tm,XM=new Bn,Wb={point:zn,lineStart:function(){Wb.point=Iwe},lineEnd:function(){QM&&UH(BH,zH),Wb.point=zn},polygonStart:function(){QM=!0},polygonEnd:function(){QM=null},result:function(){var e=+XM;return XM=new Bn,e}};function Iwe(e,t){Wb.point=UH,BH=Mm=e,zH=Tm=t}function UH(e,t){XM.add(Ar((Mm-=e)*Mm+(Tm-=t)*Tm)),Mm=e,Tm=t}const HH=Wb;function VH(){this._string=[]}function qH(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function WH(e,t){var r,i,n=4.5;function o(s){return s&&("function"==typeof n&&i.pointRadius(+n.apply(this,arguments)),Ua(s,r(i))),i.result()}return o.area=function(s){return Ua(s,r(IH)),IH.result()},o.measure=function(s){return Ua(s,r(HH)),HH.result()},o.bounds=function(s){return Ua(s,r(Hb)),Hb.result()},o.centroid=function(s){return Ua(s,r(jH)),jH.result()},o.projection=function(s){return arguments.length?(r=null==s?(e=null,Cm):(e=s).stream,o):e},o.context=function(s){return arguments.length?(i=null==s?(t=null,new VH):new $H(t=s),"function"!=typeof n&&i.pointRadius(n),o):t},o.pointRadius=function(s){return arguments.length?(n="function"==typeof s?s:(i.pointRadius(+s),+s),o):n},o.projection(e).context(t)}function GH(){var t,e=[];return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:zn,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function Gb(e,t){return Ve(e[0]-t[0])<ue&&Ve(e[1]-t[1])<ue}function Yb(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function YH(e,t,n,r,i){var a,u,o=[],s=[];if(e.forEach(function(p){if(!((g=p.length-1)<=0)){var g,y,m=p[0],v=p[g];if(Gb(m,v)){if(!m[2]&&!v[2]){for(i.lineStart(),a=0;a<g;++a)i.point((m=p[a])[0],m[1]);return void i.lineEnd()}v[0]+=2*ue}o.push(y=new Yb(m,p,null,!0)),s.push(y.o=new Yb(m,null,y,!1)),o.push(y=new Yb(v,p,null,!1)),s.push(y.o=new Yb(v,null,y,!0))}}),o.length){for(s.sort(t),XH(o),XH(s),a=0,u=s.length;a<u;++a)s[a].e=n=!n;for(var c,f,l=o[0];;){for(var d=l,h=!0;d.v;)if((d=d.n)===l)return;c=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(a=0,u=c.length;a<u;++a)i.point((f=c[a])[0],f[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(h)for(a=(c=d.p.z).length-1;a>=0;--a)i.point((f=c[a])[0],f[1]);else r(d.x,d.p.x,-1,i);d=d.p}c=(d=d.o).z,h=!h}while(!d.v);i.lineEnd()}}}function XH(e){if(t=e.length){for(var t,i,n=0,r=e[0];++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function Xb(e){return[no(e[1],e[0]),Kr(e[2])]}function Fc(e){var t=e[0],n=e[1],r=le(n);return[r*le(t),r*re(t),re(n)]}function Qb(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function vh(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function KM(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Kb(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Zb(e){var t=Ar(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function ZM(e){return Ve(e[0])<=Te?e[0]:ro(e[0])*((Ve(e[0])+Te)%Sr-Te)}function QH(e){return Array.from(function*(e){for(const t of e)yield*t}(e))}function KH(e,t,n,r){return function(i){var l,c,f,o=t(i),s=GH(),a=t(s),u=!1,d={point:h,lineStart:g,lineEnd:m,polygonStart:function(){d.point=v,d.lineStart=y,d.lineEnd=b,c=[],l=[]},polygonEnd:function(){d.point=h,d.lineStart=g,d.lineEnd=m,c=QH(c);var _=function(e,t){var n=ZM(t),r=t[1],i=re(r),o=[re(n),-le(n),0],s=0,a=0,u=new Bn;1===i?r=zt+ue:-1===i&&(r=-zt-ue);for(var l=0,c=e.length;l<c;++l)if(d=(f=e[l]).length)for(var f,d,h=f[d-1],p=ZM(h),g=h[1]/2+jb,m=re(g),v=le(g),y=0;y<d;++y,p=_,m=E,v=x,h=b){var b=f[y],_=ZM(b),w=b[1]/2+jb,E=re(w),x=le(w),D=_-p,S=D>=0?1:-1,C=S*D,A=C>Te,M=m*E;if(u.add(no(M*S*re(C),v*x+M*le(C))),s+=A?D+S*Sr:D,A^p>=n^_>=n){var T=vh(Fc(h),Fc(b));Zb(T);var L=vh(o,T);Zb(L);var O=(A^D>=0?-1:1)*Kr(L[2]);(r>O||r===O&&(T[0]||T[1]))&&(a+=A^D>=0?1:-1)}}return(s<-ue||s<ue&&u<-Lb)^1&a}(l,r);c.length?(u||(i.polygonStart(),u=!0),YH(c,Pwe,_,n,i)):_&&(u||(i.polygonStart(),u=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),u&&(i.polygonEnd(),u=!1),c=l=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(_,w){e(_,w)&&i.point(_,w)}function p(_,w){o.point(_,w)}function g(){d.point=p,o.lineStart()}function m(){d.point=h,o.lineEnd()}function v(_,w){f.push([_,w]),a.point(_,w)}function y(){a.lineStart(),f=[]}function b(){v(f[0][0],f[0][1]),a.lineEnd();var E,D,S,C,_=a.clean(),w=s.result(),x=w.length;if(f.pop(),l.push(f),f=null,x){if(1&_){if((D=(S=w[0]).length-1)>0){for(u||(i.polygonStart(),u=!0),i.lineStart(),E=0;E<D;++E)i.point((C=S[E])[0],C[1]);i.lineEnd()}return}x>1&&2&_&&w.push(w.pop().concat(w.shift())),c.push(w.filter(Nwe))}}return d}}function Nwe(e){return e.length>1}function Pwe(e,t){return((e=e.x)[0]<0?e[1]-zt-ue:zt-e[1])-((t=t.x)[0]<0?t[1]-zt-ue:zt-t[1])}VH.prototype={_radius:4.5,_circle:qH(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._string.push("M",e,",",t),this._point=1;break;case 1:this._string.push("L",e,",",t);break;default:null==this._circle&&(this._circle=qH(this._radius)),this._string.push("M",e,",",t,this._circle)}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}return null}};const ZH=KH(function(){return!0},function(e){var i,t=NaN,n=NaN,r=NaN;return{lineStart:function(){e.lineStart(),i=1},point:function(o,s){var a=o>0?Te:-Te,u=Ve(o-t);Ve(u-Te)<ue?(e.point(t,n=(n+s)/2>0?zt:-zt),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(a,n),e.point(o,n),i=0):r!==a&&u>=Te&&(Ve(t-r)<ue&&(t-=r*ue),Ve(o-a)<ue&&(o-=a*ue),n=function(e,t,n,r){var i,o,s=re(e-n);return Ve(s)>ue?gh((re(t)*(o=le(r))*re(n)-re(r)*(i=le(t))*re(e))/(i*o*s)):(t+r)/2}(t,n,o,s),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(a,n),i=0),e.point(t=o,n=s),r=a},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}},function(e,t,n,r){var i;if(null==e)r.point(-Te,i=n*zt),r.point(0,i),r.point(Te,i),r.point(Te,0),r.point(Te,-i),r.point(0,-i),r.point(-Te,-i),r.point(-Te,0),r.point(-Te,i);else if(Ve(e[0]-t[0])>ue){var o=e[0]<t[0]?Te:-Te;r.point(-o,i=n*o/2),r.point(0,i),r.point(o,i)}else r.point(t[0],t[1])},[-Te,-zt]);function eV(e,t){(t=Fc(t))[0]-=e,Zb(t);var n=OH(-t[1]);return((-t[2]<0?-n:n)+Sr-ue)%Sr}function Bwe(e){var t=le(e),n=6*ke,r=t>0,i=Ve(t)>ue;function s(c,f){return le(c)*le(f)>t}function u(c,f,d){var g=[1,0,0],m=vh(Fc(c),Fc(f)),v=Qb(m,m),y=m[0],b=v-y*y;if(!b)return!d&&c;var _=t*v/b,w=-t*y/b,E=vh(g,m),x=Kb(g,_);KM(x,Kb(m,w));var S=E,C=Qb(x,S),A=Qb(S,S),M=C*C-A*(Qb(x,x)-1);if(!(M<0)){var T=Ar(M),L=Kb(S,(-C-T)/A);if(KM(L,x),L=Xb(L),!d)return L;var te,O=c[0],N=f[0],U=c[1],W=f[1];N<O&&(te=O,O=N,N=te);var pe=N-O,We=Ve(pe-Te)<ue;if(!We&&W<U&&(te=U,U=W,W=te),We||pe<ue?We?U+W>0^L[1]<(Ve(L[0]-O)<ue?U:W):U<=L[1]&&L[1]<=W:pe>Te^(O<=L[0]&&L[0]<=N)){var Ht=Kb(S,(-C+T)/A);return KM(Ht,x),[L,Xb(Ht)]}}}function l(c,f){var d=r?e:Te-e,h=0;return c<-d?h|=1:c>d&&(h|=2),f<-d?h|=4:f>d&&(h|=8),h}return KH(s,function(c){var f,d,h,p,g;return{lineStart:function(){p=h=!1,g=1},point:function(m,v){var b,y=[m,v],_=s(m,v),w=r?_?0:l(m,v):_?l(m+(m<0?Te:-Te),v):0;if(!f&&(p=h=_)&&c.lineStart(),_!==h&&(!(b=u(f,y))||Gb(f,b)||Gb(y,b))&&(y[2]=1),_!==h)g=0,_?(c.lineStart(),b=u(y,f),c.point(b[0],b[1])):(b=u(f,y),c.point(b[0],b[1],2),c.lineEnd()),f=b;else if(i&&f&&r^_){var E;!(w&d)&&(E=u(y,f,!0))&&(g=0,r?(c.lineStart(),c.point(E[0][0],E[0][1]),c.point(E[1][0],E[1][1]),c.lineEnd()):(c.point(E[1][0],E[1][1]),c.lineEnd(),c.lineStart(),c.point(E[0][0],E[0][1],3)))}_&&(!f||!Gb(f,y))&&c.point(y[0],y[1]),f=y,h=_,d=w},lineEnd:function(){h&&c.lineEnd(),f=null},clean:function(){return g|(p&&h)<<1}}},function(c,f,d,h){!function(e,t,n,r,i,o){if(n){var s=le(t),a=re(t),u=r*n;null==i?(i=t+r*Sr,o=t-u/2):(i=eV(s,i),o=eV(s,o),(r>0?i<o:i>o)&&(i+=r*Sr));for(var l,c=i;r>0?c>o:c<o;c-=u)l=Xb([s,-a*le(c),-a*re(c)]),e.point(l[0],l[1])}}(h,e,n,d,c,f)},r?[0,-e]:[-Te,e-Te])}var km=1e9,Jb=-km;function tV(e,t,n,r){function i(l,c){return e<=l&&l<=n&&t<=c&&c<=r}function o(l,c,f,d){var h=0,p=0;if(null==l||(h=s(l,f))!==(p=s(c,f))||u(l,c)<0^f>0)do{d.point(0===h||3===h?e:n,h>1?r:t)}while((h=(h+f+4)%4)!==p);else d.point(c[0],c[1])}function s(l,c){return Ve(l[0]-e)<ue?c>0?0:3:Ve(l[0]-n)<ue?c>0?2:1:Ve(l[1]-t)<ue?c>0?1:0:c>0?3:2}function a(l,c){return u(l.x,c.x)}function u(l,c){var f=s(l,1),d=s(c,1);return f!==d?f-d:0===f?c[1]-l[1]:1===f?l[0]-c[0]:2===f?l[1]-c[1]:c[0]-l[0]}return function(l){var d,h,p,g,m,v,y,b,_,w,E,c=l,f=GH(),x={point:D,lineStart:function(){x.point=L,h&&h.push(p=[]),w=!0,_=!1,y=b=NaN},lineEnd:function(){d&&(L(g,m),v&&_&&f.rejoin(),d.push(f.result())),x.point=D,_&&c.lineEnd()},polygonStart:function(){c=f,d=[],h=[],E=!0},polygonEnd:function(){var O=function(){for(var O=0,N=0,U=h.length;N<U;++N)for(var Ge,Ht,W=h[N],te=1,pe=W.length,We=W[0],_t=We[0],Kt=We[1];te<pe;++te)Ge=_t,Ht=Kt,_t=(We=W[te])[0],Kt=We[1],Ht<=r?Kt>r&&(_t-Ge)*(r-Ht)>(Kt-Ht)*(e-Ge)&&++O:Kt<=r&&(_t-Ge)*(r-Ht)<(Kt-Ht)*(e-Ge)&&--O;return O}(),N=E&&O,U=(d=QH(d)).length;(N||U)&&(l.polygonStart(),N&&(l.lineStart(),o(null,null,1,l),l.lineEnd()),U&&YH(d,a,O,o,l),l.polygonEnd()),c=l,d=h=p=null}};function D(O,N){i(O,N)&&c.point(O,N)}function L(O,N){var U=i(O,N);if(h&&p.push([O,N]),w)g=O,m=N,v=U,w=!1,U&&(c.lineStart(),c.point(O,N));else if(U&&_)c.point(O,N);else{var W=[y=Math.max(Jb,Math.min(km,y)),b=Math.max(Jb,Math.min(km,b))],te=[O=Math.max(Jb,Math.min(km,O)),N=Math.max(Jb,Math.min(km,N))];!function(e,t,n,r,i,o){var p,s=e[0],a=e[1],c=0,f=1,d=t[0]-s,h=t[1]-a;if(p=n-s,d||!(p>0)){if(p/=d,d<0){if(p<c)return;p<f&&(f=p)}else if(d>0){if(p>f)return;p>c&&(c=p)}if(p=i-s,d||!(p<0)){if(p/=d,d<0){if(p>f)return;p>c&&(c=p)}else if(d>0){if(p<c)return;p<f&&(f=p)}if(p=r-a,h||!(p>0)){if(p/=h,h<0){if(p<c)return;p<f&&(f=p)}else if(h>0){if(p>f)return;p>c&&(c=p)}if(p=o-a,h||!(p<0)){if(p/=h,h<0){if(p>f)return;p>c&&(c=p)}else if(h>0){if(p<c)return;p<f&&(f=p)}return c>0&&(e[0]=s+c*d,e[1]=a+c*h),f<1&&(t[0]=s+f*d,t[1]=a+f*h),!0}}}}}(W,te,e,t,n,r)?U&&(c.lineStart(),c.point(O,N),E=!1):(_||(c.lineStart(),c.point(W[0],W[1])),c.point(te[0],te[1]),U||c.lineEnd(),E=!1)}y=O,b=N,_=U}return x}}function JM(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return(r=t.invert(r,i))&&e.invert(r[0],r[1])}),n}function eT(e,t){return[Ve(e)>Te?e+Math.round(-e/Sr)*Sr:e,t]}function nV(e,t,n){return(e%=Sr)?t||n?JM(iV(e),oV(t,n)):iV(e):t||n?oV(t,n):eT}function rV(e){return function(t,n){return[(t+=e)>Te?t-Sr:t<-Te?t+Sr:t,n]}}function iV(e){var t=rV(e);return t.invert=rV(-e),t}function oV(e,t){var n=le(e),r=re(e),i=le(t),o=re(t);function s(a,u){var l=le(u),c=le(a)*l,f=re(a)*l,d=re(u),h=d*n+c*r;return[no(f*i-h*o,c*n-d*r),Kr(h*i+f*o)]}return s.invert=function(a,u){var l=le(u),c=le(a)*l,f=re(a)*l,d=re(u),h=d*i-f*o;return[no(f*i+d*o,c*n+h*r),Kr(h*n-c*r)]},s}function Im(e){return function(t){var n=new tT;for(var r in e)n[r]=e[r];return n.stream=t,n}}function tT(){}function nT(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=r&&e.clipExtent(null),Ua(n,e.stream(Hb)),t(Hb.result()),null!=r&&e.clipExtent(r),e}function e_(e,t,n){return nT(e,function(r){var i=t[1][0]-t[0][0],o=t[1][1]-t[0][1],s=Math.min(i/(r[1][0]-r[0][0]),o/(r[1][1]-r[0][1])),a=+t[0][0]+(i-s*(r[1][0]+r[0][0]))/2,u=+t[0][1]+(o-s*(r[1][1]+r[0][1]))/2;e.scale(150*s).translate([a,u])},n)}function rT(e,t,n){return e_(e,[[0,0],t],n)}function iT(e,t,n){return nT(e,function(r){var i=+t,o=i/(r[1][0]-r[0][0]),s=(i-o*(r[1][0]+r[0][0]))/2,a=-o*r[0][1];e.scale(150*o).translate([s,a])},n)}function oT(e,t,n){return nT(e,function(r){var i=+t,o=i/(r[1][1]-r[0][1]),s=-o*r[0][0],a=(i-o*(r[1][1]+r[0][1]))/2;e.scale(150*o).translate([s,a])},n)}eT.invert=eT,tT.prototype={constructor:tT,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var Hwe=le(30*ke);function aV(e,t){return+t?function(e,t){function n(r,i,o,s,a,u,l,c,f,d,h,p,g,m){var v=l-r,y=c-i,b=v*v+y*y;if(b>4*t&&g--){var _=s+d,w=a+h,E=u+p,x=Ar(_*_+w*w+E*E),D=Kr(E/=x),S=Ve(Ve(E)-1)<ue||Ve(o-f)<ue?(o+f)/2:no(w,_),C=e(S,D),A=C[0],M=C[1],T=A-r,L=M-i,O=y*T-v*L;(O*O/b>t||Ve((v*T+y*L)/b-.5)>.3||s*d+a*h+u*p<Hwe)&&(n(r,i,o,s,a,u,A,M,S,_/=x,w/=x,E,g,m),m.point(A,M),n(A,M,S,_,w,E,l,c,f,d,h,p,g,m))}}return function(r){var i,o,s,a,u,l,c,f,d,h,p,g,m={point:v,lineStart:y,lineEnd:_,polygonStart:function(){r.polygonStart(),m.lineStart=w},polygonEnd:function(){r.polygonEnd(),m.lineStart=y}};function v(D,S){D=e(D,S),r.point(D[0],D[1])}function y(){f=NaN,m.point=b,r.lineStart()}function b(D,S){var C=Fc([D,S]),A=e(D,S);n(f,d,c,h,p,g,f=A[0],d=A[1],c=D,h=C[0],p=C[1],g=C[2],16,r),r.point(f,d)}function _(){m.point=v,r.lineEnd()}function w(){y(),m.point=E,m.lineEnd=x}function E(D,S){b(i=D,S),o=f,s=d,a=h,u=p,l=g,m.point=b}function x(){n(f,d,c,h,p,g,o,s,i,a,u,l,16,r),m.lineEnd=_,_()}return m}}(e,t):function(e){return Im({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}(e)}var Wwe=Im({point:function(e,t){this.stream.point(e*ke,t*ke)}});function uV(e,t,n,r,i,o){if(!o)return function(e,t,n,r,i){function o(s,a){return[t+e*(s*=r),n-e*(a*=i)]}return o.invert=function(s,a){return[(s-t)/e*r,(n-a)/e*i]},o}(e,t,n,r,i);var s=le(o),a=re(o),u=s*e,l=a*e,c=s/e,f=a/e,d=(a*n-s*t)/e,h=(a*t+s*n)/e;function p(g,m){return[u*(g*=r)-l*(m*=i)+t,n-l*g-u*m]}return p.invert=function(g,m){return[r*(c*g-f*m+d),i*(h-f*g-c*m)]},p}function zs(e){return lV(function(){return e})()}function lV(e){var t,c,v,y,b,E,x,D,S,C,n=150,r=480,i=250,o=0,s=0,a=0,u=0,l=0,f=0,d=1,h=1,p=null,g=ZH,m=null,_=Cm,w=.5;function A(O){return D(O[0]*ke,O[1]*ke)}function M(O){return(O=D.invert(O[0],O[1]))&&[O[0]*Xt,O[1]*Xt]}function T(){var O=uV(n,0,0,d,h,f).apply(null,t(o,s)),N=uV(n,r-O[0],i-O[1],d,h,f);return c=nV(a,u,l),x=JM(t,N),D=JM(c,x),E=aV(x,w),L()}function L(){return S=C=null,A}return A.stream=function(O){return S&&C===O?S:S=Wwe(function(e){return Im({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}(c)(g(E(_(C=O)))))},A.preclip=function(O){return arguments.length?(g=O,p=void 0,L()):g},A.postclip=function(O){return arguments.length?(_=O,m=v=y=b=null,L()):_},A.clipAngle=function(O){return arguments.length?(g=+O?Bwe(p=O*ke):(p=null,ZH),L()):p*Xt},A.clipExtent=function(O){return arguments.length?(_=null==O?(m=v=y=b=null,Cm):tV(m=+O[0][0],v=+O[0][1],y=+O[1][0],b=+O[1][1]),L()):null==m?null:[[m,v],[y,b]]},A.scale=function(O){return arguments.length?(n=+O,T()):n},A.translate=function(O){return arguments.length?(r=+O[0],i=+O[1],T()):[r,i]},A.center=function(O){return arguments.length?(o=O[0]%360*ke,s=O[1]%360*ke,T()):[o*Xt,s*Xt]},A.rotate=function(O){return arguments.length?(a=O[0]%360*ke,u=O[1]%360*ke,l=O.length>2?O[2]%360*ke:0,T()):[a*Xt,u*Xt,l*Xt]},A.angle=function(O){return arguments.length?(f=O%360*ke,T()):f*Xt},A.reflectX=function(O){return arguments.length?(d=O?-1:1,T()):d<0},A.reflectY=function(O){return arguments.length?(h=O?-1:1,T()):h<0},A.precision=function(O){return arguments.length?(E=aV(x,w=O*O),L()):Ar(w)},A.fitExtent=function(O,N){return e_(A,O,N)},A.fitSize=function(O,N){return rT(A,O,N)},A.fitWidth=function(O,N){return iT(A,O,N)},A.fitHeight=function(O,N){return oT(A,O,N)},function(){return t=e.apply(this,arguments),A.invert=t.invert&&M,T()}}function sT(e){var t=0,n=Te/3,r=lV(e),i=r(t,n);return i.parallels=function(o){return arguments.length?r(t=o[0]*ke,n=o[1]*ke):[t*Xt,n*Xt]},i}function Qwe(e,t){var n=re(e),r=(n+re(t))/2;if(Ve(r)<ue)return function(e){var t=le(e);function n(r,i){return[r*t,re(i)/t]}return n.invert=function(r,i){return[r/t,Kr(i*t)]},n}(e);var i=1+n*(2*r-n),o=Ar(i)/r;function s(a,u){var l=Ar(i-2*r*re(u))/r;return[l*re(a*=r),o-l*le(a)]}return s.invert=function(a,u){var l=o-u,c=no(a,Ve(l))*ro(l);return l*r<0&&(c-=Te*ro(a)*ro(l)),[c/r,Kr((i-(a*a+l*l)*r*r)/(2*r))]},s}function t_(){return sT(Qwe).scale(155.424).center([0,33.6442])}function cV(){return t_().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function fV(e){return function(t,n){var r=le(t),i=le(n),o=e(r*i);return o===1/0?[2,0]:[o*i*re(t),o*re(n)]}}function Fm(e){return function(t,n){var r=Ar(t*t+n*n),i=e(r),o=re(i),s=le(i);return[no(t*o,r*s),Kr(r&&n*o/r)]}}var dV=fV(function(e){return Ar(2/(1+e))});dV.invert=Fm(function(e){return 2*Kr(e/2)});var hV=fV(function(e){return(e=OH(e))&&e/re(e)});function n_(e,t){return[e,Bb(BM((zt+t)/2))]}function pV(e){var a,u,l,t=zs(e),n=t.center,r=t.scale,i=t.translate,o=t.clipExtent,s=null;function c(){var f=Te*r(),d=t(function(e){function t(n){return(n=e(n[0]*ke,n[1]*ke))[0]*=Xt,n[1]*=Xt,n}return e=nV(e[0]*ke,e[1]*ke,e.length>2?e[2]*ke:0),t.invert=function(n){return(n=e.invert(n[0]*ke,n[1]*ke))[0]*=Xt,n[1]*=Xt,n},t}(t.rotate()).invert([0,0]));return o(null==s?[[d[0]-f,d[1]-f],[d[0]+f,d[1]+f]]:e===n_?[[Math.max(d[0]-f,s),a],[Math.min(d[0]+f,u),l]]:[[s,Math.max(d[1]-f,a)],[u,Math.min(d[1]+f,l)]])}return t.scale=function(f){return arguments.length?(r(f),c()):r()},t.translate=function(f){return arguments.length?(i(f),c()):i()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(null==f?s=a=u=l=null:(s=+f[0][0],a=+f[0][1],u=+f[1][0],l=+f[1][1]),c()):null==s?null:[[s,a],[u,l]]},c()}function r_(e){return BM((zt+e)/2)}function nxe(e,t){var n=le(e),r=e===t?re(e):Bb(n/le(t))/Bb(r_(t)/r_(e)),i=n*$M(r_(e),r)/r;if(!r)return n_;function o(s,a){i>0?a<-zt+ue&&(a=-zt+ue):a>zt-ue&&(a=zt-ue);var u=i/$M(r_(a),r);return[u*re(r*s),i-u*le(r*s)]}return o.invert=function(s,a){var u=i-a,l=ro(r)*Ar(s*s+u*u),c=no(s,Ve(u))*ro(u);return u*r<0&&(c-=Te*ro(s)*ro(u)),[c/r,2*gh($M(i/l,1/r))-zt]},o}function i_(e,t){return[e,t]}function oxe(e,t){var n=le(e),r=e===t?re(e):(n-le(t))/(t-e),i=n/r+e;if(Ve(r)<ue)return i_;function o(s,a){var u=i-a,l=r*s;return[u*re(l),i-u*le(l)]}return o.invert=function(s,a){var u=i-a,l=no(s,Ve(u))*ro(u);return u*r<0&&(l-=Te*ro(s)*ro(u)),[l/r,i-ro(r)*Ar(s*s+u*u)]},o}hV.invert=Fm(function(e){return e}),n_.invert=function(e,t){return[e,2*gh(AH(t))-zt]},i_.invert=i_;var Rm=1.340264,Nm=-.081106,Pm=893e-6,Lm=.003796,o_=Ar(3)/2;function gV(e,t){var n=Kr(o_*re(t)),r=n*n,i=r*r*r;return[e*le(n)/(o_*(Rm+3*Nm*r+i*(7*Pm+9*Lm*r))),n*(Rm+Nm*r+i*(Pm+Lm*r))]}function mV(e,t){var n=le(t),r=le(e)*n;return[n*re(e)/r,re(t)/r]}function yV(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),t*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}function vV(e,t){return[le(t)*re(e),re(t)]}function bV(e,t){var n=le(t),r=1+le(e)*n;return[n*re(e)/r,re(t)/r]}function _V(e,t){return[Bb(BM((zt+t)/2)),-e]}gV.invert=function(e,t){for(var s,n=t,r=n*n,i=r*r*r,o=0;o<12&&(i=(r=(n-=s=(n*(Rm+Nm*r+i*(Pm+Lm*r))-t)/(Rm+3*Nm*r+i*(7*Pm+9*Lm*r)))*n)*r*r,!(Ve(s)<Lb));++o);return[o_*e*(Rm+3*Nm*r+i*(7*Pm+9*Lm*r))/le(n),Kr(re(n)/o_)]},mV.invert=Fm(gh),yV.invert=function(e,t){var i,n=t,r=25;do{var o=n*n,s=o*o;n-=i=(n*(1.007226+o*(.015085+s*(.028874*o-.044475-.005916*s)))-t)/(1.007226+o*(.045255+s*(.259866*o-.311325-.005916*11*s)))}while(Ve(i)>ue&&--r>0);return[e/(.8707+(o=n*n)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),n]},vV.invert=Fm(Kr),bV.invert=Fm(function(e){return 2*gh(e)}),_V.invert=function(e,t){return[-t,2*gh(AH(e))-zt]};var gxe=Math.abs,aT=(Math,Math,Math,Math.cos),s_=(Math,Math,Math,Math,Math,Math,Math,Math,Math.sin),fl=(Math,Math.PI),uT=fl/2,xV=(Math,a_(2));function EV(e){return e>1?uT:e<-1?-uT:Math.asin(e)}function a_(e){return e>0?Math.sqrt(e):0}function yxe(e,t){var i,n=e*s_(t),r=30;do{t-=i=(t+s_(t)-n)/(1+aT(t))}while(gxe(i)>1e-6&&--r>0);return t/2}a_(fl);var bxe=function(e,t,n){function r(i,o){return[e*i*aT(o=yxe(n,o)),t*s_(o)]}return r.invert=function(i,o){return o=EV(o/t),[i/(e*aT(o)),EV((2*o+s_(2*o))/n)]},r}(xV/uT,xV,fl);const wxe=WH(),lT=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function xxe(e,t){return function n(){const r=t();return r.type=e,r.path=WH().projection(r),r.copy=r.copy||function(){const i=n();return lT.forEach(o=>{r[o]&&i[o](r[o]())}),i.path.pointRadius(r.path.pointRadius()),i},r}}function cT(e,t){if(!e||"string"!=typeof e)throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(u_[e]=xxe(e,t),this):u_[e]||null}function DV(e){return e&&e.path||wxe}const u_={albers:cV,albersusa:function(){var e,t,r,o,a,u,n=cV(),i=t_().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s=t_().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(d,h){u=[d,h]}};function c(d){var h=d[0],p=d[1];return u=null,r.point(h,p),u||(o.point(h,p),u)||(a.point(h,p),u)}function f(){return e=t=null,c}return c.invert=function(d){var h=n.scale(),p=n.translate(),g=(d[0]-p[0])/h,m=(d[1]-p[1])/h;return(m>=.12&&m<.234&&g>=-.425&&g<-.214?i:m>=.166&&m<.234&&g>=-.214&&g<-.115?s:n).invert(d)},c.stream=function(d){return e&&t===d?e:e=function(e){var t=e.length;return{point:function(n,r){for(var i=-1;++i<t;)e[i].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}([n.stream(t=d),i.stream(d),s.stream(d)])},c.precision=function(d){return arguments.length?(n.precision(d),i.precision(d),s.precision(d),f()):n.precision()},c.scale=function(d){return arguments.length?(n.scale(d),i.scale(.35*d),s.scale(d),c.translate(n.translate())):n.scale()},c.translate=function(d){if(!arguments.length)return n.translate();var h=n.scale(),p=+d[0],g=+d[1];return r=n.translate(d).clipExtent([[p-.455*h,g-.238*h],[p+.455*h,g+.238*h]]).stream(l),o=i.translate([p-.307*h,g+.201*h]).clipExtent([[p-.425*h+ue,g+.12*h+ue],[p-.214*h-ue,g+.234*h-ue]]).stream(l),a=s.translate([p-.205*h,g+.212*h]).clipExtent([[p-.214*h+ue,g+.166*h+ue],[p-.115*h-ue,g+.234*h-ue]]).stream(l),f()},c.fitExtent=function(d,h){return e_(c,d,h)},c.fitSize=function(d,h){return rT(c,d,h)},c.fitWidth=function(d,h){return iT(c,d,h)},c.fitHeight=function(d,h){return oT(c,d,h)},c.scale(1070)},azimuthalequalarea:function(){return zs(dV).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return zs(hV).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return sT(nxe).scale(109.5).parallels([30,30])},conicequalarea:t_,conicequidistant:function(){return sT(oxe).scale(131.154).center([0,13.9389])},equalEarth:function(){return zs(gV).scale(177.158)},equirectangular:function(){return zs(i_).scale(152.63)},gnomonic:function(){return zs(mV).scale(144.049).clipAngle(60)},identity:function(){var s,a,l,c,f,m,v,e=1,t=0,n=0,r=1,i=1,o=0,u=null,d=1,h=1,p=Im({point:function(_,w){var E=b([_,w]);this.stream.point(E[0],E[1])}}),g=Cm;function y(){return d=e*r,h=e*i,m=v=null,b}function b(_){var w=_[0]*d,E=_[1]*h;if(o){var x=E*s-w*a;w=w*s+E*a,E=x}return[w+t,E+n]}return b.invert=function(_){var w=_[0]-t,E=_[1]-n;if(o){var x=E*s+w*a;w=w*s-E*a,E=x}return[w/d,E/h]},b.stream=function(_){return m&&v===_?m:m=p(g(v=_))},b.postclip=function(_){return arguments.length?(g=_,u=l=c=f=null,y()):g},b.clipExtent=function(_){return arguments.length?(g=null==_?(u=l=c=f=null,Cm):tV(u=+_[0][0],l=+_[0][1],c=+_[1][0],f=+_[1][1]),y()):null==u?null:[[u,l],[c,f]]},b.scale=function(_){return arguments.length?(e=+_,y()):e},b.translate=function(_){return arguments.length?(t=+_[0],n=+_[1],y()):[t,n]},b.angle=function(_){return arguments.length?(a=re(o=_%360*ke),s=le(o),y()):o*Xt},b.reflectX=function(_){return arguments.length?(r=_?-1:1,y()):r<0},b.reflectY=function(_){return arguments.length?(i=_?-1:1,y()):i<0},b.fitExtent=function(_,w){return e_(b,_,w)},b.fitSize=function(_,w){return rT(b,_,w)},b.fitWidth=function(_,w){return iT(b,_,w)},b.fitHeight=function(_,w){return oT(b,_,w)},b},mercator:function(){return pV(n_).scale(961/Sr)},mollweide:function(){return zs(bxe).scale(169.529)},naturalEarth1:function(){return zs(yV).scale(175.295)},orthographic:function(){return zs(vV).scale(249.5).clipAngle(90+ue)},stereographic:function(){return zs(bV).scale(250).clipAngle(142)},transversemercator:function(){var e=pV(_V),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):[(r=t())[1],-r[0]]},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):[(r=n())[0],r[1],r[2]-90]},n([0,0,90]).scale(159.155)}};for(const e in u_)cT(e,u_[e]);function CV(e,t,n){var r=Ci(e,t-ue,n).concat(t);return function(i){return r.map(function(o){return[i,o]})}}function SV(e,t,n){var r=Ci(e,t-ue,n).concat(t);return function(i){return r.map(function(o){return[o,i]})}}function Exe(){}const Ha=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function OV(){var e=1,t=1,n=a;function r(u,l){return l.map(c=>i(u,c))}function i(u,l){var c=[],f=[];return function(u,l,c){var h,p,m,v,y,f=new Array,d=new Array;for(h=p=-1,Ha[(m=u[0]>=l)<<1].forEach(b);++h<e-1;)Ha[m|(m=u[h+1]>=l)<<1].forEach(b);for(Ha[m<<0].forEach(b);++p<t-1;){for(h=-1,Ha[(m=u[p*e+e]>=l)<<1|(v=u[p*e]>=l)<<2].forEach(b);++h<e-1;)y=v,Ha[m|(m=u[p*e+e+h+1]>=l)<<1|(v=u[p*e+h+1]>=l)<<2|y<<3].forEach(b);Ha[m|v<<3].forEach(b)}for(h=-1,Ha[(v=u[p*e]>=l)<<2].forEach(b);++h<e-1;)y=v,Ha[(v=u[p*e+h+1]>=l)<<2|y<<3].forEach(b);function b(_){var S,C,w=[_[0][0]+h,_[0][1]+p],E=[_[1][0]+h,_[1][1]+p],x=s(w),D=s(E);(S=d[x])?(C=f[D])?(delete d[S.end],delete f[C.start],S===C?(S.ring.push(E),c(S.ring)):f[S.start]=d[C.end]={start:S.start,end:C.end,ring:S.ring.concat(C.ring)}):(delete d[S.end],S.ring.push(E),d[S.end=D]=S):(S=f[D])?(C=d[x])?(delete f[S.start],delete d[C.end],S===C?(S.ring.push(E),c(S.ring)):f[C.start]=d[S.end]={start:C.start,end:S.end,ring:C.ring.concat(S.ring)}):(delete f[S.start],S.ring.unshift(w),f[S.start=x]=S):f[x]=d[D]={start:x,end:D,ring:[w,E]}}Ha[v<<3].forEach(b)}(u,l,d=>{n(d,u,l),function(e){for(var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}(d)>0?c.push([d]):f.push(d)}),f.forEach(d=>{for(var g,h=0,p=c.length;h<p;++h)if(-1!==Cxe((g=c[h])[0],d))return void g.push(d)}),{type:"MultiPolygon",value:l,coordinates:c}}function s(u){return 2*u[0]+u[1]*(e+1)*4}function a(u,l,c){u.forEach(f=>{var m,d=f[0],h=f[1],p=0|d,g=0|h,v=l[g*e+p];d>0&&d<e&&p===d&&(f[0]=d+(c-(m=l[g*e+p-1]))/(v-m)-.5),h>0&&h<t&&g===h&&(f[1]=h+(c-(m=l[(g-1)*e+p]))/(v-m)-.5)})}return r.contour=i,r.size=function(u){if(!arguments.length)return[e,t];var l=Math.floor(u[0]),c=Math.floor(u[1]);return l>=0&&c>=0||F("invalid size"),e=l,t=c,r},r.smooth=function(u){return arguments.length?(n=u?a:Exe,r):n===a},r}function Cxe(e,t){for(var i,n=-1,r=t.length;++n<r;)if(i=Sxe(e,t[n]))return i;return 0}function Sxe(e,t){for(var n=t[0],r=t[1],i=-1,o=0,s=e.length,a=s-1;o<s;a=o++){var u=e[o],l=u[0],c=u[1],f=e[a],d=f[0],h=f[1];if(Axe(u,f,t))return 0;c>r!=h>r&&n<(d-l)*(r-c)/(h-c)+l&&(i=-i)}return i}function Axe(e,t,n){var r;return function(e,t,n){return(t[0]-e[0])*(n[1]-e[1])==(n[0]-e[0])*(t[1]-e[1])}(e,t,n)&&function(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}(e[r=+(e[0]===t[0])],n[r],t[r])}function MV(e,t,n){return function(r){var i=Cs(r),o=n?Math.min(i[0],0):i[0],s=i[1],a=s-o,u=t?Ru(o,s,e):a/(e+1);return Ci(o+u,s,u)}}function fT(e){k.call(this,null,e)}function TV(e,t,n,r,i){const o=e.x1||0,s=e.y1||0,a=t*n<0;function u(f){f.forEach(l)}function l(f){a&&f.reverse(),f.forEach(c)}function c(f){f[0]=(f[0]-o)*t+r,f[1]=(f[1]-s)*n+i}return function(f){return f.coordinates.forEach(u),f}}function kV(e,t,n){const r=e>=0?e:UA(t,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function dT(e){return xe(e)?e:nr(+e)}function IV(){var e=u=>u[0],t=u=>u[1],n=Od,r=[-1,-1],i=960,o=500,s=2;function a(u,l){const c=kV(r[0],u,e)>>s,f=kV(r[1],u,t)>>s,d=c?c+2:0,h=f?f+2:0,p=2*d+(i>>s),g=2*h+(o>>s),m=new Float32Array(p*g),v=new Float32Array(p*g);let y=m;u.forEach(_=>{const w=d+(+e(_)>>s),E=h+(+t(_)>>s);w>=0&&w<p&&E>=0&&E<g&&(m[w+E*p]+=+n(_))}),c>0&&f>0?(bh(p,g,m,v,c),_h(p,g,v,m,f),bh(p,g,m,v,c),_h(p,g,v,m,f),bh(p,g,m,v,c),_h(p,g,v,m,f)):c>0?(bh(p,g,m,v,c),bh(p,g,v,m,c),bh(p,g,m,v,c),y=v):f>0&&(_h(p,g,m,v,f),_h(p,g,v,m,f),_h(p,g,m,v,f),y=v);const b=l?Math.pow(2,-2*s):1/sH(y);for(let _=0,w=p*g;_<w;++_)y[_]*=b;return{values:y,scale:1<<s,width:p,height:g,x1:d,y1:h,x2:d+(i>>s),y2:h+(o>>s)}}return a.x=function(u){return arguments.length?(e=dT(u),a):e},a.y=function(u){return arguments.length?(t=dT(u),a):t},a.weight=function(u){return arguments.length?(n=dT(u),a):n},a.size=function(u){if(!arguments.length)return[i,o];var l=+u[0],c=+u[1];return l>=0&&c>=0||F("invalid size"),i=l,o=c,a},a.cellSize=function(u){return arguments.length?((u=+u)>=1||F("invalid cell size"),s=Math.floor(Math.log(u)/Math.LN2),a):1<<s},a.bandwidth=function(u){return arguments.length?(1===(u=X(u)).length&&(u=[+u[0],+u[0]]),2!==u.length&&F("invalid bandwidth"),r=u,a):r},a}function bh(e,t,n,r,i){const o=1+(i<<1);for(let s=0;s<t;++s)for(let a=0,u=0;a<e+i;++a)a<e&&(u+=n[a+s*e]),a>=i&&(a>=o&&(u-=n[a-o+s*e]),r[a-i+s*e]=u/Math.min(a+1,e-1+o-a,o))}function _h(e,t,n,r,i){const o=1+(i<<1);for(let s=0;s<e;++s)for(let a=0,u=0;a<t+i;++a)a<t&&(u+=n[s+a*e]),a>=i&&(a>=o&&(u-=n[s+(a-o)*e]),r[s+(a-i)*e]=u/Math.min(a+1,t-1+o-a,o))}function hT(e){k.call(this,null,e)}fT.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},z(fT,k,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=e.field||er,o=OV().smooth(!1!==e.smooth),s=e.thresholds||function(e,t,n){const r=MV(n.levels||10,n.nice,!1!==n.zero);return"shared"!==n.resolve?r:r(e.map(i=>vc(t(i).values)))}(r,i,e),a=null===e.as?null:e.as||"contour",u=[];return r.forEach(l=>{const c=i(l),f=o.size([c.width,c.height])(c.values,R(s)?s:s(c.values));(function(e,t,n,r){let i=r.scale||t.scale,o=r.translate||t.translate;if(xe(i)&&(i=i(n,r)),xe(o)&&(o=o(n,r)),(1===i||null==i)&&!o)return;const s=(ft(i)?i:i[0])||1,a=(ft(i)?i:i[1])||1;e.forEach(TV(t,s,a,o&&o[0]||0,o&&o[1]||0))})(f,c,l,e),f.forEach(d=>{u.push(v1(l,it(null!=a?{[a]:d}:d)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}}),hT.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const Ixe=["x","y","weight","size","cellSize","bandwidth"];function FV(e,t){return Ixe.forEach(n=>null!=t[n]?e[n](t[n]):0),e}function pT(e){k.call(this,null,e)}z(hT,k,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var u,n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=function(e,t){var i,o,s,a,u,l,n=[],r=c=>c(a);if(null==t)n.push(e);else for(i={},o=0,s=e.length;o<s;++o)a=e[o],(l=i[u=t.map(r)])||(i[u]=l=[],l.dims=u,n.push(l)),l.push(a);return n}(t.materialize(t.SOURCE).source,e.groupby),o=(e.groupby||[]).map(Bt),s=FV(IV(),e),a=e.as||"grid";return u=i.map(c=>it(function(c,f){for(let d=0;d<o.length;++d)c[o[d]]=f[d];return c}({[a]:s(c,e.counts)},c.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}}),pT.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},z(pT,k,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var a,u,n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=OV().smooth(!1!==e.smooth),i=e.values,o=e.thresholds||MV(e.count||10,e.nice,!!i),s=e.size;return i||(i=t.materialize(t.SOURCE).source,u=TV(a=FV(IV(),e)(i,!0),a.scale||1,a.scale||1,0,0),s=[a.width,a.height],i=a.values),o=R(o)?o:o(i),i=r.size(s)(i,o),u&&i.forEach(u),this.value&&(n.rem=this.value),this.value=n.source=n.add=(i||[]).map(it),n}});const gT="Feature",mT="FeatureCollection";function yT(e){k.call(this,null,e)}function vT(e){k.call(this,null,e)}function bT(e){k.call(this,null,e)}function _T(e){k.call(this,null,e)}function wT(e){k.call(this,[],e),this.generator=function(){var e,t,n,r,i,o,s,a,d,h,p,g,u=10,l=u,c=90,f=360,m=2.5;function v(){return{type:"MultiLineString",coordinates:y()}}function y(){return Ci($b(r/c)*c,n,c).map(p).concat(Ci($b(a/f)*f,s,f).map(g)).concat(Ci($b(t/u)*u,e,u).filter(function(b){return Ve(b%c)>ue}).map(d)).concat(Ci($b(o/l)*l,i,l).filter(function(b){return Ve(b%f)>ue}).map(h))}return v.lines=function(){return y().map(function(b){return{type:"LineString",coordinates:b}})},v.outline=function(){return{type:"Polygon",coordinates:[p(r).concat(g(s).slice(1),p(n).reverse().slice(1),g(a).reverse().slice(1))]}},v.extent=function(b){return arguments.length?v.extentMajor(b).extentMinor(b):v.extentMinor()},v.extentMajor=function(b){return arguments.length?(a=+b[0][1],s=+b[1][1],(r=+b[0][0])>(n=+b[1][0])&&(b=r,r=n,n=b),a>s&&(b=a,a=s,s=b),v.precision(m)):[[r,a],[n,s]]},v.extentMinor=function(b){return arguments.length?(o=+b[0][1],i=+b[1][1],(t=+b[0][0])>(e=+b[1][0])&&(b=t,t=e,e=b),o>i&&(b=o,o=i,i=b),v.precision(m)):[[t,o],[e,i]]},v.step=function(b){return arguments.length?v.stepMajor(b).stepMinor(b):v.stepMinor()},v.stepMajor=function(b){return arguments.length?(c=+b[0],f=+b[1],v):[c,f]},v.stepMinor=function(b){return arguments.length?(u=+b[0],l=+b[1],v):[u,l]},v.precision=function(b){return arguments.length?(m=+b,d=CV(o,i,90),h=SV(t,e,m),p=CV(a,s,90),g=SV(r,n,m),v):m},v.extentMajor([[-180,-90+ue],[180,90-ue]]).extentMinor([[-180,-80-ue],[180,80+ue]])}()}function xT(e){k.call(this,null,e)}function RV(e){if(!xe(e))return!1;const t=To(Jn(e));return t.$x||t.$y||t.$value||t.$max}function NV(e){k.call(this,null,e),this.modified(!0)}function PV(e,t,n){xe(e[t])&&e[t](n)}function LV(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,f,d,h,p,g,m,v,y,o=e._root,s={data:r},a=e._x0,u=e._y0,l=e._x1,c=e._y1;if(!o)return e._root=s,e;for(;o.length;)if((g=t>=(f=(a+l)/2))?a=f:l=f,(m=n>=(d=(u+c)/2))?u=d:c=d,i=o,!(o=o[v=m<<1|g]))return i[v]=s,e;if(h=+e._x.call(null,o.data),p=+e._y.call(null,o.data),t===h&&n===p)return s.next=o,i?i[v]=s:e._root=s,e;do{i=i?i[v]=new Array(4):e._root=new Array(4),(g=t>=(f=(a+l)/2))?a=f:l=f,(m=n>=(d=(u+c)/2))?u=d:c=d}while((v=m<<1|g)==(y=(p>=d)<<1|h>=f));return i[y]=o,i[v]=s,e}function Or(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function rEe(e){return e[0]}function oEe(e){return e[1]}function ET(e,t,n){var r=new DT(null==t?rEe:t,null==n?oEe:n,NaN,NaN,NaN,NaN);return null==e?r:r.addAll(e)}function DT(e,t,n,r,i,o){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function jV(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}yT.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},z(yT,k,{transform(e,t){var l,n=this._features,r=this._points,i=e.fields,o=i&&i[0],s=i&&i[1],a=e.geojson||!i&&er,u=t.ADD;l=e.modified()||t.changed(t.REM)||t.modified(Jn(a))||o&&t.modified(Jn(o))||s&&t.modified(Jn(s)),(!this.value||l)&&(u=t.SOURCE,this._features=n=[],this._points=r=[]),a&&t.visit(u,c=>n.push(a(c))),o&&s&&(t.visit(u,c=>{var f=o(c),d=s(c);null!=f&&null!=d&&(f=+f)===f&&(d=+d)===d&&r.push([f,d])}),n=n.concat({type:gT,geometry:{type:"MultiPoint",coordinates:r}})),this.value={type:mT,features:n}}}),vT.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},z(vT,k,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.field||er,o=e.as||"path",s=n.SOURCE;!r||e.modified()?(this.value=r=DV(e.projection),n.materialize().reflow()):s=i===er||t.modified(i.fields)?n.ADD_MOD:n.ADD;const a=function(e,t){const n=e.pointRadius();return e.context(null),null!=t&&e.pointRadius(t),n}(r,e.pointRadius);return n.visit(s,u=>u[o]=r(i(u))),r.pointRadius(a),n.modifies(o)}}),bT.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},z(bT,k,{transform(e,t){var u,n=e.projection,r=e.fields[0],i=e.fields[1],o=e.as||["x","y"],s=o[0],a=o[1];function l(c){const f=n([r(c),i(c)]);f?(c[s]=f[0],c[a]=f[1]):(c[s]=void 0,c[a]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,l):(u=t.modified(r.fields)||t.modified(i.fields),t.visit(u?t.ADD_MOD:t.ADD,l)),t.modifies(o)}}),_T.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},z(_T,k,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.as||"shape",o=n.ADD;return(!r||e.modified())&&(this.value=r=function(e,t,n){const r=null==n?i=>e(t(i)):i=>{var o=e.pointRadius(),s=e.pointRadius(n)(t(i));return e.pointRadius(o),s};return r.context=i=>(e.context(i),r),r}(DV(e.projection),e.field||qr("datum"),e.pointRadius),n.materialize().reflow(),o=n.SOURCE),n.visit(o,s=>s[i]=r),n.modifies(i)}}),wT.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},z(wT,k,{transform(e,t){var i,n=this.value,r=this.generator;if(!n.length||e.modified())for(const o in e)xe(r[o])&&r[o](e[o]);return i=r(),n.length?t.mod.push(s4(n[0],i)):t.add.push(it(i)),n[0]=i,t}}),xT.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},z(xT,k,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,r="shared"===e.resolve,i=e.field||er,o=function(e,t){let n;return xe(e)?(n=r=>e(r,t),n.dep=RV(e)):e?n=nr(e):(n=r=>r.$value/r.$max||0,n.dep=!0),n}(e.opacity,e),s=function(e,t){let n;return xe(e)?(n=r=>Yu(e(r,t)),n.dep=RV(e)):n=nr(Yu(e||"#888")),n}(e.color,e),a=e.as||"image",u={$x:0,$y:0,$value:0,$max:r?vc(n.map(l=>vc(i(l).values))):0};return n.forEach(l=>{const c=i(l),f=Ee({},l,u);r||(f.$max=vc(c.values||[])),l[a]=function(e,t,n,r){const i=e.width,s=e.x1||0,a=e.y1||0,u=e.x2||i,l=e.y2||e.height,c=e.values,f=c?m=>c[m]:Mu,d=Qd(u-s,l-a),h=d.getContext("2d"),p=h.getImageData(0,0,u-s,l-a),g=p.data;for(let m=a,v=0;m<l;++m){t.$y=m-a;for(let y=s,b=m*i;y<u;++y,v+=4){t.$x=y-s,t.$value=f(y+b);const _=n(t);g[v+0]=_.r,g[v+1]=_.g,g[v+2]=_.b,g[v+3]=~~(255*r(t))}}return h.putImageData(p,0,0),d}(c,f,s.dep?s:nr(s(f)),o.dep?o:nr(o(f)))}),t.reflow(!0).modifies(a)}}),z(NV,k,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=function(e){const t=cT((e||"mercator").toLowerCase());return t||F("Unrecognized projection type: "+e),t()}(e.type),lT.forEach(r=>{null!=e[r]&&PV(n,r,e[r])})):lT.forEach(r=>{e.modified(r)&&PV(n,r,e[r])}),null!=e.pointRadius&&n.path.pointRadius(e.pointRadius),e.fit&&function(e,t){const n=function(e){return 1===(e=X(e)).length?e[0]:{type:mT,features:e.reduce((t,n)=>t.concat(function(e){return e.type===mT?e.features:X(e).filter(t=>null!=t).map(t=>t.type===gT?t:{type:gT,geometry:t})}(n)),[])}}(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});var Mr=ET.prototype=DT.prototype;function Tr(e){return function(){return e}}function dl(e){return 1e-6*(e()-.5)}function aEe(e){return e.x+e.vx}function uEe(e){return e.y+e.vy}Mr.copy=function(){var n,r,e=new DT(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root;if(!t)return e;if(!t.length)return e._root=jV(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=jV(r));return e},Mr.add=function(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return LV(this.cover(t,n),t,n,e)},Mr.addAll=function(e){var t,n,i,o,r=e.length,s=new Array(r),a=new Array(r),u=1/0,l=1/0,c=-1/0,f=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(o=+this._y.call(null,t))||(s[n]=i,a[n]=o,i<u&&(u=i),i>c&&(c=i),o<l&&(l=o),o>f&&(f=o));if(u>c||l>f)return this;for(this.cover(u,l).cover(c,f),n=0;n<r;++n)LV(this,s[n],a[n],e[n]);return this},Mr.cover=function(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,o=(r=Math.floor(t))+1;else{for(var u,l,s=i-n||1,a=this._root;n>e||e>=i||r>t||t>=o;)switch(l=(t<r)<<1|e<n,u=new Array(4),u[l]=a,a=u,s*=2,l){case 0:i=n+s,o=r+s;break;case 1:n=i-s,o=r+s;break;case 2:i=n+s,r=o-s;break;case 3:n=i-s,r=o-s}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this},Mr.data=function(){var e=[];return this.visit(function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)}),e},Mr.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},Mr.find=function(e,t,n){var r,s,a,u,l,p,g,i=this._x0,o=this._y0,c=this._x1,f=this._y1,d=[],h=this._root;for(h&&d.push(new Or(h,i,o,c,f)),null==n?n=1/0:(i=e-n,o=t-n,c=e+n,f=t+n,n*=n);p=d.pop();)if(!(!(h=p.node)||(s=p.x0)>c||(a=p.y0)>f||(u=p.x1)<i||(l=p.y1)<o))if(h.length){var m=(s+u)/2,v=(a+l)/2;d.push(new Or(h[3],m,v,u,l),new Or(h[2],s,v,m,l),new Or(h[1],m,a,u,v),new Or(h[0],s,a,m,v)),(g=(t>=v)<<1|e>=m)&&(p=d[d.length-1],d[d.length-1]=d[d.length-1-g],d[d.length-1-g]=p)}else{var y=e-+this._x.call(null,h.data),b=t-+this._y.call(null,h.data),_=y*y+b*b;if(_<n){var w=Math.sqrt(n=_);i=e-w,o=t-w,c=e+w,f=t+w,r=h.data}}return r},Mr.remove=function(e){if(isNaN(c=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,r,i,o,c,f,d,h,p,g,m,v,n=this._root,s=this._x0,a=this._y0,u=this._x1,l=this._y1;if(!n)return this;if(n.length)for(;;){if((p=c>=(d=(s+u)/2))?s=d:u=d,(g=f>=(h=(a+l)/2))?a=h:l=h,t=n,!(n=n[m=g<<1|p]))return this;if(!n.length)break;(t[m+1&3]||t[m+2&3]||t[m+3&3])&&(r=t,v=m)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(o=n.next)&&delete n.next,i?(o?i.next=o:delete i.next,this):t?(o?t[m]=o:delete t[m],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[v]=n:this._root=n),this):(this._root=o,this)},Mr.removeAll=function(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this},Mr.root=function(){return this._root},Mr.size=function(){var e=0;return this.visit(function(t){if(!t.length)do{++e}while(t=t.next)}),e},Mr.visit=function(e){var n,i,o,s,a,u,t=[],r=this._root;for(r&&t.push(new Or(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,o=n.x0,s=n.y0,a=n.x1,u=n.y1)&&r.length){var l=(o+a)/2,c=(s+u)/2;(i=r[3])&&t.push(new Or(i,l,c,a,u)),(i=r[2])&&t.push(new Or(i,o,c,l,u)),(i=r[1])&&t.push(new Or(i,l,s,a,c)),(i=r[0])&&t.push(new Or(i,o,s,l,c))}return this},Mr.visitAfter=function(e){var r,t=[],n=[];for(this._root&&t.push(new Or(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var o,s=r.x0,a=r.y0,u=r.x1,l=r.y1,c=(s+u)/2,f=(a+l)/2;(o=i[0])&&t.push(new Or(o,s,a,c,f)),(o=i[1])&&t.push(new Or(o,c,a,u,f)),(o=i[2])&&t.push(new Or(o,s,f,c,l)),(o=i[3])&&t.push(new Or(o,c,f,u,l))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this},Mr.x=function(e){return arguments.length?(this._x=e,this):this._x},Mr.y=function(e){return arguments.length?(this._y=e,this):this._y};var cEe={value:()=>{}};function $V(){for(var r,e=0,t=arguments.length,n={};e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new l_(n)}function l_(e){this._=e}function fEe(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}function dEe(e,t){for(var i,n=0,r=e.length;n<r;++n)if((i=e[n]).name===t)return i.value}function BV(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=cEe,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}l_.prototype=$V.prototype={constructor:l_,on:function(e,t){var i,n=this._,r=fEe(e+"",n),o=-1,s=r.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++o<s;)if(i=(e=r[o]).type)n[i]=BV(n[i],e.name,t);else if(null==t)for(i in n)n[i]=BV(n[i],e.name,null);return this}for(;++o<s;)if((i=(e=r[o]).type)&&(i=dEe(n[i],e.name)))return i},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new l_(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var i,o,n=new Array(i),r=0;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(r=0,i=(o=this._[e]).length;r<i;++r)o[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};const hEe=$V;var c_,zm,wh=0,$m=0,Bm=0,f_=0,Rc=0,d_=0,Um="object"==typeof performance&&performance.now?performance:Date,UV="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function CT(){return Rc||(UV(pEe),Rc=Um.now()+d_)}function pEe(){Rc=0}function h_(){this._call=this._time=this._next=null}function HV(e,t,n){var r=new h_;return r.restart(e,t,n),r}function VV(){Rc=(f_=Um.now())+d_,wh=$m=0;try{!function(){CT(),++wh;for(var t,e=c_;e;)(t=Rc-e._time)>=0&&e._call.call(null,t),e=e._next;--wh}()}finally{wh=0,function(){for(var e,n,t=c_,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:c_=n);zm=e,ST(r)}(),Rc=0}}function mEe(){var e=Um.now(),t=e-f_;t>1e3&&(d_-=t,f_=e)}function ST(e){wh||($m&&($m=clearTimeout($m)),e-Rc>24?(e<1/0&&($m=setTimeout(VV,e-Um.now()-d_)),Bm&&(Bm=clearInterval(Bm))):(Bm||(f_=Um.now(),Bm=setInterval(mEe,1e3)),wh=1,UV(VV)))}h_.prototype=HV.prototype={constructor:h_,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?CT():+n)+(null==t?0:+t),!this._next&&zm!==this&&(zm?zm._next=this:c_=this,zm=this),this._call=e,this._time=n,ST()},stop:function(){this._call&&(this._call=null,this._time=1/0,ST())}};const qV=4294967296;function wEe(e){return e.x}function xEe(e){return e.y}var DEe=Math.PI*(3-Math.sqrt(5));function AEe(e){return e.index}function WV(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}const GV={center:function(e,t){var n,r=1;function i(){var o,a,s=n.length,u=0,l=0;for(o=0;o<s;++o)u+=(a=n[o]).x,l+=a.y;for(u=(u/s-e)*r,l=(l/s-t)*r,o=0;o<s;++o)(a=n[o]).x-=u,a.y-=l}return null==e&&(e=0),null==t&&(t=0),i.initialize=function(o){n=o},i.x=function(o){return arguments.length?(e=+o,i):e},i.y=function(o){return arguments.length?(t=+o,i):t},i.strength=function(o){return arguments.length?(r=+o,i):r},i},collide:function(e){var t,n,r,i=1,o=1;function s(){for(var l,f,d,h,p,g,m,c=t.length,v=0;v<o;++v)for(f=ET(t,aEe,uEe).visitAfter(a),l=0;l<c;++l)m=(g=n[(d=t[l]).index])*g,h=d.x+d.vx,p=d.y+d.vy,f.visit(y);function y(b,_,w,E,x){var D=b.data,S=b.r,C=g+S;if(!D)return _>h+C||E<h-C||w>p+C||x<p-C;if(D.index>d.index){var A=h-D.x-D.vx,M=p-D.y-D.vy,T=A*A+M*M;T<C*C&&(0===A&&(T+=(A=dl(r))*A),0===M&&(T+=(M=dl(r))*M),T=(C-(T=Math.sqrt(T)))/T*i,d.vx+=(A*=T)*(C=(S*=S)/(m+S)),d.vy+=(M*=T)*C,D.vx-=A*(C=1-C),D.vy-=M*C)}}}function a(l){if(l.data)return l.r=n[l.data.index];for(var c=l.r=0;c<4;++c)l[c]&&l[c].r>l.r&&(l.r=l[c].r)}function u(){if(t){var l,f,c=t.length;for(n=new Array(c),l=0;l<c;++l)n[(f=t[l]).index]=+e(f,l,t)}}return"function"!=typeof e&&(e=Tr(null==e?1:+e)),s.initialize=function(l,c){t=l,r=c,u()},s.iterations=function(l){return arguments.length?(o=+l,s):o},s.strength=function(l){return arguments.length?(i=+l,s):i},s.radius=function(l){return arguments.length?(e="function"==typeof l?l:Tr(+l),u(),s):e},s},nbody:function(){var e,t,n,r,o,i=Tr(-30),s=1,a=1/0,u=.81;function l(h){var p,g=e.length,m=ET(e,wEe,xEe).visitAfter(f);for(r=h,p=0;p<g;++p)t=e[p],m.visit(d)}function c(){if(e){var h,g,p=e.length;for(o=new Array(p),h=0;h<p;++h)o[(g=e[h]).index]=+i(g,h,e)}}function f(h){var g,m,y,b,_,p=0,v=0;if(h.length){for(y=b=_=0;_<4;++_)(g=h[_])&&(m=Math.abs(g.value))&&(p+=g.value,v+=m,y+=m*g.x,b+=m*g.y);h.x=y/v,h.y=b/v}else{(g=h).x=g.data.x,g.y=g.data.y;do{p+=o[g.data.index]}while(g=g.next)}h.value=p}function d(h,p,g,m){if(!h.value)return!0;var v=h.x-t.x,y=h.y-t.y,b=m-p,_=v*v+y*y;if(b*b/u<_)return _<a&&(0===v&&(_+=(v=dl(n))*v),0===y&&(_+=(y=dl(n))*y),_<s&&(_=Math.sqrt(s*_)),t.vx+=v*h.value*r/_,t.vy+=y*h.value*r/_),!0;if(!(h.length||_>=a)){(h.data!==t||h.next)&&(0===v&&(_+=(v=dl(n))*v),0===y&&(_+=(y=dl(n))*y),_<s&&(_=Math.sqrt(s*_)));do{h.data!==t&&(t.vx+=v*(b=o[h.data.index]*r/_),t.vy+=y*b)}while(h=h.next)}}return l.initialize=function(h,p){e=h,n=p,c()},l.strength=function(h){return arguments.length?(i="function"==typeof h?h:Tr(+h),c(),l):i},l.distanceMin=function(h){return arguments.length?(s=h*h,l):Math.sqrt(s)},l.distanceMax=function(h){return arguments.length?(a=h*h,l):Math.sqrt(a)},l.theta=function(h){return arguments.length?(u=h*h,l):Math.sqrt(u)},l},link:function(e){var r,o,s,a,u,l,t=AEe,n=function(m){return 1/Math.min(a[m.source.index],a[m.target.index])},i=Tr(30),c=1;function d(m){for(var v=0,y=e.length;v<c;++v)for(var _,w,E,x,D,S,C,b=0;b<y;++b)x=(E=(_=e[b]).target).x+E.vx-(w=_.source).x-w.vx||dl(l),D=E.y+E.vy-w.y-w.vy||dl(l),D*=S=((S=Math.sqrt(x*x+D*D))-o[b])/S*m*r[b],E.vx-=(x*=S)*(C=u[b]),E.vy-=D*C,w.vx+=x*(C=1-C),w.vy+=D*C}function h(){if(s){var m,_,v=s.length,y=e.length,b=new Map(s.map((w,E)=>[t(w,E,s),w]));for(m=0,a=new Array(v);m<y;++m)(_=e[m]).index=m,"object"!=typeof _.source&&(_.source=WV(b,_.source)),"object"!=typeof _.target&&(_.target=WV(b,_.target)),a[_.source.index]=(a[_.source.index]||0)+1,a[_.target.index]=(a[_.target.index]||0)+1;for(m=0,u=new Array(y);m<y;++m)u[m]=a[(_=e[m]).source.index]/(a[_.source.index]+a[_.target.index]);r=new Array(y),p(),o=new Array(y),g()}}function p(){if(s)for(var m=0,v=e.length;m<v;++m)r[m]=+n(e[m],m,e)}function g(){if(s)for(var m=0,v=e.length;m<v;++m)o[m]=+i(e[m],m,e)}return null==e&&(e=[]),d.initialize=function(m,v){s=m,l=v,h()},d.links=function(m){return arguments.length?(e=m,h(),d):e},d.id=function(m){return arguments.length?(t=m,d):t},d.iterations=function(m){return arguments.length?(c=+m,d):c},d.strength=function(m){return arguments.length?(n="function"==typeof m?m:Tr(+m),p(),d):n},d.distance=function(m){return arguments.length?(i="function"==typeof m?m:Tr(+m),g(),d):i},d},x:function(e){var n,r,i,t=Tr(.1);function o(a){for(var c,u=0,l=n.length;u<l;++u)(c=n[u]).vx+=(i[u]-c.x)*r[u]*a}function s(){if(n){var a,u=n.length;for(r=new Array(u),i=new Array(u),a=0;a<u;++a)r[a]=isNaN(i[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return"function"!=typeof e&&(e=Tr(null==e?0:+e)),o.initialize=function(a){n=a,s()},o.strength=function(a){return arguments.length?(t="function"==typeof a?a:Tr(+a),s(),o):t},o.x=function(a){return arguments.length?(e="function"==typeof a?a:Tr(+a),s(),o):e},o},y:function(e){var n,r,i,t=Tr(.1);function o(a){for(var c,u=0,l=n.length;u<l;++u)(c=n[u]).vy+=(i[u]-c.y)*r[u]*a}function s(){if(n){var a,u=n.length;for(r=new Array(u),i=new Array(u),a=0;a<u;++a)r[a]=isNaN(i[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return"function"!=typeof e&&(e=Tr(null==e?0:+e)),o.initialize=function(a){n=a,s()},o.strength=function(a){return arguments.length?(t="function"==typeof a?a:Tr(+a),s(),o):t},o.y=function(a){return arguments.length?(e="function"==typeof a?a:Tr(+a),s(),o):e},o}},Hm="forces",AT=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],kEe=["static","iterations"],YV=["x","y","vx","vy"];function OT(e){k.call(this,null,e)}function XV(e,t,n,r){var o,s,a,u,i=X(t.forces);for(o=0,s=AT.length;o<s;++o)(a=AT[o])!==Hm&&t.modified(a)&&e[a](t[a]);for(o=0,s=i.length;o<s;++o)u=Hm+o,(a=n||t.modified(Hm,o)?NEe(i[o]):r&&REe(i[o],r)?e.force(u):null)&&e.force(u,a);for(s=e.numForces||0;o<s;++o)e.force(Hm+o,null);return e.numForces=i.length,e}function REe(e,t){var n,r;for(n in e)if(xe(r=e[n])&&t.modified(Jn(r)))return 1;return 0}function NEe(e){var t,n;for(n in ne(GV,e.force)||F("Unrecognized force: "+e.force),t=GV[e.force](),e)xe(t[n])&&PEe(t[n],e[n],e);return t}function PEe(e,t,n){e(xe(t)?r=>t(r,n):t)}function LEe(e){var t=0,n=e.children,r=n&&n.length;if(r)for(;--r>=0;)t+=n[r].value;else t=1;e.value=t}function MT(e,t){e instanceof Map?(e=[void 0,e],void 0===t&&(t=eDe)):void 0===t&&(t=JEe);for(var r,o,s,a,u,n=new xh(e),i=[n];r=i.pop();)if((s=t(r.data))&&(u=(s=Array.from(s)).length))for(r.children=s,a=u-1;a>=0;--a)i.push(o=s[a]=new xh(s[a])),o.parent=r,o.depth=r.depth+1;return n.eachBefore(QV)}function JEe(e){return e.children}function eDe(e){return Array.isArray(e)?e[1]:null}function tDe(e){void 0!==e.data.value&&(e.value=e.data.value),e.data=e.data.data}function QV(e){var t=0;do{e.height=t}while((e=e.parent)&&e.height<++t)}function xh(e){this.data=e,this.depth=this.height=0,this.parent=null}function oDe(e,t){var n,r;if(TT(t,e))return[t];for(n=0;n<e.length;++n)if(p_(t,e[n])&&TT(Vm(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(p_(Vm(e[n],e[r]),t)&&p_(Vm(e[n],t),e[r])&&p_(Vm(e[r],t),e[n])&&TT(ZV(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function p_(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function KV(e,t){var n=e.r-t.r+1e-9*Math.max(e.r,t.r,1),r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function TT(e,t){for(var n=0;n<t.length;++n)if(!KV(e,t[n]))return!1;return!0}function sDe(e){switch(e.length){case 1:return function(e){return{x:e.x,y:e.y,r:e.r}}(e[0]);case 2:return Vm(e[0],e[1]);case 3:return ZV(e[0],e[1],e[2])}}function Vm(e,t){var n=e.x,r=e.y,i=e.r,o=t.x,s=t.y,a=t.r,u=o-n,l=s-r,c=a-i,f=Math.sqrt(u*u+l*l);return{x:(n+o+u/f*c)/2,y:(r+s+l/f*c)/2,r:(f+i+a)/2}}function ZV(e,t,n){var r=e.x,i=e.y,o=e.r,s=t.x,a=t.y,u=t.r,l=n.x,c=n.y,f=n.r,d=r-s,h=r-l,p=i-a,g=i-c,m=u-o,v=f-o,y=r*r+i*i-o*o,b=y-s*s-a*a+u*u,_=y-l*l-c*c+f*f,w=h*p-d*g,E=(p*_-g*b)/(2*w)-r,x=(g*m-p*v)/w,D=(h*b-d*_)/(2*w)-i,S=(d*v-h*m)/w,C=x*x+S*S-1,A=2*(o+E*x+D*S),M=E*E+D*D-o*o,T=-(C?(A+Math.sqrt(A*A-4*C*M))/(2*C):M/A);return{x:r+E+x*T,y:i+D+S*T,r:T}}function JV(e,t,n){var i,o,a,u,r=e.x-t.x,s=e.y-t.y,l=r*r+s*s;l?(o=t.r+n.r,u=e.r+n.r,(o*=o)>(u*=u)?(i=(l+u-o)/(2*l),a=Math.sqrt(Math.max(0,u/l-i*i)),n.x=e.x-i*r-a*s,n.y=e.y-i*s+a*r):(i=(l+o-u)/(2*l),a=Math.sqrt(Math.max(0,o/l-i*i)),n.x=t.x+i*r-a*s,n.y=t.y+i*s+a*r)):(n.x=t.x+n.r,n.y=t.y)}function eq(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function tq(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,o=(t.y*n.r+n.y*t.r)/r;return i*i+o*o}function g_(e){this._=e,this.next=null,this.previous=null}function nq(e){if(!(i=(e=function(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}(e)).length))return 0;var t,n,r,i,o,s,a,u,l,c,f;if((t=e[0]).x=0,t.y=0,!(i>1))return t.r;if(t.x=-(n=e[1]).r,n.x=t.r,n.y=0,!(i>2))return t.r+n.r;JV(n,t,r=e[2]),t=new g_(t),n=new g_(n),r=new g_(r),t.next=r.previous=n,n.next=t.previous=r,r.next=n.previous=t;e:for(a=3;a<i;++a){JV(t._,n._,r=e[a]),r=new g_(r),u=n.next,l=t.previous,c=n._.r,f=t._.r;do{if(c<=f){if(eq(u._,r._)){t.next=n=u,n.previous=t,--a;continue e}c+=u._.r,u=u.next}else{if(eq(l._,r._)){(t=l).next=n,n.previous=t,--a;continue e}f+=l._.r,l=l.previous}}while(u!==l.next);for(r.previous=t,r.next=n,t.next=n.previous=n=r,o=tq(t);(r=r.next)!==n;)(s=tq(r))<o&&(t=r,o=s);n=t.next}for(t=[n._],r=n;(r=r.next)!==n;)t.push(r._);for(r=function(e){for(var i,o,t=0,n=(e=function(e){for(var n,r,t=e.length;t;)r=Math.random()*t--|0,n=e[t],e[t]=e[r],e[r]=n;return e}(Array.from(e))).length,r=[];t<n;)i=e[t],o&&KV(o,i)?++t:(o=sDe(r=oDe(r,i)),t=0);return o}(t),a=0;a<i;++a)(t=e[a]).x-=r.x,t.y-=r.y;return r.r}function uDe(e){return null==e?null:m_(e)}function m_(e){if("function"!=typeof e)throw new Error;return e}function Nc(){return 0}function Eh(e){return function(){return e}}function lDe(e){return Math.sqrt(e.value)}function rq(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function kT(e,t){return function(n){if(r=n.children){var r,i,a,o=r.length,s=e(n)*t||0;if(s)for(i=0;i<o;++i)r[i].r+=s;if(a=nq(r),s)for(i=0;i<o;++i)r[i].r-=s;n.r=a+s}}}function iq(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function oq(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function qm(e,t,n,r,i){for(var s,o=e.children,a=-1,u=o.length,l=e.value&&(r-t)/e.value;++a<u;)(s=o[a]).y0=n,s.y1=i,s.x0=t,s.x1=t+=s.value*l}OT.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:YV}]},z(OT,k,{transform(e,t){var n=this.value,r=t.changed(t.ADD_REM),i=e.modified(AT),o=e.iterations||300;if(n?(r&&(t.modifies("index"),n.nodes(t.source)),(i||t.changed(t.MOD))&&XV(n,e,0,t)):(this.value=n=function(e,t){const n=function(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,s=.6,a=new Map,u=HV(f),l=hEe("tick","end"),c=function(){let e=1;return()=>(e=(1664525*e+1013904223)%qV)/qV}();function f(){d(),l.call("tick",t),n<r&&(u.stop(),l.call("end",t))}function d(g){var m,y,v=e.length;void 0===g&&(g=1);for(var b=0;b<g;++b)for(n+=(o-n)*i,a.forEach(function(_){_(n)}),m=0;m<v;++m)null==(y=e[m]).fx?y.x+=y.vx*=s:(y.x=y.fx,y.vx=0),null==y.fy?y.y+=y.vy*=s:(y.y=y.fy,y.vy=0);return t}function h(){for(var v,g=0,m=e.length;g<m;++g){if((v=e[g]).index=g,null!=v.fx&&(v.x=v.fx),null!=v.fy&&(v.y=v.fy),isNaN(v.x)||isNaN(v.y)){var y=10*Math.sqrt(.5+g),b=g*DEe;v.x=y*Math.cos(b),v.y=y*Math.sin(b)}(isNaN(v.vx)||isNaN(v.vy))&&(v.vx=v.vy=0)}}function p(g){return g.initialize&&g.initialize(e,c),g}return null==e&&(e=[]),h(),t={tick:d,restart:function(){return u.restart(f),t},stop:function(){return u.stop(),t},nodes:function(g){return arguments.length?(e=g,h(),a.forEach(p),t):e},alpha:function(g){return arguments.length?(n=+g,t):n},alphaMin:function(g){return arguments.length?(r=+g,t):r},alphaDecay:function(g){return arguments.length?(i=+g,t):+i},alphaTarget:function(g){return arguments.length?(o=+g,t):o},velocityDecay:function(g){return arguments.length?(s=1-g,t):1-s},randomSource:function(g){return arguments.length?(c=g,a.forEach(p),t):c},force:function(g,m){return arguments.length>1?(null==m?a.delete(g):a.set(g,p(m)),t):a.get(g)},find:function(g,m,v){var _,w,E,x,D,y=0,b=e.length;for(null==v?v=1/0:v*=v,y=0;y<b;++y)(E=(_=g-(x=e[y]).x)*_+(w=m-x.y)*w)<v&&(D=x,v=E);return D},on:function(g,m){return arguments.length>1?(l.on(g,m),t):l.on(g)}}}(e),r=n.stop,i=n.restart;let o=!1;return n.stopped=()=>o,n.restart=()=>(o=!1,i()),n.stop=()=>(o=!0,r()),XV(n,t,!0).on("end",()=>o=!0)}(t.source,e),n.on("tick",function(e,t){return()=>e.touch(t).run()}(t.dataflow,this)),e.static||(r=!0,n.tick()),t.modifies("index")),i||r||e.modified(kEe)||t.changed()&&e.restart)if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/o)),e.static)for(n.stop();--o>=0;)n.tick();else if(n.stopped()&&n.restart(),!r)return t.StopPropagation;return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let c,a=this._argops,u=0,l=a.length;u<l;++u)if(c=a[u],c.name===Hm&&"link"===c.op._argval.force)for(var s,r=c.op._argops,i=0,o=r.length;i<o;++i)if("links"===r[i].name&&(s=r[i].op.source)){n.pulse(s,n.changeset().reflow());break}return t.reflow(e.modified()).modifies(YV)}}),xh.prototype=MT.prototype={constructor:xh,count:function(){return this.eachAfter(LEe)},each:function(e,t){let n=-1;for(const r of this)e.call(t,r,++n,this);return this},eachAfter:function(e,t){for(var o,s,a,n=this,r=[n],i=[],u=-1;n=r.pop();)if(i.push(n),o=n.children)for(s=0,a=o.length;s<a;++s)r.push(o[s]);for(;n=i.pop();)e.call(t,n,++u,this);return this},eachBefore:function(e,t){for(var i,o,n=this,r=[n],s=-1;n=r.pop();)if(e.call(t,n,++s,this),i=n.children)for(o=i.length-1;o>=0;--o)r.push(i[o]);return this},find:function(e,t){let n=-1;for(const r of this)if(e.call(t,r,++n,this))return r},sum:function(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n})},sort:function(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})},path:function(e){for(var t=this,n=function(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;for(e=n.pop(),t=r.pop();e===t;)i=e,e=n.pop(),t=r.pop();return i}(t,e),r=[t];t!==n;)r.push(t=t.parent);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r},ancestors:function(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t},descendants:function(){return Array.from(this)},leaves:function(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e},links:function(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t},copy:function(){return MT(this).eachBefore(tDe)},[Symbol.iterator]:function*(){var t,r,i,o,e=this,n=[e];do{for(t=n.reverse(),n=[];e=t.pop();)if(yield e,r=e.children)for(i=0,o=r.length;i<o;++i)n.push(r[i])}while(n.length)}};var dDe={depth:-1},sq={};function hDe(e){return e.id}function pDe(e){return e.parentId}function aq(){var e=hDe,t=pDe;function n(r){var s,a,u,l,c,f,d,i=Array.from(r),o=i.length,h=new Map;for(a=0;a<o;++a)c=i[a]=new xh(s=i[a]),null!=(f=e(s,a,r))&&(f+="")&&(d=c.id=f,h.set(d,h.has(d)?sq:c)),null!=(f=t(s,a,r))&&(f+="")&&(c.parent=f);for(a=0;a<o;++a)if(f=(c=i[a]).parent){if(!(l=h.get(f)))throw new Error("missing: "+f);if(l===sq)throw new Error("ambiguous: "+f);l.children?l.children.push(c):l.children=[c],c.parent=l}else{if(u)throw new Error("multiple roots");u=c}if(!u)throw new Error("no root");if(u.parent=dDe,u.eachBefore(function(p){p.depth=p.parent.depth+1,--o}).eachBefore(QV),u.parent=null,o>0)throw new Error("cycle");return u}return n.id=function(r){return arguments.length?(e=m_(r),n):e},n.parentId=function(r){return arguments.length?(t=m_(r),n):t},n}function gDe(e,t){return e.parent===t.parent?1:2}function IT(e){var t=e.children;return t?t[0]:e.t}function FT(e){var t=e.children;return t?t[t.length-1]:e.t}function mDe(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function vDe(e,t,n){return e.a.parent===t.parent?e.a:n}function y_(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}function wDe(e,t){return e.parent===t.parent?1:2}function EDe(e,t){return e+t.x}function CDe(e,t){return Math.max(e,t.y)}function v_(e,t,n,r,i){for(var s,o=e.children,a=-1,u=o.length,l=e.value&&(i-n)/e.value;++a<u;)(s=o[a]).x0=t,s.x1=r,s.y0=n,s.y1=n+=s.value*l}y_.prototype=Object.create(xh.prototype);var uq=(1+Math.sqrt(5))/2;function lq(e,t,n,r,i,o){for(var u,l,h,p,m,v,y,b,_,w,E,s=[],a=t.children,c=0,f=0,d=a.length,g=t.value;c<d;){h=i-n,p=o-r;do{m=a[f++].value}while(!m&&f<d);for(v=y=m,E=m*m*(w=Math.max(p/h,h/p)/(g*e)),_=Math.max(y/E,E/v);f<d;++f){if(m+=l=a[f].value,l<v&&(v=l),l>y&&(y=l),E=m*m*w,(b=Math.max(y/E,E/v))>_){m-=l;break}_=b}s.push(u={value:m,dice:h<p,children:a.slice(c,f)}),u.dice?qm(u,n,r,i,g?r+=p*m/g:o):v_(u,n,r,g?n+=h*m/g:i,o),g-=m,c=f}return s}const cq=function e(t){function n(r,i,o,s,a){lq(t,r,i,o,s,a)}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(uq),kDe=function e(t){function n(r,i,o,s,a){if((u=r._squarify)&&u.ratio===t)for(var u,l,c,f,h,d=-1,p=u.length,g=r.value;++d<p;){for(c=(l=u[d]).children,f=l.value=0,h=c.length;f<h;++f)l.value+=c[f].value;l.dice?qm(l,i,o,s,g?o+=(a-o)*l.value/g:a):v_(l,i,o,g?i+=(s-i)*l.value/g:s,a),g-=l.value}else r._squarify=u=lq(t,r,i,o,s,a),u.ratio=t}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(uq);function RT(e,t,n){const r={};return e.each(i=>{const o=i.data;n(o)&&(r[t(o)]=i)}),e.lookup=r,e}function NT(e){k.call(this,null,e)}NT.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const FDe=e=>e.values;function RDe(){const e=[],t={entries:i=>r(n(i,0),0),key:i=>(e.push(i),t)};function n(i,o){if(o>=e.length)return i;const s=i.length,a=e[o++],u={},l={};let f,d,h,c=-1;for(;++c<s;)f=a(d=i[c])+"",(h=u[f])?h.push(d):u[f]=[d];for(f in u)l[f]=n(u[f],o);return l}function r(i,o){if(++o>e.length)return i;const s=[];for(const a in i)s.push({key:a,values:r(i[a],o)});return s}return t}function Va(e){k.call(this,null,e)}z(NT,k,{transform(e,t){t.source||F("Nest transform requires an upstream data source.");var n=e.generate,r=e.modified(),i=t.clone(),o=this.value;return(!o||r||t.changed())&&(o&&o.each(s=>{s.children&&y1(s.data)&&i.rem.push(s.data)}),this.value=o=MT({values:X(e.keys).reduce((s,a)=>(s.key(a),s),RDe()).entries(i.source)},FDe),n&&o.each(s=>{s.children&&(s=it(s.data),i.add.push(s),i.source.push(s))}),RT(o,oe,oe)),i.source.root=o,i}});const NDe=(e,t)=>e.parent===t.parent?1:2;z(Va,k,{transform(e,t){(!t.source||!t.source.root)&&F(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),r=this.fields,i=t.source.root,o=e.as||r;e.field?i.sum(e.field):i.count(),e.sort&&i.sort(mc(e.sort,s=>s.data)),function(e,t,n){for(let r,i=0,o=t.length;i<o;++i)r=t[i],r in n&&e[r](n[r])}(n,this.params,e),n.separation&&n.separation(!1!==e.separation?NDe:Od);try{this.value=n(i)}catch(s){F(s)}return i.each(s=>function(e,t,n){const r=e.data,i=t.length-1;for(let o=0;o<i;++o)r[n[o]]=e[t[o]];r[n[i]]=e.children?e.children.length:0}(s,r,o)),t.reflow(e.modified()).modifies(o).modifies("leaf")}});const PT=["x","y","r","depth","children"];function LT(e){Va.call(this,e)}LT.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:PT.length,default:PT}]},z(LT,Va,{layout:function(){var e=null,t=1,n=1,r=Nc;function i(o){return o.x=t/2,o.y=n/2,e?o.eachBefore(rq(e)).eachAfter(kT(r,.5)).eachBefore(iq(1)):o.eachBefore(rq(lDe)).eachAfter(kT(Nc,1)).eachAfter(kT(r,o.r/Math.min(t,n))).eachBefore(iq(Math.min(t,n)/(2*o.r))),o}return i.radius=function(o){return arguments.length?(e=uDe(o),i):e},i.size=function(o){return arguments.length?(t=+o[0],n=+o[1],i):[t,n]},i.padding=function(o){return arguments.length?(r="function"==typeof o?o:Eh(+o),i):r},i},params:["radius","size","padding"],fields:PT});const jT=["x0","y0","x1","y1","depth","children"];function $T(e){Va.call(this,e)}function BT(e){k.call(this,null,e)}$T.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:jT.length,default:jT}]},z($T,Va,{layout:function(){var e=1,t=1,n=0,r=!1;function i(s){var a=s.height+1;return s.x0=s.y0=n,s.x1=e,s.y1=t/a,s.eachBefore(function(s,a){return function(u){u.children&&qm(u,u.x0,s*(u.depth+1)/a,u.x1,s*(u.depth+2)/a);var l=u.x0,c=u.y0,f=u.x1-n,d=u.y1-n;f<l&&(l=f=(l+f)/2),d<c&&(c=d=(c+d)/2),u.x0=l,u.y0=c,u.x1=f,u.y1=d}}(t,a)),r&&s.eachBefore(oq),s}return i.round=function(s){return arguments.length?(r=!!s,i):r},i.size=function(s){return arguments.length?(e=+s[0],t=+s[1],i):[e,t]},i.padding=function(s){return arguments.length?(n=+s,i):n},i},params:["size","round","padding"],fields:jT}),BT.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},z(BT,k,{transform(e,t){t.source||F("Stratify transform requires an upstream data source.");let n=this.value;const r=e.modified(),i=t.fork(t.ALL).materialize(t.SOURCE),o=!n||r||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return i.source=i.source.slice(),o&&(n=i.source.length?RT(aq().id(e.key).parentId(e.parentKey)(i.source),e.key,Yi):RT(aq()([{}]),e.key,e.key)),i.source.root=this.value=n,i}});const fq={tidy:function(){var e=gDe,t=1,n=1,r=null;function i(l){var c=function(e){for(var n,i,o,s,a,t=new y_(e,0),r=[t];n=r.pop();)if(o=n._.children)for(n.children=new Array(a=o.length),s=a-1;s>=0;--s)r.push(i=n.children[s]=new y_(o[s],s)),i.parent=n;return(t.parent=new y_(null,0)).children=[t],t}(l);if(c.eachAfter(o),c.parent.m=-c.z,c.eachBefore(s),r)l.eachBefore(u);else{var f=l,d=l,h=l;l.eachBefore(function(y){y.x<f.x&&(f=y),y.x>d.x&&(d=y),y.depth>h.depth&&(h=y)});var p=f===d?1:e(f,d)/2,g=p-f.x,m=t/(d.x+p+g),v=n/(h.depth||1);l.eachBefore(function(y){y.x=(y.x+g)*m,y.y=y.depth*v})}return l}function o(l){var c=l.children,f=l.parent.children,d=l.i?f[l.i-1]:null;if(c){!function(e){for(var o,t=0,n=0,r=e.children,i=r.length;--i>=0;)(o=r[i]).z+=t,o.m+=t,t+=o.s+(n+=o.c)}(l);var h=(c[0].z+c[c.length-1].z)/2;d?(l.z=d.z+e(l._,d._),l.m=l.z-h):l.z=h}else d&&(l.z=d.z+e(l._,d._));l.parent.A=function(l,c,f){if(c){for(var _,d=l,h=l,p=c,g=d.parent.children[0],m=d.m,v=h.m,y=p.m,b=g.m;p=FT(p),d=IT(d),p&&d;)g=IT(g),(h=FT(h)).a=l,(_=p.z+y-d.z-m+e(p._,d._))>0&&(mDe(vDe(p,l,f),l,_),m+=_,v+=_),y+=p.m,m+=d.m,b+=g.m,v+=h.m;p&&!FT(h)&&(h.t=p,h.m+=y-v),d&&!IT(g)&&(g.t=d,g.m+=m-b,f=l)}return f}(l,d,l.parent.A||f[0])}function s(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function u(l){l.x*=t,l.y=l.depth*n}return i.separation=function(l){return arguments.length?(e=l,i):e},i.size=function(l){return arguments.length?(r=!1,t=+l[0],n=+l[1],i):r?null:[t,n]},i.nodeSize=function(l){return arguments.length?(r=!0,t=+l[0],n=+l[1],i):r?[t,n]:null},i},cluster:function(){var e=wDe,t=1,n=1,r=!1;function i(o){var s,a=0;o.eachAfter(function(d){var h=d.children;h?(d.x=function(e){return e.reduce(EDe,0)/e.length}(h),d.y=function(e){return 1+e.reduce(CDe,0)}(h)):(d.x=s?a+=e(d,s):0,d.y=0,s=d)});var u=function(e){for(var t;t=e.children;)e=t[0];return e}(o),l=function(e){for(var t;t=e.children;)e=t[t.length-1];return e}(o),c=u.x-e(u,l)/2,f=l.x+e(l,u)/2;return o.eachAfter(r?function(d){d.x=(d.x-o.x)*t,d.y=(o.y-d.y)*n}:function(d){d.x=(d.x-c)/(f-c)*t,d.y=(1-(o.y?d.y/o.y:1))*n})}return i.separation=function(o){return arguments.length?(e=o,i):e},i.size=function(o){return arguments.length?(r=!1,t=+o[0],n=+o[1],i):r?null:[t,n]},i.nodeSize=function(o){return arguments.length?(r=!0,t=+o[0],n=+o[1],i):r?[t,n]:null},i}},zT=["x","y","depth","children"];function UT(e){Va.call(this,e)}function HT(e){k.call(this,[],e)}UT.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:zT.length,default:zT}]},z(UT,Va,{layout(e){const t=e||"tidy";if(ne(fq,t))return fq[t]();F("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:zT}),HT.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},z(HT,k,{transform(e,t){const n=this.value,r=t.source&&t.source.root,i=t.fork(t.NO_SOURCE),o={};return r||F("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(i.rem=n,t.visit(t.SOURCE,s=>o[oe(s)]=1),r.each(s=>{const a=s.data,u=s.parent&&s.parent.data;u&&o[oe(a)]&&o[oe(u)]&&i.add.push(it({source:u,target:a}))}),this.value=i.add):t.changed(t.MOD)&&(t.visit(t.MOD,s=>o[oe(s)]=1),n.forEach(s=>{(o[oe(s.source)]||o[oe(s.target)])&&i.mod.push(s)})),i}});const dq={binary:function(e,t,n,r,i){var s,u,o=e.children,a=o.length,l=new Array(a+1);for(l[0]=u=s=0;s<a;++s)l[s+1]=u+=o[s].value;!function c(f,d,h,p,g,m,v){if(f>=d-1){var y=o[f];return y.x0=p,y.y0=g,y.x1=m,void(y.y1=v)}for(var b=l[f],_=h/2+b,w=f+1,E=d-1;w<E;){var x=w+E>>>1;l[x]<_?w=x+1:E=x}_-l[w-1]<l[w]-_&&f+1<w&&--w;var D=l[w]-b,S=h-D;if(m-p>v-g){var C=h?(p*S+m*D)/h:m;c(f,w,D,p,g,C,v),c(w,d,S,C,g,m,v)}else{var A=h?(g*S+v*D)/h:v;c(f,w,D,p,g,m,A),c(w,d,S,p,A,m,v)}}(0,a,e.value,t,n,r,i)},dice:qm,slice:v_,slicedice:function(e,t,n,r,i){(1&e.depth?v_:qm)(e,t,n,r,i)},squarify:cq,resquarify:kDe},VT=["x0","y0","x1","y1","depth","children"];function qT(e){Va.call(this,e)}function UDe(e,t,n,r){const i=e.width,o=e.height,s=n||r,a=Qd(i,o).getContext("2d");t.forEach(m=>hq(a,m,s));const u=new Uint32Array(a.getImageData(0,0,i,o).data.buffer),l=e.bitmap(),c=s&&e.bitmap();let f,d,h,p,g;for(d=0;d<o;++d)for(f=0;f<i;++f)g=4278190080&u[d*i+f],g&&(h=e(f),p=e(d),r||l.set(h,p),s&&268435456^g&&c.set(h,p));return[l,c]}function hq(e,t,n){if(!t.length)return;const r=t[0].mark.marktype;"group"===r?t.forEach(i=>{i.items.forEach(o=>hq(e,o.items,n))}):Si[r].draw(e,{items:n?t.map(HDe):t})}function HDe(e){const t=v1(e,{});return t.stroke&&(t.strokeOpacity=1),t.fill&&(t.fillOpacity=.0625,t.stroke="#000",t.strokeOpacity=1,t.strokeWidth=2),t}qT.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:VT.length,default:VT}]},z(qT,Va,{layout(){const e=function(){var e=cq,t=!1,n=1,r=1,i=[0],o=Nc,s=Nc,a=Nc,u=Nc,l=Nc;function c(d){return d.x0=d.y0=0,d.x1=n,d.y1=r,d.eachBefore(f),i=[0],t&&d.eachBefore(oq),d}function f(d){var h=i[d.depth],p=d.x0+h,g=d.y0+h,m=d.x1-h,v=d.y1-h;m<p&&(p=m=(p+m)/2),v<g&&(g=v=(g+v)/2),d.x0=p,d.y0=g,d.x1=m,d.y1=v,d.children&&(h=i[d.depth+1]=o(d)/2,p+=l(d)-h,g+=s(d)-h,(m-=a(d)-h)<p&&(p=m=(p+m)/2),(v-=u(d)-h)<g&&(g=v=(g+v)/2),e(d,p,g,m,v))}return c.round=function(d){return arguments.length?(t=!!d,c):t},c.size=function(d){return arguments.length?(n=+d[0],r=+d[1],c):[n,r]},c.tile=function(d){return arguments.length?(e=m_(d),c):e},c.padding=function(d){return arguments.length?c.paddingInner(d).paddingOuter(d):c.paddingInner()},c.paddingInner=function(d){return arguments.length?(o="function"==typeof d?d:Eh(+d),c):o},c.paddingOuter=function(d){return arguments.length?c.paddingTop(d).paddingRight(d).paddingBottom(d).paddingLeft(d):c.paddingTop()},c.paddingTop=function(d){return arguments.length?(s="function"==typeof d?d:Eh(+d),c):s},c.paddingRight=function(d){return arguments.length?(a="function"==typeof d?d:Eh(+d),c):a},c.paddingBottom=function(d){return arguments.length?(u="function"==typeof d?d:Eh(+d),c):u},c.paddingLeft=function(d){return arguments.length?(l="function"==typeof d?d:Eh(+d),c):l},c}();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{ne(dq,t)?e.tile(dq[t]):F("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:VT});const hl=new Uint32Array(33),Bo=new Uint32Array(33);Bo[0]=0,hl[0]=~Bo[0];for(let e=1;e<=32;++e)Bo[e]=Bo[e-1]<<1|1,hl[e]=~Bo[e];function GDe(e,t,n,r,i,o){let s=n/2;return e-s<0||e+s>i||t-(s=r/2)<0||t+s>o}function YDe(){return!1}function XDe(e,t,n,r,i,o,s,a){const u=i*o/(2*r),l=e(t-u),c=e(t+u),f=e(n-(o/=2)),d=e(n+o);return s.outOfBounds(l,f,c,d)||s.getRange(l,f,c,d)||a&&a.getRange(l,f,c,d)}function QDe(e,t,n,r,i,o,s,a){const u=i*o/(2*r);let l=e(t-u),c=e(t+u),f=e(n-(o/=2)),d=e(n+o);return l=l>0?l:0,f=f>0?f:0,c=c<e.width?c:e.width-1,d=d<e.height?d:e.height-1,s.getRange(l,f,c,d)||a&&a.getRange(l,f,c,d)}function pq(e){return e?[QDe,YDe]:[XDe,GDe]}const ZDe=[-1,-1,1,1],JDe=[-1,1,-1,1],tCe=["right","center","left"],nCe=["bottom","middle","top"];function gq(e,t,n,r,i,o,s,a,u,l,c,f){return!(i.outOfBounds(e,n,t,r)||(f&&o?o.getRange(e,n,t,r)||!function(e,t,n,r,i){return i[0]<=e&&n<=i[2]&&i[3]<=t&&r<=i[5]}(s,u,a,l,c):i.getRange(e,n,t,r)))}const oCe={"top-left":0,top:1,"top-right":2,left:4,middle:5,right:6,"bottom-left":8,bottom:9,"bottom-right":10},sCe={naive:function(e,t,n,r){const i=e.width,o=e.height;return function(s){const a=s.datum.datum.items[r].items,u=a.length,l=s.datum.fontSize,c=Ps.width(s.datum,s.datum.text);let d,h,p,g,m,v,y,f=0;for(let b=0;b<u;++b)d=a[b].x,p=a[b].y,h=void 0===a[b].x2?d:a[b].x2,g=void 0===a[b].y2?p:a[b].y2,m=(d+h)/2,v=(p+g)/2,y=Math.abs(h-d+g-p),y>=f&&(f=y,s.x=m,s.y=v);return m=c/2,v=l/2,d=s.x-m,h=s.x+m,p=s.y-v,g=s.y+v,s.align="center",d<0&&h<=i?s.align="left":0<=d&&i<h&&(s.align="right"),s.baseline="middle",p<0&&g<=o?s.baseline="top":0<=p&&o<g&&(s.baseline="bottom"),!0}},"reduced-search":function(e,t,n,r,i){const o=e.width,s=e.height,[a,u]=pq(i),l=t[0],c=t[1];function f(d,h,p,g,m){const v=e.invert(d),y=e.invert(h);let w,b=p,_=s;if(!u(v,y,g,m,o,s)&&!a(e,v,y,m,g,b,l,c)&&!a(e,v,y,m,g,m,l,null)){for(;_-b>=1;)w=(b+_)/2,a(e,v,y,m,g,w,l,c)?_=w:b=w;if(b>p)return[v,y,b,!0]}}return function(d){const h=d.datum.datum.items[r].items,p=h.length,g=d.datum.fontSize,m=Ps.width(d.datum,d.datum.text);let w,E,x,D,S,C,A,M,T,L,O,N,U,W,te,pe,We,v=n?g:0,y=!1,b=!1,_=0;for(let Ge=0;Ge<p;++Ge){for(w=h[Ge].x,x=h[Ge].y,E=void 0===h[Ge].x2?w:h[Ge].x2,D=void 0===h[Ge].y2?x:h[Ge].y2,w>E&&(We=w,w=E,E=We),x>D&&(We=x,x=D,D=We),T=e(w),O=e(E),L=~~((T+O)/2),N=e(x),W=e(D),U=~~((N+W)/2),A=L;A>=T;--A)for(M=U;M>=N;--M)pe=f(A,M,v,m,g),pe&&([d.x,d.y,v,y]=pe);for(A=L;A<=O;++A)for(M=U;M<=W;++M)pe=f(A,M,v,m,g),pe&&([d.x,d.y,v,y]=pe);!y&&!n&&(te=Math.abs(E-w+D-x),S=(w+E)/2,C=(x+D)/2,te>=_&&!u(S,C,m,g,o,s)&&!a(e,S,C,g,m,g,l,null)&&(_=te,d.x=S,d.y=C,b=!0))}return!(!y&&!b||(S=m/2,C=g/2,l.setRange(e(d.x-S),e(d.y-C),e(d.x+S),e(d.y+C)),d.align="center",d.baseline="middle",0))}},floodfill:function(e,t,n,r,i){const o=e.width,s=e.height,[a,u]=pq(i),l=t[0],c=t[1],f=e.bitmap();return function(d){const h=d.datum.datum.items[r].items,p=h.length,g=d.datum.fontSize,m=Ps.width(d.datum,d.datum.text),v=[];let E,x,D,S,C,A,M,T,L,O,N,U,y=n?g:0,b=!1,_=!1,w=0;for(let W=0;W<p;++W){for(E=h[W].x,D=h[W].y,x=void 0===h[W].x2?E:h[W].x2,S=void 0===h[W].y2?D:h[W].y2,v.push([e((E+x)/2),e((D+S)/2)]);v.length;)if([M,T]=v.pop(),!(l.get(M,T)||c.get(M,T)||f.get(M,T))){f.set(M,T);for(let te=0;te<4;++te)C=M+ZDe[te],A=T+JDe[te],f.outOfBounds(C,A,C,A)||v.push([C,A]);if(C=e.invert(M),A=e.invert(T),L=y,O=s,!u(C,A,m,g,o,s)&&!a(e,C,A,g,m,L,l,c)&&!a(e,C,A,g,m,g,l,null)){for(;O-L>=1;)N=(L+O)/2,a(e,C,A,g,m,N,l,c)?O=N:L=N;L>y&&(d.x=C,d.y=A,y=L,b=!0)}}!b&&!n&&(U=Math.abs(x-E+S-D),C=(E+x)/2,A=(D+S)/2,U>=w&&!u(C,A,m,g,o,s)&&!a(e,C,A,g,m,g,l,null)&&(w=U,d.x=C,d.y=A,_=!0))}return!(!b&&!_||(C=m/2,A=g/2,l.setRange(e(d.x-C),e(d.y-A),e(d.x+C),e(d.y+A)),d.align="center",d.baseline="middle",0))}}};function aCe(e,t,n,r,i,o,s,a,u,l,c){if(!e.length)return e;const f=Math.max(r.length,i.length),d=function(e,t){const n=new Float64Array(t),r=e.length;for(let i=0;i<r;++i)n[i]=e[i]||0;for(let i=r;i<t;++i)n[i]=n[r-1];return n}(r,f),h=function(e,t){const n=new Int8Array(t),r=e.length;for(let i=0;i<r;++i)n[i]|=oCe[e[i]];for(let i=r;i<t;++i)n[i]=n[r-1];return n}(i,f),p=function(e){return e&&e.mark&&e.mark.marktype}(e[0].datum),g="group"===p&&e[0].datum.items[u].marktype,m="area"===g,v=function(e,t,n,r){const i=o=>[o.x,o.x,o.x,o.y,o.y,o.y];return e?"line"===e||"area"===e?o=>i(o.datum):"line"===t?o=>{const s=o.datum.items[r].items;return i(s.length?s["start"===n?0:s.length-1]:{x:NaN,y:NaN})}:o=>{const s=o.datum.bounds;return[s.x1,(s.x1+s.x2)/2,s.x2,s.y1,(s.y1+s.y2)/2,s.y2]}:i}(p,g,a,u),y=null===l||l===1/0,b=function(e,t,n){const r=Math.max(1,Math.sqrt(e*t/1e6)),i=~~((e+2*n+r)/r),o=~~((t+2*n+r)/r),s=a=>~~((a+n)/r);return s.invert=a=>a*r-n,s.bitmap=()=>function(e,t){const n=new Uint32Array(~~((e*t+32)/32));function r(o,s){n[o]|=s}function i(o,s){n[o]&=s}return{array:n,get:(o,s)=>{const a=s*e+o;return n[a>>>5]&1<<(31&a)},set:(o,s)=>{const a=s*e+o;r(a>>>5,1<<(31&a))},clear:(o,s)=>{const a=s*e+o;i(a>>>5,~(1<<(31&a)))},getRange:(o,s,a,u)=>{let c,f,d,h,l=u;for(;l>=s;--l)if(c=l*e+o,f=l*e+a,d=c>>>5,h=f>>>5,d===h){if(n[d]&hl[31&c]&Bo[1+(31&f)])return!0}else{if(n[d]&hl[31&c]||n[h]&Bo[1+(31&f)])return!0;for(let p=d+1;p<h;++p)if(n[p])return!0}return!1},setRange:(o,s,a,u)=>{let l,c,f,d,h;for(;s<=u;++s)if(l=s*e+o,c=s*e+a,f=l>>>5,d=c>>>5,f===d)r(f,hl[31&l]&Bo[1+(31&c)]);else for(r(f,hl[31&l]),r(d,Bo[1+(31&c)]),h=f+1;h<d;++h)r(h,4294967295)},clearRange:(o,s,a,u)=>{let l,c,f,d,h;for(;s<=u;++s)if(l=s*e+o,c=s*e+a,f=l>>>5,d=c>>>5,f===d)i(f,Bo[31&l]|hl[1+(31&c)]);else for(i(f,Bo[31&l]),i(d,hl[1+(31&c)]),h=f+1;h<d;++h)i(h,0)},outOfBounds:(o,s,a,u)=>o<0||s<0||u>=t||a>=e}}(i,o),s.ratio=r,s.padding=n,s.width=e,s.height=t,s}(t[0],t[1],y?0:l),_=m&&"naive"===c,w=e.map(D=>({datum:D,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:v(D)}));let E;if(!_){n&&w.sort((S,C)=>n(S.datum,C.datum));let D=!1;for(let S=0;S<h.length&&!D;++S)D=5===h[S]||d[S]<0;p&&(s||m)&&(o=[e.map(S=>S.datum)].concat(o)),E=o.length?UDe(b,o,D,m):function(e,t){const n=e.bitmap();return(t||[]).forEach(r=>n.set(e(r.boundary[0]),e(r.boundary[3]))),[n,void 0]}(b,s&&w)}const x=m?sCe[c](b,E,s,u,y):function(e,t,n,r,i){const o=e.width,s=e.height,a=t[0],u=t[1],l=r.length;return function(c){const f=c.boundary,d=c.datum.fontSize;if(!i&&(f[2]<0||f[5]<0||f[0]>o||f[3]>s))return!1;let p,g,m,v,y,b,_,w,E,x,D,S,C,A,M,h=0;for(let T=0;T<l;++T){if(p=(3&n[T])-1,g=(n[T]>>>2&3)-1,m=0===p&&0===g||r[T]<0,v=p&&g?Math.SQRT1_2:1,y=r[T]<0?-1:1,b=f[1+p]+r[T]*p*v,D=f[4+g]+y*d*g/2+r[T]*g*v,w=D-d/2,E=D+d/2,S=e(b),A=e(w),M=e(E),i&&(S=S<0?0:S,A=A<0?0:A,M=M>=e.height?e.height-1:M),!h){if(!gq(S,S,A,M,a,u,b,b,w,E,f,m))continue;h=Ps.width(c.datum,c.datum.text)}if(x=b+y*h*p/2,b=x-h/2,_=x+h/2,S=e(b),C=e(_),i&&(S=S<0?0:S,C=C>=e.width?e.width-1:C),gq(S,C,A,M,a,u,b,_,w,E,f,m))return c.x=p?p*y<0?_:b:x,c.y=g?g*y<0?E:w:D,c.align=tCe[p*y+1],c.baseline=nCe[g*y+1],a.setRange(S,A,C,M),!0}return!1}}(b,E,h,d,y);return w.forEach(D=>D.opacity=+x(D)),w}const ZT=["x","y","opacity","align","baseline"],mq=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function JT(e){k.call(this,null,e)}function yq(e,t){var i,o,s,a,u,l,n=[],r=function(c){return c(a)};if(null==t)n.push(e);else for(i={},o=0,s=e.length;o<s;++o)a=e[o],(l=i[u=t.map(r)])||(i[u]=l=[],l.dims=u,n.push(l)),l.push(a);return n}function ek(e){k.call(this,null,e)}JT.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:mq},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:ZT.length,default:ZT}]},z(JT,k,{transform(e,t){const r=e.modified();if(!(r||t.changed(t.ADD_REM)||function(o){const s=e.sort;return xe(s)&&t.modified(s.fields)}()))return;(!e.size||2!==e.size.length)&&F("Size parameter should be specified as a [width, height] array.");const i=e.as||ZT;return aCe(t.materialize(t.SOURCE).source||[],e.size,e.sort,X(null==e.offset?1:e.offset),X(e.anchor||mq),e.avoidMarks||[],!1!==e.avoidBaseMark,e.lineAnchor||"end",e.markIndex||0,void 0===e.padding?0:e.padding,e.method||"naive").forEach(o=>{const s=o.datum;s[i[0]]=o.x,s[i[1]]=o.y,s[i[2]]=o.opacity,s[i[3]]=o.align,s[i[4]]=o.baseline}),t.reflow(r).modifies(i)}}),ek.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},z(ek,k,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=yq(t.materialize(t.SOURCE).source,e.groupby),o=(e.groupby||[]).map(Bt),s=o.length,a=e.as||[Bt(e.x),Bt(e.y)],u=[];i.forEach(l=>{P4(l,e.x,e.y,e.bandwidth||.3).forEach(c=>{const f={};for(let d=0;d<s;++d)f[o[d]]=l.dims[d];f[a[0]]=c[0],f[a[1]]=c[1],u.push(it(f))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});const tk={linear:eO,log:T4,exp:k4,pow:I4,quad:tO,poly:F4};function nk(e){k.call(this,null,e)}nk.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(tk)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},z(nk,k,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=yq(t.materialize(t.SOURCE).source,e.groupby),o=(e.groupby||[]).map(Bt),s=e.method||"linear",a=e.order||3,u=((e,t)=>"poly"===e?t:"quad"===e?2:1)(s,a),l=e.as||[Bt(e.x),Bt(e.y)],c=tk[s],f=[];let d=e.extent;ne(tk,s)||F("Invalid regression method: "+s),null!=d&&"log"===s&&d[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),d=null),i.forEach(h=>{if(h.length<=u)return void t.dataflow.warn("Skipping regression with more parameters than data points.");const g=c(h,e.x,e.y,a);if(e.params)return void f.push(it({keys:h.dims,coef:g.coef,rSquared:g.rSquared}));const m=d||Cs(h,e.x),v=y=>{const b={};for(let _=0;_<o.length;++_)b[o[_]]=h.dims[_];b[l[0]]=y[0],b[l[1]]=y[1],f.push(it(b))};"linear"===s?m.forEach(y=>v([y,g.predict(y)])):O1(g.predict,m,25,200).forEach(v)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=f}return n}});const vq=Math.pow(2,-52),b_=new Uint32Array(512);class __{static from(t,n=yCe,r=vCe){const i=t.length,o=new Float64Array(2*i);for(let s=0;s<i;s++){const a=t[s];o[2*s]=n(a),o[2*s+1]=r(a)}return new __(o)}constructor(t){const n=t.length>>1;if(n>0&&"number"!=typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;const r=Math.max(2*n-5,0);this._triangles=new Uint32Array(3*r),this._halfedges=new Int32Array(3*r),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:r,_hullTri:i,_hullHash:o}=this,s=t.length>>1;let a=1/0,u=1/0,l=-1/0,c=-1/0;for(let C=0;C<s;C++){const A=t[2*C],M=t[2*C+1];A<a&&(a=A),M<u&&(u=M),A>l&&(l=A),M>c&&(c=M),this._ids[C]=C}const f=(a+l)/2,d=(u+c)/2;let p,g,m,h=1/0;for(let C=0;C<s;C++){const A=rk(f,d,t[2*C],t[2*C+1]);A<h&&(p=C,h=A)}const v=t[2*p],y=t[2*p+1];h=1/0;for(let C=0;C<s;C++){if(C===p)continue;const A=rk(v,y,t[2*C],t[2*C+1]);A<h&&A>0&&(g=C,h=A)}let b=t[2*g],_=t[2*g+1],w=1/0;for(let C=0;C<s;C++){if(C===p||C===g)continue;const A=gCe(v,y,b,_,t[2*C],t[2*C+1]);A<w&&(m=C,w=A)}let E=t[2*m],x=t[2*m+1];if(w===1/0){for(let M=0;M<s;M++)this._dists[M]=t[2*M]-t[0]||t[2*M+1]-t[1];Dh(this._ids,this._dists,0,s-1);const C=new Uint32Array(s);let A=0;for(let M=0,T=-1/0;M<s;M++){const L=this._ids[M];this._dists[L]>T&&(C[A++]=L,T=this._dists[L])}return this.hull=C.subarray(0,A),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(w_(v,y,b,_,E,x)){const C=g,A=b,M=_;g=m,b=E,_=x,m=C,E=A,x=M}const D=function(e,t,n,r,i,o){const s=n-e,a=r-t,u=i-e,l=o-t,c=s*s+a*a,f=u*u+l*l,d=.5/(s*l-a*u);return{x:e+(l*c-a*f)*d,y:t+(s*f-u*c)*d}}(v,y,b,_,E,x);this._cx=D.x,this._cy=D.y;for(let C=0;C<s;C++)this._dists[C]=rk(t[2*C],t[2*C+1],D.x,D.y);Dh(this._ids,this._dists,0,s-1),this._hullStart=p;let S=3;r[p]=n[m]=g,r[g]=n[p]=m,r[m]=n[g]=p,i[p]=0,i[g]=1,i[m]=2,o.fill(-1),o[this._hashKey(v,y)]=p,o[this._hashKey(b,_)]=g,o[this._hashKey(E,x)]=m,this.trianglesLen=0,this._addTriangle(p,g,m,-1,-1,-1);for(let A,M,C=0;C<this._ids.length;C++){const T=this._ids[C],L=t[2*T],O=t[2*T+1];if(C>0&&Math.abs(L-A)<=vq&&Math.abs(O-M)<=vq||(A=L,M=O,T===p||T===g||T===m))continue;let N=0;for(let We=0,Ge=this._hashKey(L,O);We<this._hashSize&&(N=o[(Ge+We)%this._hashSize],-1===N||N===r[N]);We++);N=n[N];let W,U=N;for(;W=r[U],!w_(L,O,t[2*U],t[2*U+1],t[2*W],t[2*W+1]);)if(U=W,U===N){U=-1;break}if(-1===U)continue;let te=this._addTriangle(U,T,r[U],-1,-1,i[U]);i[T]=this._legalize(te+2),i[U]=te,S++;let pe=r[U];for(;W=r[pe],w_(L,O,t[2*pe],t[2*pe+1],t[2*W],t[2*W+1]);)te=this._addTriangle(pe,T,W,i[T],-1,i[pe]),i[T]=this._legalize(te+2),r[pe]=pe,S--,pe=W;if(U===N)for(;W=n[U],w_(L,O,t[2*W],t[2*W+1],t[2*U],t[2*U+1]);)te=this._addTriangle(W,T,U,-1,i[U],i[W]),this._legalize(te+2),i[W]=te,r[U]=U,S--,U=W;this._hullStart=n[T]=U,r[U]=n[pe]=T,r[T]=pe,o[this._hashKey(L,O)]=T,o[this._hashKey(t[2*U],t[2*U+1])]=U}this.hull=new Uint32Array(S);for(let C=0,A=this._hullStart;C<S;C++)this.hull[C]=A,A=r[A];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(function(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:r,coords:i}=this;let o=0,s=0;for(;;){const a=r[t],u=t-t%3;if(s=u+(t+2)%3,-1===a){if(0===o)break;t=b_[--o];continue}const l=a-a%3,f=l+(a+2)%3,d=n[s],h=n[t],p=n[u+(t+1)%3],g=n[f];if(pCe(i[2*d],i[2*d+1],i[2*h],i[2*h+1],i[2*p],i[2*p+1],i[2*g],i[2*g+1])){n[t]=g,n[a]=d;const v=r[f];if(-1===v){let b=this._hullStart;do{if(this._hullTri[b]===f){this._hullTri[b]=t;break}b=this._hullPrev[b]}while(b!==this._hullStart)}this._link(t,v),this._link(a,r[s]),this._link(s,f);const y=l+(a+1)%3;o<b_.length&&(b_[o++]=y)}else{if(0===o)break;t=b_[--o]}}return s}_link(t,n){this._halfedges[t]=n,-1!==n&&(this._halfedges[n]=t)}_addTriangle(t,n,r,i,o,s){const a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=n,this._triangles[a+2]=r,this._link(a,i),this._link(a+1,o),this._link(a+2,s),this.trianglesLen+=3,a}}function rk(e,t,n,r){const i=e-n,o=t-r;return i*i+o*o}function ik(e,t,n,r,i,o){const s=(r-t)*(i-e),a=(n-e)*(o-t);return Math.abs(s-a)>=33306690738754716e-32*Math.abs(s+a)?s-a:0}function w_(e,t,n,r,i,o){return(ik(i,o,e,t,n,r)||ik(e,t,n,r,i,o)||ik(n,r,i,o,e,t))<0}function pCe(e,t,n,r,i,o,s,a){const u=e-s,l=t-a,c=n-s,f=r-a,d=i-s,h=o-a,g=c*c+f*f,m=d*d+h*h;return u*(f*m-g*h)-l*(c*m-g*d)+(u*u+l*l)*(c*h-f*d)<0}function gCe(e,t,n,r,i,o){const s=n-e,a=r-t,u=i-e,l=o-t,c=s*s+a*a,f=u*u+l*l,d=.5/(s*l-a*u),h=(l*c-a*f)*d,p=(s*f-u*c)*d;return h*h+p*p}function Dh(e,t,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const o=e[i],s=t[o];let a=i-1;for(;a>=n&&t[e[a]]>s;)e[a+1]=e[a--];e[a+1]=o}else{let o=n+1,s=r;Gm(e,n+r>>1,o),t[e[n]]>t[e[r]]&&Gm(e,n,r),t[e[o]]>t[e[r]]&&Gm(e,o,r),t[e[n]]>t[e[o]]&&Gm(e,n,o);const a=e[o],u=t[a];for(;;){do{o++}while(t[e[o]]<u);do{s--}while(t[e[s]]>u);if(s<o)break;Gm(e,o,s)}e[n+1]=e[s],e[s]=a,r-o+1>=s-n?(Dh(e,t,o,r),Dh(e,t,n,s-1)):(Dh(e,t,n,s-1),Dh(e,t,o,r))}}function Gm(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function yCe(e){return e[0]}function vCe(e){return e[1]}class Pc{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,r){const i=(t=+t)+(r=+r),o=n=+n;if(r<0)throw new Error("negative radius");null===this._x1?this._+=`M${i},${o}`:(Math.abs(this._x1-i)>1e-6||Math.abs(this._y1-o)>1e-6)&&(this._+="L"+i+","+o),r&&(this._+=`A${r},${r},0,1,1,${t-r},${n}A${r},${r},0,1,1,${this._x1=i},${this._y1=o}`)}rect(t,n,r,i){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+r}v${+i}h${-r}Z`}value(){return this._||null}}class ok{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}class bCe{constructor(t,[n,r,i,o]=[0,0,960,500]){if(!((i=+i)>=(n=+n)&&(o=+o)>=(r=+r)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(2*t.points.length),this.vectors=new Float64Array(2*t.points.length),this.xmax=i,this.xmin=n,this.ymax=o,this.ymin=r,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:r},vectors:i}=this,o=this.circumcenters=this._circumcenters.subarray(0,r.length/3*2);for(let m,v,h=0,p=0,g=r.length;h<g;h+=3,p+=2){const y=2*r[h],b=2*r[h+1],_=2*r[h+2],w=t[y],E=t[y+1],S=t[_],C=t[_+1],A=t[b]-w,M=t[b+1]-E,T=S-w,L=C-E,O=A*A+M*M,N=T*T+L*L,U=2*(A*L-M*T);if(U)if(Math.abs(U)<1e-8)m=(w+S)/2,v=(E+C)/2;else{const W=1/U;m=w+(L*O-M*N)*W,v=E+(A*N-T*O)*W}else m=(w+S)/2-1e8*L,v=(E+C)/2+1e8*T;o[p]=m,o[p+1]=v}let a,l,f,s=n[n.length-1],u=4*s,c=t[2*s],d=t[2*s+1];i.fill(0);for(let h=0;h<n.length;++h)s=n[h],a=u,l=c,f=d,u=4*s,c=t[2*s],d=t[2*s+1],i[a+2]=i[u]=f-d,i[a+3]=i[u+1]=c-l}render(t){const n=null==t?t=new Pc:void 0,{delaunay:{halfedges:r,inedges:i,hull:o},circumcenters:s,vectors:a}=this;if(o.length<=1)return null;for(let c=0,f=r.length;c<f;++c){const d=r[c];if(d<c)continue;const h=2*Math.floor(c/3),p=2*Math.floor(d/3);this._renderSegment(s[h],s[h+1],s[p],s[p+1],t)}let u,l=o[o.length-1];for(let c=0;c<o.length;++c){u=l,l=o[c];const f=2*Math.floor(i[l]/3),d=s[f],h=s[f+1],p=4*u,g=this._project(d,h,a[p+2],a[p+3]);g&&this._renderSegment(d,h,g[0],g[1],t)}return n&&n.value()}renderBounds(t){const n=null==t?t=new Pc:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const r=null==n?n=new Pc:void 0,i=this._clip(t);if(null===i||!i.length)return;n.moveTo(i[0],i[1]);let o=i.length;for(;i[0]===i[o-2]&&i[1]===i[o-1]&&o>1;)o-=2;for(let s=2;s<o;s+=2)(i[s]!==i[s-2]||i[s+1]!==i[s-1])&&n.lineTo(i[s],i[s+1]);return n.closePath(),r&&r.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,r=t.length/2;n<r;++n){const i=this.cellPolygon(n);i&&(i.index=n,yield i)}}cellPolygon(t){const n=new ok;return this.renderCell(t,n),n.value()}_renderSegment(t,n,r,i,o){let s;const a=this._regioncode(t,n),u=this._regioncode(r,i);0===a&&0===u?(o.moveTo(t,n),o.lineTo(r,i)):(s=this._clipSegment(t,n,r,i,a,u))&&(o.moveTo(s[0],s[1]),o.lineTo(s[2],s[3]))}contains(t,n,r){return(n=+n)==n&&(r=+r)==r&&this.delaunay._step(t,n,r)===t}*neighbors(t){const n=this._clip(t);if(n)for(const r of this.delaunay.neighbors(t)){const i=this._clip(r);if(i)e:for(let o=0,s=n.length;o<s;o+=2)for(let a=0,u=i.length;a<u;a+=2)if(n[o]==i[a]&&n[o+1]==i[a+1]&&n[(o+2)%s]==i[(a+u-2)%u]&&n[(o+3)%s]==i[(a+u-1)%u]){yield r;break e}}}_cell(t){const{circumcenters:n,delaunay:{inedges:r,halfedges:i,triangles:o}}=this,s=r[t];if(-1===s)return null;const a=[];let u=s;do{const l=Math.floor(u/3);if(a.push(n[2*l],n[2*l+1]),u=u%3==2?u-2:u+1,o[u]!==t)break;u=i[u]}while(u!==s&&-1!==u);return a}_clip(t){if(0===t&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(null===n)return null;const{vectors:r}=this,i=4*t;return r[i]||r[i+1]?this._clipInfinite(t,n,r[i],r[i+1],r[i+2],r[i+3]):this._clipFinite(t,n)}_clipFinite(t,n){const r=n.length;let o,s,l,f,d,i=null,a=n[r-2],u=n[r-1],c=this._regioncode(a,u);for(let h=0;h<r;h+=2)if(o=a,s=u,a=n[h],u=n[h+1],l=c,c=this._regioncode(a,u),0===l&&0===c)f=d,d=0,i?i.push(a,u):i=[a,u];else{let p,g,m,v,y;if(0===l){if(null===(p=this._clipSegment(o,s,a,u,l,c)))continue;[g,m,v,y]=p}else{if(null===(p=this._clipSegment(a,u,o,s,c,l)))continue;[v,y,g,m]=p,f=d,d=this._edgecode(g,m),f&&d&&this._edge(t,f,d,i,i.length),i?i.push(g,m):i=[g,m]}f=d,d=this._edgecode(v,y),f&&d&&this._edge(t,f,d,i,i.length),i?i.push(v,y):i=[v,y]}if(i)f=d,d=this._edgecode(i[0],i[1]),f&&d&&this._edge(t,f,d,i,i.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return i}_clipSegment(t,n,r,i,o,s){for(;;){if(0===o&&0===s)return[t,n,r,i];if(o&s)return null;let a,u,l=o||s;8&l?(a=t+(r-t)*(this.ymax-n)/(i-n),u=this.ymax):4&l?(a=t+(r-t)*(this.ymin-n)/(i-n),u=this.ymin):2&l?(u=n+(i-n)*(this.xmax-t)/(r-t),a=this.xmax):(u=n+(i-n)*(this.xmin-t)/(r-t),a=this.xmin),o?o=this._regioncode(t=a,n=u):s=this._regioncode(r=a,i=u)}}_clipInfinite(t,n,r,i,o,s){let u,a=Array.from(n);if((u=this._project(a[0],a[1],r,i))&&a.unshift(u[0],u[1]),(u=this._project(a[a.length-2],a[a.length-1],o,s))&&a.push(u[0],u[1]),a=this._clipFinite(t,a))for(let f,l=0,c=a.length,d=this._edgecode(a[c-2],a[c-1]);l<c;l+=2)f=d,d=this._edgecode(a[l],a[l+1]),f&&d&&(l=this._edge(t,f,d,a,l),c=a.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(t,n,r,i,o){for(;n!==r;){let s,a;switch(n){case 5:n=4;continue;case 4:n=6,s=this.xmax,a=this.ymin;break;case 6:n=2;continue;case 2:n=10,s=this.xmax,a=this.ymax;break;case 10:n=8;continue;case 8:n=9,s=this.xmin,a=this.ymax;break;case 9:n=1;continue;case 1:n=5,s=this.xmin,a=this.ymin}(i[o]!==s||i[o+1]!==a)&&this.contains(t,s,a)&&(i.splice(o,0,s,a),o+=2)}if(i.length>4)for(let s=0;s<i.length;s+=2){const a=(s+2)%i.length,u=(s+4)%i.length;(i[s]===i[a]&&i[a]===i[u]||i[s+1]===i[a+1]&&i[a+1]===i[u+1])&&(i.splice(a,2),s-=2)}return o}_project(t,n,r,i){let s,a,u,o=1/0;if(i<0){if(n<=this.ymin)return null;(s=(this.ymin-n)/i)<o&&(u=this.ymin,a=t+(o=s)*r)}else if(i>0){if(n>=this.ymax)return null;(s=(this.ymax-n)/i)<o&&(u=this.ymax,a=t+(o=s)*r)}if(r>0){if(t>=this.xmax)return null;(s=(this.xmax-t)/r)<o&&(a=this.xmax,u=n+(o=s)*i)}else if(r<0){if(t<=this.xmin)return null;(s=(this.xmin-t)/r)<o&&(a=this.xmin,u=n+(o=s)*i)}return[a,u]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}}const _Ce=2*Math.PI,Ch=Math.pow;function wCe(e){return e[0]}function xCe(e){return e[1]}function DCe(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class sk{static from(t,n=wCe,r=xCe,i){return new sk("length"in t?function(e,t,n,r){const i=e.length,o=new Float64Array(2*i);for(let s=0;s<i;++s){const a=e[s];o[2*s]=t.call(r,a,s,e),o[2*s+1]=n.call(r,a,s,e)}return o}(t,n,r,i):Float64Array.from(function*(e,t,n,r){let i=0;for(const o of e)yield t.call(r,o,i,e),yield n.call(r,o,i,e),++i}(t,n,r,i)))}constructor(t){this._delaunator=new __(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&function(e){const{triangles:t,coords:n}=e;for(let r=0;r<t.length;r+=3){const i=2*t[r],o=2*t[r+1],s=2*t[r+2];if((n[s]-n[i])*(n[o+1]-n[i+1])-(n[o]-n[i])*(n[s+1]-n[i+1])>1e-10)return!1}return!0}(t)){this.collinear=Int32Array.from({length:n.length/2},(d,h)=>h).sort((d,h)=>n[2*d]-n[2*h]||n[2*d+1]-n[2*h+1]);const u=this.collinear[0],l=this.collinear[this.collinear.length-1],c=[n[2*u],n[2*u+1],n[2*l],n[2*l+1]],f=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let d=0,h=n.length/2;d<h;++d){const p=DCe(n[2*d],n[2*d+1],f);n[2*d]=p[0],n[2*d+1]=p[1]}this._delaunator=new __(n)}else delete this.collinear;const r=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,o=this.triangles=this._delaunator.triangles,s=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let u=0,l=r.length;u<l;++u){const c=o[u%3==2?u-2:u+1];(-1===r[u]||-1===s[c])&&(s[c]=u)}for(let u=0,l=i.length;u<l;++u)a[i[u]]=u;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],this.triangles[1]=i[1],this.triangles[2]=i[1],s[i[0]]=1,2===i.length&&(s[i[1]]=0))}voronoi(t){return new bCe(this,t)}*neighbors(t){const{inedges:n,hull:r,_hullIndex:i,halfedges:o,triangles:s,collinear:a}=this;if(a){const f=a.indexOf(t);return f>0&&(yield a[f-1]),void(f<a.length-1&&(yield a[f+1]))}const u=n[t];if(-1===u)return;let l=u,c=-1;do{if(yield c=s[l],l=l%3==2?l-2:l+1,s[l]!==t)return;if(l=o[l],-1===l){const f=r[(i[t]+1)%r.length];return void(f!==c&&(yield f))}}while(l!==u)}find(t,n,r=0){if((t=+t)!=t||(n=+n)!=n)return-1;const i=r;let o;for(;(o=this._step(r,t,n))>=0&&o!==r&&o!==i;)r=o;return o}_step(t,n,r){const{inedges:i,hull:o,_hullIndex:s,halfedges:a,triangles:u,points:l}=this;if(-1===i[t]||!l.length)return(t+1)%(l.length>>1);let c=t,f=Ch(n-l[2*t],2)+Ch(r-l[2*t+1],2);const d=i[t];let h=d;do{let p=u[h];const g=Ch(n-l[2*p],2)+Ch(r-l[2*p+1],2);if(g<f&&(f=g,c=p),h=h%3==2?h-2:h+1,u[h]!==t)break;if(h=a[h],-1===h){if(h=o[(s[t]+1)%o.length],h!==p&&Ch(n-l[2*h],2)+Ch(r-l[2*h+1],2)<f)return h;break}}while(h!==d);return c}render(t){const n=null==t?t=new Pc:void 0,{points:r,halfedges:i,triangles:o}=this;for(let s=0,a=i.length;s<a;++s){const u=i[s];if(u<s)continue;const l=2*o[s],c=2*o[u];t.moveTo(r[l],r[l+1]),t.lineTo(r[c],r[c+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n=2){const r=null==t?t=new Pc:void 0,{points:i}=this;for(let o=0,s=i.length;o<s;o+=2){const a=i[o],u=i[o+1];t.moveTo(a+n,u),t.arc(a,u,n,0,_Ce)}return r&&r.value()}renderHull(t){const n=null==t?t=new Pc:void 0,{hull:r,points:i}=this,o=2*r[0],s=r.length;t.moveTo(i[o],i[o+1]);for(let a=1;a<s;++a){const u=2*r[a];t.lineTo(i[u],i[u+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new ok;return this.renderHull(t),t.value()}renderTriangle(t,n){const r=null==n?n=new Pc:void 0,{points:i,triangles:o}=this,s=2*o[t*=3],a=2*o[t+1],u=2*o[t+2];return n.moveTo(i[s],i[s+1]),n.lineTo(i[a],i[a+1]),n.lineTo(i[u],i[u+1]),n.closePath(),r&&r.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,r=t.length/3;n<r;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new ok;return this.renderTriangle(t,n),n.value()}}function ak(e){k.call(this,null,e)}ak.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const ACe=[-1e5,-1e5,1e5,1e5];function OCe(e){const t=e[0][0],n=e[0][1];let r=e.length-1;for(;e[r][0]===t&&e[r][1]===n;--r);return"M"+e.slice(0,r+1).join("L")+"Z"}z(ak,k,{transform(e,t){const n=e.as||"path",r=t.source;if(!r||!r.length)return t;let i=e.size;i=i?[0,0,i[0],i[1]]:(i=e.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:ACe;const o=this.value=sk.from(r,e.x,e.y).voronoi(i);for(let s=0,a=r.length;s<a;++s){const u=o.cellPolygon(s);r[s][n]=u?OCe(u):null}return t.reflow(e.modified()).modifies(n)}});var uk=Math.PI/180;function TCe(e,t,n,r){if(!t.sprite){var i=e.context,o=e.ratio;i.clearRect(0,0,2048/o,2048/o);var c,f,d,h,p,s=0,a=0,u=0,l=n.length;for(--r;++r<l;){if(t=n[r],i.save(),i.font=t.style+" "+t.weight+" "+~~((t.size+1)/o)+"px "+t.font,c=i.measureText(t.text+"m").width*o,d=t.size<<1,t.rotate){var g=Math.sin(t.rotate*uk),m=Math.cos(t.rotate*uk),v=c*m,y=c*g,b=d*m,_=d*g;c=Math.max(Math.abs(v+_),Math.abs(v-_))+31>>5<<5,d=~~Math.max(Math.abs(y+b),Math.abs(y-b))}else c=c+31>>5<<5;if(d>u&&(u=d),s+c>=2048&&(s=0,a+=u,u=0),a+d>=2048)break;i.translate((s+(c>>1))/o,(a+(d>>1))/o),t.rotate&&i.rotate(t.rotate*uk),i.fillText(t.text,0,0),t.padding&&(i.lineWidth=2*t.padding,i.strokeText(t.text,0,0)),i.restore(),t.width=c,t.height=d,t.xoff=s,t.yoff=a,t.x1=c>>1,t.y1=d>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,s+=c}for(var w=i.getImageData(0,0,2048/o,2048/o).data,E=[];--r>=0;)if((t=n[r]).hasText){for(f=(c=t.width)>>5,d=t.y1-t.y0,h=0;h<d*f;h++)E[h]=0;if(null==(s=t.xoff))return;a=t.yoff;var x=0,D=-1;for(p=0;p<d;p++){for(h=0;h<c;h++){var C=w[2048*(a+p)+(s+h)<<2]?1<<31-h%32:0;E[f*p+(h>>5)]|=C,x|=C}x?D=p:(t.y0++,d--,p--,a++)}t.y1=t.y0+D,t.sprite=E.slice(0,(t.y1-t.y0)*f)}}}function kCe(e,t,n){for(var c,r=e.sprite,i=e.width>>5,o=e.x-(i<<4),s=127&o,a=32-s,u=e.y1-e.y0,l=(e.y+e.y0)*(n>>=5)+(o>>5),f=0;f<u;f++){c=0;for(var d=0;d<=i;d++)if((c<<a|(d<i?(c=r[f*i+d])>>>s:0))&t[l+d])return!0;l+=n}return!1}function ICe(e,t){var n=e[0],r=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>r.x&&(r.x=t.x+t.x1),t.y+t.y1>r.y&&(r.y=t.y+t.y1)}function FCe(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function _q(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function Lc(e){return"function"==typeof e?e:function(){return e}}var PCe={archimedean:_q,rectangular:function(e){var n=4*e[0]/e[1],r=0,i=0;return function(o){var s=o<0?-1:1;switch(Math.sqrt(1+4*s*o)-s&3){case 0:r+=n;break;case 1:i+=4;break;case 2:r-=n;break;default:i-=4}return[r,i]}}};const wq=["x","y","font","fontSize","fontStyle","fontWeight","angle"],LCe=["text","font","rotate","fontSize","fontStyle","fontWeight"];function lk(e){k.call(this,function(){var t,n,r,i,o,s,a,e=[256,256],u=_q,l=[],c=Math.random,f={};function h(p,g,m){for(var x,D,S,v=g.x,y=g.y,b=Math.sqrt(e[0]*e[0]+e[1]*e[1]),_=u(e),w=c()<.5?1:-1,E=-w;(x=_(E+=w))&&(D=~~x[0],S=~~x[1],!(Math.min(Math.abs(D),Math.abs(S))>=b));)if(g.x=v+D,g.y=y+S,!(g.x+g.x0<0||g.y+g.y0<0||g.x+g.x1>e[0]||g.y+g.y1>e[1])&&(!m||!kCe(g,p,e[0]))&&(!m||FCe(g,m))){for(var W,C=g.sprite,A=g.width>>5,M=e[0]>>5,T=g.x-(A<<4),L=127&T,O=32-L,N=g.y1-g.y0,U=(g.y+g.y0)*M+(T>>5),te=0;te<N;te++){W=0;for(var pe=0;pe<=A;pe++)p[U+pe]|=W<<O|(pe<A?(W=C[te*A+pe])>>>L:0);U+=M}return g.sprite=null,!0}return!1}return f.layout=function(){for(var p=function(p){p.width=p.height=1;var g=Math.sqrt(p.getContext("2d").getImageData(0,0,1,1).data.length>>2);p.width=2048/g,p.height=2048/g;var m=p.getContext("2d");return m.fillStyle=m.strokeStyle="red",m.textAlign="center",{context:m,ratio:g}}(Qd()),g=function(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}((e[0]>>5)*e[1]),m=null,v=l.length,y=-1,b=[],_=l.map(E=>({text:t(E),font:n(E),style:i(E),weight:o(E),rotate:s(E),size:~~(r(E)+1e-14),padding:a(E),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:E})).sort((E,x)=>x.size-E.size);++y<v;){var w=_[y];w.x=e[0]*(c()+.5)>>1,w.y=e[1]*(c()+.5)>>1,TCe(p,w,_,y),w.hasText&&h(g,w,m)&&(b.push(w),m?ICe(m,w):m=[{x:w.x+w.x0,y:w.y+w.y0},{x:w.x+w.x1,y:w.y+w.y1}],w.x-=e[0]>>1,w.y-=e[1]>>1)}return b},f.words=function(p){return arguments.length?(l=p,f):l},f.size=function(p){return arguments.length?(e=[+p[0],+p[1]],f):e},f.font=function(p){return arguments.length?(n=Lc(p),f):n},f.fontStyle=function(p){return arguments.length?(i=Lc(p),f):i},f.fontWeight=function(p){return arguments.length?(o=Lc(p),f):o},f.rotate=function(p){return arguments.length?(s=Lc(p),f):s},f.text=function(p){return arguments.length?(t=Lc(p),f):t},f.spiral=function(p){return arguments.length?(u=PCe[p]||p,f):u},f.fontSize=function(p){return arguments.length?(r=Lc(p),f):r},f.padding=function(p){return arguments.length?(a=Lc(p),f):a},f.random=function(p){return arguments.length?(c=p,f):c},f}(),e)}lk.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:wq}]},z(lk,k,{transform(e,t){e.size&&(!e.size[0]||!e.size[1])&&F("Wordcloud size dimensions must be non-zero.");const r=e.modified();if(!(r||t.changed(t.ADD_REM)||LCe.some(function(p){const g=e[p];return xe(g)&&t.modified(g.fields)})))return;const i=t.materialize(t.SOURCE).source,o=this.value,s=e.as||wq;let u,a=e.fontSize||14;if(xe(a)?u=e.fontSizeRange:a=nr(a),u){const p=a,g=Je("sqrt")().domain(Cs(i,p)).range(u);a=m=>g(p(m))}i.forEach(p=>{p[s[0]]=NaN,p[s[1]]=NaN,p[s[3]]=0});const l=o.words(i).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(a).random(Ki).layout(),c=o.size(),f=c[0]>>1,d=c[1]>>1,h=l.length;for(let g,m,p=0;p<h;++p)g=l[p],m=g.datum,m[s[0]]=g.x+f,m[s[1]]=g.y+d,m[s[2]]=g.font,m[s[3]]=g.size,m[s[4]]=g.style,m[s[5]]=g.weight,m[s[6]]=g.rotate;return t.reflow(r).modifies(s)}});const $Ce=e=>new Uint8Array(e),BCe=e=>new Uint16Array(e),Xm=e=>new Uint32Array(e);function E_(e,t,n){const r=(t<257?$Ce:t<65537?BCe:Xm)(e);return n&&r.set(n),r}function xq(e,t,n){const r=1<<t;return{one:r,zero:~r,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(i,o){const s=this,a=s.bisect(s.range,i.value),u=i.index,l=a[0],c=a[1],f=u.length;let d;for(d=0;d<l;++d)o[u[d]]|=r;for(d=c;d<f;++d)o[u[d]]|=r;return s}}}function Eq(){let e=Xm(0),t=[],n=0;return{insert:function(a,u,l){if(!u.length)return[];const c=n,f=u.length,d=Xm(f);let p,g,m,h=Array(f);for(m=0;m<f;++m)h[m]=a(u[m]),d[m]=m;if(h=function(e,t){return e.sort.call(t,(n,r)=>{const i=e[n],o=e[r];return i<o?-1:i>o?1:0}),function(e,t){return Array.from(t,n=>e[n])}(e,t)}(h,d),c)p=t,g=e,t=Array(c+f),e=Xm(c+f),function(e,t,n,r,i,o,s,a,u){let f,l=0,c=0;for(f=0;l<r&&c<s;++f)t[l]<i[c]?(a[f]=t[l],u[f]=n[l++]):(a[f]=i[c],u[f]=o[c++]+e);for(;l<r;++l,++f)a[f]=t[l],u[f]=n[l];for(;c<s;++c,++f)a[f]=i[c],u[f]=o[c]+e}(l,p,g,c,h,d,f,t,e);else{if(l>0)for(m=0;m<f;++m)d[m]+=l;t=h,e=d}return n=c+f,{index:d,value:h}},remove:function(a,u){const l=n;let c,f,d;for(f=0;!u[e[f]]&&f<l;++f);for(d=f;f<l;++f)u[c=e[f]]||(e[d]=c,t[d]=t[f],++d);n=l-a},bisect:function(a,u){let l;return u?l=u.length:(u=t,l=n),[hye(u,a[0],0,l),j1(u,a[1],0,l)]},reindex:function(a){for(let u=0,l=n;u<l;++u)e[u]=a[e[u]]},index:()=>e,size:()=>n}}function ck(e){k.call(this,function(){let e=8,t=[],n=Xm(0),r=E_(0,e),i=E_(0,e);return{data:()=>t,seen:()=>n=function(e,t,n){return e.length>=t?e:((n=n||new e.constructor(t)).set(e),n)}(n,t.length),add(o){for(let l,s=0,a=t.length,u=o.length;s<u;++s)l=o[s],l._index=a++,t.push(l)},remove(o,s){const a=t.length,u=Array(a-o),l=t;let c,f,d;for(f=0;!s[f]&&f<a;++f)u[f]=t[f],l[f]=f;for(d=f;f<a;++f)c=t[f],s[f]?l[f]=-1:(l[f]=d,r[d]=r[f],i[d]=i[f],u[d]=c,c._index=d++),r[f]=0;return t=u,l},size:()=>t.length,curr:()=>r,prev:()=>i,reset:o=>i[o]=r[o],all:()=>e<257?255:e<65537?65535:4294967295,set(o,s){r[o]|=s},clear(o,s){r[o]&=~s},resize(o,s){(o>r.length||s>e)&&(e=Math.max(s,e),r=E_(o,e,r),i=E_(o,e))}}}(),e),this._indices=null,this._dims=null}function fk(e){k.call(this,null,e)}ck.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]},z(ck,k,{transform(e,t){return this._dims?e.modified("fields")||e.fields.some(r=>t.modified(r.fields))?this.reinit(e,t):this.eval(e,t):this.init(e,t)},init(e,t){const n=e.fields,r=e.query,i=this._indices={},o=this._dims=[],s=r.length;let u,l,a=0;for(;a<s;++a)u=n[a].fname,l=i[u]||(i[u]=Eq()),o.push(xq(l,a,r[a]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),r=e.fields,i=e.query,o=this._indices,s=this._dims,a=this.value,u=a.curr(),l=a.prev(),c=a.all(),f=n.rem=n.add,d=n.mod,h=i.length,p={};let g,m,v,y,b,_,w,E,x;if(l.set(u),t.rem.length&&(b=this.remove(e,t,n)),t.add.length&&a.add(t.add),t.mod.length)for(_={},y=t.mod,w=0,E=y.length;w<E;++w)_[y[w]._index]=1;for(w=0;w<h;++w)x=r[w],(!s[w]||e.modified("fields",w)||t.modified(x.fields))&&(v=x.fname,(g=p[v])||(o[v]=m=Eq(),p[v]=g=m.insert(x,t.source,0)),s[w]=xq(m,w,i[w]).onAdd(g,u));for(w=0,E=a.data().length;w<E;++w)b[w]||(l[w]!==u[w]?f.push(w):_[w]&&u[w]!==c&&d.push(w));return a.mask=(1<<h)-1,n},eval(e,t){const n=t.materialize().fork(),r=this._dims.length;let i=0;return t.rem.length&&(this.remove(e,t,n),i|=(1<<r)-1),e.modified("query")&&!e.modified("fields")&&(i|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),i|=(1<<r)-1),t.mod.length&&(this.modify(t,n),i|=(1<<r)-1),this.value.mask=i,n},insert(e,t,n){const r=t.add,i=this.value,o=this._dims,s=this._indices,a=e.fields,u={},l=n.add,c=i.size()+r.length,f=o.length;let h,p,g,d=i.size();i.resize(c,f),i.add(r);const m=i.curr(),v=i.prev(),y=i.all();for(h=0;h<f;++h)p=a[h].fname,g=u[p]||(u[p]=s[p].insert(a[h],r,d)),o[h].onAdd(g,m);for(;d<c;++d)v[d]=y,m[d]!==y&&l.push(d)},modify(e,t){const n=t.mod,r=this.value,i=r.curr(),o=r.all(),s=e.mod;let a,u,l;for(a=0,u=s.length;a<u;++a)l=s[a]._index,i[l]!==o&&n.push(l)},remove(e,t,n){const r=this._indices,i=this.value,o=i.curr(),s=i.prev(),a=i.all(),u={},l=n.rem,c=t.rem;let f,d,h,p;for(f=0,d=c.length;f<d;++f)h=c[f]._index,u[h]=1,s[h]=p=o[h],o[h]=a,p!==a&&l.push(h);for(h in r)r[h].remove(d,u);return this.reindex(t,d,u),u},reindex(e,t,n){const r=this._indices,i=this.value;e.runAfter(()=>{const o=i.remove(t,n);for(const s in r)r[s].reindex(o)})},update(e,t,n){const r=this._dims,i=e.query,o=t.stamp,s=r.length;let u,l,a=0;for(n.filters=0,l=0;l<s;++l)e.modified("query",l)&&(u=l,++a);if(1===a)a=r[u].one,this.incrementOne(r[u],i[u],n.add,n.rem);else for(l=0,a=0;l<s;++l)!e.modified("query",l)||(a|=r[l].one,this.incrementAll(r[l],i[l],o,n.add),n.rem=n.add);return a},incrementAll(e,t,n,r){const i=this.value,o=i.seen(),s=i.curr(),a=i.prev(),u=e.index(),l=e.bisect(e.range),c=e.bisect(t),f=c[0],d=c[1],h=l[0],p=l[1],g=e.one;let m,v,y;if(f<h)for(m=f,v=Math.min(h,d);m<v;++m)y=u[m],o[y]!==n&&(a[y]=s[y],o[y]=n,r.push(y)),s[y]^=g;else if(f>h)for(m=h,v=Math.min(f,p);m<v;++m)y=u[m],o[y]!==n&&(a[y]=s[y],o[y]=n,r.push(y)),s[y]^=g;if(d>p)for(m=Math.max(f,p),v=d;m<v;++m)y=u[m],o[y]!==n&&(a[y]=s[y],o[y]=n,r.push(y)),s[y]^=g;else if(d<p)for(m=Math.max(h,d),v=p;m<v;++m)y=u[m],o[y]!==n&&(a[y]=s[y],o[y]=n,r.push(y)),s[y]^=g;e.range=t.slice()},incrementOne(e,t,n,r){const o=this.value.curr(),s=e.index(),a=e.bisect(e.range),u=e.bisect(t),l=u[0],c=u[1],f=a[0],d=a[1],h=e.one;let p,g,m;if(l<f)for(p=l,g=Math.min(f,c);p<g;++p)m=s[p],o[m]^=h,n.push(m);else if(l>f)for(p=f,g=Math.min(l,d);p<g;++p)m=s[p],o[m]^=h,r.push(m);if(c>d)for(p=Math.max(l,d),g=c;p<g;++p)m=s[p],o[m]^=h,n.push(m);else if(c<d)for(p=Math.max(f,c),g=d;p<g;++p)m=s[p],o[m]^=h,r.push(m);e.range=t.slice()}}),fk.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},z(fk,k,{transform(e,t){const n=~(e.ignore||0),r=e.filter,i=r.mask;if(0==(i&n))return t.StopPropagation;const o=t.fork(t.ALL),s=r.data(),a=r.curr(),u=r.prev(),l=c=>a[c]&n?null:s[c];return o.filter(o.MOD,l),i&i-1?(o.filter(o.ADD,c=>{const f=a[c]&n;return!f&&f^u[c]&n?s[c]:null}),o.filter(o.REM,c=>{const f=a[c]&n;return!f||f^f^u[c]&n?null:s[c]})):(o.filter(o.ADD,l),o.filter(o.REM,c=>(a[c]&n)===i?s[c]:null)),o.filter(o.SOURCE,c=>l(c._index))}});const jc="Literal",Dq="CallExpression";function zo(e){this.type=e}var Us,ee,I,lr,at;zo.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=function(e){switch(e.type){case"ArrayExpression":return e.elements;case"BinaryExpression":case"LogicalExpression":return[e.left,e.right];case Dq:return[e.callee].concat(e.arguments);case"ConditionalExpression":return[e.test,e.consequent,e.alternate];case"MemberExpression":return[e.object,e.property];case"ObjectExpression":return e.properties;case"Property":return[e.key,e.value];case"UnaryExpression":return[e.argument];default:return[]}}(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1},(Us={})[1]="Boolean",Us[2]="<end>",Us[3]="Identifier",Us[4]="Keyword",Us[5]="Null",Us[6]="Numeric",Us[7]="Punctuator",Us[8]="String",Us[9]="RegularExpression";var Cq="Identifier",Cn="Unexpected token %0",dk="Invalid regular expression",hk="Invalid regular expression: missing /",Sq="Octal literals are not allowed in strict mode.",Un="ILLEGAL",Zm="Disabled.",bSe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),_Se=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function S_(e,t){if(!e)throw new Error("ASSERT: "+t)}function Wa(e){return e>=48&&e<=57}function pk(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function Jm(e){return"01234567".indexOf(e)>=0}function wSe(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function e0(e){return 10===e||13===e||8232===e||8233===e}function t0(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&bSe.test(String.fromCharCode(e))}function A_(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&_Se.test(String.fromCharCode(e))}const xSe={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function Aq(){for(;I<lr;){const e=ee.charCodeAt(I);if(!wSe(e)&&!e0(e))break;++I}}function gk(e){var t,n,r,i=0;for(n="u"===e?4:2,t=0;t<n;++t)I<lr&&pk(ee[I])?(r=ee[I++],i=16*i+"0123456789abcdef".indexOf(r.toLowerCase())):et({},Cn,Un);return String.fromCharCode(i)}function ESe(){var e,t;for(t=0,"}"===(e=ee[I])&&et({},Cn,Un);I<lr&&pk(e=ee[I++]);)t=16*t+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||"}"!==e)&&et({},Cn,Un),t<=65535?String.fromCharCode(t):String.fromCharCode(55296+(t-65536>>10),56320+(t-65536&1023))}function Oq(){var e,t;for(e=ee.charCodeAt(I++),t=String.fromCharCode(e),92===e&&(117!==ee.charCodeAt(I)&&et({},Cn,Un),++I,(!(e=gk("u"))||"\\"===e||!t0(e.charCodeAt(0)))&&et({},Cn,Un),t=e);I<lr&&A_(e=ee.charCodeAt(I));)++I,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==ee.charCodeAt(I)&&et({},Cn,Un),++I,(!(e=gk("u"))||"\\"===e||!A_(e.charCodeAt(0)))&&et({},Cn,Un),t+=e);return t}function mk(){var n,i,o,s,e=I,t=ee.charCodeAt(I),r=ee[I];switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++I,{type:7,value:String.fromCharCode(t),start:e,end:I};default:if(61===(n=ee.charCodeAt(I+1)))switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return I+=2,{type:7,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:I};case 33:case 61:return 61===ee.charCodeAt(I+=2)&&++I,{type:7,value:ee.slice(e,I),start:e,end:I}}}return">>>="===(s=ee.substr(I,4))?{type:7,value:s,start:e,end:I+=4}:">>>"===(o=s.substr(0,3))||"<<="===o||">>="===o?{type:7,value:o,start:e,end:I+=3}:r===(i=o.substr(0,2))[1]&&"+-<>&|".indexOf(r)>=0||"=>"===i?{type:7,value:i,start:e,end:I+=2}:("//"===i&&et({},Cn,Un),"<>=!+-*%&|^/".indexOf(r)>=0?{type:7,value:r,start:e,end:++I}:void et({},Cn,Un))}function Mq(){var e,t,n;if(S_(Wa((n=ee[I]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),t=I,e="","."!==n){if(e=ee[I++],n=ee[I],"0"===e){if("x"===n||"X"===n)return++I,function(e){let t="";for(;I<lr&&pk(ee[I]);)t+=ee[I++];return 0===t.length&&et({},Cn,Un),t0(ee.charCodeAt(I))&&et({},Cn,Un),{type:6,value:parseInt("0x"+t,16),start:e,end:I}}(t);if(Jm(n))return function(e){let t="0"+ee[I++];for(;I<lr&&Jm(ee[I]);)t+=ee[I++];return(t0(ee.charCodeAt(I))||Wa(ee.charCodeAt(I)))&&et({},Cn,Un),{type:6,value:parseInt(t,8),octal:!0,start:e,end:I}}(t);n&&Wa(n.charCodeAt(0))&&et({},Cn,Un)}for(;Wa(ee.charCodeAt(I));)e+=ee[I++];n=ee[I]}if("."===n){for(e+=ee[I++];Wa(ee.charCodeAt(I));)e+=ee[I++];n=ee[I]}if("e"===n||"E"===n)if(e+=ee[I++],("+"===(n=ee[I])||"-"===n)&&(e+=ee[I++]),Wa(ee.charCodeAt(I)))for(;Wa(ee.charCodeAt(I));)e+=ee[I++];else et({},Cn,Un);return t0(ee.charCodeAt(I))&&et({},Cn,Un),{type:6,value:parseFloat(e),start:t,end:I}}function Tq(){if(Aq(),I>=lr)return{type:2,start:I,end:I};const e=ee.charCodeAt(I);return t0(e)?function(){var e,t;return e=I,t=92===ee.charCodeAt(I)?Oq():function(){var e,t;for(e=I++;I<lr;){if(92===(t=ee.charCodeAt(I)))return I=e,Oq();if(!A_(t))break;++I}return ee.slice(e,I)}(),{type:1===t.length?3:xSe.hasOwnProperty(t)?4:"null"===t?5:"true"===t||"false"===t?1:3,value:t,start:e,end:I}}():40===e||41===e||59===e?mk():39===e||34===e?function(){var t,n,r,i,e="",o=!1;for(S_("'"===(t=ee[I])||'"'===t,"String literal must starts with a quote"),n=I,++I;I<lr;){if((r=ee[I++])===t){t="";break}if("\\"===r)if((r=ee[I++])&&e0(r.charCodeAt(0)))"\r"===r&&"\n"===ee[I]&&++I;else switch(r){case"u":case"x":"{"===ee[I]?(++I,e+=ESe()):e+=gk(r);break;case"n":e+="\n";break;case"r":e+="\r";break;case"t":e+="\t";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:Jm(r)?(0!==(i="01234567".indexOf(r))&&(o=!0),I<lr&&Jm(ee[I])&&(o=!0,i=8*i+"01234567".indexOf(ee[I++]),"0123".indexOf(r)>=0&&I<lr&&Jm(ee[I])&&(i=8*i+"01234567".indexOf(ee[I++]))),e+=String.fromCharCode(i)):e+=r}else{if(e0(r.charCodeAt(0)))break;e+=r}}return""!==t&&et({},Cn,Un),{type:8,value:e,octal:o,start:n,end:I}}():46===e?Wa(ee.charCodeAt(I+1))?Mq():mk():Wa(e)?Mq():mk()}function Jr(){const e=at;return I=e.end,at=Tq(),I=e.end,e}function kq(){const e=I;at=Tq(),I=e}function Iq(e,t,n){const r=new zo("||"===e||"&&"===e?"LogicalExpression":"BinaryExpression");return r.operator=e,r.left=t,r.right=n,r}function NSe(e,t){const n=new zo("CallExpression");return n.callee=e,n.arguments=t,n}function yk(e){const t=new zo(Cq);return t.name=e,t}function n0(e){const t=new zo("Literal");return t.value=e.value,t.raw=ee.slice(e.start,e.end),e.regex&&("//"===t.raw&&(t.raw="/(?:)/"),t.regex=e.regex),t}function Fq(e,t,n){const r=new zo("MemberExpression");return r.computed="["===e,r.object=t,r.property=n,r.computed||(n.member=!0),r}function Rq(e,t,n){const r=new zo("Property");return r.key=t,r.value=n,r.kind=e,r}function et(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(o,s)=>(S_(s<r.length,"Message reference must be in range"),r[s]));throw(n=new Error(i)).index=I,n.description=i,n}function O_(e){2===e.type&&et(e,"Unexpected end of input"),6===e.type&&et(e,"Unexpected number"),8===e.type&&et(e,"Unexpected string"),3===e.type&&et(e,"Unexpected identifier"),4===e.type&&et(e,"Unexpected reserved word"),et(e,Cn,e.value)}function cr(e){const t=Jr();(7!==t.type||t.value!==e)&&O_(t)}function At(e){return 7===at.type&&at.value===e}function vk(e){return 4===at.type&&at.value===e}function Nq(){I=at.start;const e=Jr();return 8===e.type||6===e.type?(e.octal&&et(e,Sq),n0(e)):yk(e.value)}function BSe(){var e,t,n;return I=at.start,3===(e=at).type?(n=Nq(),cr(":"),Rq("init",n,zc())):2!==e.type&&7!==e.type?(t=Nq(),cr(":"),Rq("init",t,zc())):void O_(e)}const HSe={if:1};function VSe(){var e,t,n;if(At("("))return function(){cr("(");const e=bk();return cr(")"),e}();if(At("["))return function(){const e=[];for(I=at.start,cr("[");!At("]");)At(",")?(Jr(),e.push(null)):(e.push(zc()),At("]")||cr(","));return Jr(),function(e){const t=new zo("ArrayExpression");return t.elements=e,t}(e)}();if(At("{"))return function(){var t,r,e=[],i={},o=String;for(I=at.start,cr("{");!At("}");)r="$"+((t=BSe()).key.type===Cq?t.key.name:o(t.key.value)),Object.prototype.hasOwnProperty.call(i,r)?et({},"Duplicate data property in object literal not allowed in strict mode"):i[r]=!0,e.push(t),At("}")||cr(",");return cr("}"),function(e){const t=new zo("ObjectExpression");return t.properties=e,t}(e)}();if(I=at.start,3===(e=at.type)||HSe[at.value])n=yk(Jr().value);else if(8===e||6===e)at.octal&&et(at,Sq),n=n0(Jr());else{if(4===e)throw new Error(Zm);1===e?((t=Jr()).value="true"===t.value,n=n0(t)):5===e?((t=Jr()).value=null,n=n0(t)):At("/")||At("/=")?(n=n0(function(){var e,t,n,r;return at=null,Aq(),e=I,t=function(){var e,t,n,r;for(S_("/"===(e=ee[I]),"Regular expression literal must start with a slash"),t=ee[I++],n=!1,r=!1;I<lr;)if(t+=e=ee[I++],"\\"===e)e0((e=ee[I++]).charCodeAt(0))&&et({},hk),t+=e;else if(e0(e.charCodeAt(0)))et({},hk);else if(n)"]"===e&&(n=!1);else{if("/"===e){r=!0;break}"["===e&&(n=!0)}return r||et({},hk),{value:t.substr(1,t.length-2),literal:t}}(),n=function(){var e,t,n;for(t="",n="";I<lr&&A_((e=ee[I]).charCodeAt(0));)++I,"\\"===e&&I<lr?et({},Cn,Un):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&et({},dk,n),{value:n,literal:t}}(),r=function(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(r,i)=>{if(parseInt(i,16)<=1114111)return"x";et({},dk)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){et({},dk)}try{return new RegExp(e,t)}catch(r){return null}}(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:I}}()),kq()):O_(Jr())}return n}function qSe(){const e=[];if(cr("("),!At(")"))for(;I<lr&&(e.push(zc()),!At(")"));)cr(",");return cr(")"),e}function YSe(){cr("[");const e=bk();return cr("]"),e}function Pq(){const e=function(){var e;for(e=VSe();;)if(At("."))e=Fq(".",e,(cr("."),function(){I=at.start;const e=Jr();return function(e){return 3===e.type||4===e.type||1===e.type||5===e.type}(e)||O_(e),yk(e.value)}()));else if(At("("))e=NSe(e,qSe());else{if(!At("["))break;e=Fq("[",e,YSe())}return e}();if(7===at.type&&(At("++")||At("--")))throw new Error(Zm);return e}function M_(){var e,t;if(7!==at.type&&4!==at.type)t=Pq();else{if(At("++")||At("--"))throw new Error(Zm);if(At("+")||At("-")||At("~")||At("!"))e=Jr(),t=M_(),t=function(e,t){const n=new zo("UnaryExpression");return n.operator=e,n.argument=t,n.prefix=!0,n}(e.value,t);else{if(vk("delete")||vk("void")||vk("typeof"))throw new Error(Zm);t=Pq()}}return t}function Lq(e){let t=0;if(7!==e.type&&4!==e.type)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11}return t}function zc(){var e,t;return e=function(){var e,t,n,r,i,o,s,a,u,l;if(e=at,u=M_(),0===(i=Lq(r=at)))return u;for(r.prec=i,Jr(),t=[e,at],o=[u,r,s=M_()];(i=Lq(at))>0;){for(;o.length>2&&i<=o[o.length-2].prec;)s=o.pop(),a=o.pop().value,u=o.pop(),t.pop(),n=Iq(a,u,s),o.push(n);(r=Jr()).prec=i,o.push(r),t.push(at),n=M_(),o.push(n)}for(n=o[l=o.length-1],t.pop();l>1;)t.pop(),n=Iq(o[l-1].value,o[l-2],n),l-=2;return n}(),At("?")&&(Jr(),t=zc(),cr(":"),e=function(e,t,n){const r=new zo("ConditionalExpression");return r.test=e,r.consequent=t,r.alternate=n,r}(e,t,zc())),e}function bk(){const e=zc();if(At(","))throw new Error(Zm);return e}function _k(e){I=0,lr=(ee=e).length,at=null,kq();const t=bk();if(2!==at.type)throw new Error("Unexpect token after expression.");return t}var jq={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function $q(e){function n(s,a,u){return l=>function(s,a,u,l){let c=e(a[0]);return u&&(c=u+"("+c+")",0===u.lastIndexOf("new ",0)&&(c="("+c+")")),c+"."+s+(l<0?"":0===l?"()":"("+a.slice(1).map(e).join(",")+")")}(s,l,a,u)}const r="new Date",i="String",o="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(s){s.length<3&&F("Missing arguments to clamp function."),s.length>3&&F("Too many arguments to clamp function.");const a=s.map(e);return"Math.max("+a[1]+", Math.min("+a[2]+","+a[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),trim:n("trim",i,0),regexp:o,test:n("test",o),if:function(s){s.length<3&&F("Missing arguments to if function."),s.length>3&&F("Too many arguments to if function.");const a=s.map(e);return"("+a[0]+"?"+a[1]+":"+a[2]+")"}}}function Bq(e){const t=(e=e||{}).allowed?To(e.allowed):{},n=e.forbidden?To(e.forbidden):{},r=e.constants||jq,i=(e.functions||$q)(f),o=e.globalvar,s=e.fieldvar,a=xe(o)?o:p=>`${o}["${p}"]`;let u={},l={},c=0;function f(p){if(Y(p))return p;const g=d[p.type];return null==g&&F("Unsupported type: "+p.type),g(p)}const d={Literal:p=>p.raw,Identifier:p=>{const g=p.name;return c>0?g:ne(n,g)?F("Illegal identifier: "+g):ne(r,g)?r[g]:ne(t,g)?g:(u[g]=1,a(g))},MemberExpression:p=>{const g=!p.computed,m=f(p.object);g&&(c+=1);const v=f(p.property);return m===s&&(l[function(e){const t=e&&e.length-1;return t&&('"'===e[0]&&'"'===e[t]||"'"===e[0]&&"'"===e[t])?e.slice(1,-1):e}(v)]=1),g&&(c-=1),m+(g?"."+v:"["+v+"]")},CallExpression:p=>{"Identifier"!==p.callee.type&&F("Illegal callee type: "+p.callee.type);const g=p.callee.name,m=p.arguments,v=ne(i,g)&&i[g];return v||F("Unrecognized function: "+g),xe(v)?v(m):v+"("+m.map(f).join(",")+")"},ArrayExpression:p=>"["+p.elements.map(f).join(",")+"]",BinaryExpression:p=>"("+f(p.left)+" "+p.operator+" "+f(p.right)+")",UnaryExpression:p=>"("+p.operator+f(p.argument)+")",ConditionalExpression:p=>"("+f(p.test)+"?"+f(p.consequent)+":"+f(p.alternate)+")",LogicalExpression:p=>"("+f(p.left)+p.operator+f(p.right)+")",ObjectExpression:p=>"{"+p.properties.map(f).join(",")+"}",Property:p=>{c+=1;const g=f(p.key);return c-=1,g+":"+f(p.value)}};function h(p){const g={code:f(p),globals:Object.keys(u),fields:Object.keys(l)};return u={},l={},g}return h.functions=i,h.constants=r,h}var zq,Uq,wk,xk,Ek,T_=new Bn,k_=new Bn,Hs={point:zn,lineStart:zn,lineEnd:zn,polygonStart:function(){T_=new Bn,Hs.lineStart=ZSe,Hs.lineEnd=JSe},polygonEnd:function(){var e=+T_;k_.add(e<0?Sr+e:e),this.lineStart=this.lineEnd=this.point=zn},sphere:function(){k_.add(Sr)}};function ZSe(){Hs.point=eAe}function JSe(){Hq(zq,Uq)}function eAe(e,t){Hs.point=Hq,zq=e,Uq=t,wk=e*=ke,xk=le(t=(t*=ke)/2+jb),Ek=re(t)}function Hq(e,t){var n=(e*=ke)-wk,r=n>=0?1:-1,i=r*n,o=le(t=(t*=ke)/2+jb),s=re(t),a=Ek*s,u=xk*o+a*le(i),l=a*r*re(i);T_.add(no(l,u)),wk=e,xk=o,Ek=s}var Ft,ei,Ut,Ai,Uc,Vq,qq,Sh,r0,gl,Ga,Ya={point:Dk,lineStart:Gq,lineEnd:Yq,polygonStart:function(){Ya.point=Xq,Ya.lineStart=nAe,Ya.lineEnd=rAe,r0=new Bn,Hs.polygonStart()},polygonEnd:function(){Hs.polygonEnd(),Ya.point=Dk,Ya.lineStart=Gq,Ya.lineEnd=Yq,T_<0?(Ft=-(Ut=180),ei=-(Ai=90)):r0>ue?Ai=90:r0<-ue&&(ei=-90),Ga[0]=Ft,Ga[1]=Ut},sphere:function(){Ft=-(Ut=180),ei=-(Ai=90)}};function Dk(e,t){gl.push(Ga=[Ft=e,Ut=e]),t<ei&&(ei=t),t>Ai&&(Ai=t)}function Wq(e,t){var n=Fc([e*ke,t*ke]);if(Sh){var r=vh(Sh,n),o=vh([r[1],-r[0],0],r);Zb(o),o=Xb(o);var l,s=e-Uc,a=s>0?1:-1,u=o[0]*Xt*a,c=Ve(s)>180;c^(a*Uc<u&&u<a*e)?(l=o[1]*Xt)>Ai&&(Ai=l):c^(a*Uc<(u=(u+360)%360-180)&&u<a*e)?(l=-o[1]*Xt)<ei&&(ei=l):(t<ei&&(ei=t),t>Ai&&(Ai=t)),c?e<Uc?Oi(Ft,e)>Oi(Ft,Ut)&&(Ut=e):Oi(e,Ut)>Oi(Ft,Ut)&&(Ft=e):Ut>=Ft?(e<Ft&&(Ft=e),e>Ut&&(Ut=e)):e>Uc?Oi(Ft,e)>Oi(Ft,Ut)&&(Ut=e):Oi(e,Ut)>Oi(Ft,Ut)&&(Ft=e)}else gl.push(Ga=[Ft=e,Ut=e]);t<ei&&(ei=t),t>Ai&&(Ai=t),Sh=n,Uc=e}function Gq(){Ya.point=Wq}function Yq(){Ga[0]=Ft,Ga[1]=Ut,Ya.point=Dk,Sh=null}function Xq(e,t){if(Sh){var n=e-Uc;r0.add(Ve(n)>180?n+(n>0?360:-360):n)}else Vq=e,qq=t;Hs.point(e,t),Wq(e,t)}function nAe(){Hs.lineStart()}function rAe(){Xq(Vq,qq),Hs.lineEnd(),Ve(r0)>ue&&(Ft=-(Ut=180)),Ga[0]=Ft,Ga[1]=Ut,Sh=null}function Oi(e,t){return(t-=e)<0?t+360:t}function iAe(e,t){return e[0]-t[0]}function Qq(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}var o0,I_,F_,R_,N_,P_,L_,j_,Ck,Sk,Ak,Kq,Zq,Ir,Fr,Rr,Uo={sphere:zn,point:Ok,lineStart:Jq,lineEnd:eW,polygonStart:function(){Uo.lineStart=uAe,Uo.lineEnd=lAe},polygonEnd:function(){Uo.lineStart=Jq,Uo.lineEnd=eW}};function Ok(e,t){e*=ke;var n=le(t*=ke);s0(n*le(e),n*re(e),re(t))}function s0(e,t,n){++o0,F_+=(e-F_)/o0,R_+=(t-R_)/o0,N_+=(n-N_)/o0}function Jq(){Uo.point=sAe}function sAe(e,t){e*=ke;var n=le(t*=ke);Ir=n*le(e),Fr=n*re(e),Rr=re(t),Uo.point=aAe,s0(Ir,Fr,Rr)}function aAe(e,t){e*=ke;var n=le(t*=ke),r=n*le(e),i=n*re(e),o=re(t),s=no(Ar((s=Fr*o-Rr*i)*s+(s=Rr*r-Ir*o)*s+(s=Ir*i-Fr*r)*s),Ir*r+Fr*i+Rr*o);I_+=s,P_+=s*(Ir+(Ir=r)),L_+=s*(Fr+(Fr=i)),j_+=s*(Rr+(Rr=o)),s0(Ir,Fr,Rr)}function eW(){Uo.point=Ok}function uAe(){Uo.point=cAe}function lAe(){tW(Kq,Zq),Uo.point=Ok}function cAe(e,t){Kq=e,Zq=t,e*=ke,t*=ke,Uo.point=tW;var n=le(t);Ir=n*le(e),Fr=n*re(e),Rr=re(t),s0(Ir,Fr,Rr)}function tW(e,t){e*=ke;var n=le(t*=ke),r=n*le(e),i=n*re(e),o=re(t),s=Fr*o-Rr*i,a=Rr*r-Ir*o,u=Ir*i-Fr*r,l=jM(s,a,u),c=Kr(l),f=l&&-c/l;Ck.add(f*s),Sk.add(f*a),Ak.add(f*u),I_+=c,P_+=c*(Ir+(Ir=r)),L_+=c*(Fr+(Fr=i)),j_+=c*(Rr+(Rr=o)),s0(Ir,Fr,Rr)}const Mk="intersect",$_="index:unit";function iW(e,t){for(var s,a,n=t.fields,r=t.values,i=n.length,o=0;o<i;++o)if((a=n[o]).getter=qr.getter||qr(a.field),Iu(s=a.getter(e))&&(s=tr(s)),Iu(r[o])&&(r[o]=tr(r[o])),Iu(r[o][0])&&(r[o]=r[o].map(tr)),"E"===a.type){if(R(r[o])?r[o].indexOf(s)<0:s!==r[o])return!1}else if("R"===a.type){if(!Id(s,r[o]))return!1}else if("R-RE"===a.type){if(!Id(s,r[o],!0,!1))return!1}else if("R-E"===a.type){if(!Id(s,r[o],!1,!1))return!1}else if("R-LE"===a.type&&!Id(s,r[o],!1,!0))return!1;return!0}const Tk=qr("_vgsid_"),oW=function(e){let t=e,n=e;function r(s,a,u,l){for(null==u&&(u=0),null==l&&(l=s.length);u<l;){const c=u+l>>>1;n(s[c],a)<0?u=c+1:l=c}return u}return 1===e.length&&(t=(s,a)=>e(s)-a,n=function(e){return(t,n)=>function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}(e(t),n)}(e)),{left:r,center:function(s,a,u,l){null==u&&(u=0),null==l&&(l=s.length);const c=r(s,a,u,l-1);return c>u&&t(s[c-1],a)>-t(s[c],a)?c-1:c},right:function(s,a,u,l){for(null==u&&(u=0),null==l&&(l=s.length);u<l;){const c=u+l>>>1;n(s[c],a)>0?l=c:u=c+1}return u}}}(Tk),CAe=oW.left,SAe=oW.right;var sW={E_union:function(e,t){if(!e.length)return t;for(var n=0,r=t.length;n<r;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.indexOf(n)>=0):t},R_union:function(e,t){var n=tr(t[0]),r=tr(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<r&&(e[1]=r),e):[n,r]},R_intersect:function(e,t){var n=tr(t[0]),r=tr(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?r<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>r&&(e[1]=r),e):[n,r]}};function kk(e,t,n,r){t[0].type!==jc&&F("First argument to selection functions must be a string literal.");const i=t[0].value,s="unit",a="@"+s,u=":"+i;(t.length>=2&&je(t).value)===Mk&&!ne(r,a)&&(r[a]=n.getData(i).indataRef(n,s)),ne(r,u)||(r[u]=n.getData(i).tuplesRef())}function aW(e){const t=this.context.data[e];return t?t.values.value:[]}const a0=e=>function(t,n){return this.context.dataflow.locale()[e](n)(t)},NAe=a0("format"),uW=a0("timeFormat"),PAe=a0("utcFormat"),LAe=a0("timeParse"),jAe=a0("utcParse"),B_=new Date(2e3,0,1);function z_(e,t,n){return Number.isInteger(e)&&Number.isInteger(t)?(B_.setYear(2e3),B_.setMonth(e),B_.setDate(t),uW.call(this,B_,n)):""}function Fk(e,t,n,r){t[0].type!==jc&&F("First argument to data functions must be a string literal.");const i=t[0].value,o=":"+i;if(!ne(o,r))try{r[o]=n.getData(i).tuplesRef()}catch(s){}}function ti(e,t,n,r){if(t[0].type===jc)cW(n,r,t[0].value);else for(e in n.scales)cW(n,r,e)}function cW(e,t,n){const r="%"+n;if(!ne(t,r))try{t[r]=e.scaleRef(n)}catch(i){}}function Xa(e,t){let n;return xe(e)?e:Y(e)?(n=t.scales[e])&&n.value:void 0}function Rk(e,t){return function(n,r,i){if(n){const o=Xa(n,(i||this).context);return o&&o.path[e](r)}return t(r)}}const GAe=Rk("area",function(e){return k_=new Bn,Ua(e,Hs),2*k_}),YAe=Rk("bounds",function(e){var t,n,r,i,o,s,a;if(Ai=Ut=-(Ft=ei=1/0),gl=[],Ua(e,Ya),n=gl.length){for(gl.sort(iAe),t=1,o=[r=gl[0]];t<n;++t)Qq(r,(i=gl[t])[0])||Qq(r,i[1])?(Oi(r[0],i[1])>Oi(r[0],r[1])&&(r[1]=i[1]),Oi(i[0],r[1])>Oi(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(s=-1/0,t=0,r=o[n=o.length-1];t<=n;r=i,++t)(a=Oi(r[1],(i=o[t])[0]))>s&&(s=a,Ft=i[0],Ut=r[1])}return gl=Ga=null,Ft===1/0||ei===1/0?[[NaN,NaN],[NaN,NaN]]:[[Ft,ei],[Ut,Ai]]}),XAe=Rk("centroid",function(e){o0=I_=F_=R_=N_=P_=L_=j_=0,Ck=new Bn,Sk=new Bn,Ak=new Bn,Ua(e,Uo);var t=+Ck,n=+Sk,r=+Ak,i=jM(t,n,r);return i<Lb&&(t=P_,n=L_,r=j_,I_<ue&&(t=F_,n=R_,r=N_),(i=jM(t,n,r))<Lb)?[NaN,NaN]:[no(n,t)*Xt,Kr(r/i)*Xt]});function Nk(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(r){e.warn(r)}return n[n.length-1]}function Pk(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Lk(e){const t=Yu(e);return.2126*Pk(t.r)+.7152*Pk(t.g)+.0722*Pk(t.b)}function fW(e,t){return e===t||e!=e&&t!=t||(R(e)?!(!R(t)||e.length!==t.length)&&function(e,t){for(let n=0,r=e.length;n<r;++n)if(!fW(e[n],t[n]))return!1;return!0}(e,t):!(!J(e)||!J(t))&&dW(e,t))}function dW(e,t){for(const n in e)if(!fW(e[n],t[n]))return!1;return!0}function hW(e){return t=>dW(e,t)}const pW={};function jk(e){return R(e)||ArrayBuffer.isView(e)?e:null}function $k(e){return jk(e)||(Y(e)?e:null)}const gW=e=>e.data;function mW(e,t){const n=aW.call(t,e);return n.root&&n.root.lookup||{}}const yW=()=>"undefined"!=typeof window&&window||null,u0={random:()=>Ki(),cumulativeNormal:C1,cumulativeLogNormal:YA,cumulativeUniform:ZA,densityNormal:HA,densityLogNormal:GA,densityUniform:KA,quantileNormal:S1,quantileLogNormal:XA,quantileUniform:JA,sampleNormal:D1,sampleLogNormal:WA,sampleUniform:QA,isArray:R,isBoolean:ku,isDate:Iu,isDefined:e=>void 0!==e,isNumber:ft,isObject:J,isRegExp:S6,isString:Y,isTuple:y1,isValid:e=>null!=e&&e==e,toBoolean:NS,toDate:PS,toNumber:tr,toString:LS,indexof:function(e,...t){return $k(e).indexOf(...t)},join:function(e,...t){return jk(e).join(...t)},lastindexof:function(e,...t){return $k(e).lastIndexOf(...t)},replace:function(e,t,n){return xe(n)&&F("Function argument passed to replace."),String(e).replace(t,n)},reverse:function(e){return jk(e).slice().reverse()},slice:function(e,...t){return $k(e).slice(...t)},flush:D6,lerp:A6,merge:function(){const e=[].slice.call(arguments);return e.unshift({}),Ee(...e)},pad:T6,peek:je,pluck:function(e,t){const n=pW[t]||(pW[t]=qr(t));return R(e)?e.map(n):n(e)},span:Dg,inrange:Id,truncate:k6,rgb:Yu,lab:Y1,hcl:X1,hsl:B1,luminance:Lk,contrast:function(e,t){const n=Lk(e),r=Lk(t);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)},sequence:Ci,format:NAe,utcFormat:PAe,utcParse:jAe,utcOffset:mB,utcSequence:bB,timeFormat:uW,timeParse:LAe,timeOffset:gB,timeSequence:vB,timeUnitSpecifier:iB,monthFormat:function(e){return z_.call(this,e,1,"%B")},monthAbbrevFormat:function(e){return z_.call(this,e,1,"%b")},dayFormat:function(e){return z_.call(this,0,2+e,"%A")},dayAbbrevFormat:function(e){return z_.call(this,0,2+e,"%a")},quarter:_6,utcquarter:w6,week:sB,utcweek:lB,dayofyear:oB,utcdayofyear:uB,warn:function(){return Nk(this.context.dataflow,"warn",arguments)},info:function(){return Nk(this.context.dataflow,"info",arguments)},debug:function(){return Nk(this.context.dataflow,"debug",arguments)},extent:Cs,inScope:function(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n},intersect:function(e,t,n){if(!e)return[];const[r,i]=e,o=(new mn).set(r[0],r[1],i[0],i[1]);return k7(n||this.context.dataflow.scenegraph().root,o,function(e){let t=null;if(e){const n=X(e.marktype),r=X(e.markname);t=i=>(!n.length||n.some(o=>i.marktype===o))&&(!r.length||r.some(o=>i.name===o))}return t}(t))},clampRange:x6,pinchDistance:function(e){const t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+r*r)},pinchAngle:function(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)},screen:function(){const e=yW();return e?e.screen:{}},containerSize:function(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]},windowSize:function(){const e=yW();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]},bandspace:function(e,t,n){return m2(e||0,t||0,n||0)},setdata:function(e,t){const n=this.context.dataflow;return n.pulse(this.context.data[e].input,n.changeset().remove(Yi).insert(t)),1},pathShape:function(e){let t=null;return function(n){return n?am(n,t=t||oh(e)):e}},panLinear:m6,panLog:y6,panPow:v6,panSymlog:b6,zoomLinear:MS,zoomLog:TS,zoomPow:Jv,zoomSymlog:kS,encode:function(e,t,n){if(e){const r=this.context.dataflow;r.pulse(e.mark.source,r.changeset().encode(e,t))}return void 0!==n?n:e},modify:function(e,t,n,r,i,o){const s=this.context.dataflow,a=this.context.data[e],u=a.input,l=s.stamp();let f,d,c=a.changes;if(!1===s._trigger||!(u.value.length||t||r))return 0;if((!c||c.stamp<l)&&(a.changes=c=s.changeset(),c.stamp=l,s.runAfter(()=>{a.modified=!0,s.pulse(u,c).run()},!0,1)),n&&(f=!0===n?Yi:R(n)||y1(n)?n:hW(n),c.remove(f)),t&&c.insert(t),r&&(f=hW(r),u.value.some(f)?c.remove(f):c.insert(r)),i)for(d in o)c.modify(i,d,o[d]);return 1}},TOe=["view","item","group","xy","x","y"],vW="this.",Bk={},bW={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>`_[${H("$"+e)}]`,functions:function(e){const t=$q(e);TOe.forEach(n=>t[n]="event.vega."+n);for(const n in u0)t[n]=vW+n;return Ee(t,function(e,t,n){t.__bandwidth=i=>i&&i.bandwidth?i.bandwidth():0,n._bandwidth=ti,n._range=ti,n._scale=ti;const r=i=>"_["+(i.type===jc?H("%"+i.value):H("%")+"+"+e(i))+"]";return{_bandwidth:i=>`this.__bandwidth(${r(i[0])})`,_range:i=>`${r(i[0])}.range()`,_scale:i=>`${r(i[0])}(${e(i[1])})`}}(e,u0,Bk)),t},constants:jq,visitors:Bk},zk=Bq(bW);function on(e,t,n){return 1===arguments.length?u0[e]:(u0[e]=t,n&&(Bk[e]=n),zk&&(zk.functions[e]=vW+e),this)}function Vs(e,t){const n={};let r;try{r=_k(e=Y(e)?e:H(e)+"")}catch(o){F("Expression parse error: "+e)}r.visit(o=>{if(o.type!==Dq)return;const s=o.callee.name,a=bW.visitors[s];a&&a(s,o.arguments,t,n)});const i=zk(r);return i.globals.forEach(o=>{const s="$"+o;!ne(n,s)&&t.getSignal(o)&&(n[s]=t.signalRef(o))}),{$expr:Ee({code:i.code},t.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}on("bandwidth",function(e,t){const n=Xa(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0},ti),on("copy",function(e,t){const n=Xa(e,(t||this).context);return n?n.copy():void 0},ti),on("domain",function(e,t){const n=Xa(e,(t||this).context);return n?n.domain():[]},ti),on("range",function(e,t){const n=Xa(e,(t||this).context);return n&&n.range?n.range():[]},ti),on("invert",function(e,t,n){const r=Xa(e,(n||this).context);return r?R(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t):void 0},ti),on("scale",function(e,t,n){const r=Xa(e,(n||this).context);return r?r(t):void 0},ti),on("gradient",function(e,t,n,r,i){e=Xa(e,(i||this).context);const o=y9(t,n);let s=e.domain(),a=s[0],u=je(s),l=er;return u-a?l=n9(e,a,u):e=(e.interpolator?Je("sequential")().interpolator(e.interpolator()):Je("linear")().interpolate(e.interpolate()).range(e.range())).domain([a=0,u=1]),e.ticks&&(s=e.ticks(+r||15),a!==s[0]&&s.unshift(a),u!==je(s)&&s.push(u)),s.forEach(c=>o.stop(l(c),e(c))),o},ti),on("geoArea",GAe,ti),on("geoBounds",YAe,ti),on("geoCentroid",XAe,ti),on("geoShape",function(e,t,n){const r=Xa(e,(n||this).context);return function(i){return r?r.path.context(i)(t):""}},ti),on("indata",function(e,t,n){const r=this.context.data[e]["index:"+t],i=r?r.value.get(n):void 0;return i&&i.count},function(e,t,n,r){t[0].type!==jc&&F("First argument to indata must be a string literal."),t[1].type!==jc&&F("Second argument to indata must be a string literal.");const i=t[0].value,o=t[1].value,s="@"+o;ne(s,r)||(r[s]=n.getData(i).indataRef(n,o))}),on("data",aW,Fk),on("treePath",function(e,t,n){const r=mW(e,this),i=r[t],o=r[n];return i&&o?i.path(o).map(gW):void 0},Fk),on("treeAncestors",function(e,t){const n=mW(e,this)[t];return n?n.ancestors().map(gW):void 0},Fk),on("vlSelectionTest",function(e,t,n){for(var l,c,f,d,h,r=this.context.data[e],i=r?r.values.value:[],o=r?r[$_]&&r[$_].value:void 0,s=n===Mk,a=i.length,u=0;u<a;++u)if(l=i[u],o&&s){if(-1===(f=(c=c||{})[d=l.unit]||0))continue;if(h=iW(t,l),c[d]=h?-1:++f,h&&1===o.size)return!0;if(!h&&f===o.get(d).count)return!1}else if(s^(h=iW(t,l)))return h;return a&&s},kk),on("vlSelectionIdTest",function(e,t,n){const r=this.context.data[e],i=r?r.values.value:[],o=r?r[$_]&&r[$_].value:void 0,s=n===Mk,a=Tk(t),u=CAe(i,a);if(u===i.length||Tk(i[u])!==a)return!1;if(o&&s){if(1===o.size)return!0;if(SAe(i,a)-u<o.size)return!1}return!0},kk),on("vlSelectionResolve",function(e,t,n,r){for(var l,c,f,d,h,p,g,m,_,w,i=this.context.data[e],o=i?i.values.value:[],s={},a={},u={},y=o.length,b=0;b<y;++b){for(d=(l=o[b]).unit,f=l.values,_=0,w=(c=l.fields).length;_<w;++_)g=(p=s[(h=c[_]).field]||(s[h.field]={}))[d]||(p[d]=[]),u[h.field]=m=h.type.charAt(0),p[d]=(0,sW[m+"_union"])(g,X(f[_]));n&&(g=a[d]||(a[d]=[])).push(X(f).reduce((E,x,D)=>(E[c[D].field]=x,E),{}))}return t=t||"union",Object.keys(s).forEach(E=>{s[E]=Object.keys(s[E]).map(x=>s[E][x]).reduce((x,D)=>void 0===x?D:sW[u[E]+"_"+t](x,D))}),o=Object.keys(a),n&&o.length&&(s[r?"vlPoint":"vlMulti"]="union"===t?{or:o.reduce((x,D)=>(x.push(...a[D]),x),[])}:{and:o.map(x=>({or:a[x]}))}),s},kk),on("vlSelectionTuples",function(e,t){return e.map(n=>Ee({values:t.fields.map(r=>(r.getter||(r.getter=qr(r.field)))(n.datum))},t))});const ROe=To(["rule"]),_W=To(["group","image","rect"]);function Uk(e){return(e+"").toLowerCase()}function l0(e,t,n){";"!==n[n.length-1]&&(n="return("+n+");");const r=Function(...t.concat(n));return e&&e.functions?r.bind(e.functions):r}var $Oe={operator:(e,t)=>l0(e,["_"],t.code),parameter:(e,t)=>l0(e,["datum","_"],t.code),event:(e,t)=>l0(e,["event"],t.code),handler:(e,t)=>l0(e,["_","event"],"var datum=event.item&&event.item.datum;return ".concat(t.code,";")),encode:(e,t)=>{const{marktype:n,channels:r}=t;let i="var o=item,datum=o.datum,m=0,$;";for(const o in r){const s="o["+H(o)+"]";i+="$=".concat(r[o].code,";if(").concat(s,"!==$)").concat(s,"=$,m=1;")}return i+=function(e,t){let n="";return ROe[t]||(e.x2&&(e.x?(_W[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(_W[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}(r,n),i+="return m;",l0(e,["item","_"],i)},codegen:{get(e){const t="[".concat(e.map(H).join("]["),"]"),n=Function("_","return _".concat(t,";"));return n.path=t,n},comparator(e,t){let n;const i=Function("a","b","var u, v; return "+e.map((o,s)=>{const a=t[s];let u,l;return o.path?(u="a".concat(o.path),l="b".concat(o.path)):((n=n||{})["f"+s]=o,u="this.f".concat(s,"(a)"),l="this.f".concat(s,"(b)")),function(e,t,n,r){return"((u = ".concat(e,") < (v = ").concat(t,") || u == null) && v != null ? ").concat(n,"\n  : (u > v || v == null) && u != null ? ").concat(r,"\n  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ").concat(n,"\n  : v !== v && u === u ? ").concat(r," : ")}(u,l,-a,a)}).join("")+"0;");return n?i.bind(n):i}}};function wW(e,t,n){if(!e||!J(e))return e;for(let o,r=0,i=xW.length;r<i;++r)if(o=xW[r],ne(e,o.key))return o.parse(e,t,n);return e}var xW=[{key:"$ref",parse:function(e,t){return t.get(e.$ref)||F("Operator not defined: "+e.$ref)}},{key:"$key",parse:function(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=RS(e.$key,e.$flat,t.expr.codegen))}},{key:"$expr",parse:function(e,t,n){e.$params&&t.parseParameters(e.$params,n);const r="e:"+e.$expr.code+"_"+e.$name;return t.fn[r]||(t.fn[r]=Vr(t.parameterExpression(e.$expr),e.$fields,e.$name))}},{key:"$field",parse:function(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=qr(e.$field,e.$name,t.expr.codegen))}},{key:"$encode",parse:function(e,t){const n=e.$encode,r={};for(const i in n){const o=n[i];r[i]=Vr(t.encodeExpression(o.$expr),o.$fields),r[i].output=o.$output}return r}},{key:"$compare",parse:function(e,t){const n="c:"+e.$compare+"_"+e.$order,r=X(e.$compare).map(i=>i&&i.$tupleid?oe:i);return t.fn[n]||(t.fn[n]=IS(r,e.$order,t.expr.codegen))}},{key:"$context",parse:function(e,t){return t}},{key:"$subflow",parse:function(e,t){const n=e.$subflow;return function(r,i,o){const s=t.fork().parse(n),a=s.get(n.operators[0].id),u=s.signals.parent;return u&&u.set(o),a.detachSubflow=()=>t.detach(s),a}}},{key:"$tupleid",parse:function(){return oe}}];const e2e={skip:!0};function EW(e,t,n,r){return new DW(e,t,n,r)}function DW(e,t,n,r){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=r||$Oe,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function CW(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}function SW(e,t){e&&(null==t?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}DW.prototype=CW.prototype={fork(){const e=new CW(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,r=n.dataflow,i=e.value;if(n.set(e.id,t),function(e){return"collect"===Uk(e)}(e.type)&&i&&(i.$ingest?r.ingest(t,i.$ingest,i.$format):i.$request?r.preload(t,i.$request,i.$format):r.pulse(t,r.changeset().insert(i))),e.root&&(n.root=t),e.parent){let o=n.get(e.parent.$ref);o?(r.connect(o,[t]),t.targets().add(o)):(n.unresolved=n.unresolved||[]).push(()=>{o=n.get(e.parent.$ref),r.connect(o,[t]),t.targets().add(o)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const o in e.data){const s=n.data[o]||(n.data[o]={});e.data[o].forEach(a=>s[a]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[Uk(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,r,i){this.dataflow.on(t,n,r,i,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:function(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(r=>t.parseOperator(r)),n.forEach(r=>t.parseOperatorParameters(r)),(e.streams||[]).forEach(r=>t.parseStream(r)),(e.updates||[]).forEach(r=>t.parseUpdate(r)),t.resolve()},parseOperator:function(e){const t=this;!function(e){return"operator"===Uk(e)}(e.type)&&e.type?t.transform(e,e.type):t.operator(e,e.update?t.operatorExpression(e.update):null)},parseOperatorParameters:function(e){const t=this;if(e.params){const n=t.get(e.id);n||F("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}},parseParameters:function(e,t){t=t||{};const n=this;for(const r in e){const i=e[r];t[r]=R(i)?i.map(o=>wW(o,n,t)):wW(i,n,t)}return t},parseStream:function(e){var i,t=this,n=null!=e.filter?t.eventExpression(e.filter):void 0,r=null!=e.stream?t.get(e.stream):void 0;e.source?r=t.events(e.source,e.type,n):e.merge&&(r=(i=e.merge.map(o=>t.get(o)))[0].merge.apply(i[0],i.slice(1))),e.between&&(i=e.between.map(o=>t.get(o)),r=r.between(i[0],i[1])),e.filter&&(r=r.filter(n)),null!=e.throttle&&(r=r.throttle(+e.throttle)),null!=e.debounce&&(r=r.debounce(+e.debounce)),null==r&&F("Invalid stream definition: "+JSON.stringify(e)),e.consume&&r.consume(!0),t.stream(e,r)},parseUpdate:function(e){var i,t=this,n=J(n=e.source)?n.$ref:n,r=t.get(n),o=e.update,s=void 0;r||F("Source not defined: "+e.source),i=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),o&&o.$expr&&(o.$params&&(s=t.parseParameters(o.$params)),o=t.handlerExpression(o.$expr)),t.update(e,r,i,o,s)},getState:function(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach(o=>{const s=t.signals[o];e.signals(o,s)&&(r[o]=s.value)})}if(e.data){var i=n.data={};Object.keys(t.data).forEach(o=>{const s=t.data[o];e.data(o,s)&&(i[o]=s.input.value)})}return t.subcontext&&!1!==e.recurse&&(n.subcontext=t.subcontext.map(o=>o.getState(e))),n},setState:function(e){var t=this,n=t.dataflow,r=e.data,i=e.signals;Object.keys(i||{}).forEach(o=>{n.update(t.signals[o],i[o],e2e)}),Object.keys(r||{}).forEach(o=>{n.pulse(t.data[o].input,n.changeset().remove(Yi).insert(r[o]))}),(e.subcontext||[]).forEach((o,s)=>{const a=t.subcontext[s];a&&a.setState(o)})}};const Hk="default";function Vk(e,t){const n=e.globalCursor()?"undefined"!=typeof document&&document.body:e.container();if(n)return null==t?n.style.removeProperty("cursor"):n.style.cursor=t}function U_(e,t){var n=e._runtime.data;return ne(n,t)||F("Unrecognized data set: "+t),n[t]}function H_(e,t){a4(t)||F("Second argument to changes must be a changeset.");const n=U_(this,e);return n.modified=!0,this.pulse(n.input,t)}function AW(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function OW(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function V_(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}const g2e={trap:!1};function TW(e,t,n,r){e._eventListeners.push({type:n,sources:X(t),handler:r})}function q_(e,t,n){const r=e._eventConfig&&e._eventConfig[t];return!(!1===r||J(r)&&!r[n])||(e.warn(`Blocked ${t} ${n} event listener.`),!1)}function kW(e){return e.item}function IW(e){return e.item.mark.source}function FW(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function Mi(e,t,n){const r=document.createElement(e);for(const i in t)r.setAttribute(i,t[i]);return null!=n&&(r.textContent=n),r}function D2e(e,t,n){if(!t)return;const r=n.param;let i=n.state;return i||(i=n.state={elements:null,active:!1,set:null,update:s=>{s!=e.signal(r.signal)&&e.runAsync(null,()=>{i.source=!0,e.signal(r.signal,s)})}},r.debounce&&(i.update=FS(r.debounce,i.update))),(null==r.input&&r.element?C2e:A2e)(i,t,r,e),i.active||(e.on(e._signals[r.signal],null,()=>{i.source?i.source=!1:i.set(e.signal(r.signal))}),i.active=!0),i}function C2e(e,t,n,r){const i=n.event||"input",o=()=>e.update(t.value);r.signal(n.signal,t.value),t.addEventListener(i,o),TW(r,t,i,o),e.set=s=>{t.value=s,t.dispatchEvent(function(e){return"undefined"!=typeof Event?new Event(e):{type:e}}(i))}}function A2e(e,t,n,r){const i=r.signal(n.signal),o=Mi("div",{class:"vega-bind"}),s="radio"===n.input?o:o.appendChild(Mi("label"));s.appendChild(Mi("span",{class:"vega-bind-name"},n.name||n.signal)),t.appendChild(o);let a=O2e;switch(n.input){case"checkbox":a=M2e;break;case"select":a=T2e;break;case"radio":a=k2e;break;case"range":a=I2e}a(e,s,n,i)}function O2e(e,t,n,r){const i=Mi("input");for(const o in n)"signal"!==o&&"element"!==o&&i.setAttribute("input"===o?"type":o,n[o]);i.setAttribute("name",n.signal),i.value=r,t.appendChild(i),i.addEventListener("input",()=>e.update(i.value)),e.elements=[i],e.set=o=>i.value=o}function M2e(e,t,n,r){const i={type:"checkbox",name:n.signal};r&&(i.checked=!0);const o=Mi("input",i);t.appendChild(o),o.addEventListener("change",()=>e.update(o.checked)),e.elements=[o],e.set=s=>o.checked=!!s||null}function T2e(e,t,n,r){const i=Mi("select",{name:n.signal}),o=n.labels||[];n.options.forEach((s,a)=>{const u={value:s};W_(s,r)&&(u.selected=!0),i.appendChild(Mi("option",u,(o[a]||s)+""))}),t.appendChild(i),i.addEventListener("change",()=>{e.update(n.options[i.selectedIndex])}),e.elements=[i],e.set=s=>{for(let a=0,u=n.options.length;a<u;++a)if(W_(n.options[a],s))return void(i.selectedIndex=a)}}function k2e(e,t,n,r){const i=Mi("span",{class:"vega-bind-radio"}),o=n.labels||[];t.appendChild(i),e.elements=n.options.map((s,a)=>{const u={type:"radio",name:n.signal,value:s};W_(s,r)&&(u.checked=!0);const l=Mi("input",u);l.addEventListener("change",()=>e.update(s));const c=Mi("label",{},(o[a]||s)+"");return c.prepend(l),i.appendChild(c),l}),e.set=s=>{const a=e.elements,u=a.length;for(let l=0;l<u;++l)W_(a[l].value,s)&&(a[l].checked=!0)}}function I2e(e,t,n,r){r=void 0!==r?r:(+n.max+ +n.min)/2;const i=null!=n.max?n.max:Math.max(100,+r)||100,o=n.min||Math.min(0,i,+r)||0,s=n.step||Ru(o,i,100),a=Mi("input",{type:"range",name:n.signal,min:o,max:i,step:s});a.value=r;const u=Mi("span",{},+r);t.appendChild(a),t.appendChild(u);const l=()=>{u.textContent=a.value,e.update(+a.value)};a.addEventListener("input",l),a.addEventListener("change",l),e.elements=[a],e.set=c=>{a.value=c,u.textContent=c}}function W_(e,t){return e===t||e+""==t+""}function RW(e,t,n,r,i,o){return(t=t||new r(e.loader())).initialize(n,AW(e),OW(e),V_(e),i,o).background(e.background())}function qk(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function Wk(e,t,n){if("string"==typeof t){if("undefined"==typeof document)return e.error("DOM document instance not found."),null;if(!(t=document.querySelector(t)))return e.error("Signal bind element not found: "+t),null}if(t&&n)try{t.innerHTML=""}catch(r){t=null,e.error(r)}return t}const c0=e=>+e||0;function NW(e){return J(e)?{top:c0(e.top),bottom:c0(e.bottom),left:c0(e.left),right:c0(e.right)}:(e=>({top:e,bottom:e,left:e,right:e}))(c0(e))}function Gk(e,t,n,r){return Yk.apply(this,arguments)}function Yk(){return Yk=Zn(function*(e,t,n,r){const i=Tb(t),o=i&&i.headless;return o||F("Unrecognized renderer type: "+t),yield e.runAsync(),RW(e,null,null,o,n,r).renderAsync(e._scenegraph.root)}),Yk.apply(this,arguments)}function Xk(){return Xk=Zn(function*(e,t){e!==sl.Canvas&&e!==sl.SVG&&e!==sl.PNG&&F("Unrecognized image type: "+e);const n=yield Gk(this,e,t);return e===sl.SVG?L2e(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}),Xk.apply(this,arguments)}function L2e(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}function Qk(){return Qk=Zn(function*(e,t){return(yield Gk(this,sl.Canvas,e,t)).canvas()}),Qk.apply(this,arguments)}function Kk(){return Kk=Zn(function*(e){return(yield Gk(this,sl.SVG,e)).svg()}),Kk.apply(this,arguments)}var Zk="padding",jW={skip:!0};function $W(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===Zk?r.left+r.right:0)}function BW(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===Zk?r.top+r.bottom:0)}function q2e(e,t){return t.modified&&R(t.input.value)&&e.indexOf("_:vega:_")}function W2e(e,t){return!("parent"===e||t instanceof Wd.proxy)}function X2e(e,t,n,r){const i=e.element();i&&i.setAttribute("title",function(e){return null==e?"":R(e)?zW(e):J(e)&&!Iu(e)?function(e){return Object.keys(e).map(t=>{const n=e[t];return t+": "+(R(n)?zW(n):UW(n))}).join("\n")}(e):e+""}(r))}function zW(e){return"["+e.map(UW).join(", ")+"]"}function UW(e){return R(e)?"[\u2026]":J(e)&&!Iu(e)?"{\u2026}":e}function HW(e,t){const n=this;if(t=t||{},qd.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),null!=t.logLevel&&n.logLevel(t.logLevel),t.locale||e.locale){const o=Ee({},e.locale,t.locale);n.locale(XB(o.number,o.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||sl.Canvas,n._scenegraph=new sM;const r=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||X2e,n._redraw=!0,n._handler=(new wm).scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=function(e){const t=Ee({defaults:{}},e),n=(r,i)=>{i.forEach(o=>{R(r[o])&&(r[o]=To(r[o]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const i=function(e,t,n){return EW(e,Wd,u0,n).parse(t)}(n,e,t.expr);n._runtime=i,n._signals=i.signals,n._bind=(e.bindings||[]).map(o=>({state:null,param:Ee({},o)})),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=$W(n,n._width),n._viewHeight=BW(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,function(e){var t=e._signals,n=t.width,r=t.height,i=t[Zk];function o(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,a=>{e._width=a.size,e._viewWidth=$W(e,a.size),o()},{size:n}),e._resizeHeight=e.add(null,a=>{e._height=a.size,e._viewHeight=BW(e,a.size),o()},{size:r});const s=e.add(null,o,{pad:i});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=r.rank+1,s.rank=i.rank+1}(n),function(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}(n),function(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:Hk,item:null}));e.on(e.events("view","mousemove"),t,(n,r)=>{const i=t.value,o=i?Y(i)?i:i.user:Hk,s=r.item&&r.item.cursor||null;return i&&o===i.user&&s==i.item?i:{user:o,item:s}}),e.add(null,function(n){let r=n.cursor,i=this.value;return Y(r)||(i=r.item,r=r.user),Vk(e,r&&r!==Hk?r:i||r),i},{cursor:t})}(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}function G_(e,t){return ne(e._signals,t)?e._signals[t]:F("Unrecognized signal name: "+H(t))}function VW(e,t){const n=(e._targets||[]).filter(r=>r._update&&r._update.handler===t);return n.length?n[0]:null}function qW(e,t,n,r){let i=VW(n,r);return i||(i=qk(e,()=>r(t,n.value)),i.handler=r,e.on(n,null,i)),e}function WW(e,t,n){const r=VW(t,n);return r&&t._targets.remove(r),e}z(HW,qd,{evaluate(e,t,n){var r=this;return Zn(function*(){if(yield qd.prototype.evaluate.call(r,e,t),r._redraw||r._resize)try{r._renderer&&(r._resize&&(r._resize=0,function(e){var t=V_(e),n=AW(e),r=OW(e);e._renderer.background(e.background()),e._renderer.resize(n,r,t),e._handler.origin(t),e._resizeListeners.forEach(i=>{try{i(n,r)}catch(o){e.error(o)}})}(r)),yield r._renderer.renderAsync(r._scenegraph.root)),r._redraw=!1}catch(i){r.error(i)}return n&&m1(r,n),r})()},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=null!=e?e+"":null;return t!==this._desc&&SW(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const r=G_(this,e);return 1===arguments.length?r.value:this.update(r,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",NW(e)):NW(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(Tb(e)||F("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(qd.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(G_(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:function(e,t,n,r,i,o){this.runAfter(s=>{let a=0;s._autosize=0,s.width()!==n&&(a=1,s.signal("width",n,jW),s._resizeWidth.skip(!0)),s.height()!==r&&(a=1,s.signal("height",r,jW),s._resizeHeight.skip(!0)),s._viewWidth!==e&&(s._resize=1,s._viewWidth=e),s._viewHeight!==t&&(s._resize=1,s._viewHeight=t),(s._origin[0]!==i[0]||s._origin[1]!==i[1])&&(s._resize=1,s._origin=i),a&&s.run("enter"),o&&s.runAfter(u=>u.resize())},!1,1)},addEventListener(e,t,n){let r=t;return n&&!1===n.trap||(r=qk(this,t),r.raw=t),this._handler.on(e,r),this},removeEventListener(e,t){for(var i,o,n=this._handler.handlers(e),r=n.length;--r>=0;)if(i=n[r].handler,e===(o=n[r].type)&&(t===i||t===i.raw)){this._handler.off(o,i);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return qW(this,e,G_(this,e),t)},removeSignalListener(e,t){return WW(this,G_(this,e),t)},addDataListener(e,t){return qW(this,e,U_(this,e).values,t)},removeDataListener(e,t){return WW(this,U_(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=Vk(this,null);this._globalCursor=!!e,t&&Vk(this,t)}return this}return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:function(e,t){this._timers.push(function(e,t,n){var r=new h_,i=t;return null==t?(r.restart(e,t,n),r):(r._restart=r.restart,r.restart=function(o,s,a){s=+s,a=null==a?CT():+a,r._restart(function u(l){l+=i,r._restart(u,i+=s,a),o(l)},s,a)},r.restart(e,t,n),r)}(function(r){e({timestamp:Date.now(),elapsed:r})},t))},events:function(e,t,n){var s,r=this,i=new w1(n),o=function(l,c){r.runAsync(null,()=>{"view"===e&&function(e,t){var n=e._eventConfig.defaults,r=n.prevent,i=n.allow;return!1!==r&&!0!==i&&(!0===r||!1===i||(r?r[t]:i?!i[t]:e.preventDefault()))}(r,t)&&l.preventDefault(),i.receive(function(e,t,n){var o,a,r=e._renderer,i=r&&r.canvas();return i&&(a=V_(e),(o=wb(t.changedTouches?t.changedTouches[0]:t,i))[0]-=a[0],o[1]-=a[1]),t.dataflow=e,t.item=n,t.vega=function(e,t,n){const r=t?"group"===t.mark.marktype?t:t.mark.group:null;function i(s){var u,a=r;if(s)for(u=t;u;u=u.mark.group)if(u.mark.name===s){a=u;break}return a&&a.mark&&a.mark.interactive?a:{}}function o(s){if(!s)return n;Y(s)&&(s=i(s));const a=n.slice();for(;s;)a[0]-=s.x||0,a[1]-=s.y||0,s=s.mark&&s.mark.group;return a}return{view:nr(e),item:nr(t||{}),group:i,xy:o,x:s=>o(s)[0],y:s=>o(s)[1]}}(e,n,o),t}(r,l,c))})};if("timer"===e)q_(r,"timer",t)&&r.timer(o,t);else if("view"===e)q_(r,"view",t)&&r.addEventListener(t,o,g2e);else if("window"===e?q_(r,"window",t)&&"undefined"!=typeof window&&(s=[window]):"undefined"!=typeof document&&q_(r,"selector",t)&&(s=document.querySelectorAll(e)),s){for(var a=0,u=s.length;a<u;++a)s[a].addEventListener(t,o);TW(r,s,t,o)}else r.warn("Can not resolve event source: "+e);return i},finalize:function(){var r,i,o,e=this._tooltip,t=this._timers,n=this._eventListeners;for(r=t.length;--r>=0;)t[r].stop();for(r=n.length;--r>=0;)for(i=(o=n[r]).sources.length;--i>=0;)o.sources[i].removeEventListener(o.type,o.handler);return e&&e.call(this,this._handler,null,null,null),this},hover:function(e,t){return t=[t||"update",(e=[e||"hover"])[0]],this.on(this.events("view","mouseover",kW),IW,FW(e)),this.on(this.events("view","mouseout",kW),IW,FW(t)),this},data:function(e,t){return arguments.length<2?U_(this,e).values.value:H_.call(this,e,yc().remove(Yi).insert(t))},change:H_,insert:function(e,t){return H_.call(this,e,yc().insert(t))},remove:function(e,t){return H_.call(this,e,yc().remove(t))},scale:function(e){var t=this._runtime.scales;return ne(t,e)||F("Unrecognized scale or projection: "+e),t[e].value},initialize:function(e,t){const n=this,r=n._renderType,i=n._eventConfig.bind,o=Tb(r);e=n._el=e?Wk(n,e,!0):null,function(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),SW(t,e.description()))}(n),o||n.error("Unrecognized renderer type: "+r);const s=o.handler||wm,a=e?o.renderer:o.headless;return n._renderer=a?RW(n,n._renderer,e,a):null,n._handler=function(e,t,n,r){const i=new r(e.loader(),qk(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,V_(e),e);return t&&t.handlers().forEach(o=>{i.on(o.type,o.handler)}),i}(n,n._handler,e,s),n._redraw=!0,e&&"none"!==i&&(t=t?n._elBind=Wk(n,t,!0):e.appendChild(Mi("form",{class:"vega-bindings"})),n._bind.forEach(u=>{u.param.element&&"container"!==i&&(u.element=Wk(n,u.param.element,!!u.param.input))}),n._bind.forEach(u=>{D2e(n,u.element||t,u)})),n},toImageURL:function(e,t){return Xk.apply(this,arguments)},toCanvas:function(e,t){return Qk.apply(this,arguments)},toSVG:function(e){return Kk.apply(this,arguments)},getState:function(e){return this._runtime.getState(e||{data:q2e,signals:W2e,recurse:!0})},setState:function(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}});const nMe=/[[\]{}]/,rMe={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let QW,KW;function ml(e,t,n){return QW=t||"view",KW=n||rMe,ZW(e.trim()).map(Jk)}function f0(e,t,n,r,i){const o=e.length;let a,s=0;for(;t<o;++t){if(a=e[t],!s&&a===n)return t;i&&i.indexOf(a)>=0?--s:r&&r.indexOf(a)>=0&&++s}return t}function ZW(e){const t=[],n=e.length;let r=0,i=0;for(;i<n;)i=f0(e,i,",","[{","]}"),t.push(e.substring(r,i).trim()),r=++i;if(0===t.length)throw"Empty event selector: "+e;return t}function Jk(e){return"["===e[0]?function(e){const t=e.length;let r,n=1;if(n=f0(e,n,"]","[","]"),n===t)throw"Empty between selector: "+e;if(r=ZW(e.substring(1,n)),2!==r.length)throw"Between selector must have two elements: "+e;if(">"!==(e=e.slice(n+1).trim())[0])throw"Expected '>' after between selector: "+e;r=r.map(Jk);const i=Jk(e.slice(1).trim());return i.between?{between:r,stream:i}:(i.between=r,i)}(e):function(e){const t={source:QW},n=[];let u,l,r=[0,0],i=0,o=0,s=e.length,a=0;if("}"===e[s-1]){if(a=e.lastIndexOf("{"),!(a>=0))throw"Unmatched right brace: "+e;try{r=function(e){const t=e.split(",");if(!e.length||t.length>2)throw e;return t.map(n=>{const r=+n;if(r!=r)throw e;return r})}(e.substring(a+1,s-1))}catch(c){throw"Invalid throttle specification: "+e}s=(e=e.slice(0,a).trim()).length,a=0}if(!s)throw e;if("@"===e[0]&&(i=++a),u=f0(e,a,":"),u<s&&(n.push(e.substring(o,u).trim()),o=a=++u),a=f0(e,a,"["),a===s)n.push(e.substring(o,s).trim());else if(n.push(e.substring(o,a).trim()),l=[],o=++a,o===s)throw"Unmatched left bracket: "+e;for(;a<s;){if(a=f0(e,a,"]"),a===s)throw"Unmatched left bracket: "+e;if(l.push(e.substring(o,a).trim()),a<s-1&&"["!==e[++a])throw"Expected left bracket: "+e;o=++a}if(!(s=n.length)||nMe.test(n[s-1]))throw"Invalid event selector: "+e;return s>1?(t.type=n[1],i?t.markname=n[0].slice(1):function(e){return KW[e]}(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],"!"===t.type.slice(-1)&&(t.consume=!0,t.type=t.type.slice(0,-1)),null!=l&&(t.filter=l),r[0]&&(t.throttle=r[0]),r[1]&&(t.debounce=r[1]),t}(e)}function uMe(e){return J(e)?e:{type:e||"pad"}}const d0=e=>+e||0;function cMe(e){return J(e)?e.signal?e:{top:d0(e.top),bottom:d0(e.bottom),left:d0(e.left),right:d0(e.right)}:(e=>({top:e,bottom:e,left:e,right:e}))(d0(e))}const Sn=e=>J(e)&&!R(e)?Ee({},e):{value:e};function JW(e,t,n,r){return null!=n?(J(n)&&!R(n)||R(n)&&n.length&&J(n[0])?e.update[t]=n:e[r||"enter"][t]={value:n},1):0}function Hn(e,t,n){for(const r in t)JW(e,r,t[r]);for(const r in n)JW(e,r,n[r],"update")}function Ah(e,t,n){for(const r in t)n&&ne(n,r)||(e[r]=Ee(e[r]||{},t[r]));return e}function Oh(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const eI="mark",tI="frame",nI="scope",eG="legend-label";function rI(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const tG=e=>Y(e)?H(e):e.signal?`(${e.signal})`:nG(e);function Q_(e){if(null!=e.gradient)return function(e){const t=[e.start,e.stop,e.count].map(n=>null==n?null:H(n));for(;t.length&&null==je(t);)t.pop();return t.unshift(tG(e.gradient)),`gradient(${t.join(",")})`}(e);let t=e.signal?`(${e.signal})`:e.color?function(e){return e.c?K_("hcl",e.h,e.c,e.l):e.h||e.s?K_("hsl",e.h,e.s,e.l):e.l||e.a?K_("lab",e.l,e.a,e.b):e.r||e.g||e.b?K_("rgb",e.r,e.g,e.b):null}(e.color):null!=e.field?nG(e.field):void 0!==e.value?H(e.value):void 0;return null!=e.scale&&(t=function(e,t){const n=tG(e.scale);return null!=e.range?t=`lerp(_range(${n}), ${+e.range})`:(void 0!==t&&(t=`_scale(${n}, ${t})`),e.band&&(t=(t?t+"+":"")+`_bandwidth(${n})`+(1==+e.band?"":"*"+Z_(e.band)),e.extra&&(t=`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`)),null==t&&(t="0")),t}(e,t)),void 0===t&&(t=null),null!=e.exponent&&(t=`pow(${t},${Z_(e.exponent)})`),null!=e.mult&&(t+=`*${Z_(e.mult)}`),null!=e.offset&&(t+=`+${Z_(e.offset)}`),e.round&&(t=`round(${t})`),t}const K_=(e,t,n,r)=>`(${e}(${[t,n,r].map(Q_).join(",")})+'')`;function Z_(e){return J(e)?"("+Q_(e)+")":e}function nG(e){return rG(J(e)?e:{datum:e})}function rG(e){let t,n,r;if(e.signal)t="datum",r=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(r=e.parent,t+=".datum"):r=e.group}else e.datum?(t="datum",r=e.datum):F("Invalid field reference: "+H(e));return e.signal||(r=Y(r)?Ds(r).map(H).join("]["):rG(r)),t+"["+r+"]"}function iG(e,t,n,r,i,o){const s={};(o=o||{}).encoders={$encode:s},e=function(e,t,n,r,i){const o={},s={};let a,u,l,c;for(u in u="lineBreak","text"===t&&null!=i[u]&&!Oh(u,e)&&rI(o,u,i[u]),("legend"==n||String(n).startsWith("axis"))&&(n=null),c=n===tI?i.group:n===eI?Ee({},i.mark,i[t]):null,c)l=Oh(u,e)||("fill"===u||"stroke"===u)&&(Oh("fill",e)||Oh("stroke",e)),l||rI(o,u,c[u]);for(u in X(r).forEach(f=>{const d=i.style&&i.style[f];for(const h in d)Oh(h,e)||rI(o,h,d[h])}),e=Ee({},e),o)c=o[u],c.signal?(a=a||{})[u]=c:s[u]=c;return e.enter=Ee(s,e.enter),a&&(e.update=Ee(a,e.update)),e}(e,t,n,r,i.config);for(const a in e)s[a]=kMe(e[a],t,o,i);return o}function kMe(e,t,n,r){const i={},o={};for(const s in e)null!=e[s]&&(i[s]=FMe(IMe(e[s]),r,n,o));return{$expr:{marktype:t,channels:i},$fields:Object.keys(o),$output:Object.keys(e)}}function IMe(e){return R(e)?function(e){let t="";return e.forEach(n=>{const r=Q_(n);t+=n.test?`(${n.test})?${r}:`:r}),":"===je(t)&&(t+="null"),t}(e):Q_(e)}function FMe(e,t,n,r){const i=Vs(e,t);return i.$fields.forEach(o=>r[o]=1),Ee(n,i.$params),i.$expr}const NMe=["value","update","init","react","bind"];function oG(e,t){F(e+' for "outer" push: '+H(t))}function sG(e,t){const n=e.name;if("outer"===e.push)t.signals[n]||oG("No prior signal definition",n),NMe.forEach(r=>{void 0!==e[r]&&oG("Invalid property ",r)});else{const r=t.addSignal(n,e.value);!1===e.react&&(r.react=!1),e.bind&&t.addBinding(n,e.bind)}}function iI(e,t,n,r){this.id=-1,this.type=e,this.value=t,this.params=n,r&&(this.parent=r)}function J_(e,t,n,r){return new iI(e,t,n,r)}function ew(e,t){return J_("operator",e,t)}function se(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function h0(e,t){return t?{$field:e,$name:t}:{$field:e}}const oI=h0("key");function aG(e,t){return{$compare:e,$order:t}}function tw(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const sI="scope",aI="view";function vn(e){return e&&e.signal}function nw(e){if(vn(e))return!0;if(J(e))for(const t in e)if(nw(e[t]))return!0;return!1}function Ho(e,t){return null!=e?e:t}function Hc(e){return e&&e.signal||e}function p0(e,t){return(e.merge?UMe:e.stream?HMe:e.type?VMe:F("Invalid stream specification: "+H(e)))(e,t)}function UMe(e,t){const r=uI({merge:e.merge.map(i=>p0(i,t))},e,t);return t.addStream(r).id}function HMe(e,t){const r=uI({stream:p0(e.stream,t)},e,t);return t.addStream(r).id}function VMe(e,t){let n;"timer"===e.type?(n=t.event("timer",e.throttle),e={between:e.between,filter:e.filter}):n=t.event(function(e){return e===sI?aI:e||aI}(e.source),e.type);const r=uI({stream:n},e,t);return 1===Object.keys(r).length?n:t.addStream(r).id}function uI(e,t,n){let r=t.between;return r&&(2!==r.length&&F('Stream "between" parameter must have 2 entries: '+H(t)),e.between=[p0(r[0],n),p0(r[1],n)]),r=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&r.push(function(e,t,n){const r="event.item";return r+(e&&"*"!==e?"&&"+r+".mark.marktype==='"+e+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(t?"&&"+r+".mark.name==='"+t+"'":"")}(t.marktype,t.markname,t.markrole)),t.source===sI&&r.push("inScope(event.item)"),r.length&&(e.filter=Vs("("+r.join(")&&(")+")",n).$expr),null!=(r=t.throttle)&&(e.throttle=+r),null!=(r=t.debounce)&&(e.debounce=+r),t.consume&&(e.consume=!0),e}const WMe={code:"_.$value",ast:{type:"Identifier",value:"value"}};function XMe(e){return{signal:"["+e.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}const dt=e=>(t,n,r)=>J_(e,n,t||void 0,r),lG=dt("aggregate"),KMe=dt("axisticks"),cG=dt("bound"),Vo=dt("collect"),fG=dt("compare"),ZMe=dt("datajoin"),dG=dt("encode"),JMe=dt("expression"),eTe=dt("facet"),tTe=dt("field"),nTe=dt("key"),rTe=dt("legendentries"),iTe=dt("load"),oTe=dt("mark"),sTe=dt("multiextent"),aTe=dt("multivalues"),uTe=dt("overlap"),lTe=dt("params"),hG=dt("prefacet"),cTe=dt("projection"),fTe=dt("proxy"),dTe=dt("relay"),pG=dt("render"),hTe=dt("scale"),Vc=dt("sieve"),pTe=dt("sortitems"),gG=dt("viewlayout"),gTe=dt("values");let mTe=0;const mG={min:"min",max:"max",count:"sum"};function vTe(e,t){const n=t.getScale(e.name).params;let r;for(r in n.domain=yG(e.domain,e,t),null!=e.range&&(n.range=bG(e,t,n)),null!=e.interpolate&&function(e,t){t.interpolate=io(e.type||e),null!=e.gamma&&(t.interpolateGamma=io(e.gamma))}(e.interpolate,n),null!=e.nice&&(n.nice=function(e){return J(e)?{interval:io(e.interval),step:io(e.step)}:io(e)}(e.nice)),null!=e.bins&&(n.bins=function(e,t){return e.signal||R(e)?rw(e,t):t.objectProperty(e)}(e.bins,t)),e)ne(n,r)||"name"===r||(n[r]=io(e[r],t))}function io(e,t){return J(e)?e.signal?t.signalRef(e.signal):F("Unsupported object: "+H(e)):e}function rw(e,t){return e.signal?t.signalRef(e.signal):e.map(n=>io(n,t))}function iw(e){F("Can not find data set: "+H(e))}function yG(e,t,n){if(e)return e.signal?n.signalRef(e.signal):(R(e)?bTe:e.fields?wTe:_Te)(e,t,n);(null!=t.domainMin||null!=t.domainMax)&&F("No scale domain defined for domainMin/domainMax to override.")}function bTe(e,t,n){return e.map(r=>io(r,n))}function _Te(e,t,n){const r=n.getData(e.data);return r||iw(e.data),ih(t.type)?r.valuesRef(n,e.field,vG(e.sort,!1)):JU(t.type)?r.domainRef(n,e.field):r.extentRef(n,e.field)}function wTe(e,t,n){const r=e.data,i=e.fields.reduce((o,s)=>(s=Y(s)?{data:r,field:s}:R(s)||s.signal?function(e,t){const n="_:vega:_"+mTe++,r=Vo({});if(R(e))r.value={$ingest:e};else if(e.signal){const i="setdata("+H(n)+","+e.signal+")";r.params.input=t.signalRef(i)}return t.addDataPipeline(n,[r,Vc({})]),{data:n,field:"data"}}(s,n):s,o.push(s),o),[]);return(ih(t.type)?ETe:JU(t.type)?DTe:CTe)(e,n,i)}function ETe(e,t,n){const r=vG(e.sort,!0);let i,o;const s=n.map(l=>{const c=t.getData(l.data);return c||iw(l.data),c.countsRef(t,l.field,r)}),a={groupby:oI,pulse:s};r&&(i=r.op||"count",o=r.field?tw(i,r.field):"count",a.ops=[mG[i]],a.fields=[t.fieldRef(o)],a.as=[o]),i=t.add(lG(a));const u=t.add(Vo({pulse:se(i)}));return o=t.add(gTe({field:oI,sort:t.sortRef(r),pulse:se(u)})),se(o)}function vG(e,t){return e&&(e.field||e.op?e.field||"count"===e.op?t&&e.field&&e.op&&!mG[e.op]&&F("Multiple domain scales can not be sorted using "+e.op):F("No field provided for sort aggregate op: "+e.op):J(e)?e.field="key":e={field:"key"}),e}function DTe(e,t,n){const r=n.map(i=>{const o=t.getData(i.data);return o||iw(i.data),o.domainRef(t,i.field)});return se(t.add(aTe({values:r})))}function CTe(e,t,n){const r=n.map(i=>{const o=t.getData(i.data);return o||iw(i.data),o.extentRef(t,i.field)});return se(t.add(sTe({extents:r})))}function bG(e,t,n){const r=t.config.range;let i=e.range;if(i.signal)return t.signalRef(i.signal);if(Y(i)){if(r&&ne(r,i))return bG(e=Ee({},e,{range:r[i]}),t,n);"width"===i?i=[0,{signal:"width"}]:"height"===i?i=ih(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:F("Unrecognized scale range value: "+H(i))}else{if(i.scheme)return n.scheme=R(i.scheme)?rw(i.scheme,t):io(i.scheme,t),i.extent&&(n.schemeExtent=rw(i.extent,t)),void(i.count&&(n.schemeCount=io(i.count,t)));if(i.step)return void(n.rangeStep=io(i.step,t));if(ih(e.type)&&!R(i))return yG(i,e,t);R(i)||F("Unsupported range type: "+H(i))}return i.map(o=>(R(o)?rw:io)(o,t))}function lI(e,t,n){return R(e)?e.map(r=>lI(r,t,n)):J(e)?e.signal?n.signalRef(e.signal):"fit"===t?e:F("Unsupported parameter object: "+H(e)):e}const qo="top",yl="bottom",fI="label",oo="value",g0="guide-label",dI="guide-title",ow="gradient",hI="discrete",gI=["size","shape","fill","stroke","strokeWidth","strokeDash","opacity"],m0={name:1,style:1,interactive:1},qe={value:0},so={value:1},sw="group",mI="rule",qc="text";function y0(e){return e.type=sw,e.interactive=e.interactive||!1,e}function ni(e,t){const n=(r,i)=>Ho(e[r],Ho(t[r],i));return n.isVertical=r=>"vertical"===Ho(e.direction,t.direction||(r?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>Ho(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>Ho(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>Ho(e.columns,Ho(t.columns,+n.isVertical(!0))),n}function EG(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function aw(e,t,n){return`item.anchor === 'start' ? ${e} : item.anchor === 'end' ? ${t} : ${n}`}const yI=aw(H("left"),H("right"),H("center"));function DG(e,t){return t?e?J(e)?Object.assign({},e,{offset:DG(e.offset,t)}):{value:e,offset:t}:t:e}function Ti(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=Ah(e.encode,t,m0)):e.interactive=!1,e}function zTe(e,t,n,r){const i=ni(e,n),o=i.isVertical(),s=i.gradientThickness(),a=i.gradientLength();let u,l,c,f,d;o?(l=[0,1],c=[0,0],f=s,d=a):(l=[0,0],c=[1,0],f=a,d=s);const h={enter:u={opacity:qe,x:qe,y:qe,width:Sn(f),height:Sn(d)},update:Ee({},u,{opacity:so,fill:{gradient:t,start:l,stop:c}}),exit:{opacity:qe}};return Hn(h,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")}),Ti({type:"rect",role:"legend-gradient",encode:h},r)}function UTe(e,t,n,r,i){const o=ni(e,n),s=o.isVertical(),a=o.gradientThickness(),u=o.gradientLength();let l,c,f,d,h="";s?(l="y",f="y2",c="x",d="width",h="1-"):(l="x",f="x2",c="y",d="height");const p={opacity:qe,fill:{scale:t,field:oo}};p[l]={signal:h+"datum.perc",mult:u},p[c]=qe,p[f]={signal:h+"datum.perc2",mult:u},p[d]=Sn(a);const g={enter:p,update:Ee({},p,{opacity:so}),exit:{opacity:qe}};return Hn(g,{stroke:o("gradientStrokeColor"),strokeWidth:o("gradientStrokeWidth")},{opacity:o("gradientOpacity")}),Ti({type:"rect",role:"legend-band",key:oo,from:i,encode:g},r)}const VTe=`datum.perc<=0?"${yl}":datum.perc>=1?"top":"middle"`;function CG(e,t,n,r){const i=ni(e,t),o=i.isVertical(),s=Sn(i.gradientThickness()),a=i.gradientLength();let l,c,f,d,u=i("labelOverlap"),h="";const p={enter:l={opacity:qe},update:c={opacity:so,text:{field:fI}},exit:{opacity:qe}};return Hn(p,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:Ho(e.labelLimit,t.gradientLabelLimit)}),o?(l.align={value:"left"},l.baseline=c.baseline={signal:VTe},f="y",d="x",h="1-"):(l.align=c.align={signal:'datum.perc<=0?"left":datum.perc>=1?"right":"center"'},l.baseline={value:"top"},f="x",d="y"),l[f]=c[f]={signal:h+"datum.perc",mult:a},l[d]=c[d]=s,s.offset=Ho(e.labelOffset,t.gradientLabelOffset)||0,u=u?{separation:i("labelSeparation"),method:u,order:"datum.index"}:void 0,Ti({type:qc,role:eG,style:g0,key:oo,from:r,encode:p,overlap:u},n)}function qTe(e,t,n,r,i){const o=ni(e,t),s=n.entries,a=!(!s||!s.interactive),u=s?s.name:void 0,l=o("clipHeight"),c=o("symbolOffset"),f={data:"value"},d=`(${i}) ? datum.offset : datum.size`,h=l?Sn(l):{field:"size"},p="datum.index",g=`max(1, ${i})`;let m,v,y,b,_;h.mult=.5,m={enter:v={opacity:qe,x:{signal:d,mult:.5,offset:c},y:h},update:y={opacity:so,x:v.x,y:v.y},exit:{opacity:qe}};let w=null,E=null;e.fill||(w=t.symbolBaseFillColor,E=t.symbolBaseStrokeColor),Hn(m,{fill:o("symbolFillColor",w),shape:o("symbolType"),size:o("symbolSize"),stroke:o("symbolStrokeColor",E),strokeDash:o("symbolDash"),strokeDashOffset:o("symbolDashOffset"),strokeWidth:o("symbolStrokeWidth")},{opacity:o("symbolOpacity")}),gI.forEach(C=>{e[C]&&(y[C]=v[C]={scale:e[C],field:oo})});const x=Ti({type:"symbol",role:"legend-symbol",key:oo,from:f,clip:!!l||void 0,encode:m},n.symbols),D=Sn(c);D.offset=o("labelOffset"),m={enter:v={opacity:qe,x:{signal:d,offset:D},y:h},update:y={opacity:so,text:{field:fI},x:v.x,y:v.y},exit:{opacity:qe}},Hn(m,{align:o("labelAlign"),baseline:o("labelBaseline"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontStyle:o("labelFontStyle"),fontWeight:o("labelFontWeight"),limit:o("labelLimit")});const S=Ti({type:qc,role:eG,style:g0,key:oo,from:f,encode:m},n.labels);return m={enter:{noBound:{value:!l},width:qe,height:l?Sn(l):qe,opacity:qe},exit:{opacity:qe},update:y={opacity:so,row:{signal:null},column:{signal:null}}},o.isVertical(!0)?(b=`ceil(item.mark.items.length / ${g})`,y.row.signal=`${p}%${b}`,y.column.signal=`floor(${p} / ${b})`,_={field:["row",p]}):(y.row.signal=`floor(${p} / ${g})`,y.column.signal=`${p} % ${g}`,_={field:p}),y.column.signal=`(${i})?${y.column.signal}:${p}`,y0({role:nI,from:r={facet:{data:r,name:"value",groupby:"index"}},encode:Ah(m,s,m0),marks:[x,S],name:u,interactive:a,sort:_})}const vI='item.orient === "left"',bI='item.orient === "right"',uw=`(${vI} || ${bI})`,GTe=`datum.vgrad && ${uw}`,YTe=aw('"top"','"bottom"','"middle"'),QTe=`datum.vgrad && ${bI} ? (${aw('"right"','"left"','"center"')}) : (${uw} && !(datum.vgrad && ${vI})) ? "left" : ${yI}`,KTe=`item._anchor || (${uw} ? "middle" : "start")`,ZTe=`${GTe} ? (${vI} ? -90 : 90) : 0`,JTe=`${uw} ? (datum.vgrad ? (${bI} ? "bottom" : "top") : ${YTe}) : "top"`;function tke(e,t){let n;return J(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+SG(e.path)+")":e.sphere&&(n="geoShape("+SG(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function SG(e){return J(e)&&e.signal?e.signal:H(e)}function AG(e){const t=e.role||"";return t.indexOf("axis")&&t.indexOf("legend")&&t.indexOf("title")?e.type===sw?nI:t||eI:t}function nke(e){return{marktype:e.type,name:e.name||void 0,role:e.role||AG(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function rke(e,t){return e&&e.signal?t.signalRef(e.signal):!1!==e}function _I(e,t){const n=m4(e.type);n||F("Unrecognized transform type: "+H(e.type));const r=J_(n.type.toLowerCase(),null,OG(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(r)),r.metadata=n.metadata||{},r}function OG(e,t,n){const r={},i=e.params.length;for(let o=0;o<i;++o){const s=e.params[o];r[s.name]=ike(s,t,n)}return r}function ike(e,t,n){const r=e.type,i=t[e.name];return"index"===r?function(e,t,n){return Y(t.from)||F('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}(0,t,n):void 0!==i?"param"===r?function(e,t,n){const r=t[e.name];return e.array?(R(r)||F("Expected an array of sub-parameters. Instead: "+H(r)),r.map(i=>TG(e,i,n))):TG(e,r,n)}(e,t,n):"projection"===r?n.projectionRef(t[e.name]):e.array&&!vn(i)?i.map(o=>MG(e,o,n)):MG(e,i,n):void(e.required&&F("Missing required "+H(t.type)+" parameter: "+H(e.name)))}function MG(e,t,n){const r=e.type;if(vn(t))return kG(r)?F("Expression references can not be signals."):wI(r)?n.fieldRef(t):IG(r)?n.compareRef(t):n.signalRef(t.signal);{const i=e.expr||wI(r);return i&&ake(t)?n.exprRef(t.expr,t.as):i&&uke(t)?h0(t.field,t.as):kG(r)?Vs(t,n):lke(r)?se(n.getData(t).values):wI(r)?h0(t):IG(r)?n.compareRef(t):t}}function TG(e,t,n){const r=e.params.length;let i;for(let s=0;s<r;++s){i=e.params[s];for(const a in i.key)if(i.key[a]!==t[a]){i=null;break}if(i)break}i||F("Unsupported parameter: "+H(t));const o=Ee(OG(i,t,n),i.key);return se(n.add(lTe(o)))}const ake=e=>e&&e.expr,uke=e=>e&&e.field,lke=e=>"data"===e,kG=e=>"expr"===e,wI=e=>"field"===e,IG=e=>"compare"===e;function lw(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:se(t.getData(e.data).output)}function Wc(e,t,n,r,i){this.scope=e,this.input=t,this.output=n,this.values=r,this.aggregate=i,this.index={}}function FG(e){return Y(e)?e:null}function RG(e,t,n){const r=tw(n.op,n.field);let i;if(t.ops){for(let o=0,s=t.as.length;o<s;++o)if(t.as[o]===r)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((i=n.op.signal)?e.signalRef(i):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(r))}function v0(e,t,n,r,i,o,s){const a=t[n]||(t[n]={}),u=function(e){return J(e)?("descending"===e.order?"-":"+")+tw(e.op,e.field):""}(o);let c,f,l=FG(i);if(null!=l&&(e=t.scope,l+=u?"|"+u:"",c=a[l]),!c){const d=o?{field:oI,pulse:t.countsRef(e,i,o)}:{field:e.fieldRef(i),pulse:se(t.output)};u&&(d.sort=e.sortRef(o)),f=e.add(J_(r,void 0,d)),s&&(t.index[i]=f),c=se(f),null!=l&&(a[l]=c)}return c}function NG(e,t,n){const r=e.remove,i=e.insert,o=e.toggle,s=e.modify,a=e.values,u=t.add(ew()),c=Vs("if("+e.trigger+',modify("'+n+'",'+[i,r,o,s,a].map(f=>null==f?"null":f).join(",")+"),0)",t);u.update=c.$expr,u.params=c.$params}function cw(e,t){const n=AG(e),r=e.type===sw,i=e.from&&e.from.facet,o=e.overlap;let a,u,l,c,f,d,h,s=e.layout||n===nI||n===tI;const p=n===eI||s||i,g=function(e,t,n){let r,i,o,s,a;return e?(r=e.facet)&&(t||F("Only group marks can be faceted."),null!=r.field?s=a=lw(r,n):(e.data?a=se(n.getData(e.data).aggregate):(o=_I(Ee({type:"aggregate",groupby:X(r.groupby)},r.aggregate),n),o.params.key=n.keyRef(r.groupby),o.params.pulse=lw(r,n),s=a=se(n.add(o))),i=n.keyRef(r.groupby,!0))):s=se(n.add(Vo(null,[{}]))),s||(s=lw(e,n)),{key:i,pulse:s,parent:a}}(e.from,r,t);u=t.add(ZMe({key:g.key||(e.key?h0(e.key):void 0),pulse:g.pulse,clean:!r}));const m=se(u);u=l=t.add(Vo({pulse:m})),u=t.add(oTe({markdef:nke(e),interactive:rke(e.interactive,t),clip:tke(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:se(u)}));const v=se(u);u=c=t.add(dG(iG(e.encode,e.type,n,e.style,t,{mod:!1,pulse:v}))),u.params.parent=t.encode(),e.transform&&e.transform.forEach(E=>{const x=_I(E,t),D=x.metadata;(D.generates||D.changes)&&F("Mark transforms should not generate new data."),D.nomod||(c.params.mod=!0),x.params.pulse=se(u),t.add(u=x)}),e.sort&&(u=t.add(pTe({sort:t.compareRef(e.sort),pulse:se(u)})));const y=se(u);(i||s)&&(s=t.add(gG({layout:t.objectProperty(e.layout),legends:t.legends,mark:v,pulse:y})),d=se(s));const b=t.add(cG({mark:v,pulse:d||y}));h=se(b),r&&(p&&(a=t.operators,a.pop(),s&&a.pop()),t.pushState(y,d||h,m),i?function(e,t,n){const r=e.from.facet,i=r.name,o=lw(r,t);let s;r.name||F("Facet must have a name: "+H(r)),r.data||F("Facet must reference a data set: "+H(r)),r.field?s=t.add(hG({field:t.fieldRef(r.field),pulse:o})):r.groupby?s=t.add(eTe({key:t.keyRef(r.groupby),group:se(t.proxy(n.parent)),pulse:o})):F("Facet must specify groupby or field: "+H(r));const a=t.fork(),u=a.add(Vo()),l=a.add(Vc({pulse:se(u)}));a.addData(i,new Wc(a,u,u,l)),a.addSignal("parent",null),s.params.subflow={$subflow:a.parse(e).toRuntime()}}(e,t,g):p?function(e,t,n){const r=t.add(hG({pulse:n.pulse})),i=t.fork();i.add(Vc()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(e).toRuntime()}}(e,t,g):t.parse(e),t.popState(),p&&(s&&a.push(s),a.push(b))),o&&(h=function(e,t,n){const r=e.method,i=e.bound,o=e.separation,s={separation:vn(o)?n.signalRef(o.signal):o,method:vn(r)?n.signalRef(r.signal):r,pulse:t};if(e.order&&(s.sort=n.compareRef({field:e.order})),i){const a=i.tolerance;s.boundTolerance=vn(a)?n.signalRef(a.signal):+a,s.boundScale=n.scaleRef(i.scale),s.boundOrient=i.orient}return se(n.add(uTe(s)))}(o,h,t));const _=t.add(pG({pulse:h})),w=t.add(Vc({pulse:se(_)},void 0,t.parent()));null!=e.name&&(f=e.name,t.addData(f,new Wc(t,l,_,w)),e.on&&e.on.forEach(E=>{(E.insert||E.remove||E.toggle)&&F("Marks only support modify triggers."),NG(E,t,f)}))}function yke(e,t,n){const r={enter:{},update:{}};return Hn(r,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),r}function PG(e,t,n){return t[e]?`scale("${t[e]}",datum)`:EG(e,n[0].encode)}function Eke(e,t){const n={enter:{},update:{}};return Hn(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:yI},angle:{signal:'item.orient==="left"?-90:item.orient==="right"?90:0'},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),Ah(n,t,m0)}function Gc(e){const t=Vo({},e);return t.metadata={source:!0},t}function LG(e,t){return iTe({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}Wc.fromEntries=function(e,t){const n=t.length,r=t[n-1],i=t[n-2];let o=t[0],s=null,a=1;for(o&&"load"===o.type&&(o=t[1]),e.add(t[0]);a<n;++a)t[a].params.pulse=se(t[a-1]),e.add(t[a]),"aggregate"===t[a].type&&(s=t[a]);return new Wc(e,o,i,r,s)},Wc.prototype={countsRef(e,t,n){const r=this,i=r.counts||(r.counts={}),o=FG(t);let s,a,u;return null!=o&&(e=r.scope,s=i[o]),s?n&&n.field&&RG(e,s.agg.params,n):(u={groupby:e.fieldRef(t,"key"),pulse:se(r.output)},n&&n.field&&RG(e,u,n),a=e.add(lG(u)),s=e.add(Vo({pulse:se(a)})),s={agg:a,ref:se(s)},null!=o&&(i[o]=s)),s.ref},tuplesRef(){return se(this.values)},extentRef(e,t){return v0(e,this,"extent","extent",t,!1)},domainRef(e,t){return v0(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return v0(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return v0(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return v0(e,this,"indata","tupleindex",t,!0,!0)}};const jG=e=>e===yl||e===qo,fw=(e,t,n)=>vn(e)?kke(e.signal,t,n):"left"===e||e===qo?t:n,An=(e,t,n)=>vn(e)?Mke(e.signal,t,n):jG(e)?t:n,Wo=(e,t,n)=>vn(e)?Tke(e.signal,t,n):jG(e)?n:t,$G=(e,t,n)=>vn(e)?Ike(e.signal,t,n):e===qo?{value:t}:{value:n},Mke=(e,t,n)=>BG(`${e} === 'top' || ${e} === '${yl}'`,t,n),Tke=(e,t,n)=>BG(`${e} !== 'top' && ${e} !== '${yl}'`,t,n),kke=(e,t,n)=>xI(`${e} === 'left' || ${e} === 'top'`,t,n),Ike=(e,t,n)=>xI(`${e} === 'top'`,t,n),BG=(e,t,n)=>(t=null!=t?Sn(t):t,n=null!=n?Sn(n):n,zG(t)&&zG(n)?{signal:`${e} ? (${t=t?t.signal||H(t.value):null}) : (${n=n?n.signal||H(n.value):null})`}:[Ee({test:e},t)].concat(n||[])),zG=e=>null==e||1===Object.keys(e).length,xI=(e,t,n)=>({signal:`${e} ? (${Ih(t)}) : (${Ih(n)})`}),Rke=(e,t,n,r,i)=>({signal:(null!=r?`${e} === 'left' ? (${Ih(r)}) : `:"")+(null!=n?`${e} === '${yl}' ? (${Ih(n)}) : `:"")+(null!=i?`${e} === 'right' ? (${Ih(i)}) : `:"")+(null!=t?`${e} === 'top' ? (${Ih(t)}) : `:"")+"(null)"}),Ih=e=>vn(e)?e.signal:null==e?null:H(e),Fh=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function Rh(e,t,n,r){let i;if(t&&ne(t,e))return t[e];if(ne(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=e[5].toLowerCase()+e.slice(6)}return r[dI][i]}if(e.startsWith("label")){switch(e){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=e[5].toLowerCase()+e.slice(6)}return r[g0][i]}return null}function UG(e){const t={};for(const n of e)if(n)for(const r in n)t[r]=1;return Object.keys(t)}function HG(e,t){return{scale:e.scale,range:t}}function EI(e,t,n,r,i){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+r+","+i+")"}}function zke(e,t,n,r,i,o){const s=ni(e,t),a=e.orient,u=e.scale,l=fw(a,-1,1),c=Hc(s("labelFlush")),f=Hc(s("labelFlushOffset")),d=s("labelAlign"),h=s("labelBaseline");let g,p=0===c||!!c;const m=Sn(i);m.mult=l,m.offset=Sn(s("labelPadding")||0),m.offset.mult=l;const v={scale:u,field:oo,band:.5,offset:DG(o.offset,s("labelOffset"))},y=An(a,p?EI(u,c,'"left"','"right"','"center"'):{value:"center"},((e,t,n)=>vn(e)?((e,t,n)=>xI(`${e} === 'right'`,t,n))(e.signal,t,n):"right"===e?{value:t}:{value:n})(a,"left","right")),b=An(a,$G(a,"bottom","top"),p?EI(u,c,'"top"','"bottom"','"middle"'):{value:"middle"}),_=EI(u,c,`-(${f})`,f,0);p=p&&f;const w={opacity:qe,x:An(a,v,m),y:Wo(a,v,m)},E={enter:w,update:g={opacity:so,text:{field:fI},x:w.x,y:w.y,align:y,baseline:b},exit:{opacity:qe,x:w.x,y:w.y}};Hn(E,{dx:!d&&p?An(a,_):null,dy:!h&&p?Wo(a,_):null}),Hn(E,{angle:s("labelAngle"),fill:s("labelColor"),fillOpacity:s("labelOpacity"),font:s("labelFont"),fontSize:s("labelFontSize"),fontWeight:s("labelFontWeight"),fontStyle:s("labelFontStyle"),limit:s("labelLimit"),lineHeight:s("labelLineHeight")},{align:d,baseline:h});const x=s("labelBound");let D=s("labelOverlap");return D=D||x?{separation:s("labelSeparation"),method:D,order:"datum.index",bound:x?{scale:u,orient:a,tolerance:x}:null}:void 0,g.align!==y&&(g.align=Fh(g.align,y)),g.baseline!==b&&(g.baseline=Fh(g.baseline,b)),Ti({type:qc,role:"axis-label",style:g0,key:oo,from:r,encode:E,overlap:D},n)}function Vke(e,t){const n=function(e,t){var a,u,l,n=t.config,r=n.style,i=n.axis,o="band"===t.scaleType(e.scale)&&n.axisBand,s=e.orient;if(vn(s)){const f=UG([n.axisX,n.axisY]),d=UG([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);for(l of(a={},f))a[l]=An(s,Rh(l,n.axisX,i,r),Rh(l,n.axisY,i,r));for(l of(u={},d))u[l]=Rke(s.signal,Rh(l,n.axisTop,i,r),Rh(l,n.axisBottom,i,r),Rh(l,n.axisLeft,i,r),Rh(l,n.axisRight,i,r))}else a=s===qo||s===yl?n.axisX:n.axisY,u=n["axis"+s[0].toUpperCase()+s.slice(1)];return a||u||o?Ee({},i,a,u,o):i}(e,t),r=e.encode||{},i=r.axis||{},o=i.name||void 0,s=i.interactive,a=i.style,u=ni(e,n),l=function(e){const t=e("tickBand");let r,i,n=e("tickOffset");return t?t.signal?(r={signal:`(${t.signal}) === 'extent' ? 1 : 0.5`},i={signal:`(${t.signal}) === 'extent'`},J(n)||(n={signal:`(${t.signal}) === 'extent' ? 0 : ${n}`})):"extent"===t?(r=1,i=!0,n=0):(r=.5,i=!1):(r=e("bandPosition"),i=e("tickExtra")),{extra:i,band:r,offset:n}}(u),c={scale:e.scale,ticks:!!u("ticks"),labels:!!u("labels"),grid:!!u("grid"),domain:!!u("domain"),title:null!=e.title},f=se(t.add(Vo({},[c]))),d=se(t.add(KMe({scale:t.scaleRef(e.scale),extra:t.property(l.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),h=[];let p;return c.grid&&h.push(function(e,t,n,r,i){const o=ni(e,t),s=e.orient,a=e.gridScale,u=fw(s,1,-1),l=function(e,t){if(1!==t)if(J(e)){let n=e=Ee({},e);for(;null!=n.mult;){if(!J(n.mult))return n.mult=vn(t)?{signal:`(${n.mult}) * (${t.signal})`}:n.mult*t,e;n=n.mult=Ee({},n.mult)}n.mult=t}else e=vn(t)?{signal:`(${t.signal}) * (${e||0})`}:t*(e||0);return e}(e.offset,u);let c,f,d;const h={enter:c={opacity:qe},update:d={opacity:so},exit:f={opacity:qe}};Hn(h,{stroke:o("gridColor"),strokeCap:o("gridCap"),strokeDash:o("gridDash"),strokeDashOffset:o("gridDashOffset"),strokeOpacity:o("gridOpacity"),strokeWidth:o("gridWidth")});const p={scale:e.scale,field:oo,band:i.band,extra:i.extra,offset:i.offset,round:o("tickRound")},g=An(s,{signal:"height"},{signal:"width"}),m=a?{scale:a,range:0,mult:u,offset:l}:{value:0,offset:l},v=a?{scale:a,range:1,mult:u,offset:l}:Ee(g,{mult:u,offset:l});return c.x=d.x=An(s,p,m),c.y=d.y=Wo(s,p,m),c.x2=d.x2=Wo(s,v),c.y2=d.y2=An(s,v),f.x=An(s,p),f.y=Wo(s,p),Ti({type:mI,role:"axis-grid",key:oo,from:r,encode:h},n)}(e,n,r.grid,d,l)),c.ticks&&(p=u("tickSize"),h.push(function(e,t,n,r,i,o){const s=ni(e,t),a=e.orient,u=fw(a,-1,1);let l,c,f;const d={enter:l={opacity:qe},update:f={opacity:so},exit:c={opacity:qe}};Hn(d,{stroke:s("tickColor"),strokeCap:s("tickCap"),strokeDash:s("tickDash"),strokeDashOffset:s("tickDashOffset"),strokeOpacity:s("tickOpacity"),strokeWidth:s("tickWidth")});const h=Sn(i);h.mult=u;const p={scale:e.scale,field:oo,band:o.band,extra:o.extra,offset:o.offset,round:s("tickRound")};return f.y=l.y=An(a,qe,p),f.y2=l.y2=An(a,h),c.x=An(a,p),f.x=l.x=Wo(a,qe,p),f.x2=l.x2=Wo(a,h),c.y=Wo(a,p),Ti({type:mI,role:"axis-tick",key:oo,from:r,encode:d},n)}(e,n,r.ticks,d,p,l))),c.labels&&(p=c.ticks?p:0,h.push(zke(e,n,r.labels,d,p,l))),c.domain&&h.push(function(e,t,n,r){const i=ni(e,t),o=e.orient;let s,a;const u={enter:s={opacity:qe},update:a={opacity:so},exit:{opacity:qe}};Hn(u,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});const l=HG(e,0),c=HG(e,1);return s.x=a.x=An(o,l,qe),s.x2=a.x2=An(o,c),s.y=a.y=Wo(o,l,qe),s.y2=a.y2=Wo(o,c),Ti({type:mI,role:"axis-domain",from:r,encode:u},n)}(e,n,r.domain,f)),c.title&&h.push(function(e,t,n,r){const i=ni(e,t),o=e.orient,s=fw(o,-1,1);let a,u;const l={enter:a={opacity:qe,anchor:Sn(i("titleAnchor",null)),align:{signal:yI}},update:u=Ee({},a,{opacity:so,text:Sn(e.title)}),exit:{opacity:qe}},c={signal:`lerp(range("${e.scale}"), ${aw(0,1,.5)})`};return u.x=An(o,c),u.y=Wo(o,c),a.angle=An(o,qe,((e,t)=>vn(e)?{signal:`(${e.signal}) * 90`}:{value:90*e})(s)),a.baseline=An(o,$G(o,yl,qo),{value:yl}),u.angle=a.angle,u.baseline=a.baseline,Hn(l,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),function(e,t,n,r){const i=(a,u)=>null!=a?(n.update[u]=Fh(Sn(a),n.update[u]),!1):!Oh(u,r),o=i(e("titleX"),"x"),s=i(e("titleY"),"y");n.enter.auto=s===o?Sn(s):An(t,Sn(s),Sn(o))}(i,o,l,n),l.update.align=Fh(l.update.align,a.align),l.update.angle=Fh(l.update.angle,a.angle),l.update.baseline=Fh(l.update.baseline,a.baseline),Ti({type:qc,role:"axis-title",style:dI,from:r,encode:l},n)}(e,n,r.title,f)),cw(y0({role:"axis",from:f,encode:Ah(qke(u,e),i,m0),marks:h,aria:u("aria"),description:u("description"),zindex:u("zindex"),name:o,interactive:s,style:a}),t)}function qke(e,t){const n={enter:{},update:{}};return Hn(n,{orient:e("orient"),offset:e("offset")||0,position:Ho(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function VG(e,t,n){const r=X(e.signals),i=X(e.scales);return n||r.forEach(o=>sG(o,t)),X(e.projections).forEach(o=>function(e,t){const n=t.config.projection||{},r={};for(const i in e)"name"!==i&&(r[i]=lI(e[i],i,t));for(const i in n)null==r[i]&&(r[i]=lI(n[i],i,t));t.addProjection(e.name,r)}(o,t)),i.forEach(o=>function(e,t){const n=e.type||"linear";QU(n)||F("Unrecognized scale type: "+H(n)),t.addScale(e.name,{type:n,domain:void 0})}(o,t)),X(e.data).forEach(o=>function(e,t){const n=[];e.transform&&e.transform.forEach(r=>{n.push(_I(r,t))}),e.on&&e.on.forEach(r=>{NG(r,t,e.name)}),t.addDataPipeline(e.name,function(e,t,n){const r=[];let a,u,l,c,f,i=null,o=!1,s=!1;for(e.values?vn(e.values)||nw(e.format)?(r.push(LG(t,e)),r.push(i=Gc())):r.push(i=Gc({$ingest:e.values,$format:e.format})):e.url?nw(e.url)||nw(e.format)?(r.push(LG(t,e)),r.push(i=Gc())):r.push(i=Gc({$request:e.url,$format:e.format})):e.source&&(i=a=X(e.source).map(d=>se(t.getData(d).output)),r.push(null)),u=0,l=n.length;u<l;++u)c=n[u],f=c.metadata,!i&&!f.source&&r.push(i=Gc()),r.push(c),f.generates&&(s=!0),f.modifies&&!s&&(o=!0),f.source?i=c:f.changes&&(i=null);return a&&(l=a.length-1,r[0]=dTe({derive:o,pulse:l?a:a[0]}),(o||l)&&r.splice(1,0,Gc())),i||r.push(Gc()),r.push(Vc({})),r}(e,t,n))}(o,t)),i.forEach(o=>vTe(o,t)),(n||r).forEach(o=>function(e,t){const n=t.getSignal(e.name);let r=e.update;e.init&&(r?F("Signals can not include both init and update expressions."):(r=e.init,n.initonly=!0)),r&&(r=Vs(r,t),n.update=r.$expr,n.params=r.$params),e.on&&e.on.forEach(i=>function(e,t,n){const r=e.encode,i={target:n};let o=e.events,s=e.update,a=[];o||F("Signal update missing events specification."),Y(o)&&(o=ml(o,t.isSubscope()?sI:aI)),o=X(o).filter(u=>u.signal||u.scale?(a.push(u),0):1),a.length>1&&(a=[XMe(a)]),o.length&&a.push(o.length>1?{merge:o}:o[0]),null!=r&&(s&&F("Signal encode and update are mutually exclusive."),s="encode(item(),"+H(r)+")"),i.update=Y(s)?Vs(s,t):null!=s.expr?Vs(s.expr,t):null!=s.value?s.value:null!=s.signal?{$expr:WMe,$params:{$value:t.signalRef(s.signal)}}:F("Invalid signal update specification."),e.force&&(i.options={force:!0}),a.forEach(u=>t.addUpdate(Ee(function(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):p0(e,t)}}(u,t),i)))}(i,t,n.id))}(o,t)),X(e.axes).forEach(o=>Vke(o,t)),X(e.marks).forEach(o=>cw(o,t)),X(e.legends).forEach(o=>function(e,t){const n=t.config.legend,r=e.encode||{},i=ni(e,n),o=r.legend||{},s=o.name||void 0,a=o.interactive,u=o.style,l={};let f,d,h,c=0;gI.forEach(b=>e[b]?(l[b]=e[b],c=c||e[b]):0),c||F("Missing valid scale for legend.");const p=function(e,t){let n=e.type||"symbol";return!e.type&&1===function(e){return gI.reduce((t,n)=>t+(e[n]?1:0),0)}(e)&&(e.fill||e.stroke)&&(n=x2(t)?ow:E2(t)?hI:"symbol"),n!==ow?n:E2(t)?hI:ow}(e,t.scaleType(c)),g={title:null!=e.title,scales:l,type:p,vgrad:"symbol"!==p&&i.isVertical()},m=se(t.add(Vo(null,[g]))),y=se(t.add(rTe(d={type:p,scale:t.scaleRef(c),count:t.objectProperty(i("tickCount")),limit:t.property(i("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return p===ow?(h=[zTe(e,c,n,r.gradient),CG(e,n,r.labels,y)],d.count=d.count||t.signalRef(`max(2,2*floor((${Hc(i.gradientLength())})/100))`)):p===hI?h=[UTe(e,c,n,r.gradient,y),CG(e,n,r.labels,y)]:(f=function(e,t){const n=ni(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}(e,n),h=[qTe(e,n,r,y,Hc(f.columns))],d.size=function(e,t,n){const r=Hc(PG("size",e,n)),i=Hc(PG("strokeWidth",e,n)),o=Hc(function(e,t,n){return EG("fontSize",e)||function(e,t,n){const r=t.config.style["guide-label"];return r&&r.fontSize}(0,t)}(n[1].encode,t));return Vs(`max(ceil(sqrt(${r})+${i}),${o})`,t)}(e,t,h[0].marks)),h=[y0({role:"legend-entry",from:m,encode:{enter:{x:{value:0},y:{value:0}}},marks:h,layout:f,interactive:a})],g.title&&h.push(function(e,t,n,r){const i=ni(e,t),o={enter:{opacity:qe},update:{opacity:so,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:qe}};return Hn(o,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:KTe},angle:{signal:ZTe},align:{signal:QTe},baseline:{signal:JTe},text:e.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")}),Ti({type:qc,role:"legend-title",style:dI,from:r,encode:o},n)}(e,n,r.title,m)),cw(y0({role:"legend",from:m,encode:Ah(yke(i,e,n),o,m0),marks:h,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:s,interactive:a,style:u}),t)}(o,t)),e.title&&function(e,t){const n=ni(e=Y(e)?{text:e}:e,t.config.title),r=e.encode||{},i=r.group||{},o=i.name||void 0,s=i.interactive,a=i.style,u=[],c=se(t.add(Vo(null,[{}])));u.push(function(e,t,n,r){const i={value:0},s={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return Hn(s,{text:e.text,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Ti({type:qc,role:"title-text",style:"group-title",from:r,encode:s},n)}(e,n,function(e){const t=e.encode;return t&&t.title||Ee({name:e.name,interactive:e.interactive,style:e.style},t)}(e),c)),e.subtitle&&u.push(function(e,t,n,r){const i={value:0},s={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return Hn(s,{text:e.subtitle,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Ti({type:qc,role:"title-subtitle",style:"group-subtitle",from:r,encode:s},n)}(e,n,r.subtitle,c)),cw(y0({role:"title",from:c,encode:Eke(n,i),marks:u,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:o,interactive:s,style:a}),t)}(e.title,t),t.parseLambdas(),t}function b0(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function qG(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function WG(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}function DI(e){return(R(e)?Xke:Qke)(e)}function Xke(e){const t=e.length;let n="[";for(let r=0;r<t;++r){const i=e[r];n+=(r>0?",":"")+(J(i)?i.signal||DI(i):H(i))}return n+"]"}function Qke(e){let r,i,t="{",n=0;for(r in e)i=e[r],t+=(++n>1?",":"")+H(r)+":"+(J(i)?i.signal||DI(i):H(i));return t+"}"}function Zke(e,t,n){return J(e)||F("Input Vega specification must be an object."),function(e,t){const n=t.config,r=se(t.root=t.add(ew())),i=function(e,t){const n=s=>Ho(e[s],t[s]),r=[b0("background",n("background")),b0("autosize",uMe(n("autosize"))),b0("padding",cMe(n("padding"))),b0("width",n("width")||0),b0("height",n("height")||0)],i=r.reduce((s,a)=>(s[a.name]=a,s),{}),o={};return X(e.signals).forEach(s=>{ne(i,s.name)?s=Ee(i[s.name],s):r.push(s),o[s.name]=s}),X(t.signals).forEach(s=>{!ne(o,s.name)&&!ne(i,s.name)&&r.push(s)}),r}(e,n);i.forEach(l=>sG(l,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const o=t.add(Vo()),s=t.add(dG(iG((e=>Ah({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e))(e.encode),sw,tI,e.style,t,{pulse:se(o)}))),a=t.add(gG({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:r,pulse:se(s)}));t.operators.pop(),t.pushState(se(s),se(a),null),VG(e,t,i),t.operators.push(a);let u=t.add(cG({mark:r,pulse:se(a)}));return u=t.add(pG({pulse:se(u)})),u=t.add(Vc({pulse:se(u)})),t.addData("root",new Wc(t,o,o,u)),t}(e,new qG(t=Md(function(){const e="sans-serif",r="#4c78a8",i="#000",o="#888",s="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:r},area:{fill:r},image:null,line:{stroke:r,strokeWidth:2},path:{stroke:r},rect:{fill:r},rule:{stroke:i},shape:{stroke:r},symbol:{fill:r,size:64},text:{fill:i,font:e,fontSize:11},trail:{fill:r,size:2},style:{"guide-label":{fill:i,font:e,fontSize:10},"guide-title":{fill:i,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:i,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:i,font:e,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:s}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:o,grid:!1,gridWidth:1,gridColor:s,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:o,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:s,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:o,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}(),t,e.config),n)).toRuntime()}qG.prototype=WG.prototype={parse(e){return VG(e,this)},fork(){return new WG(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id}),e.refs=null),e},proxy(e){const t=e instanceof iI?se(e):e;return this.add(fTe({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;for(e in this.root&&(this.root.root=!0),this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(r,i,o){let s,a;r&&(s=r.data||(r.data={}),a=s[i]||(s[i]=[]),a.push(o))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const r in t.index)n(t.index[r],e,"index:"+r)}return this},pushState(e,t,n){this._encode.push(se(this.add(Vc({pulse:e})))),this._parent.push(t),this._lookup.push(n?se(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return je(this._parent)},encode(){return je(this._encode)},lookup(){return je(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(Y(e))return h0(e,t);e.signal||F("Unsupported field reference: "+H(e));const n=e.signal;let r=this.field[n];if(!r){const i={name:this.signalRef(n)};t&&(i.as=t),this.field[n]=r=se(this.add(tTe(i)))}return r},compareRef(e){let t=!1;const n=o=>vn(o)?(t=!0,this.signalRef(o.signal)):function(e){return e&&e.expr}(o)?(t=!0,this.exprRef(o.expr)):o,r=X(e.field).map(n),i=X(e.order).map(n);return t?se(this.add(fG({fields:r,orders:i}))):aG(r,i)},keyRef(e,t){let n=!1;const i=this.signals;return e=X(e).map(o=>vn(o)?(n=!0,se(i[o.signal])):o),n?se(this.add(nTe({fields:e,flat:t}))):function(e,t){const n={$key:e};return t&&(n.$flat=!0),n}(e,t)},sortRef(e){if(!e)return e;const t=tw(e.op,e.field),n=e.order||"ascending";return n.signal?se(this.add(fG({fields:t,orders:this.signalRef(n.signal)}))):aG(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const r=this.id();this.streams.push({id:r,source:e,type:t}),this.events[n]=r}return this.events[n]},hasOwnSignal(e){return ne(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&F("Duplicate signal name: "+H(e));const n=t instanceof iI?t:this.add(ew(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||F("Unrecognized signal name: "+H(e)),this.signals[e]},signalRef(e){return this.signals[e]?se(this.signals[e]):(ne(this.lambdas,e)||(this.lambdas[e]=this.add(ew(null))),se(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const r=e[t],i=Vs(r,this),o=this.lambdas[r];o.params=i.$params,o.update=i.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return e&&J(e)?this.signalRef(e.signal||DI(e)):e},exprRef(e,t){const n={expr:Vs(e,this)};return t&&(n.expr.$name=t),se(this.add(JMe(n)))},addBinding(e,t){this.bindings||F("Nested signals do not support binding: "+H(e)),this.bindings.push(Ee({signal:e},t))},addScaleProj(e,t){ne(this.scales,e)&&F("Duplicate scale or projection name: "+H(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,hTe(t))},addProjection(e,t){this.addScaleProj(e,cTe(t))},getScale(e){return this.scales[e]||F("Unrecognized scale name: "+H(e)),this.scales[e]},scaleRef(e){return se(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return ne(this.data,e)&&F("Duplicate data set name: "+H(e)),this.data[e]=t},getData(e){return this.data[e]||F("Undefined data set name: "+H(e)),this.data[e]},addDataPipeline(e,t){return ne(this.data,e)&&F("Duplicate data set name: "+H(e)),this.addData(e,Wc.fromEntries(this,t))}};Ee(Wd,lt,Oe,qt,Ke,ci,Ye,fi,Re,In,Li,go);const mIe="5.21.0";var vIe={NaN:NaN,E:Math.E,LN2:Math.LN2,LN10:Math.LN10,LOG2E:Math.LOG2E,LOG10E:Math.LOG10E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2,MIN_VALUE:Number.MIN_VALUE,MAX_VALUE:Number.MAX_VALUE},bIe={"*":(e,t)=>e*t,"+":(e,t)=>e+t,"-":(e,t)=>e-t,"/":(e,t)=>e/t,"%":(e,t)=>e%t,">":(e,t)=>e>t,"<":(e,t)=>e<t,"<=":(e,t)=>e<=t,">=":(e,t)=>e>=t,"==":(e,t)=>e==t,"!=":(e,t)=>e!=t,"===":(e,t)=>e===t,"!==":(e,t)=>e!==t,"&":(e,t)=>e&t,"|":(e,t)=>e|t,"^":(e,t)=>e^t,"<<":(e,t)=>e<<t,">>":(e,t)=>e>>t,">>>":(e,t)=>e>>>t},_Ie={"+":e=>+e,"-":e=>-e,"~":e=>~e,"!":e=>!e};const wIe=Array.prototype.slice,Yc=(e,t,n)=>{const r=n?n(t[0]):t[0];return r[e].apply(r,wIe.call(t,1))};var EIe={isNaN:Number.isNaN,isFinite:Number.isFinite,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:Math.atan2,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,pow:Math.pow,random:Math.random,round:Math.round,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,clamp:(e,t,n)=>Math.max(t,Math.min(n,e)),now:Date.now,utc:Date.UTC,datetime:(e,t,n,r,i,o,s)=>new Date(e,t||0,null!=n?n:1,r||0,i||0,o||0,s||0),date:e=>new Date(e).getDate(),day:e=>new Date(e).getDay(),year:e=>new Date(e).getFullYear(),month:e=>new Date(e).getMonth(),hours:e=>new Date(e).getHours(),minutes:e=>new Date(e).getMinutes(),seconds:e=>new Date(e).getSeconds(),milliseconds:e=>new Date(e).getMilliseconds(),time:e=>new Date(e).getTime(),timezoneoffset:e=>new Date(e).getTimezoneOffset(),utcdate:e=>new Date(e).getUTCDate(),utcday:e=>new Date(e).getUTCDay(),utcyear:e=>new Date(e).getUTCFullYear(),utcmonth:e=>new Date(e).getUTCMonth(),utchours:e=>new Date(e).getUTCHours(),utcminutes:e=>new Date(e).getUTCMinutes(),utcseconds:e=>new Date(e).getUTCSeconds(),utcmilliseconds:e=>new Date(e).getUTCMilliseconds(),length:e=>e.length,join:function(){return Yc("join",arguments)},indexof:function(){return Yc("indexOf",arguments)},lastindexof:function(){return Yc("lastIndexOf",arguments)},slice:function(){return Yc("slice",arguments)},reverse:e=>e.slice().reverse(),parseFloat,parseInt,upper:e=>String(e).toUpperCase(),lower:e=>String(e).toLowerCase(),substring:function(){return Yc("substring",arguments,String)},split:function(){return Yc("split",arguments,String)},replace:function(){return Yc("replace",arguments,String)},trim:e=>String(e).trim(),regexp:RegExp,test:(e,t)=>RegExp(e).test(t)};const DIe=["view","item","group","xy","x","y"],CIe={Literal:(e,t)=>t.value,Identifier:(e,t)=>{const n=t.name;return e.memberDepth>0?n:"datum"===n?e.datum:"event"===n?e.event:"item"===n?e.item:vIe[n]||e.params["$"+n]},MemberExpression:(e,t)=>{const n=!t.computed,r=e(t.object);n&&(e.memberDepth+=1);const i=e(t.property);return n&&(e.memberDepth-=1),r[i]},CallExpression:(e,t)=>{const n=t.arguments;let r=t.callee.name;return r.startsWith("_")&&(r=r.slice(1)),"if"===r?e(n[0])?e(n[1]):e(n[2]):(e.fn[r]||EIe[r]).apply(e.fn,n.map(e))},ArrayExpression:(e,t)=>t.elements.map(e),BinaryExpression:(e,t)=>bIe[t.operator](e(t.left),e(t.right)),UnaryExpression:(e,t)=>_Ie[t.operator](e(t.argument)),ConditionalExpression:(e,t)=>e(t.test)?e(t.consequent):e(t.alternate),LogicalExpression:(e,t)=>"&&"===t.operator?e(t.left)&&e(t.right):e(t.left)||e(t.right),ObjectExpression:(e,t)=>t.properties.reduce((n,r)=>{e.memberDepth+=1;const i=e(r.key);return e.memberDepth-=1,n[i]=e(r.value),n},{})};function _0(e,t,n,r,i,o){const s=a=>CIe[a.type](s,a);return s.memberDepth=0,s.fn=Object.create(t),s.params=n,s.datum=r,s.event=i,s.item=o,DIe.forEach(a=>s.fn[a]=(...u)=>i.vega[a](...u)),s(e)}var SIe={operator(e,t){const n=t.ast,r=e.functions;return i=>_0(n,r,i)},parameter(e,t){const n=t.ast,r=e.functions;return(i,o)=>_0(n,r,o,i)},event(e,t){const n=t.ast,r=e.functions;return i=>_0(n,r,void 0,void 0,i)},handler(e,t){const n=t.ast,r=e.functions;return(i,o)=>_0(n,r,i,o.item&&o.item.datum,o)},encode(e,t){const{marktype:n,channels:r}=t,i=e.functions,o="group"===n||"image"===n||"rect"===n;return(s,a)=>{const u=s.datum;let c,l=0;for(const f in r)c=_0(r[f].ast,i,a,u,void 0,s),s[f]!==c&&(s[f]=c,l=1);return"rule"!==n&&function(e,t,n){let r;t.x2&&(t.x?(n&&e.x>e.x2&&(r=e.x,e.x=e.x2,e.x2=r),e.width=e.x2-e.x):e.x=e.x2-(e.width||0)),t.xc&&(e.x=e.xc-(e.width||0)/2),t.y2&&(t.y?(n&&e.y>e.y2&&(r=e.y,e.y=e.y2,e.y2=r),e.height=e.y2-e.y):e.y=e.y2-(e.height||0)),t.yc&&(e.y=e.yc-(e.height||0)/2)}(s,r,o),l}}};Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,function(n,r){return Array.isArray(r)?n.push.apply(n,e.call(r,t-1)):n.push(r),n},[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var OIe=G(478),MIe=G.n(OIe),TIe=G(559),kIe=G.n(TIe),IIe=G(245),CI=G.n(IIe);function SI(e){return!!e.or}function AI(e){return!!e.and}function OI(e){return!!e.not}function dw(e,t){if(OI(e))dw(e.not,t);else if(AI(e))for(const n of e.and)dw(n,t);else if(SI(e))for(const n of e.or)dw(n,t);else t(e)}function Nh(e,t){return OI(e)?{not:Nh(e.not,t)}:AI(e)?{and:e.and.map(n=>Nh(n,t))}:SI(e)?{or:e.or.map(n=>Nh(n,t))}:t(e)}const qs=kIe(),we=MIe();function GG(e){throw new Error(e)}function Ph(e,t){const n={};for(const r of t)ne(e,r)&&(n[r]=e[r]);return n}function ki(e,t){const n=Object.assign({},e);for(const r of t)delete n[r];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>CI()(e)).join(",")})`};const Et=CI();function $e(e){if(ft(e))return e;const t=Y(e)?e:CI()(e);if(t.length<250)return t;let n=0;for(let r=0;r<t.length;r++)n=(n<<5)-n+t.charCodeAt(r),n&=n;return n}function MI(e){return!1===e||null===e}function Be(e,t){return e.includes(t)}function Xc(e,t){let n=0;for(const[r,i]of e.entries())if(t(i,r,n++))return!0;return!1}function TI(e,t){let n=0;for(const[r,i]of e.entries())if(!t(i,r,n++))return!1;return!0}function YG(e,...t){for(const n of t)FIe(e,null!=n?n:{});return e}function FIe(e,t){for(const n of P(t))Td(e,n,t[n],!0)}function Ws(e,t){const n=[],r={};let i;for(const o of e)i=t(o),!(i in r)&&(r[i]=1,n.push(o));return n}function RIe(e,t){const n=P(e),r=P(t);if(n.length!==r.length)return!1;for(const i of n)if(e[i]!==t[i])return!1;return!0}function XG(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function kI(e,t){for(const n of e)if(t.has(n))return!0;return!1}function II(e){const t=new Set;for(const n of e){const i=Ds(n).map((s,a)=>0===a?s:`[${s}]`),o=i.map((s,a)=>i.slice(0,a+1).join(""));for(const s of o)t.add(s)}return t}function FI(e,t){return void 0===e||void 0===t||kI(II(e),II(t))}function ht(e){return 0===P(e).length}const P=Object.keys,fr=Object.values,vl=Object.entries;function w0(e){return!0===e||!1===e}function kt(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function x0(e,t){return OI(e)?`!(${x0(e.not,t)})`:AI(e)?`(${e.and.map(n=>x0(n,t)).join(") && (")})`:SI(e)?`(${e.or.map(n=>x0(n,t)).join(") || (")})`:t(e)}function hw(e,t){if(0===t.length)return!0;const n=t.shift();return n in e&&hw(e[n],t)&&delete e[n],ht(e)}function E0(e){return e.charAt(0).toUpperCase()+e.substr(1)}function RI(e,t="datum"){const n=Ds(e),r=[];for(let i=1;i<=n.length;i++){const o=`[${n.slice(0,i).map(H).join("][")}]`;r.push(`${t}${o}`)}return r.join(" && ")}function QG(e,t="datum"){return`${t}[${H(Ds(e).join("."))}]`}function NIe(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function ao(e){return`${Ds(e).map(NIe).join("\\.")}`}function Qc(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function NI(e){return`${Ds(e).join(".")}`}function Lh(e){return e?Ds(e).length:0}function sn(...e){for(const t of e)if(void 0!==t)return t}let KG=42;function ZG(e){const t=++KG;return e?String(e)+t:t}function PIe(){KG=42}function JG(e){return eY(e)?e:`__${e}`}function eY(e){return e.startsWith("__")}function D0(e){if(void 0!==e)return(e%360+360)%360}function pw(e){return!!ft(e)||!isNaN(e)&&!isNaN(parseFloat(e))}var C0=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const Qa="row",Ka="column",gw="facet",Rt="x",On="y",Go="x2",Gs="y2",bl="xOffset",jh="yOffset",Ys="radius",Za="radius2",Yo="theta",Ja="theta2",Xs="latitude",Qs="longitude",Xo="latitude2",uo="longitude2",ri="color",Ks="fill",Zs="stroke",ii="shape",eu="size",Kc="angle",tu="opacity",_l="fillOpacity",wl="strokeOpacity",xl="strokeWidth",El="strokeDash",S0="text",A0="order",O0="detail",mw="key",Zc="tooltip",yw="href",vw="url",bw="description",tY={theta:1,theta2:1,radius:1,radius2:1};function nY(e){return e in tY}const PI={longitude:1,longitude2:1,latitude:1,latitude2:1},BIe=P(PI),_w=Object.assign(Object.assign(Object.assign(Object.assign({},{x:1,y:1,x2:1,y2:1}),tY),PI),{xOffset:1,yOffset:1,color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function $h(e){return e===ri||e===Ks||e===Zs}const rY={row:1,column:1,facet:1},lo=P(rY),ww=Object.assign(Object.assign({},_w),rY),zIe=P(ww),LI=C0(ww,["order","detail","tooltip"]),iY=C0(LI,["row","column","facet"]);function UIe(e){return!!iY[e]}function oY(e){return!!ww[e]}P(LI),P(iY);const HIe=[Go,Gs,Xo,uo,Ja,Za];function sY(e){return Jc(e)!==e}function Jc(e){switch(e){case Go:return Rt;case Gs:return On;case Xo:return Xs;case uo:return Qs;case Ja:return Yo;case Za:return Ys}return e}function Dl(e){if(nY(e))switch(e){case Yo:return"startAngle";case Ja:return"endAngle";case Ys:return"outerRadius";case Za:return"innerRadius"}return e}function nu(e){switch(e){case Rt:return Go;case On:return Gs;case Xs:return Xo;case Qs:return uo;case Yo:return Ja;case Ys:return Za}}function oi(e){switch(e){case Rt:case Go:return"width";case On:case Gs:return"height"}}function aY(e){switch(e){case Rt:return"xOffset";case On:return"yOffset"}}function uY(e){switch(e){case"xOffset":return"x";case"yOffset":return"y"}}const qIe=P(_w),xw=C0(_w,["x","y","x2","y2","xOffset","yOffset","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),WIe=P(xw),jI={x:1,y:1},Js=P(jI);function Vn(e){return e in jI}const $I={theta:1,radius:1},GIe=P($I);function Ew(e){return"width"===e?Rt:On}const BI={xOffset:1,yOffset:1};function Bh(e){return e in BI}P(BI);const lY=C0(xw,["text","tooltip","href","url","description","detail","key","order"]),YIe=P(lY),cY=Object.assign(Object.assign(Object.assign(Object.assign({},jI),$I),BI),lY),Dw=P(cY);function Cl(e){return!!cY[e]}const zI={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},ZIe=C0(zI,["geoshape"]);function UI(e){switch(e){case Rt:case On:case Yo:case Ys:case bl:case jh:case eu:case Kc:case xl:case tu:case _l:case wl:case Go:case Gs:case Ja:case Za:return;case gw:case Qa:case Ka:case ii:case El:case S0:case Zc:case yw:case vw:case bw:return"discrete";case ri:case Ks:case Zs:return"flexible";case Xs:case Qs:case Xo:case uo:case O0:case mw:case A0:return}}const eFe={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},tFe={count:1,min:1,max:1};function ru(e){return!!e&&!!e.argmin}function Sl(e){return!!e&&!!e.argmax}function HI(e){return Y(e)&&!!eFe[e]}const nFe=new Set(["count","valid","missing","distinct"]);function fY(e){return Y(e)&&nFe.has(e)}const iFe=new Set(["count","sum","distinct","valid","missing"]),oFe=new Set(["mean","average","median","q1","q3","min","max"]);function dY(e){return ku(e)&&(e=Ww(e,void 0)),"bin"+P(e).map(t=>Cw(e[t])?kt(`_${t}_${vl(e[t])}`):kt(`_${t}_${e[t]}`)).join("")}function Dt(e){return!0===e||ef(e)&&!e.binned}function Nr(e){return"binned"===e||ef(e)&&!0===e.binned}function ef(e){return J(e)}function Cw(e){return null==e?void 0:e.param}function hY(e){switch(e){case Qa:case Ka:case eu:case ri:case Ks:case Zs:case xl:case tu:case _l:case wl:case ii:return 6;case El:return 4;default:return 10}}function M0(e){return e&&!!e.expr}function si(e){const t=P(e||{}),n={};for(const r of t)n[r]=Ii(e[r]);return n}function pY(e){const{anchor:t,frame:n,offset:r,orient:i,angle:o,limit:s,color:a,subtitleColor:u,subtitleFont:l,subtitleFontSize:c,subtitleFontStyle:f,subtitleFontWeight:d,subtitleLineHeight:h,subtitlePadding:p}=e,g=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["anchor","frame","offset","orient","angle","limit","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),m=Object.assign(Object.assign({},g),a?{fill:a}:{}),v=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},t?{anchor:t}:{}),n?{frame:n}:{}),r?{offset:r}:{}),i?{orient:i}:{}),void 0!==o?{angle:o}:{}),void 0!==s?{limit:s}:{}),y=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},u?{subtitleColor:u}:{}),l?{subtitleFont:l}:{}),c?{subtitleFontSize:c}:{}),f?{subtitleFontStyle:f}:{}),d?{subtitleFontWeight:d}:{}),h?{subtitleLineHeight:h}:{}),p?{subtitlePadding:p}:{});return{titleMarkConfig:m,subtitleMarkConfig:Ph(e,["align","baseline","dx","dy","limit"]),nonMarkTitleProperties:v,subtitle:y}}function Al(e){return Y(e)||R(e)&&Y(e[0])}function ie(e){return e&&!!e.signal}function Ol(e){return!!e.step}function iu(e){return!R(e)&&"field"in e&&"data"in e}const lFe=P({aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1}),cFe={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},VI=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];var qI=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function gY(e){const t=R(e.condition)?e.condition.map(mY):mY(e.condition);return Object.assign(Object.assign({},Ii(e)),{condition:t})}function Ii(e){if(M0(e)){const{expr:t}=e,n=qI(e,["expr"]);return Object.assign({signal:t},n)}return e}function mY(e){if(M0(e)){const{expr:t}=e,n=qI(e,["expr"]);return Object.assign({signal:t},n)}return e}function Ot(e){if(M0(e)){const{expr:t}=e,n=qI(e,["expr"]);return Object.assign({signal:t},n)}return ie(e)?e:void 0!==e?{value:e}:void 0}function fFe(e){return ie(e)?e.signal:H(e)}function yY(e){return ie(e)?e.signal:H(e.value)}function ou(e){return ie(e)?e.signal:null==e?null:H(e)}function vY(e){var t;return[].concat(e.type,null!==(t=e.style)&&void 0!==t?t:[])}function st(e,t,n,r={}){const{vgChannel:i,ignoreVgConfig:o}=r;return i&&void 0!==t[i]?t[i]:void 0!==t[e]?t[e]:!o||i&&i!==e?tf(e,t,n,r):void 0}function tf(e,t,n,{vgChannel:r}={}){return sn(r?Sw(e,t,n.style):void 0,Sw(e,t,n.style),r?n[t.type][r]:void 0,n[t.type][e],r?n.mark[r]:n.mark[e])}function Sw(e,t,n){return bY(e,vY(t),n)}function bY(e,t,n){let r;t=X(t);for(const i of t){const o=n[i];o&&void 0!==o[e]&&(r=o[e])}return r}function _Y(e,t){return X(e).reduce((n,r)=>{var i;return n.field.push(q(r,t)),n.order.push(null!==(i=r.sort)&&void 0!==i?i:"ascending"),n},{field:[],order:[]})}function wY(e,t){const n=[...e];return t.forEach(r=>{for(const i of n)if(qs(i,r))return;n.push(r)}),n}function xY(e,t){return qs(e,t)||!t?e:e?[...X(e),...X(t)].join(", "):t}function EY(e,t){const n=e.value,r=t.value;if(null==n||null===r)return{explicit:e.explicit,value:null};if((Al(n)||ie(n))&&(Al(r)||ie(r)))return{explicit:e.explicit,value:xY(n,r)};if(Al(n)||ie(n))return{explicit:e.explicit,value:n};if(Al(r)||ie(r))return{explicit:e.explicit,value:r};if(!(Al(n)||ie(n)||Al(r)||ie(r)))return{explicit:e.explicit,value:wY(n,r)};throw new Error("It should never reach here")}function WI(e){return`Invalid specification ${Et(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}function DY(e){return("width"==e?"Width":"Height")+' "container" only works for single views and layered views.'}function CY(e){return`${"width"==e?"Width":"Height"} "container" only works well with autosize "fit" or "fit-${"width"==e?"x":"y"}".`}function SY(e){return e?`Dropping "fit-${e}" because spec has discrete ${oi(e)}.`:'Dropping "fit" because spec has discrete size.'}function GI(e){return`Unknown field for ${e}. Cannot calculate view size.`}function AY(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function pFe(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function OY(e){return`Selection not supported for ${e} yet.`}function MY(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}function TY(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}function AFe(e){return`Ignoring an invalid transform: ${Et(e)}.`}function kY(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function kFe(e){return`${e}Offset dropped because ${e} is continuous`}function IFe(e){return`There is no ${e} encoding. Replacing ${e}Offset encoding as ${e}.`}function IY(e){return`Invalid field type "${e}".`}function FY(e,t){const{fill:n,stroke:r}=t;return`Dropping color ${e} as the plot also has ${n&&r?"fill and stroke":n?"fill":"stroke"}.`}function YI(e,t){return`Dropping ${Et(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}function Aw(e,t,n){return`${e} dropped as it is incompatible with "${t}"${n?` when ${n}`:""}.`}function jFe(e){return`${e} encoding has no scale, so specified scale is ignored.`}function $Fe(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function BFe(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function zFe(e){return`${e} encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).`}function XI(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${"ordinal"===t?"order":"magnitude"}.`}function YFe(e){return`Using unaggregated domain with raw field has no effect (${Et(e)}).`}function XFe(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function QFe(e){return`Unaggregated domain is currently unsupported for log scale (${Et(e)}).`}function RY(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function NY(e){return`The step for "${e}" is dropped because the ${"width"===e?"x":"y"} is continuous.`}const PY="Domains that should be unioned has conflicting sort properties. Sort will be set to true.";function Ow(e,t){return`Invalid ${e}: ${Et(t)}.`}function LY(e){return`1D error band does not support ${e}.`}function jY(e){return`Channel ${e} is required for "binned" bin.`}const $Y=OS(AS);let ea=$Y;function $(...e){ea.warn(...e)}function nf(e){if(e&&J(e))for(const t of KI)if(t in e)return!0;return!1}new WeakMap;const zY=["january","february","march","april","may","june","july","august","september","october","november","december"],_Re=zY.map(e=>e.substr(0,3)),UY=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],wRe=UY.map(e=>e.substr(0,3));function QI(e,t){const n=[];if(t&&void 0!==e.day&&P(e).length>1&&($(function(e){return`Dropping day from datetime ${Et(e)} as day cannot be combined with other units.`}(e)),delete(e=we(e)).day),n.push(void 0!==e.year?e.year:2012),void 0!==e.month){const r=t?function(e){if(pw(e)&&(e=+e),ft(e))return e-1;{const t=e.toLowerCase(),n=zY.indexOf(t);if(-1!==n)return n;const r=t.substr(0,3),i=_Re.indexOf(r);if(-1!==i)return i;throw new Error(Ow("month",e))}}(e.month):e.month;n.push(r)}else if(void 0!==e.quarter){const r=t?function(e){if(pw(e)&&(e=+e),ft(e))return e>4&&$(Ow("quarter",e)),e-1;throw new Error(Ow("quarter",e))}(e.quarter):e.quarter;n.push(ft(r)?3*r:`${r}*3`)}else n.push(0);if(void 0!==e.date)n.push(e.date);else if(void 0!==e.day){const r=t?function(e){if(pw(e)&&(e=+e),ft(e))return e%7;{const t=e.toLowerCase(),n=UY.indexOf(t);if(-1!==n)return n;const r=t.substr(0,3),i=wRe.indexOf(r);if(-1!==i)return i;throw new Error(Ow("day",e))}}(e.day):e.day;n.push(ft(r)?r+1:`${r}+1`)}else n.push(1);for(const r of["hours","minutes","seconds","milliseconds"]){const i=e[r];n.push(void 0===i?0:i)}return n}function k0(e){const n=QI(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}const HY={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},KI=P(HY);function ZI(e){return e.startsWith("utc")}const TRe={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function JI(e){return KI.filter(t=>VY(e,t))}function VY(e,t){const n=e.indexOf(t);return!(n<0||n>0&&"seconds"===t&&"i"===e.charAt(n-1)||e.length>n+3&&"day"===t&&"o"===e.charAt(n+3)||n>0&&"year"===t&&"f"===e.charAt(n-1))}function qY(e){if(!e)return;const t=JI(e);return`timeUnitSpecifier(${Et(t)}, ${Et(TRe)})`}function Pr(e){if(!e)return;let t;return Y(e)?t={unit:e}:J(e)&&(t=Object.assign(Object.assign({},e),e.unit?{unit:e.unit}:{})),ZI(t.unit)&&(t.utc=!0,t.unit=function(e){return e.substr(3)}(t.unit)),t}function eF(e){return e&&!!e.field&&void 0!==e.equal}function tF(e){return e&&!!e.field&&void 0!==e.lt}function nF(e){return e&&!!e.field&&void 0!==e.lte}function rF(e){return e&&!!e.field&&void 0!==e.gt}function iF(e){return e&&!!e.field&&void 0!==e.gte}function oF(e){if(null==e?void 0:e.field){if(R(e.range)&&2===e.range.length)return!0;if(ie(e.range))return!0}return!1}function sF(e){return e&&!!e.field&&(R(e.oneOf)||R(e.in))}function WY(e){return sF(e)||eF(e)||oF(e)||tF(e)||rF(e)||nF(e)||iF(e)}function ta(e,t){return Gw(e,{timeUnit:t,wrapTime:!0})}function GY(e,t=!0){var n;const{field:r}=e,i=null===(n=Pr(e.timeUnit))||void 0===n?void 0:n.unit,o=i?`time(${function(e,t,{end:n}={end:!1}){const r=RI(t),i=ZI(e)?"utc":"";function o(u){return"quarter"===u?`(${i}quarter(${r})-1)`:`${i}${u}(${r})`}let s;const a={};for(const u of KI)VY(e,u)&&(a[u]=o(u),s=u);return n&&(a[s]+="+1"),function(e){const n=QI(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}(a)}(i,r)})`:q(e,{expr:"datum"});if(eF(e))return`${o}===${ta(e.equal,i)}`;if(tF(e))return`${o}<${ta(e.lt,i)}`;if(rF(e))return`${o}>${ta(e.gt,i)}`;if(nF(e))return`${o}<=${ta(e.lte,i)}`;if(iF(e))return`${o}>=${ta(e.gte,i)}`;if(sF(e))return`indexof([${function(e,t){return e.map(n=>ta(n,t))}(e.oneOf,i).join(",")}], ${o}) !== -1`;if(function(e){return e&&!!e.field&&void 0!==e.valid}(e))return aF(o,e.valid);if(oF(e)){const{range:s}=e,a=ie(s)?{signal:`${s.signal}[0]`}:s[0],u=ie(s)?{signal:`${s.signal}[1]`}:s[1];if(null!==a&&null!==u&&t)return"inrange("+o+", ["+ta(a,i)+", "+ta(u,i)+"])";const l=[];return null!==a&&l.push(`${o} >= ${ta(a,i)}`),null!==u&&l.push(`${o} <= ${ta(u,i)}`),l.length>0?l.join(" && "):"true"}throw new Error(`Invalid field predicate: ${Et(e)}`)}function aF(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function LRe(e){var t;return WY(e)&&e.timeUnit?Object.assign(Object.assign({},e),{timeUnit:null===(t=Pr(e.timeUnit))||void 0===t?void 0:t.unit}):e}const rf={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};function jRe(e){return"quantitative"===e||"temporal"===e}function YY(e){return"ordinal"===e||"nominal"===e}const of=rf.quantitative,uF=rf.ordinal,zh=rf.temporal,lF=rf.nominal,Uh=rf.geojson;P(rf);const Mw={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};function zRe(e,t){const n=Mw[e],r=Mw[t];return n===r||"ordinal-position"===n&&"time"===r||"ordinal-position"===r&&"time"===n}P(Mw);const URe={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function XY(e){return URe[e]}const QY=new Set(["linear","log","pow","sqrt","symlog"]),KY=new Set([...QY,"time","utc"]);function ZY(e){return QY.has(e)}const JY=new Set(["quantile","quantize","threshold"]),HRe=new Set([...KY,...JY,"sequential","identity"]),VRe=new Set(["ordinal","bin-ordinal","point","band"]);function Mn(e){return VRe.has(e)}function Fi(e){return HRe.has(e)}function Qo(e){return KY.has(e)}function Hh(e){return JY.has(e)}function eX(e){return null==e?void 0:e.param}const cF={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},XRe=(P(cF),function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(cF,["type","domain","range","rangeMax","rangeMin","scheme"])),QRe=P(XRe);function fF(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(e);case"bins":return!["point","band","identity","ordinal"].includes(e);case"round":return Qo(e)||"band"===e||"point"===e;case"padding":case"rangeMin":case"rangeMax":return Qo(e)||["point","band"].includes(e);case"paddingOuter":case"align":return["point","band"].includes(e);case"paddingInner":return"band"===e;case"domainMax":case"domainMid":case"domainMin":case"clamp":return Qo(e);case"nice":return Qo(e)||"quantize"===e||"threshold"===e;case"exponent":return"pow"===e;case"base":return"log"===e;case"constant":return"symlog"===e;case"zero":return Fi(e)&&!Be(["log","time","utc","threshold","quantile"],e)}}function tX(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return $h(e)?void 0:function(e){return`Cannot use the scale property "${e}" with non-color channel.`}(e);case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}const dr={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},nX=dr.arc,Tw=dr.area,kw=dr.bar,JRe=dr.image,Iw=dr.line,Fw=dr.point,eNe=dr.rect,Rw=dr.rule,rX=dr.text,dF=dr.tick,tNe=dr.trail,hF=dr.circle,pF=dr.square,iX=dr.geoshape;function Tl(e){return["line","area","trail"].includes(e)}function oX(e){return["rect","bar","image","arc"].includes(e)}const sX=new Set(P(dr));function Ko(e){return e.type}const iNe=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit","fill","fillOpacity"],aX=P({color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1}),uX=P({mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1});function Vh(e){return e&&null!=e.band}const aNe={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]};function gF(e){const{channel:t,channelDef:n,markDef:r,scale:i,config:o}=e,s=yF(e);return V(n)&&!fY(n.aggregate)&&i&&Qo(i.get("type"))?function({fieldDef:e,channel:t,markDef:n,ref:r,config:i}){return Tl(n.type)?r:null===st("invalid",n,i)?[hNe(e,t),r]:r}({fieldDef:n,channel:t,markDef:r,ref:s,config:o}):s}function hNe(e,t){const n=mF(e,!0),i="y"===Jc(t)?{field:{group:"height"}}:{value:0};return Object.assign({test:n},i)}function mF(e,t=!0){return aF(Y(e)?e:q(e,{expr:"datum"}),!t)}function sf(e,t,n,r){const i={};if(t&&(i.scale=t),ra(e)){const{datum:o}=e;nf(o)?i.signal=k0(o):ie(o)?i.signal=o.signal:M0(o)?i.signal=o.expr:i.value=o}else i.field=q(e,n);if(r){const{offset:o,band:s}=r;o&&(i.offset=o),s&&(i.band=s)}return i}function Nw({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:r,startSuffix:i,bandPosition:o=.5}){const s=0<o&&o<1?"datum":void 0,a=q(t,{expr:s,suffix:i}),u=void 0!==n?q(n,{expr:s}):q(t,{suffix:"end",expr:s}),l={};if(0===o||1===o)l.scale=e,l.field=0===o?a:u;else{const c=ie(o)?`${o.signal} * ${a} + (1-${o.signal}) * ${u}`:`${o} * ${a} + ${1-o} * ${u}`;l.signal=`scale("${e}", ${c})`}return r&&(l.offset=r),l}function yF({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:o,scale:s,stack:a,offset:u,defaultRef:l,bandPosition:c}){var f;if(t){if(ye(t)){const d=null==s?void 0:s.get("type");if(co(t)){null!=c||(c=wX({fieldDef:t,fieldDef2:n,markDef:r,config:i}));const{bin:h,timeUnit:p,type:g}=t;if(Dt(h)||c&&p&&g===zh)return(null==a?void 0:a.impute)?sf(t,o,{binSuffix:"mid"},{offset:u}):c&&!Mn(d)?Nw({scaleName:o,fieldOrDatumDef:t,bandPosition:c,offset:u}):sf(t,o,N0(t,e)?{binSuffix:"range"}:{},{offset:u});if(Nr(h)){if(V(n))return Nw({scaleName:o,fieldOrDatumDef:t,fieldOrDatumDef2:n,bandPosition:c,offset:u});$(jY(e===Rt?Go:Gs))}}return sf(t,o,Mn(d)?{binSuffix:"range"}:{},{offset:u,band:"band"===d?null!==(f=null!=c?c:t.bandPosition)&&void 0!==f?f:.5:void 0})}if(Zo(t)){const h=u?{offset:u}:{};return Object.assign(Object.assign({},I0(e,t.value)),h)}}return xe(l)&&(l=l()),l&&Object.assign(Object.assign({},l),u?{offset:u}:{})}function I0(e,t){return Be(["x","x2"],e)&&"width"===t?{field:{group:"width"}}:Be(["y","y2"],e)&&"height"===t?{field:{group:"height"}}:Ot(t)}function af(e){return e&&"number"!==e&&"time"!==e}function cX(e,t,n){return`${e}(${t}${n?`, ${Et(n)}`:""})`}function vF({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:o}){var s,a;if(af(n))return bF({fieldOrDatumDef:e,format:t,formatType:n,expr:r,config:o});const u=fX(e,r,i);if(Gh(e)){const l=function(e,t,n,r,i){return!t||n?`${i?"utc":"time"}Format(${e}, '${n=Y(n)?n:r}')`:function(e,t,n){if(!e)return;const r=qY(e);return`${n||ZI(e)?"utc":"time"}Format(${t}, ${r})`}(t,e,i)}(u,V(e)?null===(s=Pr(e.timeUnit))||void 0===s?void 0:s.unit:void 0,t,o.timeFormat,uf(e)&&"utc"===(null===(a=e.scale)||void 0===a?void 0:a.type));return l?{signal:l}:void 0}return t=pX(zw(e),t,o),V(e)&&Dt(e.bin)?{signal:Pw(u,q(e,{expr:r,binSuffix:"end"}),t,n,o)}:t||"quantitative"===zw(e)?{signal:`${gX(u,t)}`}:{signal:`isValid(${u}) ? ${u} : ""+${u}`}}function fX(e,t,n){return V(e)?n?`${q(e,{expr:t,suffix:"end"})}-${q(e,{expr:t,suffix:"start"})}`:q(e,{expr:t}):function(e){const{datum:t}=e;return nf(t)?k0(t):`${Et(t)}`}(e)}function bF({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:o,field:s}){return null!=s||(s=fX(e,r,i)),V(e)&&Dt(e.bin)?{signal:Pw(s,q(e,{expr:r,binSuffix:"end"}),t,n,o)}:{signal:cX(n,s,t)}}function dX(e,t,n,r,i,o){var s;if(!af(r))return Gh(e)?function(e,t,n,r){return e||(t?{signal:qY(t)}:r?void 0:n.timeFormat)}(n,V(e)?null===(s=Pr(e.timeUnit))||void 0===s?void 0:s.unit:void 0,i,o):pX(t,n,i)}function hX(e,t,n){return e&&(ie(e)||"number"===e||"time"===e)?e:Gh(t)&&"time"!==n&&"utc"!==n?"time":void 0}function pX(e,t,n){return Y(t)?t:e===of?n.numberFormat:void 0}function gX(e,t){return`format(${e}, "${t||""}")`}function mX(e,t,n,r){var i;return af(n)?cX(n,e,t):gX(e,null!==(i=Y(t)?t:void 0)&&void 0!==i?i:r.numberFormat)}function Pw(e,t,n,r,i){const o=mX(e,n,r,i),s=mX(t,n,r,i);return`${aF(e,!1)} ? "null" : ${o} + " \u2013 " + ${s}`}const Lw="min",vNe={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function yX(e){return e in vNe}function vX(e){return!!e&&!!e.encoding}function na(e){return!(!e||"count"!==e.op&&!e.field)}function bX(e){return!!e&&R(e)}function F0(e){return"row"in e||"column"in e}function _F(e){return!!e&&"header"in e}function jw(e){return"facet"in e}var wF=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function _X(e){const{field:t,timeUnit:n,bin:r,aggregate:i}=e;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),r?{bin:r}:{}),i?{aggregate:i}:{}),{field:t})}function xF(e){return"sort"in e}function wX({fieldDef:e,fieldDef2:t,markDef:n,config:r}){if(ye(e)&&void 0!==e.bandPosition)return e.bandPosition;if(V(e)){const{timeUnit:i,bin:o}=e;if(i&&!t)return oX(n.type)?0:tf("timeUnitBandPosition",n,r);if(Dt(o))return.5}}function xX({channel:e,fieldDef:t,fieldDef2:n,markDef:r,config:i,scaleType:o,useVlSizeChannel:s}){var a,u,l;const c=oi(e),f=st(s?"size":c,r,i,{vgChannel:c});if(void 0!==f)return f;if(V(t)){const{timeUnit:d,bin:h}=t;if(d&&!n)return{band:tf("timeUnitBandSize",r,i)};if(Dt(h)&&!Mn(o))return{band:1}}return oX(r.type)?o?Mn(o)?(null===(a=i[r.type])||void 0===a?void 0:a.discreteBandSize)||{band:1}:null===(u=i[r.type])||void 0===u?void 0:u.continuousBandSize:null===(l=i[r.type])||void 0===l?void 0:l.discreteBandSize:void 0}function EX(e,t,n,r){return!!(Dt(e.bin)||e.timeUnit&&co(e)&&"temporal"===e.type)&&void 0!==wX({fieldDef:e,fieldDef2:t,markDef:n,config:r})}function $w(e){return e&&"condition"in e}function Bw(e){const t=e&&e.condition;return!!t&&!R(t)&&V(t)}function R0(e){const t=e&&e.condition;return!!t&&!R(t)&&ye(t)}function V(e){return e&&(!!e.field||"count"===e.aggregate)}function zw(e){return e&&e.type}function ra(e){return e&&"datum"in e}function ia(e){return co(e)&&!Hw(e)||Uw(e)}function Uw(e){return ra(e)&&ft(e.datum)}function ye(e){return V(e)||ra(e)}function co(e){return e&&("field"in e||"count"===e.aggregate)&&"type"in e}function Zo(e){return e&&"value"in e&&"value"in e}function uf(e){return e&&("scale"in e||"sort"in e)}function EF(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function DX(e){return e&&"legend"in e}function CX(e){return e&&("format"in e||"formatType"in e)}function xNe(e){return ki(e,["legend","axis","header","scale"])}function q(e,t={}){var n,r,i;let o=e.field;const s=t.prefix;let a=t.suffix,u="";if(function(e){return"count"===e.aggregate}(e))o=JG("count");else{let l;if(!t.nofn)if(function(e){return"op"in e}(e))l=e.op;else{const{bin:c,aggregate:f,timeUnit:d}=e;Dt(c)?(l=dY(c),a=(null!==(n=t.binSuffix)&&void 0!==n?n:"")+(null!==(r=t.suffix)&&void 0!==r?r:"")):f?Sl(f)?(u=`["${o}"]`,o=`argmax_${f.argmax}`):ru(f)?(u=`["${o}"]`,o=`argmin_${f.argmin}`):l=String(f):d&&(l=function(e){const t=Pr(e),{utc:n}=t,r=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(t,["utc"]);return r.unit?(n?"utc":"")+P(r).map(i=>kt(`${"unit"===i?"":`_${i}_`}${r[i]}`)).join(""):(n?"utc":"")+"timeunit"+P(r).map(i=>kt(`_${i}_${r[i]}`)).join("")}(d),a=(!["range","mid"].includes(t.binSuffix)&&t.binSuffix||"")+(null!==(i=t.suffix)&&void 0!==i?i:""))}l&&(o=o?`${l}_${o}`:l)}return a&&(o=`${o}_${a}`),s&&(o=`${s}_${o}`),t.forAs?NI(o):t.expr?QG(o,t.expr)+u:ao(o)+u}function Hw(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return V(e)&&!!e.bin;case"temporal":return!1}throw new Error(IY(e.type))}const SX=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return function(e){const{aggregate:t,bin:n,timeUnit:r,field:i}=e;if(Sl(t))return`${i} for argmax(${t.argmax})`;if(ru(t))return`${i} for argmin(${t.argmin})`;const o=Pr(r),s=t||(null==o?void 0:o.unit)||(null==o?void 0:o.maxbins)&&"timeunit"||Dt(n)&&"bin";return s?`${s.toUpperCase()}(${i})`:i}(e);default:return function(e,t){var n;const{field:r,bin:i,timeUnit:o,aggregate:s}=e;if("count"===s)return t.countTitle;if(Dt(i))return`${r} (binned)`;if(o){const a=null===(n=Pr(o))||void 0===n?void 0:n.unit;if(a)return`${r} (${JI(a).join("-")})`}else if(s)return Sl(s)?`${r} for max ${s.argmax}`:ru(s)?`${r} for min ${s.argmin}`:`${E0(s)} of ${r}`;return r}(e,t)}};let AX=SX;function OX(e){AX=e}function qh(e,t,{allowDisabling:n,includeDefault:r=!0}){var i,o;const s=null===(i=DF(e))||void 0===i?void 0:i.title;if(!V(e))return null!=s?s:e.title;const a=e,u=r?CF(a,t):void 0;return n?sn(s,a.title,u):null!==(o=null!=s?s:a.title)&&void 0!==o?o:u}function DF(e){return EF(e)&&e.axis?e.axis:DX(e)&&e.legend?e.legend:_F(e)&&e.header?e.header:void 0}function CF(e,t){return AX(e,t)}function Vw(e){var t;if(CX(e)){const{format:n,formatType:r}=e;return{format:n,formatType:r}}{const n=null!==(t=DF(e))&&void 0!==t?t:{},{format:r,formatType:i}=n;return{format:r,formatType:i}}}function oa(e){return V(e)?e:Bw(e)?e.condition:void 0}function bn(e){return ye(e)?e:R0(e)?e.condition:void 0}function MX(e,t,n,r={}){return Y(e)||ft(e)||ku(e)?($(function(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${Et(n)}}.`}(t,Y(e)?"string":ft(e)?"number":"boolean",e)),{value:e}):ye(e)?qw(e,t,n,r):R0(e)?Object.assign(Object.assign({},e),{condition:qw(e.condition,t,n,r)}):e}function qw(e,t,n,r){if(CX(e)){const{formatType:o}=e,s=wF(e,["format","formatType"]);if(af(o)&&!n.customFormatTypes)return $(kY(t)),qw(s,t,n,r)}else{const i=EF(e)?"axis":DX(e)?"legend":_F(e)?"header":null;if(i&&e[i]){const o=e[i],{formatType:a}=o,u=wF(o,["format","formatType"]);if(af(a)&&!n.customFormatTypes)return $(kY(t)),qw(Object.assign(Object.assign({},e),{[i]:u}),t,n,r)}}return V(e)?SF(e,t,r):function(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=ft(n)?"quantitative":Y(n)?"nominal":nf(n)?"temporal":void 0,Object.assign(Object.assign({},e),{type:t})}(e)}function SF(e,t,{compositeMark:n=!1}={}){const{aggregate:r,timeUnit:i,bin:o,field:s}=e,a=Object.assign({},e);if(!n&&r&&!HI(r)&&!Sl(r)&&!ru(r)&&($(function(e){return`Invalid aggregation operator "${e}".`}(r)),delete a.aggregate),i&&(a.timeUnit=Pr(i)),s&&(a.field=`${s}`),Dt(o)&&(a.bin=Ww(o,t)),Nr(o)&&!Vn(t)&&$(function(e){return`Channel ${e} should not be used with "binned" bin.`}(t)),co(a)){const{type:u}=a,l=function(e){if(e)switch(e=e.toLowerCase(),e){case"q":case of:return"quantitative";case"t":case zh:return"temporal";case"o":case uF:return"ordinal";case"n":case lF:return"nominal";case Uh:return"geojson"}}(u);u!==l&&(a.type=l),"quantitative"!==u&&fY(r)&&($(function(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}(u,r)),a.type="quantitative")}else if(!sY(t)){const u=function(e,t){var n;switch(t){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(xF(e)&&R(e.sort))return"ordinal";const{aggregate:r,bin:i,timeUnit:o}=e;if(o)return"temporal";if(i||r&&!Sl(r)&&!ru(r))return"quantitative";if(uf(e)&&(null===(n=e.scale)||void 0===n?void 0:n.type))switch(Mw[e.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}(a,t);a.type=u}if(co(a)){const{compatible:u,warning:l}=function(e,t){const n=e.type;if("geojson"===n&&"shape"!==t)return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case Qa:case Ka:case gw:return Hw(e)?Wh:{compatible:!1,warning:BFe(t)};case Rt:case On:case bl:case jh:case ri:case Ks:case Zs:case S0:case O0:case mw:case Zc:case yw:case vw:case Kc:case Yo:case Ys:case bw:return Wh;case Qs:case uo:case Xs:case Xo:return n!==of?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:Wh;case tu:case _l:case wl:case xl:case eu:case Ja:case Za:case Go:case Gs:return"nominal"!==n||e.sort?Wh:{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`};case ii:case El:return Hw(e)||function(e){var t;return uf(e)&&Hh(null===(t=e.scale)||void 0===t?void 0:t.type)}(e)?Wh:{compatible:!1,warning:zFe(t)};case A0:return"nominal"!==e.type||"sort"in e?Wh:{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}}}(a,t)||{};!1===u&&$(l)}if(xF(a)&&Y(a.sort)){const{sort:u}=a;if(yX(u))return Object.assign(Object.assign({},a),{sort:{encoding:u}});const l=u.substr(1);if("-"===u.charAt(0)&&yX(l))return Object.assign(Object.assign({},a),{sort:{encoding:l,order:"descending"}})}if(_F(a)){const{header:u}=a;if(u){const{orient:l}=u,c=wF(u,["orient"]);if(l)return Object.assign(Object.assign({},a),{header:Object.assign(Object.assign({},c),{labelOrient:u.labelOrient||l,titleOrient:u.titleOrient||l})})}}return a}function Ww(e,t){return ku(e)?{maxbins:hY(t)}:"binned"===e?{binned:!0}:e.maxbins||e.step?e:Object.assign(Object.assign({},e),{maxbins:hY(t)})}const Wh={compatible:!0};function Gh(e){const{formatType:t}=Vw(e);return"time"===t||!t&&function(e){return e&&("temporal"===e.type||V(e)&&!!e.timeUnit)}(e)}function Gw(e,{timeUnit:t,type:n,wrapTime:r,undefinedIfExprNotRequired:i}){var o;const s=t&&(null===(o=Pr(t))||void 0===o?void 0:o.unit);let u,a=s||"temporal"===n;return M0(e)?u=e.expr:ie(e)?u=e.signal:nf(e)?(a=!0,u=k0(e)):(Y(e)||ft(e))&&a&&(u=`datetime(${Et(e)})`,function(e){return!!HY[e]}(s)&&(ft(e)&&e<1e4||Y(e)&&isNaN(Date.parse(e)))&&(u=k0({[s]:e}))),u?r&&a?`time(${u})`:u:i?void 0:Et(e)}function TX(e,t){const{type:n}=e;return t.map(r=>{const i=Gw(r,{timeUnit:V(e)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return void 0!==i?{signal:i}:r})}function N0(e,t){return Dt(e.bin)?Cl(t)&&["ordinal","nominal"].includes(e.type):(console.warn("Only call this method for binned field defs."),!1)}const kX={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function P0(e){return e&&e.condition}const IX=["domain","grid","labels","ticks","title"],FNe={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},FX={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},RX=Object.assign(Object.assign({},FX),{style:1,labelExpr:1,encoding:1});function NX(e){return!!RX[e]}P(RX);const PX=P({axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1});function su(e){return"mark"in e}class Yw{constructor(t,n){this.name=t,this.run=n}hasMatchingType(t){return!!su(t)&&function(e){return Ko(e)?e.type:e}(t.mark)===this.name}}function lf(e,t){const n=e&&e[t];return!!n&&(R(n)?Xc(n,r=>!!r.field):V(n)||Bw(n))}function LX(e,t){const n=e&&e[t];return!!n&&(R(n)?Xc(n,r=>!!r.field):V(n)||ra(n)||R0(n))}function AF(e,t){if(Vn(t)){const n=e[t];if((V(n)||ra(n))&&YY(n.type))return LX(e,aY(t))}return!1}function OF(e){return Xc(zIe,t=>{if(lf(e,t)){const n=e[t];if(R(n))return Xc(n,r=>!!r.aggregate);{const r=oa(n);return r&&!!r.aggregate}}return!1})}function jX(e,t){const n=[],r=[],i=[],o=[],s={};return MF(e,(a,u)=>{if(V(a)){const{field:l,aggregate:c,bin:f,timeUnit:d}=a,h=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(a,["field","aggregate","bin","timeUnit"]);if(c||d||f){const p=DF(a),g=null==p?void 0:p.title;let m=q(a,{forAs:!0});const v=Object.assign(Object.assign(Object.assign({},g?[]:{title:qh(a,t,{allowDisabling:!0})}),h),{field:m});if(c){let y;if(Sl(c)?(y="argmax",m=q({op:"argmax",field:c.argmax},{forAs:!0}),v.field=`${m}.${l}`):ru(c)?(y="argmin",m=q({op:"argmin",field:c.argmin},{forAs:!0}),v.field=`${m}.${l}`):"boxplot"!==c&&"errorbar"!==c&&"errorband"!==c&&(y=c),y){const b={op:y,as:m};l&&(b.field=l),o.push(b)}}else if(n.push(m),co(a)&&Dt(f))r.push({bin:f,field:l,as:m}),n.push(q(a,{binSuffix:"end"})),N0(a,u)&&n.push(q(a,{binSuffix:"range"})),Vn(u)&&(s[`${u}2`]={field:`${m}_end`}),v.bin="binned",sY(u)||(v.type=of);else if(d){i.push({timeUnit:d,field:l,as:m});const y=co(a)&&a.type!==zh&&"time";y&&(u===S0||u===Zc?v.formatType=y:function(e){return!!xw[e]}(u)?v.legend=Object.assign({formatType:y},v.legend):Vn(u)&&(v.axis=Object.assign({formatType:y},v.axis)))}s[u]=v}else n.push(l),s[u]=e[u]}else s[u]=e[u]}),{bins:r,timeUnits:i,aggregate:o,groupby:n,encoding:s}}function NNe(e,t,n){const r=function(e,t){return function(e){switch(e){case ri:case Ks:case Zs:case bw:case O0:case mw:case Zc:case yw:case A0:case tu:case _l:case wl:case xl:case gw:case Qa:case Ka:return zI;case Rt:case On:case bl:case jh:case Xs:case Qs:return ZIe;case Go:case Gs:case Xo:case uo:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case eu:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case El:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case ii:return{point:"always",geoshape:"always"};case S0:return{text:"always"};case Kc:return{point:"always",square:"always",text:"always"};case vw:return{image:"always"};case Yo:case Ys:return{text:"always",arc:"always"};case Ja:case Za:return{arc:"always"}}}(e)[t]}(t,n);if(!r)return!1;if("binned"===r){const i=e[t===Go?Rt:On];return!!(V(i)&&V(e[t])&&Nr(i.bin))}return!0}function Xw(e,t){const n={};for(const r of P(e)){const i=MX(e[r],r,t,{compositeMark:!0});n[r]=i}return n}function MF(e,t,n){if(e)for(const r of P(e)){const i=e[r];if(R(i))for(const o of i)t.call(n,o,r);else t.call(n,i,r)}}function $X(e,t){return P(t).reduce((n,r)=>{switch(r){case Rt:case On:case yw:case bw:case vw:case Go:case Gs:case bl:case jh:case Yo:case Ja:case Ys:case Za:case Xs:case Qs:case Xo:case uo:case S0:case ii:case Kc:case Zc:return n;case A0:if("line"===e||"trail"===e)return n;case O0:case mw:{const i=t[r];if(R(i)||V(i))for(const o of X(i))o.aggregate||n.push(q(o,{}));return n}case eu:if("trail"===e)return n;case ri:case Ks:case Zs:case tu:case _l:case wl:case El:case xl:{const i=oa(t[r]);return i&&!i.aggregate&&n.push(q(i,{})),n}}},[])}var BX=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function TF(e,t,n,r=!0){if("tooltip"in n)return{tooltip:n.tooltip};const i=e.map(({fieldPrefix:s,titlePrefix:a})=>{const u=r?` of ${kF(t)}`:"";return{field:s+t.field,type:t.type,title:ie(a)?{signal:`${a}"${escape(u)}"`}:a+u}}),o=function(e){const t=[];for(const n of P(e))if(lf(e,n)){const i=X(e[n]);for(const o of i)V(o)?t.push(o):Bw(o)&&t.push(o.condition)}return t}(n).map(xNe);return{tooltip:[...i,...Ws(o,$e)]}}function kF(e){const{title:t,field:n}=e;return sn(t,n)}function IF(e,t,n,r,i){const{scale:o,axis:s}=n;return({partName:a,mark:u,positionPrefix:l,endPositionPrefix:c,extraEncoding:f={}})=>{const d=kF(n);return zX(e,a,i,{mark:u,encoding:Object.assign(Object.assign(Object.assign({[t]:Object.assign(Object.assign(Object.assign({field:`${l}_${n.field}`,type:n.type},void 0!==d?{title:d}:{}),void 0!==o?{scale:o}:{}),void 0!==s?{axis:s}:{})},Y(c)?{[`${t}2`]:{field:`${c}_${n.field}`}}:{}),r),f)})}}function zX(e,t,n,r){const{clip:i,color:o,opacity:s}=e,a=e.type;return e[t]||void 0===e[t]&&n[t]?[Object.assign(Object.assign({},r),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[t]),i?{clip:i}:{}),o?{color:o}:{}),s?{opacity:s}:{}),Ko(r.mark)?r.mark:{type:r.mark}),{style:`${a}-${t}`}),ku(e[t])?{}:e[t])})]:[]}function UX(e,t,n){const{encoding:r}=e,i="vertical"===t?"y":"x",s=r[`${i}2`],a=r[`${i}Error`],u=r[`${i}Error2`];return{continuousAxisChannelDef:Qw(r[i],n),continuousAxisChannelDef2:Qw(s,n),continuousAxisChannelDefError:Qw(a,n),continuousAxisChannelDefError2:Qw(u,n),continuousAxis:i}}function Qw(e,t){if(null==e?void 0:e.aggregate){const{aggregate:n}=e,r=BX(e,["aggregate"]);return n!==t&&$(function(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}(n,t)),r}return e}function HX(e,t){const{mark:n,encoding:r}=e,{x:i,y:o}=r;if(Ko(n)&&n.orient)return n.orient;if(ia(i)){if(ia(o)){const s=V(i)&&i.aggregate,a=V(o)&&o.aggregate;if(!s&&a===t)return"vertical";if(!a&&s===t)return"horizontal";if(s===t&&a===t)throw new Error("Both x and y cannot have aggregate");return Gh(o)&&!Gh(i)?"horizontal":"vertical"}return"horizontal"}if(ia(o))return"vertical";throw new Error(`Need a valid continuous axis for ${t}s`)}var Kw=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const Zw="boxplot",zNe=new Yw(Zw,qX);function VX(e){return ft(e)?"tukey":e}function qX(e,{config:t}){var n,r;e=Object.assign(Object.assign({},e),{encoding:Xw(e.encoding,t)});const{mark:i,params:s}=e,u=Kw(e,["mark","encoding","params","projection"]),l=Ko(i)?i:{type:i};s&&$(OY("boxplot"));const c=null!==(n=l.extent)&&void 0!==n?n:t.boxplot.extent,f=st("size",l,t),d=VX(c),{bins:h,timeUnits:p,transform:g,continuousAxisChannelDef:m,continuousAxis:v,groupby:y,aggregate:b,encodingWithoutContinuousAxis:_,ticksOrient:w,boxOrient:E,customTooltipWithoutAggregatedField:x}=function(e,t,n){const r=HX(e,Zw),{continuousAxisChannelDef:i,continuousAxis:o}=UX(e,r,Zw),s=i.field,a=VX(t),u=[...WX(s),{op:"median",field:s,as:`mid_box_${s}`},{op:"min",field:s,as:("min-max"===a?"lower_whisker_":"min_")+s},{op:"max",field:s,as:("min-max"===a?"upper_whisker_":"max_")+s}],l="min-max"===a||"tukey"===a?[]:[{calculate:`datum["upper_box_${s}"] - datum["lower_box_${s}"]`,as:`iqr_${s}`},{calculate:`min(datum["upper_box_${s}"] + datum["iqr_${s}"] * ${t}, datum["max_${s}"])`,as:`upper_whisker_${s}`},{calculate:`max(datum["lower_box_${s}"] - datum["iqr_${s}"] * ${t}, datum["min_${s}"])`,as:`lower_whisker_${s}`}],h=Kw(e.encoding,["symbol"==typeof o?o:o+""]),{customTooltipWithoutAggregatedField:p,filteredEncoding:g}=function(e){const{tooltip:t}=e,n=BX(e,["tooltip"]);if(!t)return{filteredEncoding:n};let r,i;if(R(t)){for(const o of t)o.aggregate?(r||(r=[]),r.push(o)):(i||(i=[]),i.push(o));r&&(n.tooltip=r)}else t.aggregate?n.tooltip=t:i=t;return R(i)&&1===i.length&&(i=i[0]),{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}(h),{bins:m,timeUnits:v,aggregate:y,groupby:b,encoding:_}=jX(g,n),w="vertical"===r?"horizontal":"vertical",E=r;return{bins:m,timeUnits:v,transform:[...m,...v,{aggregate:[...y,...u],groupby:b},...l],groupby:b,aggregate:y,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:_,ticksOrient:w,boxOrient:E,customTooltipWithoutAggregatedField:p}}(e,c,t),{color:D,size:S}=_,C=Kw(_,["color","size"]),A=da=>IF(l,v,m,da,t.boxplot),M=A(C),T=A(_),L=A(Object.assign(Object.assign({},C),S?{size:S}:{})),O=TF([{fieldPrefix:"min-max"===d?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:"min-max"===d?"lower_whisker_":"min_",titlePrefix:"Min"}],m,_),N={type:"tick",color:"black",opacity:1,orient:w,invalid:null,aria:!1},U="min-max"===d?O:TF([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],m,_),W=[...M({partName:"rule",mark:{type:"rule",invalid:null,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:U}),...M({partName:"rule",mark:{type:"rule",invalid:null,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:U}),...M({partName:"ticks",mark:N,positionPrefix:"lower_whisker",extraEncoding:U}),...M({partName:"ticks",mark:N,positionPrefix:"upper_whisker",extraEncoding:U})],te=[..."tukey"!==d?W:[],...T({partName:"box",mark:Object.assign(Object.assign({type:"bar"},f?{size:f}:{}),{orient:E,invalid:null,ariaRoleDescription:"box"}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:O}),...L({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},J(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{}),f?{size:f}:{}),{orient:w,aria:!1}),positionPrefix:"mid_box",extraEncoding:O})];if("min-max"===d)return Object.assign(Object.assign({},u),{transform:(null!==(r=u.transform)&&void 0!==r?r:[]).concat(g),layer:te});const pe=`datum["lower_box_${m.field}"]`,We=`datum["upper_box_${m.field}"]`,Ge=`(${We} - ${pe})`,Ht=`${pe} - ${c} * ${Ge}`,_t=`${We} + ${c} * ${Ge}`,Kt=`datum["${m.field}"]`,$r={joinaggregate:WX(m.field),groupby:y},ss={transform:[{filter:`(${Ht} <= ${Kt}) && (${Kt} <= ${_t})`},{aggregate:[{op:"min",field:m.field,as:`lower_whisker_${m.field}`},{op:"max",field:m.field,as:`upper_whisker_${m.field}`},{op:"min",field:`lower_box_${m.field}`,as:`lower_box_${m.field}`},{op:"max",field:`upper_box_${m.field}`,as:`upper_box_${m.field}`},...b],groupby:y}],layer:W},Z=Kw(C,["tooltip"]),{scale:de,axis:Me}=m,B=kF(m),un=ki(Me,["title"]),ze=zX(l,"outliers",t.boxplot,{transform:[{filter:`(${Kt} < ${Ht}) || (${Kt} > ${_t})`}],mark:"point",encoding:Object.assign(Object.assign(Object.assign({[v]:Object.assign(Object.assign(Object.assign({field:m.field,type:m.type},void 0!==B?{title:B}:{}),void 0!==de?{scale:de}:{}),ht(un)?{}:{axis:un})},Z),D?{color:D}:{}),x?{tooltip:x}:{})})[0];let Zt;const Vt=[...h,...p,$r];return ze?Zt={transform:Vt,layer:[ze,ss]}:(Zt=ss,Zt.transform.unshift(...Vt)),Object.assign(Object.assign({},u),{layer:[Zt,{transform:g,layer:te}]})}function WX(e){return[{op:"q1",field:e,as:`lower_box_${e}`},{op:"q3",field:e,as:`upper_box_${e}`}]}var GX=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const FF="errorbar",VNe=new Yw(FF,YX);function YX(e,{config:t}){e=Object.assign(Object.assign({},e),{encoding:Xw(e.encoding,t)});const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:o,ticksOrient:s,markDef:a,outerSpec:u,tooltipEncoding:l}=XX(e,FF,t);delete o.size;const c=IF(a,i,r,o,t.errorbar),f=a.thickness,d=a.size,h=Object.assign(Object.assign({type:"tick",orient:s,aria:!1},void 0!==f?{thickness:f}:{}),void 0!==d?{size:d}:{}),p=[...c({partName:"ticks",mark:h,positionPrefix:"lower",extraEncoding:l}),...c({partName:"ticks",mark:h,positionPrefix:"upper",extraEncoding:l}),...c({partName:"rule",mark:Object.assign({type:"rule",ariaRoleDescription:"errorbar"},void 0!==f?{size:f}:{}),positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l})];return Object.assign(Object.assign(Object.assign({},u),{transform:n}),p.length>1?{layer:p}:Object.assign({},p[0]))}function XX(e,t,n){var r;const{mark:i,encoding:o,params:s}=e,u=GX(e,["mark","encoding","params","projection"]),l=Ko(i)?i:{type:i};s&&$(OY(t));const{orient:c,inputType:f}=function(e,t){const{encoding:n}=e;if(function(e){return(ye(e.x)||ye(e.y))&&!ye(e.x2)&&!ye(e.y2)&&!ye(e.xError)&&!ye(e.xError2)&&!ye(e.yError)&&!ye(e.yError2)}(n))return{orient:HX(e,t),inputType:"raw"};const r=function(e){return ye(e.x2)||ye(e.y2)}(n),i=function(e){return ye(e.xError)||ye(e.xError2)||ye(e.yError)||ye(e.yError2)}(n),o=n.x,s=n.y;if(r){if(i)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const a=n.x2,u=n.y2;if(ye(a)&&ye(u))throw new Error(`${t} cannot have both x2 and y2`);if(ye(a)){if(ia(o))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}if(ye(u)){if(ia(s))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}{const a=n.xError,l=n.yError,c=n.yError2;if(ye(n.xError2)&&!ye(a))throw new Error(`${t} cannot have xError2 without xError`);if(ye(c)&&!ye(l))throw new Error(`${t} cannot have yError2 without yError`);if(ye(a)&&ye(l))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(ye(a)){if(ia(o))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}if(ye(l)){if(ia(s))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}(e,t),{continuousAxisChannelDef:d,continuousAxisChannelDef2:h,continuousAxisChannelDefError:p,continuousAxisChannelDefError2:g,continuousAxis:m}=UX(e,c,t),{errorBarSpecificAggregate:v,postAggregateCalculates:y,tooltipSummary:b,tooltipTitleWithFieldName:_}=function(e,t,n,r,i,o,s,a){let u=[],l=[];const c=t.field;let f,d=!1;if("raw"===o){const h=e.center?e.center:e.extent?"iqr"===e.extent?"median":"mean":a.errorbar.center,p=e.extent?e.extent:"mean"===h?"stderr":"iqr";if("median"===h!=("iqr"===p)&&$(function(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}(h,p,s)),"stderr"===p||"stdev"===p)u=[{op:p,field:c,as:`extent_${c}`},{op:h,field:c,as:`center_${c}`}],l=[{calculate:`datum["center_${c}"] + datum["extent_${c}"]`,as:`upper_${c}`},{calculate:`datum["center_${c}"] - datum["extent_${c}"]`,as:`lower_${c}`}],f=[{fieldPrefix:"center_",titlePrefix:E0(h)},{fieldPrefix:"upper_",titlePrefix:QX(h,p,"+")},{fieldPrefix:"lower_",titlePrefix:QX(h,p,"-")}],d=!0;else{let g,m,v;"ci"===p?(g="mean",m="ci0",v="ci1"):(g="median",m="q1",v="q3"),u=[{op:m,field:c,as:`lower_${c}`},{op:v,field:c,as:`upper_${c}`},{op:g,field:c,as:`center_${c}`}],f=[{fieldPrefix:"upper_",titlePrefix:qh({field:c,aggregate:v,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:qh({field:c,aggregate:m,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:qh({field:c,aggregate:g,type:"quantitative"},a,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&$(function(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}(e.center,e.extent)),"aggregated-upper-lower"===o?(f=[],l=[{calculate:`datum["${n.field}"]`,as:`upper_${c}`},{calculate:`datum["${c}"]`,as:`lower_${c}`}]):"aggregated-error"===o&&(f=[{fieldPrefix:"",titlePrefix:c}],l=[{calculate:`datum["${c}"] + datum["${r.field}"]`,as:`upper_${c}`}],l.push(i?{calculate:`datum["${c}"] + datum["${i.field}"]`,as:`lower_${c}`}:{calculate:`datum["${c}"] - datum["${r.field}"]`,as:`lower_${c}`}));for(const h of l)f.push({fieldPrefix:h.as.substring(0,6),titlePrefix:Qc(Qc(h.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:l,errorBarSpecificAggregate:u,tooltipSummary:f,tooltipTitleWithFieldName:d}}(l,d,h,p,g,f,t,n),D="x"===m?"x2":"y2",C="x"===m?"xError":"yError",M="x"===m?"xError2":"yError2",L=GX(o,["symbol"==typeof m?m:m+"","symbol"==typeof D?D:D+"","symbol"==typeof C?C:C+"","symbol"==typeof M?M:M+""]),{bins:O,timeUnits:N,aggregate:U,groupby:W,encoding:te}=jX(L,n),pe=[...U,...v],We="raw"!==f?[]:W,Ge=TF(b,d,te,_);return{transform:[...null!==(r=u.transform)&&void 0!==r?r:[],...O,...N,...0===pe.length?[]:[{aggregate:pe,groupby:We}],...y],groupby:We,continuousAxisChannelDef:d,continuousAxis:m,encodingWithoutContinuousAxis:te,ticksOrient:"vertical"===c?"horizontal":"vertical",markDef:l,outerSpec:u,tooltipEncoding:Ge}}function QX(e,t,n){return`${E0(e)} ${n} ${t}`}const RF="errorband",KNe=new Yw(RF,KX);function KX(e,{config:t}){e=Object.assign(Object.assign({},e),{encoding:Xw(e.encoding,t)});const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:o,markDef:s,outerSpec:a,tooltipEncoding:u}=XX(e,RF,t),l=s,c=IF(l,i,r,o,t.errorband),f=void 0!==e.encoding.x&&void 0!==e.encoding.y;let d={type:f?"area":"rect"},h={type:f?"line":"rule"};const p=Object.assign(Object.assign({},l.interpolate?{interpolate:l.interpolate}:{}),l.tension&&l.interpolate?{tension:l.tension}:{});return f?(d=Object.assign(Object.assign(Object.assign({},d),p),{ariaRoleDescription:"errorband"}),h=Object.assign(Object.assign(Object.assign({},h),p),{aria:!1})):l.interpolate?$(LY("interpolate")):l.tension&&$(LY("tension")),Object.assign(Object.assign({},a),{transform:n,layer:[...c({partName:"band",mark:d,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"lower",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"upper",extraEncoding:u})]})}const NF={};function PF(e,t,n){const r=new Yw(e,t);NF[e]={normalizer:r,parts:n}}PF(Zw,qX,["box","median","outliers","rule","ticks"]),PF(FF,YX,["ticks","rule"]),PF(RF,KX,["band","borders"]);const JNe=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],ZX={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},JX={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},ePe=P(ZX),tPe=P(JX),eQ=P({header:1,headerRow:1,headerColumn:1,headerFacet:1}),tQ=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],nQ={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},L0=(P(nQ),"_vgsid_"),rPe={point:{on:"click",fields:[L0],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function LF(e){return!(!e||"legend"!==e&&!e.legend)}function jF(e){return LF(e)&&J(e)}function $F(e){return!!e.select}var iPe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function rQ(e){const t=[];for(const n of e||[]){if($F(n))continue;const{expr:r,bind:i}=n,o=iPe(n,["expr","bind"]);if(i&&r){const s=Object.assign(Object.assign({},o),{bind:i,init:r});t.push(s)}else{const s=Object.assign(Object.assign(Object.assign({},o),r?{update:r}:{}),i?{bind:i}:{});t.push(s)}}return t}function BF(e){return"concat"in e}function Jw(e){return"vconcat"in e}function zF(e){return"hconcat"in e}function iQ({step:e,offsetIsDiscrete:t}){var n;return t?null!==(n=e.for)&&void 0!==n?n:"offset":"position"}function sa(e){return J(e)&&void 0!==e.step}function oQ(e){return e.view||e.width||e.height}const sPe=P({align:1,bounds:1,center:1,columns:1,spacing:1});function UF(e,t){var n;return null!==(n=e[t])&&void 0!==n?n:e["width"===t?"continuousWidth":"continuousHeight"]}function ex(e,t){const n=tx(e,t);return sa(n)?n.step:aQ}function tx(e,t){var n;return sn(null!==(n=e[t])&&void 0!==n?n:e["width"===t?"discreteWidth":"discreteHeight"],{step:e.step})}const aQ=20,cPe={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:{continuousWidth:200,continuousHeight:200,step:aQ},mark:{color:"#4c78a8",invalid:"filter",timeUnitBandSize:1},arc:{},area:{},bar:{binSpacing:1,continuousBandSize:5,timeUnitBandPosition:.5},circle:{},geoshape:{},image:{},line:{},point:{},rect:{binSpacing:0,continuousBandSize:5,timeUnitBandPosition:.5},rule:{color:"black"},square:{},text:{color:"black"},tick:{thickness:1},trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:{pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,bandWithNestedOffsetPaddingInner:.2,bandWithNestedOffsetPaddingOuter:.2,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4},projection:{},legend:{gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:rPe,style:{},title:{},facet:{spacing:20},concat:{spacing:20}},au=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],uQ={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},lQ={blue:au[0],orange:au[1],red:au[2],teal:au[3],green:au[4],yellow:au[5],purple:au[6],pink:au[7],brown:au[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function cQ(e){const t=P(e||{}),n={};for(const r of t){const i=e[r];n[r]=P0(i)?gY(i):Ii(i)}return n}const gPe=[...uX,...PX,...eQ,"background","padding","legend","lineBreak","scale","style","title","view"];function fQ(e={}){const{color:t,font:n,fontSize:r,selection:i}=e,o=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["color","font","fontSize","selection"]),s=Md({},we(cPe),n?function(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}(n):{},t?function(e={}){return{signals:[{name:"color",value:J(e)?Object.assign(Object.assign({},lQ),e):lQ}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}(t):{},r?function(e){return{signals:[{name:"fontSize",value:J(e)?Object.assign(Object.assign({},uQ),e):uQ}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}(r):{},o||{});i&&Td(s,"selection",i,!0);const a=ki(s,gPe);for(const u of["background","lineBreak","padding"])s[u]&&(a[u]=Ii(s[u]));for(const u of uX)s[u]&&(a[u]=si(s[u]));for(const u of PX)s[u]&&(a[u]=cQ(s[u]));for(const u of eQ)s[u]&&(a[u]=si(s[u]));return s.legend&&(a.legend=si(s.legend)),s.scale&&(a.scale=si(s.scale)),s.style&&(a.style=function(e){const t=P(e),n={};for(const r of t)n[r]=cQ(e[r]);return n}(s.style)),s.title&&(a.title=si(s.title)),s.view&&(a.view=si(s.view)),a}const mPe=new Set(["view",...sX]),yPe=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],vPe=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},{area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]});function wPe(e,t,n,r){"view"===t&&(n="cell");const o=Object.assign(Object.assign({},r?e[t][r]:e[t]),e.style[null!=n?n:t]);ht(o)||(e.style[null!=n?n:t]=o),r||delete e[t]}function nx(e){return"layer"in e}class HF{map(t,n){return jw(t)?this.mapFacet(t,n):function(e){return"repeat"in e}(t)?this.mapRepeat(t,n):zF(t)?this.mapHConcat(t,n):Jw(t)?this.mapVConcat(t,n):BF(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(nx(t))return this.mapLayer(t,n);if(su(t))return this.mapUnit(t,n);throw new Error(WI(t))}mapLayer(t,n){return Object.assign(Object.assign({},t),{layer:t.layer.map(r=>this.mapLayerOrUnit(r,n))})}mapHConcat(t,n){return Object.assign(Object.assign({},t),{hconcat:t.hconcat.map(r=>this.map(r,n))})}mapVConcat(t,n){return Object.assign(Object.assign({},t),{vconcat:t.vconcat.map(r=>this.map(r,n))})}mapConcat(t,n){const{concat:r}=t,i=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(t,["concat"]);return Object.assign(Object.assign({},i),{concat:r.map(o=>this.map(o,n))})}mapFacet(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}mapRepeat(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}}const CPe={zero:1,center:1,normalize:1},APe=new Set([nX,kw,Tw,Rw,Fw,hF,pF,Iw,rX,dF]),OPe=new Set([kw,Tw,nX]);function Yh(e){return V(e)&&"quantitative"===zw(e)&&!e.bin}function dQ(e,t){var n,r;const i="x"===t?"y":"radius",o=e[t],s=e[i];if(V(o)&&V(s))if(Yh(o)&&Yh(s)){if(o.stack)return t;if(s.stack)return i;const a=V(o)&&!!o.aggregate;if(a!==(V(s)&&!!s.aggregate))return a?t:i;{const l=null===(n=o.scale)||void 0===n?void 0:n.type,c=null===(r=s.scale)||void 0===r?void 0:r.type;if(l&&"linear"!==l)return i;if(c&&"linear"!==c)return t}}else{if(Yh(o))return t;if(Yh(s))return i}else{if(Yh(o))return t;if(Yh(s))return i}}function hQ(e,t,n={}){var r,i;const o=Ko(e)?e.type:e;if(!APe.has(o))return null;const s=dQ(t,"x")||dQ(t,"theta");if(!s)return null;const a=t[s],u=V(a)?q(a,{}):void 0,l=function(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}(s),c=[],f=new Set;if(t[l]){const p=t[l],g=V(p)?q(p,{}):void 0;g&&g!==u&&(c.push(l),f.add(g));const m="x"===l?"xOffset":"yOffset",v=t[m],y=V(v)?q(v,{}):void 0;y&&y!==u&&(c.push(m),f.add(y))}const d=WIe.reduce((p,g)=>{if("tooltip"!==g&&lf(t,g)){const m=t[g];for(const v of X(m)){const y=oa(v);if(y.aggregate)continue;const b=q(y,{});(!b||!f.has(b))&&p.push({channel:g,fieldDef:y})}}return p},[]);let h;if(void 0!==a.stack?h=ku(a.stack)?a.stack?"zero":null:a.stack:OPe.has(o)&&(h="zero"),!h||!function(e){return e in CPe}(h)||OF(t)&&0===d.length)return null;if((null===(r=null==a?void 0:a.scale)||void 0===r?void 0:r.type)&&"linear"!==(null===(i=null==a?void 0:a.scale)||void 0===i?void 0:i.type)){if(n.disallowNonLinearStack)return null;$(function(e){return`Cannot stack non-linear scale (${e}).`}(a.scale.type))}return ye(t[nu(s)])?(void 0!==a.stack&&$(function(e){return`Cannot stack "${e}" if there is already "${e}2".`}(s)),null):(V(a)&&a.aggregate&&!iFe.has(a.aggregate)&&$(function(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}(a.aggregate)),{groupbyChannels:c,groupbyFields:f,fieldChannel:s,impute:null!==a.impute&&Tl(o),stackBy:d,offset:h})}var pQ=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function TPe(e){const r=pQ(e,["point","line"]);return P(r).length>1?r:r.type}function kPe(e){for(const t of["line","area","rule","trail"])e[t]&&(e=Object.assign(Object.assign({},e),{[t]:ki(e[t],["point","line"])}));return e}function VF(e,t={},n){return"transparent"===e.point?{opacity:0}:e.point?J(e.point)?e.point:{}:void 0!==e.point?null:t.point||n.shape?J(t.point)?t.point:{}:void 0}function gQ(e,t={}){return e.line?!0===e.line?{}:e.line:void 0!==e.line?null:t.line?!0===t.line?{}:t.line:void 0}class IPe{constructor(){this.name="path-overlay"}hasMatchingType(t,n){if(su(t)){const{mark:r,encoding:i}=t,o=Ko(r)?r:{type:r};switch(o.type){case"line":case"rule":case"trail":return!!VF(o,n[o.type],i);case"area":return!!VF(o,n[o.type],i)||!!gQ(o,n[o.type])}}return!1}run(t,n,r){const{config:i}=n,{params:o,projection:s,mark:a,encoding:u}=t,l=pQ(t,["params","projection","mark","encoding"]),c=Xw(u,i),f=Ko(a)?a:{type:a},d=VF(f,i[f.type],c),h="area"===f.type&&gQ(f,i[f.type]),p=[Object.assign(Object.assign({},o?{params:o}:{}),{mark:TPe(Object.assign(Object.assign({},"area"===f.type&&void 0===f.opacity&&void 0===f.fillOpacity?{opacity:.7}:{}),f)),encoding:ki(c,["shape"])})],g=hQ(f,c);let m=c;if(g){const{fieldChannel:v,offset:y}=g;m=Object.assign(Object.assign({},c),{[v]:Object.assign(Object.assign({},c[v]),y?{stack:y}:{})})}return h&&p.push(Object.assign(Object.assign({},s?{projection:s}:{}),{mark:Object.assign(Object.assign({type:"line"},Ph(f,["clip","interpolate","tension","tooltip"])),h),encoding:m})),d&&p.push(Object.assign(Object.assign({},s?{projection:s}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},Ph(f,["clip","tooltip"])),d),encoding:m})),r(Object.assign(Object.assign({},l),{layer:p}),Object.assign(Object.assign({},n),{config:kPe(i)}))}}function RPe(e,t){return t?F0(e)?bQ(e,t):mQ(e,t):e}function qF(e,t){return t?bQ(e,t):e}function WF(e,t,n){const r=t[e];return function(e){return e&&!Y(e)&&"repeat"in e}(r)?r.repeat in n?Object.assign(Object.assign({},t),{[e]:n[r.repeat]}):void $(function(e){return`Unknown repeated value "${e}".`}(r.repeat)):t}function mQ(e,t){if(void 0!==(e=WF("field",e,t))){if(null===e)return null;if(xF(e)&&na(e.sort)){const n=WF("field",e.sort,t);e=Object.assign(Object.assign({},e),n?{sort:n}:{})}return e}}function yQ(e,t){if(V(e))return mQ(e,t);{const n=WF("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function vQ(e,t){if(!ye(e)){if(R0(e)){const n=yQ(e.condition,t);return n?Object.assign(Object.assign({},e),{condition:n}):function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["condition"])}return e}{const n=yQ(e,t);if(n)return n;if($w(e))return{condition:e.condition}}}function bQ(e,t){const n={};for(const r in e)if(ne(e,r)){const i=e[r];if(R(i))n[r]=i.map(o=>vQ(o,t)).filter(o=>o);else{const o=vQ(i,t);void 0!==o&&(n[r]=o)}}return n}class NPe{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(su(t)){const{encoding:n,mark:r}=t;if("line"===r||Ko(r)&&"line"===r.type)for(const i of HIe){const s=n[Jc(i)];if(n[i]&&(V(s)&&!Nr(s.bin)||ra(s)))return!0}}return!1}run(t,n,r){const{encoding:i,mark:o}=t;return $(function(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}(!!i.x2,!!i.y2)),r(Object.assign(Object.assign({},t),{mark:J(o)?Object.assign(Object.assign({},o),{type:"rule"}):"rule"}),n)}}var kl=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function _Q({parentEncoding:e,encoding:t={},layer:n}){let r={};if(e){const i=new Set([...P(e),...P(t)]);for(const o of i){const s=t[o],a=e[o];if(ye(s)){const u=Object.assign(Object.assign({},a),s);r[o]=u}else R0(s)?r[o]=Object.assign(Object.assign({},s),{condition:Object.assign(Object.assign({},a),s.condition)}):s||null===s?r[o]=s:(n||Zo(a)||ie(a)||ye(a)||R(a))&&(r[o]=a)}}else r=t;return!r||ht(r)?void 0:r}function wQ(e){const{parentProjection:t,projection:n}=e;return t&&n&&$(function(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${Et(t)} is overridden by a child projection ${Et(n)}.`}({parentProjection:t,projection:n})),null!=n?n:t}function GF(e){return"filter"in e}function LPe(e){return void 0!==(null==e?void 0:e.stop)}function xQ(e){return"lookup"in e}function BPe(e){return"pivot"in e}function zPe(e){return"density"in e}function UPe(e){return"quantile"in e}function HPe(e){return"regression"in e}function VPe(e){return"loess"in e}function qPe(e){return"sample"in e}function WPe(e){return"window"in e}function GPe(e){return"joinaggregate"in e}function YPe(e){return"flatten"in e}function XPe(e){return"calculate"in e}function EQ(e){return"bin"in e}function QPe(e){return"impute"in e}function KPe(e){return"timeUnit"in e}function ZPe(e){return"aggregate"in e}function JPe(e){return"stack"in e}function eLe(e){return"fold"in e}var Il=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function DQ(e,t){const{transform:n}=e,r=Il(e,["transform"]);if(n){const i=n.map(o=>{if(GF(o))return{filter:YF(o,t)};if(EQ(o)&&ef(o.bin))return Object.assign(Object.assign({},o),{bin:SQ(o.bin)});if(xQ(o)){const s=o.from,{selection:a}=s,u=Il(s,["selection"]);return a?Object.assign(Object.assign({},o),{from:Object.assign({param:a},u)}):o}return o});return Object.assign(Object.assign({},r),{transform:i})}return e}function CQ(e,t){var n,r;const i=we(e);if(V(i)&&ef(i.bin)&&(i.bin=SQ(i.bin)),uf(i)&&(null===(r=null===(n=i.scale)||void 0===n?void 0:n.domain)||void 0===r?void 0:r.selection)){const o=i.scale.domain,{selection:s}=o,a=Il(o,["selection"]);i.scale.domain=Object.assign(Object.assign({},a),s?{param:s}:{})}if($w(i))if(R(i.condition))i.condition=i.condition.map(o=>{const{param:a}=o,l=Il(o,["selection","param","test"]);return a?o:Object.assign(Object.assign({},l),{test:YF(o,t)})});else{const o=CQ(i.condition,t),{param:a}=o,l=Il(o,["selection","param","test"]);i.condition=a?i.condition:Object.assign(Object.assign({},l),{test:YF(i.condition,t)})}return i}function SQ(e){const t=e.extent;if(null==t?void 0:t.selection){const{selection:n}=t,r=Il(t,["selection"]);return Object.assign(Object.assign({},e),{extent:Object.assign(Object.assign({},r),{param:n})})}return e}function YF(e,t){const n=r=>Nh(r,i=>{var o,s,a;const l={param:i,empty:null===(o=t.emptySelections[i])||void 0===o||o};return null!==(s=(a=t.selectionPredicates)[i])&&void 0!==s||(a[i]=[]),t.selectionPredicates[i].push(l),l});return e.selection?n(e.selection):Nh(e.test||e.filter,r=>r.selection?n(r.selection):r)}class XF extends HF{map(t,n){var r;const i=null!==(r=n.selections)&&void 0!==r?r:[];if(t.params&&!su(t)){const o=[];for(const s of t.params)$F(s)?i.push(s):o.push(s);t.params=o}return n.selections=i,super.map(t,AQ(t,n))}mapUnit(t,n){var r;const i=n.selections;if(!i||!i.length)return t;const o=(null!==(r=n.path)&&void 0!==r?r:[]).concat(t.name),s=[];for(const a of i)if(a.views&&a.views.length)for(const u of a.views)(Y(u)&&(u===t.name||o.indexOf(u)>=0)||R(u)&&u.map(l=>o.indexOf(l)).every((l,c,f)=>-1!==l&&(0===c||l>f[c-1])))&&s.push(a);else s.push(a);return s.length&&(t.params=s),t}}for(const e of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const t=XF.prototype[e];XF.prototype[e]=function(n,r){return t.call(this,n,AQ(n,r))}}function AQ(e,t){var n;return e.name?Object.assign(Object.assign({},t),{path:(null!==(n=t.path)&&void 0!==n?n:[]).concat(e.name)}):t}function OQ(e,t){void 0===t&&(t=fQ(e.config));const n=function(e,t={}){const n={config:t};return oLe.map(rLe.map(iLe.map(e,n),n),n)}(e,t),{width:r,height:i}=e,o=function(e,t,n){let{width:r,height:i}=t;const o=su(e)||nx(e),s={};o?"container"==r&&"container"==i?(s.type="fit",s.contains="padding"):"container"==r?(s.type="fit-x",s.contains="padding"):"container"==i&&(s.type="fit-y",s.contains="padding"):("container"==r&&($(DY("width")),r=void 0),"container"==i&&($(DY("height")),i=void 0));const a=Object.assign(Object.assign(Object.assign({type:"pad"},s),n?MQ(n.autosize):{}),MQ(e.autosize));if("fit"===a.type&&!o&&($('Autosize "fit" only works for single views and layered views.'),a.type="pad"),"container"==r&&!("fit"==a.type||"fit-x"==a.type)&&$(CY("width")),"container"==i&&!("fit"==a.type||"fit-y"==a.type)&&$(CY("height")),!qs(a,{type:"pad"}))return a}(n,{width:r,height:i,autosize:e.autosize},t);return Object.assign(Object.assign({},n),o?{autosize:o}:{})}const rLe=new class extends HF{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[zNe,VNe,KNe,new IPe,new NPe]}map(t,n){if(su(t)){const r=lf(t.encoding,Qa),i=lf(t.encoding,Ka),o=lf(t.encoding,gw);if(r||i||o)return this.mapFacetedUnit(t,n)}return super.map(t,n)}mapUnit(t,n){const{parentEncoding:r,parentProjection:i}=n,o=qF(t.encoding,n.repeater),s=Object.assign(Object.assign({},t),o?{encoding:o}:{});if(r||i)return this.mapUnitWithParentEncodingOrProjection(s,n);const a=this.mapLayerOrUnit.bind(this);for(const u of this.nonFacetUnitNormalizers)if(u.hasMatchingType(s,n.config))return u.run(s,n,a);return s}mapRepeat(t,n){return function(e){return!R(e.repeat)&&e.repeat.layer}(t)?this.mapLayerRepeat(t,n):this.mapNonLayerRepeat(t,n)}mapLayerRepeat(t,n){const{repeat:r,spec:i}=t,o=kl(t,["repeat","spec"]),{row:s,column:a,layer:u}=r,{repeater:l={},repeaterPrefix:c=""}=n;return s||a?this.mapRepeat(Object.assign(Object.assign({},t),{repeat:Object.assign(Object.assign({},s?{row:s}:{}),a?{column:a}:{}),spec:{repeat:{layer:u},spec:i}}),n):Object.assign(Object.assign({},o),{layer:u.map(f=>{const d=Object.assign(Object.assign({},l),{layer:f}),h=`${(i.name||"")+c}child__layer_${kt(f)}`,p=this.mapLayerOrUnit(i,Object.assign(Object.assign({},n),{repeater:d,repeaterPrefix:h}));return p.name=h,p})})}mapNonLayerRepeat(t,n){var r;const{repeat:i,spec:o,data:s}=t,a=kl(t,["repeat","spec","data"]);!R(i)&&t.columns&&(t=ki(t,["columns"]),$(MY("repeat")));const u=[],{repeater:l={},repeaterPrefix:c=""}=n,f=!R(i)&&i.row||[l?l.row:null],d=!R(i)&&i.column||[l?l.column:null],h=R(i)&&i||[l?l.repeat:null];for(const g of h)for(const m of f)for(const v of d){const y={repeat:g,row:m,column:v,layer:l.layer},b=(o.name||"")+c+"child__"+(R(i)?`${kt(g)}`:(i.row?`row_${kt(m)}`:"")+(i.column?`column_${kt(v)}`:"")),_=this.map(o,Object.assign(Object.assign({},n),{repeater:y,repeaterPrefix:b}));_.name=b,u.push(ki(_,["data"]))}const p=R(i)?t.columns:i.column?i.column.length:1;return Object.assign(Object.assign({data:null!==(r=o.data)&&void 0!==r?r:s,align:"all"},a),{columns:p,concat:u})}mapFacet(t,n){const{facet:r}=t;return F0(r)&&t.columns&&(t=ki(t,["columns"]),$(MY("facet"))),super.mapFacet(t,n)}mapUnitWithParentEncodingOrProjection(t,n){const{encoding:r,projection:i}=t,{parentEncoding:o,parentProjection:s,config:a}=n,u=wQ({parentProjection:s,projection:i}),l=_Q({parentEncoding:o,encoding:qF(r,n.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},t),u?{projection:u}:{}),l?{encoding:l}:{}),{config:a})}mapFacetedUnit(t,n){const r=t.encoding,{row:i,column:o,facet:s}=r,a=kl(r,["row","column","facet"]),{mark:u,width:l,projection:c,height:f,view:d,params:h}=t,g=kl(t,["mark","width","projection","height","view","params","encoding"]),{facetMapping:m,layout:v}=this.getFacetMappingAndLayout({row:i,column:o,facet:s},n),y=qF(a,n.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},g),v),{facet:m,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},l?{width:l}:{}),f?{height:f}:{}),d?{view:d}:{}),c?{projection:c}:{}),{mark:u,encoding:y}),h?{params:h}:{})}),n)}getFacetMappingAndLayout(t,n){var r;const{row:i,column:o,facet:s}=t;if(i||o){s&&$(function(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}([...i?[Qa]:[],...o?[Ka]:[]]));const a={},u={};for(const l of[Qa,Ka]){const c=t[l];if(c){const g=kl(c,["align","center","spacing","columns"]);a[l]=g;for(const m of["align","center","spacing"])void 0!==c[m]&&(null!==(r=u[m])&&void 0!==r||(u[m]={}),u[m][l]=c[m])}}return{facetMapping:a,layout:u}}{const{align:a,center:u,spacing:l,columns:c}=s;return{facetMapping:RPe(kl(s,["align","center","spacing","columns"]),n.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},a?{align:a}:{}),u?{center:u}:{}),l?{spacing:l}:{}),c?{columns:c}:{})}}}mapLayer(t,n){var{parentEncoding:r,parentProjection:i}=n,o=kl(n,["parentEncoding","parentProjection"]);const{encoding:s,projection:a}=t,u=kl(t,["encoding","projection"]),l=Object.assign(Object.assign({},o),{parentEncoding:_Q({parentEncoding:r,encoding:s,layer:!0}),parentProjection:wQ({parentProjection:i,projection:a})});return super.mapLayer(u,l)}},iLe=new class extends HF{map(t,n){var r,i;return null!==(r=n.emptySelections)&&void 0!==r||(n.emptySelections={}),null!==(i=n.selectionPredicates)&&void 0!==i||(n.selectionPredicates={}),t=DQ(t,n),super.map(t,n)}mapLayerOrUnit(t,n){if((t=DQ(t,n)).encoding){const r={};for(const[i,o]of vl(t.encoding))r[i]=CQ(o,n);t=Object.assign(Object.assign({},t),{encoding:r})}return super.mapLayerOrUnit(t,n)}mapUnit(t,n){const r=t,{selection:i}=r,o=Il(r,["selection"]);return i?Object.assign(Object.assign({},o),{params:vl(i).map(([s,a])=>{var u;const l=a,{init:c,bind:f,empty:d}=l,h=Il(l,["init","bind","empty"]);"single"===h.type?(h.type="point",h.toggle=!1):"multi"===h.type&&(h.type="point"),n.emptySelections[s]="none"!==d;for(const p of fr(null!==(u=n.selectionPredicates[s])&&void 0!==u?u:{}))p.empty="none"!==d;return{name:s,value:c,select:h,bind:f}})}):t}},oLe=new XF;function MQ(e){return Y(e)?{type:e}:null!=e?e:{}}const cLe=["background","padding"];function TQ(e,t){const n={};for(const r of cLe)e&&void 0!==e[r]&&(n[r]=Ii(e[r]));return t&&(n.params=e.params),n}class uu{constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new uu(we(this.explicit),we(this.implicit))}combine(){return Object.assign(Object.assign({},this.explicit),this.implicit)}get(t){return sn(this.explicit[t],this.implicit[t])}getWithExplicit(t){return void 0!==this.explicit[t]?{explicit:!0,value:this.explicit[t]}:void 0!==this.implicit[t]?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,{value:n,explicit:r}){void 0!==n&&this.set(t,n,r)}set(t,n,r){return delete this[r?"implicit":"explicit"][t],this[r?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,{explicit:n,implicit:r}){void 0!==n[t]?this.set(t,n[t],!0):void 0!==r[t]&&this.set(t,r[t],!1)}copyKeyFromObject(t,n){void 0!==n[t]&&this.set(t,n[t],!0)}copyAll(t){for(const n of P(t.combine())){const r=t.getWithExplicit(n);this.setWithExplicit(n,r)}}}function aa(e){return{explicit:!0,value:e}}function Ri(e){return{explicit:!1,value:e}}function kQ(e){return(t,n,r,i)=>{const o=e(t.value,n.value);return o>0?t:o<0?n:rx(t,n,r,i)}}function rx(e,t,n,r){return e.explicit&&t.explicit&&$(function(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${Et(n)} and ${Et(r)}). Using ${Et(n)}.`}(n,r,e.value,t.value)),e}function Fl(e,t,n,r,i=rx){return void 0===e||void 0===e.value?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:qs(e.value,t.value)?e:i(e,t,n,r)}class fLe extends uu{constructor(t={},n={},r=!1){super(t,n),this.explicit=t,this.implicit=n,this.parseNothing=r}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function Xh(e){return"url"in e}function j0(e){return"values"in e}function IQ(e){return"name"in e&&!Xh(e)&&!j0(e)&&!Rl(e)}function Rl(e){return e&&(FQ(e)||RQ(e)||QF(e))}function FQ(e){return"sequence"in e}function RQ(e){return"sphere"in e}function QF(e){return"graticule"in e}var bt=(()=>(function(e){e[e.Raw=0]="Raw",e[e.Main=1]="Main",e[e.Row=2]="Row",e[e.Column=3]="Column",e[e.Lookup=4]="Lookup"}(bt||(bt={})),bt))(),dLe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function Qh(e,t=!0,n=er){if(R(e)){const r=e.map(i=>Qh(i,t,n));return t?`[${r.join(", ")}]`:r}return nf(e)?n(t?k0(e):function(e){const t=QI(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}(e)):t?n(Et(e)):e}function hLe(e,t){var n;for(const r of fr(null!==(n=e.component.selection)&&void 0!==n?n:{})){const i=r.name;let o=`${i}${Ll}, ${"global"===r.resolve?"true":`{unit: ${Jh(e)}}`}`;for(const s of ux)!s.defined(r)||(s.signals&&(t=s.signals(e,r,t)),s.modifyExpr&&(o=s.modifyExpr(e,r,o)));t.push({name:i+GLe,on:[{events:{signal:r.name+Ll},update:`modify(${H(r.name+cf)}, ${o})`}]})}return KF(t)}function pLe(e,t){if(e.component.selection&&P(e.component.selection).length){const n=H(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:ml("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return KF(t)}function NQ(e,t){var n;for(const r of fr(null!==(n=e.component.selection)&&void 0!==n?n:{}))for(const i of ux)i.defined(r)&&i.marks&&(t=i.marks(e,r,t));return t}function KF(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}class pt{constructor(t,n){this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){this._children.includes(t)?$("Attempt to add the same child twice."):void 0!==n?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){const n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(const n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){const n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){const t=this._parent,n=t.parent;for(const r of this._children)r.parent=t;this._children=[],t.removeChild(this),t.parent.removeChild(t),this.parent=n,t.parent=this}}class Lr extends pt{constructor(t,n,r,i){super(t,n),this.type=r,this.refCounts=i,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){const t=new this.constructor;return t.debugName=`clone_${this.debugName}`,t._source=this._source,t._name=`clone_${this._name}`,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}dependentFields(){return new Set}producedFields(){return new Set}hash(){return void 0===this._hash&&(this._hash=`Output ${ZG()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}var PQ=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};class ua extends pt{constructor(t,n){super(t),this.formula=n}clone(){return new ua(null,we(this.formula))}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,o)=>{const{field:s,timeUnit:a}=o;if(a){const u=q(o,{forAs:!0});i[$e({as:u,field:s,timeUnit:a})]={as:u,field:s,timeUnit:a}}return i},{});return ht(r)?null:new ua(t,r)}static makeFromTransform(t,n){const r=Object.assign({},n),{timeUnit:i}=r,o=PQ(r,["timeUnit"]),s=Pr(i),a=Object.assign(Object.assign({},o),{timeUnit:s});return new ua(t,{[$e(a)]:a})}merge(t){this.formula=Object.assign({},this.formula);for(const n in t.formula)this.formula[n]||(this.formula[n]=t.formula[n]);for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}removeFormulas(t){const n={};for(const[r,i]of vl(this.formula))t.has(i.as)||(n[r]=i);this.formula=n}producedFields(){return new Set(fr(this.formula).map(t=>t.as))}dependentFields(){return new Set(fr(this.formula).map(t=>t.field))}hash(){return`TimeUnit ${$e(this.formula)}`}assemble(){const t=[];for(const n of fr(this.formula)){const{field:r,as:i,timeUnit:o}=n,s=Pr(o),{unit:a,utc:u}=s,l=PQ(s,["unit","utc"]);t.push(Object.assign(Object.assign(Object.assign(Object.assign({field:ao(r),type:"timeunit"},a?{units:JI(a)}:{}),u?{timezone:"utc"}:{}),l),{as:[i,`${i}_end`]}))}return t}}const $0="_tuple_fields";class _Le{constructor(...t){this.items=t,this.hasChannel={},this.hasField={}}}const wLe={defined:()=>!0,parse:(e,t,n)=>{var r;const i=t.name,o=null!==(r=t.project)&&void 0!==r?r:t.project=new _Le,s={},a={},u=new Set,l=(g,m)=>{const v="visual"===m?g.channel:g.field;let y=kt(`${i}_${v}`);for(let b=1;u.has(y);b++)y=kt(`${i}_${v}_${b}`);return u.add(y),{[m]:y}},c=t.type,f=e.config.selection[c],d=void 0!==n.value?X(n.value):null;let{fields:h,encodings:p}=J(n.select)?n.select:{};if(!h&&!p&&d)for(const g of d)if(J(g))for(const m of P(g))UIe(m)?(p||(p=[])).push(m):"interval"===c?($('Interval selections should be initialized using "x" and/or "y" keys.'),p=f.encodings):(h||(h=[])).push(m);!h&&!p&&(p=f.encodings,"fields"in f&&(h=f.fields));for(const g of null!=p?p:[]){const m=e.fieldDef(g);if(m){let v=m.field;if(m.aggregate){$(pFe(g,m.aggregate));continue}if(!v){$(AY(g));continue}if(m.timeUnit){v=e.vgField(g);const y={timeUnit:m.timeUnit,as:v,field:m.field};a[$e(y)]=y}if(!s[v]){let y="E";"interval"===c?Fi(e.getScaleComponent(g).get("type"))&&(y="R"):m.bin&&(y="R-RE");const b={field:v,channel:g,type:y};b.signals=Object.assign(Object.assign({},l(b,"data")),l(b,"visual")),o.items.push(s[v]=b),o.hasField[v]=o.hasChannel[g]=s[v]}}else $(AY(g))}for(const g of null!=h?h:[]){if(o.hasField[g])continue;const m={type:"E",field:g};m.signals=Object.assign({},l(m,"data")),o.items.push(m),o.hasField[g]=m}d&&(t.init=d.map(g=>o.items.map(m=>J(g)?void 0!==g[m.channel]?g[m.channel]:g[m.field]:g))),ht(a)||(o.timeUnit=new ua(null,a))},signals:(e,t,n)=>{const r=t.name+$0;return n.filter(o=>o.name===r).length>0?n:n.concat({name:r,value:t.project.items.map(o=>{const u=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(o,["signals","hasLegend"]);return u.field=ao(u.field),u})})}},Nl={defined:e=>"interval"===e.type&&"global"===e.resolve&&e.bind&&"scales"===e.bind,parse:(e,t)=>{const n=t.scales=[];for(const r of t.project.items){const i=r.channel;if(!Cl(i))continue;const o=e.getScaleComponent(i),s=o?o.get("type"):void 0;o&&Fi(s)?(o.set("selectionExtent",{param:t.name,field:r.field},!0),n.push(r)):$("Scale bindings are currently only supported for scales with unbinned, continuous domains.")}},topLevelSignals:(e,t,n)=>{const r=t.scales.filter(s=>0===n.filter(a=>a.name===s.signals.data).length);if(!e.parent||JF(e)||0===r.length)return n;const i=n.filter(s=>s.name===t.name)[0];let o=i.update;if(o.indexOf(rK)>=0)i.update=`{${r.map(s=>`${H(ao(s.field))}: ${s.signals.data}`).join(", ")}}`;else{for(const s of r){const a=`${H(ao(s.field))}: ${s.signals.data}`;o.includes(a)||(o=`${o.substring(0,o.length-1)}, ${a}}`)}i.update=o}return n.concat(r.map(s=>({name:s.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!JF(e))for(const r of t.scales){const i=n.filter(o=>o.name===r.signals.data)[0];i.push="outer",delete i.value,delete i.update}return n}};function ZF(e,t){return`domain(${H(e.scaleName(t))})`}function JF(e){var t;return e.parent&&sp(e.parent)&&(null!==(t=!e.parent.parent)&&void 0!==t?t:JF(e.parent.parent))}const Kh="_brush",eR="_scale_trigger",ELe={defined:e=>"interval"===e.type,signals:(e,t,n)=>{const r=t.name,i=r+$0,o=Nl.defined(t),s=t.init?t.init[0]:null,a=[],u=[];if(t.translate&&!o){const c=`!event.item || event.item.mark.name !== ${H(r+Kh)}`;LQ(t,(f,d)=>{var h,p;const g=X(null!==(h=(p=d.between[0]).filter)&&void 0!==h?h:p.filter=[]);return g.includes(c)||g.push(c),f})}t.project.items.forEach((c,f)=>{const d=c.channel;if(d!==Rt&&d!==On)return void $("Interval selections only support x and y encoding channels.");const p=function(e,t,n,r){const i=n.channel,o=n.signals.visual,s=n.signals.data,a=Nl.defined(t),u=H(e.scaleName(i)),l=e.getScaleComponent(i),c=l?l.get("type"):void 0,f=g=>`scale(${u}, ${g})`,d=e.getSizeSignalRef(i===Rt?"width":"height").signal,h=`${i}(unit)`,p=LQ(t,(g,m)=>[...g,{events:m.between[0],update:`[${h}, ${h}]`},{events:m,update:`[${o}[0], clamp(${h}, 0, ${d})]`}]);return p.push({events:{signal:t.name+eR},update:Fi(c)?`[${f(`${s}[0]`)}, ${f(`${s}[1]`)}]`:"[0, 0]"}),a?[{name:s,on:[]}]:[Object.assign(Object.assign({name:o},r?{init:Qh(r,!0,f)}:{value:[]}),{on:p}),Object.assign(Object.assign({name:s},r?{init:Qh(r)}:{}),{on:[{events:{signal:o},update:`${o}[0] === ${o}[1] ? null : invert(${u}, ${o})`}]})]}(e,t,c,s?s[f]:null),g=c.signals.data,m=c.signals.visual,v=H(e.scaleName(d)),b=Fi(e.getScaleComponent(d).get("type"))?"+":"";n.push(...p),a.push(g),u.push({scaleName:e.scaleName(d),expr:`(!isArray(${g}) || (${b}invert(${v}, ${m})[0] === ${b}${g}[0] && ${b}invert(${v}, ${m})[1] === ${b}${g}[1]))`})}),!o&&u.length&&n.push({name:r+eR,value:{},on:[{events:u.map(c=>({scale:c.scaleName})),update:`${u.map(c=>c.expr).join(" && ")} ? ${r+eR} : {}`}]});const l=`unit: ${Jh(e)}, fields: ${i}, values`;return n.concat(Object.assign(Object.assign({name:r+Ll},s?{init:`{${l}: ${Qh(s)}}`}:{}),a.length?{on:[{events:[{signal:a.join(" || ")}],update:`${a.join(" && ")} ? {${l}: [${a}]} : null`}]}:{}))},marks:(e,t,n)=>{const r=t.name,{x:i,y:o}=t.project.hasChannel,s=null==i?void 0:i.signals.visual,a=null==o?void 0:o.signals.visual,u=`data(${H(t.name+cf)})`;if(Nl.defined(t)||!i&&!o)return n;const l={x:void 0!==i?{signal:`${s}[0]`}:{value:0},y:void 0!==o?{signal:`${a}[0]`}:{value:0},x2:void 0!==i?{signal:`${s}[1]`}:{field:{group:"width"}},y2:void 0!==o?{signal:`${a}[1]`}:{field:{group:"height"}}};if("global"===t.resolve)for(const m of P(l))l[m]=[Object.assign({test:`${u}.length && ${u}[0].unit === ${Jh(e)}`},l[m]),{value:0}];const c=t.mark,{fill:f,fillOpacity:d,cursor:h}=c,p=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(c,["fill","fillOpacity","cursor"]),g=P(p).reduce((m,v)=>(m[v]=[{test:[void 0!==i&&`${s}[0] !== ${s}[1]`,void 0!==o&&`${a}[0] !== ${a}[1]`].filter(y=>y).join(" && "),value:p[v]},{value:null}],m),{});return[{name:`${r+Kh}_bg`,type:"rect",clip:!0,encode:{enter:{fill:{value:f},fillOpacity:{value:d}},update:l}},...n,{name:r+Kh,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},h?{cursor:{value:h}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},l),g)}}]}};function LQ(e,t){return e.events.reduce((n,r)=>r.between?t(n,r):($(`${r} is not an ordered event stream for interval selections.`),n),[])}const CLe={defined:e=>"point"===e.type,signals:(e,t,n)=>{var r;const i=t.name,o=i+$0,a="(item().isVoronoi ? datum.datum : datum)",u=t.project.items.map(h=>{const p=e.fieldDef(h.channel);return(null==p?void 0:p.bin)?`[${a}[${H(e.vgField(h.channel,{}))}], ${a}[${H(e.vgField(h.channel,{binSuffix:"end"}))}]]`:`${a}[${H(h.field)}]`}).join(", "),l=`unit: ${Jh(e)}, fields: ${o}, values`,c=t.events,f=fr(null!==(r=e.component.selection)&&void 0!==r?r:{}).reduce((h,p)=>"interval"===p.type?h.concat(p.name+Kh):h,[]).map(h=>`indexof(item().mark.name, '${h}') < 0`).join(" && ");return n.concat([{name:i+Ll,on:c?[{events:c,update:`${"datum && item().mark.marktype !== 'group'"+(f?` && ${f}`:"")} ? {${l}: [${u}]} : null`,force:!0}]:[]}])}};function Zh(e,t,n,r){const i=$w(t)&&t.condition,o=r(t);return i?{[n]:[...X(i).map(u=>{const l=r(u);if(function(e){return e.param}(u)){const{param:c,empty:f}=u,d=aK(e,{param:c,empty:f});return Object.assign({test:d},l)}{const c=lx(e,u.test);return Object.assign({test:c},l)}}),...void 0!==o?[o]:[]]}:void 0!==o?{[n]:o}:{}}function tR(e,t="text"){return Zh(e,e.encoding[t],t,r=>ix(r,e.config))}function ix(e,t,n="datum"){if(e){if(Zo(e))return Ot(e.value);if(ye(e)){const{format:r,formatType:i}=Vw(e);return vF({fieldOrDatumDef:e,format:r,formatType:i,expr:n,config:t})}}}function jQ(e,t={}){const{encoding:n,markDef:r,config:i,stack:o}=e,s=n.tooltip;if(R(s))return{tooltip:BQ({tooltip:s},o,i,t)};{const a=t.reactiveGeom?"datum.datum":"datum";return Zh(e,s,"tooltip",u=>{const l=ix(u,i,a);if(l)return l;if(null===u)return;let c=st("tooltip",r,i);return!0===c&&(c={content:"encoding"}),Y(c)?{value:c}:J(c)?ie(c)?c:"encoding"===c.content?BQ(n,o,i,t):{signal:a}:void 0})}}function $Q(e,t,n,{reactiveGeom:r}={}){const i={},o=r?"datum.datum":"datum",s=[];function a(l,c){const f=Jc(c),d=co(l)?l:Object.assign(Object.assign({},l),{type:e[f].type}),p=X(d.title||CF(d,n)).join(", ");let g;if(Vn(c)){const m="x"===c?"x2":"y2",v=oa(e[m]);if(Nr(d.bin)&&v){const y=q(d,{expr:o}),b=q(v,{expr:o}),{format:_,formatType:w}=Vw(d);g=Pw(y,b,_,w,n),i[m]=!0}else if(t&&t.fieldChannel===c&&"normalize"===t.offset){const{format:y,formatType:b}=Vw(d);g=vF({fieldOrDatumDef:d,format:y,formatType:b,expr:o,config:n,normalizeStack:!0}).signal}}null!=g||(g=ix(d,n,o).signal),s.push({channel:c,key:p,value:g})}MF(e,(l,c)=>{V(l)?a(l,c):Bw(l)&&a(l.condition,c)});const u={};for(const{channel:l,key:c,value:f}of s)!i[l]&&!u[c]&&(u[c]=f);return u}function BQ(e,t,n,{reactiveGeom:r}={}){const i=$Q(e,t,n,{reactiveGeom:r}),o=vl(i).map(([s,a])=>`"${s}": ${a}`);return o.length>0?{signal:`{${o.join(", ")}}`}:void 0}function Tn(e,t,n={}){const{markDef:r,encoding:i,config:o}=t,{vgChannel:s}=n;let{defaultRef:a,defaultValue:u}=n;return void 0===a&&(null!=u||(u=st(e,r,o,{vgChannel:s,ignoreVgConfig:!0})),void 0!==u&&(a=Ot(u))),Zh(t,i[e],null!=s?s:e,c=>yF({channel:e,channelDef:c,markDef:r,config:o,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:a}))}function zQ(e,t={filled:void 0}){var n,r,i,o;const{markDef:s,encoding:a,config:u}=e,{type:l}=s,c=null!==(n=t.filled)&&void 0!==n?n:st("filled",s,u),f=Be(["bar","point","circle","square","geoshape"],l)?"transparent":void 0,d=null!==(i=null!==(r=st(!0===c?"color":void 0,s,u,{vgChannel:"fill"}))&&void 0!==r?r:u.mark[!0===c&&"color"])&&void 0!==i?i:f,h=null!==(o=st(!1===c?"color":void 0,s,u,{vgChannel:"stroke"}))&&void 0!==o?o:u.mark[!1===c&&"color"],p=c?"fill":"stroke",g=Object.assign(Object.assign({},d?{fill:Ot(d)}:{}),h?{stroke:Ot(h)}:{});return s.color&&(c?s.fill:s.stroke)&&$(FY("property",{fill:"fill"in s,stroke:"stroke"in s})),Object.assign(Object.assign(Object.assign(Object.assign({},g),Tn("color",e,{vgChannel:p,defaultValue:c?d:h})),Tn("fill",e,{defaultValue:a.fill?d:void 0})),Tn("stroke",e,{defaultValue:a.stroke?h:void 0}))}function B0({channel:e,markDef:t,encoding:n={},model:r,bandPosition:i}){const o=`${e}Offset`,s=t[o],a=n[o];if(("xOffset"===o||"yOffset"===o)&&a)return{offsetType:"encoding",offset:yF({channel:o,channelDef:a,markDef:t,config:null==r?void 0:r.config,scaleName:r.scaleName(o),scale:r.getScaleComponent(o),stack:null,defaultRef:Ot(s),bandPosition:i})};const u=t[o];return u?{offsetType:"visual",offset:u}:{}}function hr(e,t,{defaultPos:n,vgChannel:r}){const{encoding:i,markDef:o,config:s,stack:a}=t,u=i[e],l=i[nu(e)],c=t.scaleName(e),f=t.getScaleComponent(e),{offset:d,offsetType:h}=B0({channel:e,markDef:o,encoding:i,model:t,bandPosition:.5}),p=nR({model:t,defaultPos:n,channel:e,scaleName:c,scale:f}),g=!u&&Vn(e)&&(i.latitude||i.longitude)?{field:t.getName(e)}:function(e){const{channel:t,channelDef:n,scaleName:r,stack:i,offset:o,markDef:s}=e;if(ye(n)&&i&&t===i.fieldChannel){if(V(n)){let a=n.bandPosition;if(void 0===a&&"text"===s.type&&("radius"===t||"theta"===t)&&(a=.5),void 0!==a)return Nw({scaleName:r,fieldOrDatumDef:n,startSuffix:"start",bandPosition:a,offset:o})}return sf(n,r,{suffix:"end"},{offset:o})}return gF(e)}({channel:e,channelDef:u,channel2Def:l,markDef:o,config:s,scaleName:c,scale:f,stack:a,offset:d,defaultRef:p,bandPosition:"encoding"===h?0:void 0});return g?{[r||e]:g}:void 0}function nR({model:e,defaultPos:t,channel:n,scaleName:r,scale:i}){const{markDef:o,config:s}=e;return()=>{const a=Jc(n),u=Dl(n),l=st(n,o,s,{vgChannel:u});if(void 0!==l)return I0(n,l);switch(t){case"zeroOrMin":case"zeroOrMax":if(r){if(!Be(["log","time","utc"],i.get("type"))&&i.domainDefinitelyIncludesZero())return{scale:r,value:0}}if("zeroOrMin"===t)return"y"===a?{field:{group:"height"}}:{value:0};switch(a){case"radius":return{signal:`min(${e.width.signal},${e.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":{const c=e[oi(n)];return Object.assign(Object.assign({},c),{mult:.5})}}}}const kLe={left:"x",center:"xc",right:"x2"},ILe={top:"y",middle:"yc",bottom:"y2"};function UQ(e,t,n,r="middle"){if("radius"===e||"theta"===e)return Dl(e);const i="x"===e?"align":"baseline",o=st(i,t,n);let s;return ie(o)?($(function(e){return`The ${e} for range marks cannot be an expression`}(i)),s=void 0):s=o,"x"===e?kLe[s||("top"===r?"left":"center")]:ILe[s||r]}function ox(e,t,{defaultPos:n,defaultPos2:r,range:i}){return i?HQ(e,t,{defaultPos:n,defaultPos2:r}):hr(e,t,{defaultPos:n})}function HQ(e,t,{defaultPos:n,defaultPos2:r}){const{markDef:i,config:o}=t,s=nu(e),a=oi(e),u=function(e,t,n){const{encoding:r,mark:i,markDef:o,stack:s,config:a}=e,u=Jc(n),l=oi(n),c=Dl(n),f=r[u],d=e.scaleName(u),h=e.getScaleComponent(u),{offset:p}=B0(n in r||n in o?{channel:n,markDef:o,encoding:r,model:e}:{channel:u,markDef:o,encoding:r,model:e});if(!f&&("x2"===n||"y2"===n)&&(r.latitude||r.longitude)){const m=oi(n),v=e.markDef[m];return null!=v?{[m]:{value:v}}:{[c]:{field:e.getName(n)}}}const g=function({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:o,scale:s,stack:a,offset:u,defaultRef:l}){return ye(t)&&a&&e.charAt(0)===a.fieldChannel.charAt(0)?sf(t,o,{suffix:"start"},{offset:u}):gF({channel:e,channelDef:n,scaleName:o,scale:s,stack:a,markDef:r,config:i,offset:u,defaultRef:l})}({channel:n,channelDef:f,channel2Def:r[n],markDef:o,config:a,scaleName:d,scale:h,stack:s,offset:p,defaultRef:void 0});return void 0!==g?{[c]:g}:sx(n,o)||sx(n,{[n]:Sw(n,o,a.style),[l]:Sw(l,o,a.style)})||sx(n,a[i])||sx(n,a.mark)||{[c]:nR({model:e,defaultPos:t,channel:n,scaleName:d,scale:h})()}}(t,r,s),l=u[a]?UQ(e,i,o):Dl(e);return Object.assign(Object.assign({},hr(e,t,{defaultPos:n,vgChannel:l})),u)}function sx(e,t){const n=oi(e),r=Dl(e);if(void 0!==t[r])return{[r]:I0(e,t[r])};if(void 0!==t[e])return{[r]:I0(e,t[e])};if(t[n]){const i=t[n];if(!Vh(i))return{[n]:I0(e,i)};$(function(e){return`Position range does not support relative band size for ${e}.`}(n))}}function Pl(e,t){var n,r;const{config:i,encoding:o,markDef:s}=e,a=s.type,u=nu(t),l=oi(t),c=o[t],f=o[u],d=e.getScaleComponent(t),h=d?d.get("type"):void 0,p=s.orient,g=null!==(r=null!==(n=o[l])&&void 0!==n?n:o.size)&&void 0!==r?r:st("size",s,i,{vgChannel:l}),m="bar"===a&&("x"===t?"vertical"===p:"horizontal"===p);return!V(c)||!(Dt(c.bin)||Nr(c.bin)||c.timeUnit&&!f)||g&&!Vh(g)||Mn(h)?(ye(c)&&Mn(h)||m)&&!f?function(e,t,n){const{markDef:r,encoding:i,config:o,stack:s}=n,a=r.orient,u=n.scaleName(t),l=n.getScaleComponent(t),c=oi(t),f=nu(t),d=function(e){switch(e){case Rt:return"xOffset";case On:return"yOffset";case Go:return"x2Offset";case Gs:return"y2Offset";case Yo:return"thetaOffset";case Ys:return"radiusOffset";case Ja:return"theta2Offset";case Za:return"radius2Offset"}}(t),h=n.scaleName(d),p="horizontal"===a&&"y"===t||"vertical"===a&&"x"===t;let g;(i.size||r.size)&&(p?g=Tn("size",n,{vgChannel:c,defaultRef:Ot(r.size)}):$(function(e){return`Cannot apply size to non-oriented mark "${e}".`}(r.type)));const m=xX({channel:t,fieldDef:e,markDef:r,config:o,scaleType:null==l?void 0:l.get("type"),useVlSizeChannel:p});g=g||{[c]:NLe(c,h||u,l,o,m)};const y=UQ(t,r,o,"band"===(null==l?void 0:l.get("type"))&&"band"in g[c]?"top":"middle"),b="xc"===y||"yc"===y,{offset:_,offsetType:w}=B0({channel:t,markDef:r,encoding:i,model:n,bandPosition:b?.5:0}),E=gF({channel:t,channelDef:e,markDef:r,config:o,scaleName:u,scale:l,stack:s,offset:_,defaultRef:nR({model:n,defaultPos:"mid",channel:t,scaleName:u,scale:l}),bandPosition:b?"encoding"===w?0:.5:ie(m)?{signal:`(1-${m})/2`}:Vh(m)?(1-m.band)/2:0});if(c)return Object.assign({[y]:E},g);{const x=Dl(f),D=g[c],S=_?Object.assign(Object.assign({},D),{offset:_}):D;return{[y]:E,[x]:R(E)?[E[0],Object.assign(Object.assign({},E[1]),{offset:S})]:Object.assign(Object.assign({},E),{offset:S})}}}(c,t,e):HQ(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"}):function({fieldDef:e,fieldDef2:t,channel:n,model:r}){var i,o,s;const{config:a,markDef:u,encoding:l}=r,c=r.getScaleComponent(n),f=r.scaleName(n),d=c?c.get("type"):void 0,h=c.get("reverse"),p=xX({channel:n,fieldDef:e,markDef:u,config:a,scaleType:d}),g=null===(i=r.component.axes[n])||void 0===i?void 0:i[0],m=null!==(o=null==g?void 0:g.get("translate"))&&void 0!==o?o:.5,v=Vn(n)&&null!==(s=st("binSpacing",u,a))&&void 0!==s?s:0,y=nu(n),b=Dl(n),_=Dl(y),{offset:w}=B0({channel:n,markDef:u,encoding:l,model:r,bandPosition:0}),E=ie(p)?{signal:`(1-${p.signal})/2`}:Vh(p)?(1-p.band)/2:.5;if(Dt(e.bin)||e.timeUnit)return{[_]:VQ({fieldDef:e,scaleName:f,bandPosition:E,offset:z0(y,v,h,m,w)}),[b]:VQ({fieldDef:e,scaleName:f,bandPosition:ie(E)?{signal:`1-${E.signal}`}:1-E,offset:z0(n,v,h,m,w)})};if(Nr(e.bin)){const x=sf(e,f,{},{offset:z0(y,v,h,m,w)});if(V(t))return{[_]:x,[b]:sf(t,f,{},{offset:z0(n,v,h,m,w)})};if(ef(e.bin)&&e.bin.step)return{[_]:x,[b]:{signal:`scale("${f}", ${q(e,{expr:"datum"})} + ${e.bin.step})`,offset:z0(n,v,h,m,w)}}}$(jY(y))}({fieldDef:c,fieldDef2:f,channel:t,model:e})}function NLe(e,t,n,r,i){if(Vh(i)){if(!n)return{mult:i.band,field:{group:e}};{const s=n.get("type");if("band"===s)return{scale:t,band:i.band};1!==i.band&&($(function(e){return`Cannot use the relative band size with ${e} scale.`}(s)),i=void 0)}}else{if(ie(i))return i;if(i)return{value:i}}if(n){const s=n.get("range");if(Ol(s)&&ft(s.step))return{value:s.step-2}}return{value:ex(r.view,e)-2}}function z0(e,t,n,r,i){if(nY(e))return 0;const o="x"===e||"y2"===e?-t/2:t/2;if(ie(n)||ie(i)||ie(r)){const s=ou(n),a=ou(i),u=ou(r);return{signal:(u?`${u} + `:"")+(s?`(${s} ? -1 : 1) * `:"")+(a?`(${a} + ${o})`:o)}}return i=i||0,r+(n?-i-o:+i+o)}function VQ({fieldDef:e,scaleName:t,bandPosition:n,offset:r}){return Nw({scaleName:t,fieldOrDatumDef:e,bandPosition:n,offset:r})}const jLe=new Set(["aria","width","height"]);function fo(e,t){const{fill:n,stroke:r}="include"===t.color?zQ(e):{};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},function(e,t){return lFe.reduce((n,r)=>(!jLe.has(r)&&void 0!==e[r]&&"ignore"!==t[r]&&(n[r]=Ot(e[r])),n),{})}(e.markDef,t)),qQ(e,"fill",n)),qQ(e,"stroke",r)),Tn("opacity",e)),Tn("fillOpacity",e)),Tn("strokeOpacity",e)),Tn("strokeWidth",e)),Tn("strokeDash",e)),function(e){const{encoding:t,mark:n}=e,r=t.order;return!Tl(n)&&Zo(r)?Zh(e,r,"zindex",i=>Ot(i.value)):{}}(e)),jQ(e)),tR(e,"href")),function(e){const{markDef:t,config:n}=e,r=st("aria",t,n);return!1===r?{}:Object.assign(Object.assign(Object.assign({},r?{aria:r}:{}),function(e){const{mark:t,markDef:n,config:r}=e;if(!1===r.aria)return{};const i=st("ariaRoleDescription",n,r);return null!=i?{ariaRoleDescription:{value:i}}:t in cFe?{}:{ariaRoleDescription:{value:t}}}(e)),function(e){const{encoding:t,markDef:n,config:r,stack:i}=e,o=t.description;if(o)return Zh(e,o,"description",u=>ix(u,e.config));const s=st("description",n,r);if(null!=s)return{description:Ot(s)};if(!1===r.aria)return{};const a=$Q(t,i,r);return ht(a)?void 0:{description:{signal:vl(a).map(([u,l],c)=>`"${c>0?"; ":""}${u}: " + (${l})`).join(" + ")}}}(e))}(e))}function qQ(e,t,n){const{config:r,mark:i,markDef:o}=e;if("hide"===st("invalid",o,r)&&n&&!Tl(i)){const a=function(e,{invalid:t=!1,channels:n}){const r=n.reduce((o,s)=>{const a=e.getScaleComponent(s);if(a){const u=a.get("type"),l=e.vgField(s,{expr:"datum"});l&&Fi(u)&&(o[l]=!0)}return o},{}),i=P(r);if(i.length>0){const o=t?"||":"&&";return i.map(s=>mF(s,t)).join(` ${o} `)}}(e,{invalid:!0,channels:Dw});if(a)return{[t]:[{test:a,value:null},...X(n)]}}return n?{[t]:n}:{}}function rR(e){const{config:t,markDef:n}=e;if(st("invalid",n,t)){const i=function(e,{invalid:t=!1,channels:n}){const r=n.reduce((o,s)=>{const a=e.getScaleComponent(s);if(a){const u=a.get("type"),l=e.vgField(s,{expr:"datum"});l&&Fi(u)&&(o[l]=!0)}return o},{}),i=P(r);if(i.length>0){const o=t?"||":"&&";return i.map(s=>mF(s,t)).join(` ${o} `)}}(e,{channels:Js});if(i)return{defined:{signal:i}}}return{}}function WQ(e,t){if(void 0!==t)return{[e]:Ot(t)}}const iR="voronoi",GQ={defined:e=>"point"===e.type&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(iR)},marks:(e,t,n)=>{const{x:r,y:i}=t.project.hasChannel,o=e.mark;if(Tl(o))return $(function(e){return`The "nearest" transform is not supported for ${e} marks.`}(o)),n;const s={name:e.getName(iR),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},jQ(e,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:r||!i?"datum.datum.x || 0":"0"},y:{expr:i||!r?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let a=0,u=!1;return n.forEach((l,c)=>{var f;const d=null!==(f=l.name)&&void 0!==f?f:"";d===e.component.mark[0].name?a=c:d.indexOf(iR)>=0&&(u=!0)}),u||n.splice(a+1,0,s),n}},YQ={defined:e=>"point"===e.type&&"global"===e.resolve&&e.bind&&"scales"!==e.bind&&!LF(e.bind),parse:(e,t,n)=>iK(t,n),topLevelSignals:(e,t,n)=>{const r=t.name,i=t.project,o=t.bind,s=t.init&&t.init[0],a=GQ.defined(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return i.items.forEach((u,l)=>{var c,f;const d=kt(`${r}_${u.field}`);n.filter(p=>p.name===d).length||n.unshift(Object.assign(Object.assign({name:d},s?{init:Qh(s[l])}:{value:null}),{on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${a}[${H(u.field)}] : null`}]:[],bind:null!==(f=null!==(c=o[u.field])&&void 0!==c?c:o[u.channel])&&void 0!==f?f:o}))}),n},signals:(e,t,n)=>{const r=t.name,i=t.project,o=n.filter(l=>l.name===r+Ll)[0],s=r+$0,a=i.items.map(l=>kt(`${r}_${l.field}`)),u=a.map(l=>`${l} !== null`).join(" && ");return a.length&&(o.update=`${u} ? {fields: ${s}, values: [${a.join(", ")}]} : null`),delete o.value,delete o.on,n}},ax="_toggle",XQ={defined:e=>"point"===e.type&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+ax,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+Ll,r=t.name+ax;return`${r} ? null : ${n}, `+("global"===t.resolve?`${r} ? null : true, `:`${r} ? null : {unit: ${Jh(e)}}, `)+`${r} ? ${n} : null`}},ULe={defined:e=>void 0!==e.clear&&!1!==e.clear,parse:(e,t)=>{t.clear&&(t.clear=Y(t.clear)?ml(t.clear,"view"):t.clear)},topLevelSignals:(e,t,n)=>{if(YQ.defined(t))for(const r of t.project.items){const i=n.findIndex(o=>o.name===kt(`${t.name}_${r.field}`));-1!==i&&n[i].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function r(i,o){-1!==i&&n[i].on&&n[i].on.push({events:t.clear,update:o})}if("interval"===t.type)for(const i of t.project.items){const o=n.findIndex(s=>s.name===i.signals.visual);r(o,"[0, 0]"),-1===o&&r(n.findIndex(a=>a.name===i.signals.data),"null")}else{let i=n.findIndex(o=>o.name===t.name+Ll);r(i,"null"),XQ.defined(t)&&(i=n.findIndex(o=>o.name===t.name+ax),r(i,"false"))}return n}},QQ={defined:e=>{const t="global"===e.resolve&&e.bind&&LF(e.bind),n=1===e.project.items.length&&e.project.items[0].field!==L0;return t&&!n&&$("Legend bindings are only supported for selections over an individual field or encoding channel."),t&&n},parse:(e,t,n)=>{var r;const i=we(n);if(i.select=Y(i.select)?{type:i.select,toggle:t.toggle}:Object.assign(Object.assign({},i.select),{toggle:t.toggle}),iK(t,i),J(n.select)&&(n.select.on||n.select.clear)){const a='event.item && indexof(event.item.mark.role, "legend") < 0';for(const u of t.events)u.filter=X(null!==(r=u.filter)&&void 0!==r?r:[]),u.filter.includes(a)||u.filter.push(a)}const o=jF(t.bind)?t.bind.legend:"click",s=Y(o)?ml(o,"view"):X(o);t.bind={legend:{merge:s}}},topLevelSignals:(e,t,n)=>{const r=t.name,i=jF(t.bind)&&t.bind.legend,o=s=>a=>{const u=we(a);return u.markname=s,u};for(const s of t.project.items){if(!s.hasLegend)continue;const a=`${kt(s.field)}_legend`,u=`${r}_${a}`;if(0===n.filter(c=>c.name===u).length){const c=i.merge.map(o(`${a}_symbols`)).concat(i.merge.map(o(`${a}_labels`))).concat(i.merge.map(o(`${a}_entries`)));n.unshift(Object.assign(Object.assign({name:u},t.init?{}:{value:null}),{on:[{events:c,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:`!event.item || !datum ? null : ${u}`,force:!0}]}))}}return n},signals:(e,t,n)=>{const r=t.name,i=t.project,o=n.find(d=>d.name===r+Ll),s=r+$0,a=i.items.filter(d=>d.hasLegend).map(d=>kt(`${r}_${kt(d.field)}_legend`)),l=`${a.map(d=>`${d} !== null`).join(" && ")} ? {fields: ${s}, values: [${a.join(", ")}]} : null`;t.events&&a.length>0?o.on.push({events:a.map(d=>({signal:d})),update:l}):a.length>0&&(o.update=l,delete o.value,delete o.on);const c=n.find(d=>d.name===r+ax),f=jF(t.bind)&&t.bind.legend;return c&&(t.events?c.on.push(Object.assign(Object.assign({},c.on[0]),{events:f})):c.on[0].events=f),n}},KQ="_translate_anchor",ZQ="_translate_delta",qLe={defined:e=>"interval"===e.type&&e.translate,signals:(e,t,n)=>{const r=t.name,i=Nl.defined(t),o=r+KQ,{x:s,y:a}=t.project.hasChannel;let u=ml(t.translate,"scope");return i||(u=u.map(l=>(l.between[0].markname=r+Kh,l))),n.push({name:o,value:{},on:[{events:u.map(l=>l.between[0]),update:"{x: x(unit), y: y(unit)"+(void 0!==s?`, extent_x: ${i?ZF(e,Rt):`slice(${s.signals.visual})`}`:"")+(void 0!==a?`, extent_y: ${i?ZF(e,On):`slice(${a.signals.visual})`}`:"")+"}"}]},{name:r+ZQ,value:{},on:[{events:u,update:`{x: ${o}.x - x(unit), y: ${o}.y - y(unit)}`}]}),void 0!==s&&JQ(e,t,s,"width",n),void 0!==a&&JQ(e,t,a,"height",n),n}};function JQ(e,t,n,r,i){var o,s;const a=t.name,u=a+KQ,l=a+ZQ,c=n.channel,f=Nl.defined(t),d=i.filter(x=>x.name===n.signals[f?"data":"visual"])[0],h=e.getSizeSignalRef(r).signal,p=e.getScaleComponent(c),g=p.get("type"),m=p.get("reverse"),y=`${u}.extent_${c}`,E=`${f?"log"===g?"panLog":"symlog"===g?"panSymlog":"pow"===g?"panPow":"panLinear":"panLinear"}(${y}, ${f?c===Rt?m?"":"-":m?"-":"":""}${l}.${c} / ${f?`${h}`:`span(${y})`}${f?"pow"===g?`, ${null!==(o=p.get("exponent"))&&void 0!==o?o:1}`:"symlog"===g?`, ${null!==(s=p.get("constant"))&&void 0!==s?s:1}`:"":""})`;d.on.push({events:{signal:l},update:f?E:`clampRange(${E}, 0, ${h})`})}const eK="_zoom_anchor",tK="_zoom_delta",WLe={defined:e=>"interval"===e.type&&e.zoom,signals:(e,t,n)=>{const r=t.name,i=Nl.defined(t),o=r+tK,{x:s,y:a}=t.project.hasChannel,u=H(e.scaleName(Rt)),l=H(e.scaleName(On));let c=ml(t.zoom,"scope");return i||(c=c.map(f=>(f.markname=r+Kh,f))),n.push({name:r+eK,on:[{events:c,update:i?"{"+[u?`x: invert(${u}, x(unit))`:"",l?`y: invert(${l}, y(unit))`:""].filter(f=>!!f).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:o,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),void 0!==s&&nK(e,t,s,"width",n),void 0!==a&&nK(e,t,a,"height",n),n}};function nK(e,t,n,r,i){var o,s;const a=t.name,u=n.channel,l=Nl.defined(t),c=i.filter(_=>_.name===n.signals[l?"data":"visual"])[0],f=e.getSizeSignalRef(r).signal,d=e.getScaleComponent(u),h=d.get("type"),p=l?ZF(e,u):c.name,g=a+tK,b=`${l?"log"===h?"zoomLog":"symlog"===h?"zoomSymlog":"pow"===h?"zoomPow":"zoomLinear":"zoomLinear"}(${p}, ${a}${eK}.${u}, ${g}${l?"pow"===h?`, ${null!==(o=d.get("exponent"))&&void 0!==o?o:1}`:"symlog"===h?`, ${null!==(s=d.get("constant"))&&void 0!==s?s:1}`:"":""})`;c.on.push({events:{signal:g},update:l?b:`clampRange(${b}, 0, ${f})`})}const cf="_store",Ll="_tuple",GLe="_modify",rK="vlSelectionResolve",ux=[CLe,ELe,wLe,XQ,YQ,Nl,QQ,ULe,qLe,WLe,GQ];function Jh(e,{escape:t}={escape:!0}){let n=t?H(e.name):e.name;const r=function(e){let t=e.parent;for(;t&&!ts(t);)t=t.parent;return t}(e);if(r){const{facet:i}=r;for(const o of lo)i[o]&&(n+=` + '__facet_${o}_' + (facet[${H(r.vgField(o))}])`)}return n}function oR(e){var t;return fr(null!==(t=e.component.selection)&&void 0!==t?t:{}).reduce((n,r)=>n||r.project.items.some(i=>i.field===L0),!1)}function iK(e,t){(Y(t.select)||!t.select.on)&&delete e.events,(Y(t.select)||!t.select.clear)&&delete e.clear,(Y(t.select)||!t.select.toggle)&&delete e.toggle}function sR(e){const t=[];return"Identifier"===e.type?[e.name]:"Literal"===e.type?[e.value]:("MemberExpression"===e.type&&(t.push(...sR(e.object)),t.push(...sR(e.property))),t)}function oK(e){return"MemberExpression"===e.object.type?oK(e.object):"datum"===e.object.name}function sK(e){const t=_k(e),n=new Set;return t.visit(r=>{"MemberExpression"===r.type&&oK(r)&&n.add(sR(r).slice(1).join("."))}),n}class ep extends pt{constructor(t,n,r){super(t),this.model=n,this.filter=r,this.expr=lx(this.model,this.filter,this),this._dependentFields=sK(this.expr)}clone(){return new ep(null,this.model,we(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function aK(e,t,n,r="datum"){const i=Y(t)?t:t.param,o=kt(i),s=H(o+cf);let a;try{a=e.getSelectionComponent(o,i)}catch(c){return`!!${o}`}if(a.project.timeUnit){const c=null!=n?n:e.component.data.raw,f=a.project.timeUnit.clone();c.parent?f.insertAsParentOf(c):c.parent=f}const u=`vlSelectionTest(${s}, ${r}${"global"===a.resolve?")":`, ${H(a.resolve)})`}`,l=`length(data(${s}))`;return!1===t.empty?`${l} && ${u}`:`!${l} || ${u}`}function uK(e,t,n){const r=kt(t),i=n.encoding;let s,o=n.field;try{s=e.getSelectionComponent(r,t)}catch(a){return r}if(i||o){if(i&&!o){const a=s.project.items.filter(u=>u.channel===i);!a.length||a.length>1?(o=s.project.items[0].field,$((a.length?"Multiple ":"No ")+`matching ${H(i)} encoding found for selection ${H(n.param)}. Using "field": ${H(o)}.`)):o=a[0].field}}else o=s.project.items[0].field,s.project.items.length>1&&$(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${H(o)}.`);return`${s.name}[${H(ao(o))}]`}function lx(e,t,n){return x0(t,r=>Y(r)?r:function(e){return null==e?void 0:e.param}(r)?aK(e,r,n):GY(r))}var cx=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function aR(e,t,n,r){var i,o,s,a,u;null!==(i=e.encode)&&void 0!==i||(e.encode={}),null!==(o=(a=e.encode)[t])&&void 0!==o||(a[t]={}),null!==(s=(u=e.encode[t]).update)&&void 0!==s||(u.update={}),e.encode[t].update[n]=r}function U0(e,t,n,r={header:!1}){var i,o;const s=e.combine(),{disable:a,orient:u,scale:l,labelExpr:c,title:f,zindex:d}=s,h=cx(s,["disable","orient","scale","labelExpr","title","zindex"]);if(!a){for(const p in h){const g=FNe[p],m=h[p];if(g&&g!==t&&"both"!==g)delete h[p];else if(P0(m)){const{condition:v}=m,y=cx(m,["condition"]),b=X(v),_=kX[p];if(_){const{vgProp:w,part:E}=_;aR(h,E,w,[...b.map(D=>{const{test:S}=D,C=cx(D,["test"]);return Object.assign({test:lx(null,S)},C)}),y]),delete h[p]}else if(null===_){const w={signal:b.map(E=>{const{test:x}=E,D=cx(E,["test"]);return`${lx(null,x)} ? ${yY(D)} : `}).join("")+yY(y)};h[p]=w}}else if(ie(m)){const v=kX[p];if(v){const{vgProp:y,part:b}=v;aR(h,b,y,m),delete h[p]}}Be(["labelAlign","labelBaseline"],p)&&null===h[p]&&delete h[p]}if("grid"===t){if(!h.grid)return;if(h.encode){const{grid:p}=h.encode;h.encode=Object.assign({},p?{grid:p}:{}),ht(h.encode)&&delete h.encode}return Object.assign(Object.assign({scale:l,orient:u},h),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:sn(d,0)})}{if(!r.header&&e.mainExtracted)return;if(void 0!==c){let g=c;(null===(o=null===(i=h.encode)||void 0===i?void 0:i.labels)||void 0===o?void 0:o.update)&&ie(h.encode.labels.update.text)&&(g=Qc(c,"datum.label",h.encode.labels.update.text.signal)),aR(h,"labels","text",{signal:g})}if(null===h.labelAlign&&delete h.labelAlign,h.encode){for(const g of IX)e.hasAxisPart(g)||delete h.encode[g];ht(h.encode)&&delete h.encode}const p=function(e,t){if(e)return R(e)&&!Al(e)?e.map(n=>CF(n,t)).join(", "):e}(f,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:l,orient:u,grid:!1},p?{title:p}:{}),h),!1===n.aria?{aria:!1}:{}),{zindex:sn(d,0)})}}}function lK(e){const{axes:t}=e.component,n=[];for(const r of Js)if(t[r])for(const i of t[r])if(!i.get("disable")&&!i.get("gridScale")){const o="x"===r?"height":"width",s=e.getSizeSignalRef(o).signal;o!==s&&n.push({name:o,update:s})}return n}function cK(e,t,n,r){return Object.assign.apply(null,[{},...e.map(i=>{if("axisOrient"===i){const o="x"===n?"bottom":"left",s=t["x"===n?"axisBottom":"axisLeft"]||{},a=t["x"===n?"axisTop":"axisRight"]||{},u=new Set([...P(s),...P(a)]),l={};for(const c of u.values())l[c]={signal:`${r.signal} === "${o}" ? ${ou(s[c])} : ${ou(a[c])}`};return l}return t[i]})])}function eje(e,t){var n;const r=[{}];for(const i of e){let o=null===(n=t[i])||void 0===n?void 0:n.style;if(o){o=X(o);for(const s of o)r.push(t.style[s])}}return Object.assign.apply(null,r)}function uR(e,t,n,r={}){var i;const o=bY(e,n,t);if(void 0!==o)return{configFrom:"style",configValue:o};for(const s of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(void 0!==(null===(i=r[s])||void 0===i?void 0:i[e]))return{configFrom:s,configValue:r[s][e]};return{}}const fK={scale:({model:e,channel:t})=>e.scaleName(t),format:({fieldOrDatumDef:e,config:t,axis:n})=>{const{format:r,formatType:i}=n;return dX(e,e.type,r,i,t,!0)},formatType:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:r}=e;return hX(r,t,n)},grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>{var r;return null!==(r=t.grid)&&void 0!==r?r:function(e,t){return!Mn(e)&&V(t)&&!Dt(null==t?void 0:t.bin)&&!Nr(null==t?void 0:t.bin)}(n,e)},gridScale:({model:e,channel:t})=>function(e,t){const n="x"===t?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelAlign||hK(t,n,r),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelBaseline||dK(t,n,r),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>{var r;return null!==(r=e.labelFlush)&&void 0!==r?r:function(e,t){if("x"===t&&Be(["quantitative","temporal"],e))return!0}(t.type,n)},labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{var r;return null!==(r=e.labelOverlap)&&void 0!==r?r:function(e,t,n,r){if(n&&!J(r)||"nominal"!==e&&"ordinal"!==e)return"log"!==t&&"symlog"!==t||"greedy"}(t.type,n,V(t)&&!!t.timeUnit,V(t)?t.sort:void 0)},orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:r,scaleType:i})=>{var o;const s="x"===e?"width":"y"===e?"height":void 0,a=s?t.getSizeSignalRef(s):void 0;return null!==(o=n.tickCount)&&void 0!==o?o:function({fieldOrDatumDef:e,scaleType:t,size:n,values:r}){var i;if(!r&&!Mn(t)&&"log"!==t){if(V(e)){if(Dt(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&Be(["month","hours","day","quarter"],null===(i=Pr(e.timeUnit))||void 0===i?void 0:i.unit))return}return{signal:`ceil(${n.signal}/40)`}}}({fieldOrDatumDef:r,scaleType:i,size:a,values:n.values})},title:({axis:e,model:t,channel:n})=>{if(void 0!==e.title)return e.title;const r=pK(t,n);if(void 0!==r)return r;const i=t.typedFieldDef(n),s=t.fieldDef("x"===n?"x2":"y2");return wY(i?[_X(i)]:[],V(s)?[_X(s)]:[])},values:({axis:e,fieldOrDatumDef:t})=>function(e,t){const n=e.values;return R(n)?TX(t,n):ie(n)?n:void 0}(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>{var r;return null!==(r=e.zindex)&&void 0!==r?r:function(e,t){return"rect"===e&&Hw(t)?1:0}(n,t)}};function lR(e){return`(((${e.signal} % 360) + 360) % 360)`}function dK(e,t,n,r){if(void 0!==e){if("x"===n){if(ie(e)){const i=lR(e);return{signal:`(45 < ${i} && ${i} < 135) || (225 < ${i} && ${i} < 315) ? "middle" :(${i} <= 45 || 315 <= ${i}) === ${ie(t)?`(${t.signal} === "top")`:"top"===t} ? "bottom" : "top"`}}return 45<e&&e<135||225<e&&e<315?"middle":ie(t)?{signal:`${t.signal} ${e<=45||315<=e?"===":"!=="} "top" ? "bottom" : "top"`}:(e<=45||315<=e)==("top"===t)?"bottom":"top"}if(ie(e)){const i=lR(e);return{signal:`${i} <= 45 || 315 <= ${i} || (135 <= ${i} && ${i} <= 225) ? ${r?'"middle"':"null"} : (45 <= ${i} && ${i} <= 135) === ${ie(t)?`(${t.signal} === "left")`:"left"===t} ? "top" : "bottom"`}}return e<=45||315<=e||135<=e&&e<=225?r?"middle":null:ie(t)?{signal:`${t.signal} ${45<=e&&e<=135?"===":"!=="} "left" ? "top" : "bottom"`}:(45<=e&&e<=135)==("left"===t)?"top":"bottom"}}function hK(e,t,n){if(void 0===e)return;const r="x"===n,i=r?0:90,o=r?"bottom":"left";if(ie(e)){const s=lR(e);return{signal:`(${i?`(${s} + 90)`:s} % 180 === 0) ? ${r?null:'"center"'} :(${i} < ${s} && ${s} < ${180+i}) === ${ie(t)?`(${t.signal} === "${o}")`:t===o} ? "left" : "right"`}}return(e+i)%180==0?r?null:"center":ie(t)?{signal:`${t.signal} ${i<e&&e<180+i?"===":"!=="} "${o}" ? "left" : "right"`}:(i<e&&e<180+i)==(t===o)?"left":"right"}function pK(e,t){const n="x"===t?"x2":"y2",r=e.fieldDef(t),i=e.fieldDef(n),o=r?r.title:void 0,s=i?i.title:void 0;return o&&s?xY(o,s):o||s||(void 0!==o?o:void 0!==s?s:void 0)}class tp extends pt{constructor(t,n){super(t),this.transform=n,this._dependentFields=sK(this.transform.calculate)}clone(){return new tp(null,we(this.transform))}static parseAllForSortIndex(t,n){return n.forEachFieldDef((r,i)=>{if(uf(r)&&bX(r.sort)){const{field:o,timeUnit:s}=r,a=r.sort,u=a.map((l,c)=>`${GY({field:o,timeUnit:s,equal:l})} ? ${c} : `).join("")+a.length;t=new tp(t,{calculate:u,as:np(r,i,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${$e(this.transform)}`}}function np(e,t,n){return q(e,Object.assign({prefix:t,suffix:"sort_index"},null!=n?n:{}))}function fx(e,t){return Be(["top","bottom"],t)?"column":Be(["left","right"],t)||"row"===e?"row":"column"}function rp(e,t,n,r){return sn((t||{})[e],("row"===r?n.headerRow:"column"===r?n.headerColumn:n.headerFacet)[e],n.header[e])}function dx(e,t,n,r){const i={};for(const o of e){const s=rp(o,t||{},n,r);void 0!==s&&(i[o]=s)}return i}const cR=["row","column"],fR=["header","footer"];function cje(e,t){const n=e.component.layoutHeaders[t].title,r=e.config?e.config:void 0,i=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:o,titleAngle:s,titleOrient:a}=dx(["titleAnchor","titleAngle","titleOrient"],i.header,r,t),u=fx(t,a),l=D0(s);return{name:`${t}-title`,type:"group",role:`${u}-title`,title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},"row"===t?{orient:"left"}:{}),{style:"guide-title"}),mK(l,u)),gK(u,l,o)),yK(r,i,t,ePe,ZX))}}function gK(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const r=hK(t,"row"===e?"left":"top","row"===e?"y":"x");return r?{align:r}:{}}function mK(e,t){const n=dK(e,"row"===t?"left":"top","row"===t?"y":"x",!0);return n?{baseline:n}:{}}function fje(e,t){const n=e.component.layoutHeaders[t],r=[];for(const i of fR)if(n[i])for(const o of n[i]){const s=hje(e,t,i,n,o);null!=s&&r.push(s)}return r}function dje(e,t){var n;const{sort:r}=e;return na(r)?{field:q(r,{expr:"datum"}),order:null!==(n=r.order)&&void 0!==n?n:"ascending"}:R(r)?{field:np(e,t,{expr:"datum"}),order:"ascending"}:{field:q(e,{expr:"datum"}),order:null!=r?r:"ascending"}}function dR(e,t,n){const{format:r,formatType:i,labelAngle:o,labelAnchor:s,labelOrient:a,labelExpr:u}=dx(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e.header,n,t),l=vF({fieldOrDatumDef:e,format:r,formatType:i,expr:"parent",config:n}).signal,c=fx(t,a);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:u?Qc(Qc(u,"datum.label",l),"datum.value",q(e,{expr:"parent"})):l}},"row"===t?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),mK(o,c)),gK(c,o,s)),yK(n,e,t,tPe,JX))}function hje(e,t,n,r,i){if(i){let o=null;const{facetFieldDef:s}=r,a=e.config?e.config:void 0;if(s&&i.labels){const{labelOrient:f}=dx(["labelOrient"],s.header,a,t);("row"===t&&!Be(["top","bottom"],f)||"column"===t&&!Be(["left","right"],f))&&(o=dR(s,t,a))}const u=ts(e)&&!F0(e.facet),l=i.axes,c=(null==l?void 0:l.length)>0;if(o||c){const f="row"===t?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`},r.facetFieldDef?{from:{data:e.getName(`${t}_domain`)},sort:dje(s,t)}:{}),c&&u?{from:{data:e.getName(`facet_domain_${t}`)}}:{}),o?{title:o}:{}),i.sizeSignal?{encode:{update:{[f]:i.sizeSignal}}}:{}),c?{axes:l}:{})}}return null}const pje={column:{start:0,end:1},row:{start:1,end:0}};function gje(e,t){return pje[t][e]}function yK(e,t,n,r,i){const o={};for(const s of r){if(!i[s])continue;const a=rp(s,null==t?void 0:t.header,e,n);void 0!==a&&(o[i[s]]=a)}return o}function hR(e){return[...hx(e,"width"),...hx(e,"height"),...hx(e,"childWidth"),...hx(e,"childHeight")]}function hx(e,t){const n="width"===t?"x":"y",r=e.component.layoutSize.get(t);if(!r||"merged"===r)return[];const i=e.getSizeSignalRef(t).signal;if("step"===r){const o=e.getScaleComponent(n);if(o){const s=o.get("type"),a=o.get("range");if(Mn(s)&&Ol(a)){const u=e.scaleName(n);return ts(e.parent)&&"independent"===e.parent.component.resolve.scale[n]?[vK(u,a)]:[vK(u,a),{name:i,update:bK(u,o,`domain('${u}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}if("container"==r){const o=i.endsWith("width"),s=o?"containerSize()[0]":"containerSize()[1]",u=`isFinite(${s}) ? ${s} : ${UF(e.config.view,o?"width":"height")}`;return[{name:i,init:u,on:[{update:u,events:"window:resize"}]}]}return[{name:i,value:r}]}function vK(e,t){const n=`${e}_step`;return ie(t.step)?{name:n,update:t.step.signal}:{name:n,value:t.step}}function bK(e,t,n){const r=t.get("type"),i=t.get("padding"),o=sn(t.get("paddingOuter"),i);let s=t.get("paddingInner");return s="band"===r?void 0!==s?s:i:1,`bandspace(${n}, ${ou(s)}, ${ou(o)}) * ${e}_step`}function _K(e){return"childWidth"===e?"width":"childHeight"===e?"height":e}function wK(e,t){return P(e).reduce((n,r)=>{const i=e[r];return Object.assign(Object.assign({},n),Zh(t,i,r,o=>Ot(o.value)))},{})}function xK(e,t){if(ts(t))return"theta"===e?"independent":"shared";if(sp(t))return"shared";if(MR(t))return Vn(e)||"theta"===e||"radius"===e?"independent":"shared";throw new Error("invalid model type for resolve")}function pR(e,t){const n=e.scale[t],r=Vn(t)?"axis":"legend";return"independent"===n?("shared"===e[r][t]&&$(function(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}(t)),"independent"):e[r][t]||"shared"}const yje=Object.assign(Object.assign({},nQ),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),EK=P(yje);class vje extends uu{}const DK={symbols:function(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i,legendType:o}){var s,a,u,l,c,f,d,h;if("symbol"!==o)return;const{markDef:p,encoding:g,config:m,mark:v}=n,y=p.filled&&"trail"!==v;let b=Object.assign(Object.assign({},function(e,t,n){for(const r of n){const i=tf(r,t.markDef,t.config);void 0!==i&&(e[r]=Ot(i))}return e}({},n,iNe)),zQ(n,{filled:y}));const _=null!==(s=i.get("symbolOpacity"))&&void 0!==s?s:m.legend.symbolOpacity,w=null!==(a=i.get("symbolFillColor"))&&void 0!==a?a:m.legend.symbolFillColor,E=null!==(u=i.get("symbolStrokeColor"))&&void 0!==u?u:m.legend.symbolStrokeColor,x=void 0===_?null!==(l=CK(g.opacity))&&void 0!==l?l:p.opacity:void 0;if(b.fill)if("fill"===r||y&&r===ri)delete b.fill;else if(b.fill.field)w?delete b.fill:(b.fill=Ot(null!==(c=m.legend.symbolBaseFillColor)&&void 0!==c?c:"black"),b.fillOpacity=Ot(null!=x?x:1));else if(R(b.fill)){const D=null!==(h=null!==(d=gR(null!==(f=g.fill)&&void 0!==f?f:g.color))&&void 0!==d?d:p.fill)&&void 0!==h?h:y&&p.color;D&&(b.fill=Ot(D))}if(b.stroke)if("stroke"===r||!y&&r===ri)delete b.stroke;else if(b.stroke.field||E)delete b.stroke;else if(R(b.stroke)){const D=sn(gR(g.stroke||g.color),p.stroke,y?p.color:void 0);D&&(b.stroke={value:D})}if(r!==tu){const D=V(t)&&AK(0,i,t);D?b.opacity=[Object.assign({test:D},Ot(null!=x?x:1)),Ot(m.legend.unselectedOpacity)]:x&&(b.opacity=Ot(x))}return b=Object.assign(Object.assign({},b),e),ht(b)?void 0:b},gradient:function(e,{model:t,legendType:n,legendCmpt:r}){var i;if("gradient"!==n)return;const{config:o,markDef:s,encoding:a}=t;let u={};const c=void 0===(null!==(i=r.get("gradientOpacity"))&&void 0!==i?i:o.legend.gradientOpacity)?CK(a.opacity)||s.opacity:void 0;return c&&(u.opacity=Ot(c)),u=Object.assign(Object.assign({},u),e),ht(u)?void 0:u},labels:function(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i}){const o=n.legend(r)||{},s=n.config,a=V(t)?AK(0,i,t):void 0,u=a?[{test:a,value:1},{value:s.legend.unselectedOpacity}]:void 0,{format:l,formatType:c}=o,f=af(c)?bF({fieldOrDatumDef:t,field:"datum.value",format:l,formatType:c,config:s}):void 0,d=Object.assign(Object.assign(Object.assign({},u?{opacity:u}:{}),f?{text:f}:{}),e);return ht(d)?void 0:d},entries:function(e,{legendCmpt:t}){const n=t.get("selections");return(null==n?void 0:n.length)?Object.assign(Object.assign({},e),{fill:{value:"transparent"}}):e}};function CK(e){return SK(e,(t,n)=>Math.max(t,n.value))}function gR(e){return SK(e,(t,n)=>sn(t,n.value))}function SK(e,t){return function(e){const t=e&&e.condition;return!!t&&(R(t)||Zo(t))}(e)?X(e.condition).reduce(t,e.value):Zo(e)?e.value:void 0}function AK(e,t,n){const r=t.get("selections");if(!(null==r?void 0:r.length))return;const i=H(n.field);return r.map(o=>`(!length(data(${H(kt(o)+cf)})) || (${o}[${i}] && indexof(${o}[${i}], datum.value) >= 0))`).join(" || ")}const OK={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:r,formatType:i}=t;return dX(e,e.type,r,i,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:r}=e;return hX(r,t,n)},gradientLength:e=>{var t,n;const{legend:r,legendConfig:i}=e;return null!==(n=null!==(t=r.gradientLength)&&void 0!==t?t:i.gradientLength)&&void 0!==n?n:function({legendConfig:e,model:t,direction:n,orient:r,scaleType:i}){const{gradientHorizontalMaxLength:o,gradientHorizontalMinLength:s,gradientVerticalMaxLength:a,gradientVerticalMinLength:u}=e;if(Qo(i))return"horizontal"===n?"top"===r||"bottom"===r?MK(t,"width",s,o):s:MK(t,"height",u,a)}(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>{var r,i;return null!==(i=null!==(r=e.labelOverlap)&&void 0!==r?r:t.labelOverlap)&&void 0!==i?i:function(e){if(Be(["quantile","threshold","log","symlog"],e))return"greedy"}(n)},symbolType:({legend:e,markDef:t,channel:n,encoding:r})=>{var i;return null!==(i=e.symbolType)&&void 0!==i?i:function(e,t,n,r){var i;if("shape"!==t){const o=null!==(i=gR(n))&&void 0!==i?i:r;if(o)return o}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}(t.type,n,r.shape,t.shape)},title:({fieldOrDatumDef:e,config:t})=>qh(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if($h(n)&&Qo(t)){if("gradient"===e)return}else if("symbol"===e)return;return e},values:({fieldOrDatumDef:e,legend:t})=>function(e,t){const n=e.values;return R(n)?TX(t,n):ie(n)?n:void 0}(t,e)};function MK(e,t,n,r){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${r})`}}function TK(e){const t=an(e)?function(e){const{encoding:t}=e,n={};for(const r of[ri,...tQ]){const i=bn(t[r]);!i||!e.getScaleComponent(r)||r===ii&&V(i)&&i.type===Uh||(n[r]=Rje(e,r))}return n}(e):function(e){const{legends:t,resolve:n}=e.component;for(const r of e.children){TK(r);for(const i of P(r.component.legends))n.legend[i]=pR(e.component.resolve,i),"shared"===n.legend[i]&&(t[i]=kK(t[i],r.component.legends[i]),t[i]||(n.legend[i]="independent",delete t[i]))}for(const r of P(t))for(const i of e.children)!i.component.legends[r]||"shared"===n.legend[r]&&delete i.component.legends[r];return t}(e);return e.component.legends=t,t}function Fje(e,t,n,r){switch(t){case"disable":return void 0!==n;case"values":return!!(null==n?void 0:n.values);case"title":if("title"===t&&e===(null==r?void 0:r.title))return!0}return e===(n||{})[t]}function Rje(e,t){var n,r,i;let o=e.legend(t);const{markDef:s,encoding:a,config:u}=e,l=u.legend,c=new vje({},function(e,t){const n=e.scaleName(t);if("trail"===e.mark){if("color"===t)return{stroke:n};if("size"===t)return{strokeWidth:n}}return"color"===t?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}(e,t));!function(e,t,n){var r,i,o,s;const a=null===(r=e.fieldDef(t))||void 0===r?void 0:r.field;for(const u of fr(null!==(i=e.component.selection)&&void 0!==i?i:{})){const l=null!==(o=u.project.hasField[a])&&void 0!==o?o:u.project.hasChannel[t];if(l&&QQ.defined(u)){const c=null!==(s=n.get("selections"))&&void 0!==s?s:[];c.push(u.name),n.set("selections",c,!1),l.hasLegend=!0}}}(e,t,c);const f=void 0!==o?!o:l.disable;if(c.set("disable",f,void 0!==o),f)return c;o=o||{};const d=e.getScaleComponent(t).get("type"),h=bn(a[t]),p=V(h)?null===(n=Pr(h.timeUnit))||void 0===n?void 0:n.unit:void 0,g=o.orient||u.legend.orient||"right",m=function(e){const{legend:t}=e;return sn(t.type,function({channel:e,timeUnit:t,scaleType:n}){if($h(e)){if(Be(["quarter","month","day"],t))return"symbol";if(Qo(n))return"gradient"}return"symbol"}(e))}({legend:o,channel:t,timeUnit:p,scaleType:d}),v=function({legendConfig:e,legendType:t,orient:n,legend:r}){var i,o;return null!==(o=null!==(i=r.direction)&&void 0!==i?i:e[t?"gradientDirection":"symbolDirection"])&&void 0!==o?o:function(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return"gradient"===t?"horizontal":void 0}}(n,t)}({legend:o,legendType:m,orient:g,legendConfig:l}),y={legend:o,channel:t,model:e,markDef:s,encoding:a,fieldOrDatumDef:h,legendConfig:l,config:u,scaleType:d,orient:g,legendType:m,direction:v};for(const x of EK){if("gradient"===m&&x.startsWith("symbol")||"symbol"===m&&x.startsWith("gradient"))continue;const D=x in OK?OK[x](y):o[x];if(void 0!==D){const S=Fje(D,x,o,e.fieldDef(t));(S||void 0===u.legend[x])&&c.set(x,D,S)}}const b=null!==(r=null==o?void 0:o.encoding)&&void 0!==r?r:{},_=c.get("selections"),w={},E={fieldOrDatumDef:h,model:e,channel:t,legendCmpt:c,legendType:m};for(const x of["labels","legend","title","symbols","gradient","entries"]){const D=wK(null!==(i=b[x])&&void 0!==i?i:{},e),S=x in DK?DK[x](D,E):D;void 0!==S&&!ht(S)&&(w[x]=Object.assign(Object.assign(Object.assign({},(null==_?void 0:_.length)&&V(h)?{name:`${kt(h.field)}_legend_${x}`}:{}),(null==_?void 0:_.length)?{interactive:!!_}:{}),{update:S}))}return ht(w)||c.set("encode",w,!!(null==o?void 0:o.encoding)),c}function kK(e,t){var n,r,i,o;if(!e)return t.clone();const s=e.getWithExplicit("orient"),a=t.getWithExplicit("orient");if(s.explicit&&a.explicit&&s.value!==a.value)return;let u=!1;for(const l of EK){const c=Fl(e.getWithExplicit(l),t.getWithExplicit(l),l,"legend",(f,d)=>{switch(l){case"symbolType":return Pje(f,d);case"title":return EY(f,d);case"type":return u=!0,Ri("symbol")}return rx(f,d,l,"legend")});e.setWithExplicit(l,c)}return u&&((null===(r=null===(n=e.implicit)||void 0===n?void 0:n.encode)||void 0===r?void 0:r.gradient)&&hw(e.implicit,["encode","gradient"]),(null===(o=null===(i=e.explicit)||void 0===i?void 0:i.encode)||void 0===o?void 0:o.gradient)&&hw(e.explicit,["encode","gradient"])),e}function Pje(e,t){return"circle"===t.value?t:e}function IK(e){const t=e.component.legends,n={};for(const i of P(t)){const o=e.getScaleComponent(i),s=Et(o.get("domains"));if(n[s])for(const a of n[s])kK(a,t[i])||n[s].push(t[i]);else n[s]=[t[i].clone()]}return fr(n).flat().map(i=>function(e,t){var n,r,i;const o=e.combine(),{disable:s,labelExpr:a}=o,l=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(o,["disable","labelExpr","selections"]);if(!s){if(!1===t.aria&&null==l.aria&&(l.aria=!1),null===(n=l.encode)||void 0===n?void 0:n.symbols){const c=l.encode.symbols.update;c.fill&&"transparent"!==c.fill.value&&!c.stroke&&!l.stroke&&(c.stroke={value:"transparent"});for(const f of tQ)l[f]&&delete c[f]}if(l.title||delete l.title,void 0!==a){let c=a;(null===(i=null===(r=l.encode)||void 0===r?void 0:r.labels)||void 0===i?void 0:i.update)&&ie(l.encode.labels.update.text)&&(c=Qc(a,"datum.label",l.encode.labels.update.text.signal)),function(e,t,n,r){var i,o,s,a,u;null!==(i=e.encode)&&void 0!==i||(e.encode={}),null!==(o=(a=e.encode)[t])&&void 0!==o||(a[t]={}),null!==(s=(u=e.encode[t]).update)&&void 0!==s||(u.update={}),e.encode[t].update.text=r}(l,"labels",0,{signal:c})}return l}}(i,e.config)).filter(i=>void 0!==i)}function FK(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:r}=n;if(t.data){const i={signal:`[${t.size.map(s=>s.signal).join(", ")}]`},o=t.data.reduce((s,a)=>{const u=ie(a)?a.signal:`data('${e.lookupDataSource(a)}')`;return Be(s,u)||s.push(u),s},[]);if(o.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:r,size:i,fit:{signal:o.length>1?`[${o.join(", ")}]`:o[0]}},n)]}return[Object.assign(Object.assign({name:r},{translate:{signal:"[width / 2, height / 2]"}}),n)]}const Uje=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class RK extends uu{constructor(t,n,r,i){super(Object.assign({},n),{name:t}),this.specifiedProjection=n,this.size=r,this.data=i,this.merged=!1}get isFit(){return!!this.data}}function NK(e){e.component.projection=an(e)?function(e){var t;if(e.hasProjection){const n=si(e.specifiedProjection),r=!(n&&(null!=n.scale||null!=n.translate)),i=r?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,o=r?function(e){const t=[],{encoding:n}=e;for(const r of[[Qs,Xs],[uo,Xo]])(bn(n[r[0]])||bn(n[r[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(ii)&&e.typedFieldDef(ii).type===Uh&&t.push({signal:e.getName(`geojson_${t.length}`)}),0===t.length&&t.push(e.requestDataName(bt.Main)),t}(e):void 0,s=new RK(e.projectionName(!0),Object.assign(Object.assign({},null!==(t=si(e.config.projection))&&void 0!==t?t:{}),null!=n?n:{}),i,o);return s.get("type")||s.set("type","equalEarth",!1),s}}(e):function(e){if(0===e.children.length)return;let t;for(const r of e.children)NK(r);const n=TI(e.children,r=>{const i=r.component.projection;if(i){if(t){const o=function(e,t){const n=TI(Uje,i=>!!(!ne(e.explicit,i)&&!ne(t.explicit,i)||ne(e.explicit,i)&&ne(t.explicit,i)&&qs(e.get(i),t.get(i))));if(qs(e.size,t.size)){if(n)return e;if(qs(e.explicit,{}))return t;if(qs(t.explicit,{}))return e}return null}(t,i);return o&&(t=o),!!o}return t=i,!0}return!0});if(t&&n){const r=e.projectionName(!0),i=new RK(r,t.specifiedProjection,t.size,we(t.data));for(const o of e.children){const s=o.component.projection;s&&(s.isFit&&i.data.push(...o.component.projection.data),o.renameProjection(s.get("name"),r),s.merged=!0)}return i}}(e)}function PK(e,t){return`${dY(e)}_${t}`}function mR(e,t,n){var r;const o=PK(null!==(r=Ww(n,void 0))&&void 0!==r?r:{},t);return e.getName(`${o}_bins`)}function LK(e,t,n){let r,i;r=function(e){return"as"in e}(e)?Y(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:[q(e,{forAs:!0}),q(e,{binSuffix:"end",forAs:!0})];const o=Object.assign({},Ww(t,void 0)),s=PK(o,e.field),{signal:a,extentSignal:u}=function(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}(n,s);if(Cw(o.extent)){const c=o.extent;i=uK(n,c.param,c),delete o.extent}return{key:s,binComponent:Object.assign(Object.assign(Object.assign({bin:o,field:e.field,as:[r]},a?{signal:a}:{}),u?{extentSignal:u}:{}),i?{span:i}:{})}}class la extends pt{constructor(t,n){super(t),this.bins=n}clone(){return new la(null,we(this.bins))}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,o,s)=>{if(co(o)&&Dt(o.bin)){const{key:a,binComponent:u}=LK(o,o.bin,n);i[a]=Object.assign(Object.assign(Object.assign({},u),i[a]),function(e,t,n,r){var i,o;if(N0(t,n)){const s=an(e)&&null!==(o=null!==(i=e.axis(n))&&void 0!==i?i:e.legend(n))&&void 0!==o?o:{},a=q(t,{expr:"datum"}),u=q(t,{expr:"datum",binSuffix:"end"});return{formulaAs:q(t,{binSuffix:"range",forAs:!0}),formula:Pw(a,u,s.format,s.formatType,r)}}return{}}(n,o,s,n.config))}return i},{});return ht(r)?null:new la(t,r)}static makeFromTransform(t,n,r){const{key:i,binComponent:o}=LK(n,n.bin,r);return new la(t,{[i]:o})}merge(t,n){for(const r of P(t.bins))r in this.bins?(n(t.bins[r].signal,this.bins[r].signal),this.bins[r].as=Ws([...this.bins[r].as,...t.bins[r].as],$e)):this.bins[r]=t.bins[r];for(const r of t.children)t.removeChild(r),r.parent=this;t.remove()}producedFields(){return new Set(fr(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(fr(this.bins).map(t=>t.field))}hash(){return`Bin ${$e(this.bins)}`}assemble(){return fr(this.bins).flatMap(t=>{const n=[],[r,...i]=t.as,o=t.bin,{extent:s}=o,a=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(o,["extent"]),u=Object.assign(Object.assign(Object.assign({type:"bin",field:ao(t.field),as:r,signal:t.signal},Cw(s)?{extent:null}:{extent:s}),t.span?{span:{signal:`span(${t.span})`}}:{}),a);!s&&t.extentSignal&&(n.push({type:"extent",field:ao(t.field),signal:t.extentSignal}),u.extent={signal:t.extentSignal}),n.push(u);for(const l of i)for(let c=0;c<2;c++)n.push({type:"formula",expr:q({field:r[c]},{expr:"datum"}),as:l[c]});return t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n})}}class Jo extends pt{constructor(t,n,r){super(t),this.dimensions=n,this.measures=r}clone(){return new Jo(null,new Set(this.dimensions),we(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let r=!1;n.forEachFieldDef(s=>{s.aggregate&&(r=!0)});const i={},o=new Set;return r&&(n.forEachFieldDef((s,a)=>{var u,l,c,f;const{aggregate:d,field:h}=s;if(d)if("count"===d)null!==(u=i["*"])&&void 0!==u||(i["*"]={}),i["*"].count=new Set([q(s,{forAs:!0})]);else{if(ru(d)||Sl(d)){const p=ru(d)?"argmin":"argmax",g=d[p];null!==(l=i[g])&&void 0!==l||(i[g]={}),i[g][p]=new Set([q({op:p,field:g},{forAs:!0})])}else null!==(c=i[h])&&void 0!==c||(i[h]={}),i[h][d]=new Set([q(s,{forAs:!0})]);Cl(a)&&"unaggregated"===n.scaleDomain(a)&&(null!==(f=i[h])&&void 0!==f||(i[h]={}),i[h].min=new Set([q({field:h,aggregate:"min"},{forAs:!0})]),i[h].max=new Set([q({field:h,aggregate:"max"},{forAs:!0})]))}else!function(e,t,n,r){var i;const o=an(r)?r.encoding[nu(t)]:void 0;if(co(n)&&an(r)&&EX(n,o,r.markDef,r.config))e.add(q(n,{})),e.add(q(n,{suffix:"end"})),n.bin&&N0(n,t)&&e.add(q(n,{binSuffix:"range"}));else if(function(e){return e in PI}(t)){const s=function(e){switch(e){case Xs:return"y";case Xo:return"y2";case Qs:return"x";case uo:return"x2"}}(t);e.add(r.getName(s))}else e.add(q(n));uf(n)&&function(e){return J(e)&&"field"in e}(null===(i=n.scale)||void 0===i?void 0:i.range)&&e.add(n.scale.range.field)}(o,a,s,n)}),o.size+P(i).length!==0)?new Jo(t,o,i):null}static makeFromTransform(t,n){var r,i,o;const s=new Set,a={};for(const u of n.aggregate){const{op:l,field:c,as:f}=u;l&&("count"===l?(null!==(r=a["*"])&&void 0!==r||(a["*"]={}),a["*"].count=new Set([f||q(u,{forAs:!0})])):(null!==(i=a[c])&&void 0!==i||(a[c]={}),a[c][l]=new Set([f||q(u,{forAs:!0})])))}for(const u of null!==(o=n.groupby)&&void 0!==o?o:[])s.add(u);return s.size+P(a).length===0?null:new Jo(t,s,a)}merge(t){return XG(this.dimensions,t.dimensions)?(function(e,t){var n;for(const r of P(t)){const i=t[r];for(const o of P(i))r in e?e[r][o]=new Set([...null!==(n=e[r][o])&&void 0!==n?n:[],...i[o]]):e[r]={[o]:i[o]}}}(this.measures,t.measures),!0):(ea.debug("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...P(this.measures)])}producedFields(){const t=new Set;for(const n of P(this.measures))for(const r of P(this.measures[n])){const i=this.measures[n][r];0===i.size?t.add(`${r}_${n}`):i.forEach(t.add,t)}return t}hash(){return`Aggregate ${$e({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],n=[],r=[];for(const o of P(this.measures))for(const s of P(this.measures[o]))for(const a of this.measures[o][s])r.push(a),t.push(s),n.push("*"===o?null:ao(o));return{type:"aggregate",groupby:[...this.dimensions].map(ao),ops:t,fields:n,as:r}}}class ip extends pt{constructor(t,n,r,i){super(t),this.model=n,this.name=r,this.data=i;for(const o of lo){const s=n.facet[o];if(s){const{bin:a,sort:u}=s;this[o]=Object.assign({name:n.getName(`${o}_domain`),fields:[q(s),...Dt(a)?[q(s,{binSuffix:"end"})]:[]]},na(u)?{sortField:u}:R(u)?{sortIndexField:np(s,o)}:{})}}this.childModel=n.child}hash(){let t="Facet";for(const n of lo)this[n]&&(t+=` ${n.charAt(0)}:${$e(this[n])}`);return t}get fields(){var t;const n=[];for(const r of lo)(null===(t=this[r])||void 0===t?void 0:t.fields)&&n.push(...this[r].fields);return n}dependentFields(){const t=new Set(this.fields);for(const n of lo)this[n]&&(this[n].sortField&&t.add(this[n].sortField.field),this[n].sortIndexField&&t.add(this[n].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const n of Js){const r=this.childModel.component.scales[n];if(r&&!r.merged){const i=r.get("type"),o=r.get("range");if(Mn(i)&&Ol(o)){const a=SR(gx(this.childModel,n));a?t[n]=a:$(GI(n))}}}return t}assembleRowColumnHeaderData(t,n,r){const i={row:"y",column:"x",facet:void 0}[t],o=[],s=[],a=[];i&&r&&r[i]&&(n?(o.push(`distinct_${r[i]}`),s.push("max")):(o.push(r[i]),s.push("distinct")),a.push(`distinct_${r[i]}`));const{sortField:u,sortIndexField:l}=this[t];if(u){const{op:c=Lw,field:f}=u;o.push(f),s.push(c),a.push(q(u,{forAs:!0}))}else l&&(o.push(l),s.push("max"),a.push(l));return{name:this[t].name,source:null!=n?n:this.data,transform:[Object.assign({type:"aggregate",groupby:this[t].fields},o.length?{fields:o,ops:s,as:a}:{})]}}assembleFacetHeaderData(t){var n,r;const{columns:i}=this.model.layout,{layoutHeaders:o}=this.model.component,s=[],a={};for(const c of cR){for(const f of fR){const d=null!==(n=o[c]&&o[c][f])&&void 0!==n?n:[];for(const h of d)if((null===(r=h.axes)||void 0===r?void 0:r.length)>0){a[c]=!0;break}}if(a[c]){const f=`length(data("${this.facet.name}"))`;s.push({name:`${this.facet.name}_${c}`,transform:[{type:"sequence",start:0,stop:"row"===c?i?{signal:`ceil(${f} / ${i})`}:1:i?{signal:`min(${f}, ${i})`}:{signal:f}}]})}}const{row:u,column:l}=a;return(u||l)&&s.unshift(this.assembleRowColumnHeaderData("facet",null,t)),s}assemble(){var t,n;const r=[];let i=null;const o=this.getChildIndependentFieldsWithStep(),{column:s,row:a,facet:u}=this;if(s&&a&&(o.x||o.y)){i=`cross_${this.column.name}_${this.row.name}`;const l=[].concat(null!==(t=o.x)&&void 0!==t?t:[],null!==(n=o.y)&&void 0!==n?n:[]),c=l.map(()=>"distinct");r.push({name:i,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:l,ops:c}]})}for(const l of[Ka,Qa])this[l]&&r.push(this.assembleRowColumnHeaderData(l,i,o));if(u){const l=this.assembleFacetHeaderData(o);l&&r.push(...l)}return r}}function jK(e){return e.startsWith("'")&&e.endsWith("'")||e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1):e}function e3e(e){const t={};return dw(e.filter,n=>{var r;if(WY(n)){let i=null;eF(n)?i=Ii(n.equal):nF(n)?i=Ii(n.lte):tF(n)?i=Ii(n.lt):rF(n)?i=Ii(n.gt):iF(n)?i=Ii(n.gte):oF(n)?i=n.range[0]:sF(n)&&(i=(null!==(r=n.oneOf)&&void 0!==r?r:n.in)[0]),i&&(nf(i)?t[n.field]="date":ft(i)?t[n.field]="number":Y(i)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}class pr extends pt{constructor(t,n){super(t),this._parse=n}clone(){return new pr(null,we(this._parse))}hash(){return`Parse ${$e(this._parse)}`}static makeExplicit(t,n,r){var i;let o={};const s=n.data;return!Rl(s)&&(null===(i=null==s?void 0:s.format)||void 0===i?void 0:i.parse)&&(o=s.format.parse),this.makeWithAncestors(t,o,{},r)}static makeWithAncestors(t,n,r,i){for(const a of P(r)){const u=i.getWithExplicit(a);void 0!==u.value&&(u.explicit||u.value===r[a]||"derived"===u.value||"flatten"===r[a]?delete r[a]:$(TY(a,r[a],u.value)))}for(const a of P(n)){const u=i.get(a);void 0!==u&&(u===n[a]?delete n[a]:$(TY(a,n[a],u)))}const o=new uu(n,r);i.copyAll(o);const s={};for(const a of P(o.combine())){const u=o.get(a);null!==u&&(s[a]=u)}return 0===P(s).length||i.parseNothing?null:new pr(t,s)}get parse(){return this._parse}merge(t){this._parse=Object.assign(Object.assign({},this._parse),t.parse),t.remove()}assembleFormatParse(){const t={};for(const n of P(this._parse)){const r=this._parse[n];1===Lh(n)&&(t[n]=r)}return t}producedFields(){return new Set(P(this._parse))}dependentFields(){return new Set(P(this._parse))}assembleTransforms(t=!1){return P(this._parse).filter(n=>!t||Lh(n)>1).map(n=>{const r=function(e,t){const n=RI(e);return"number"===t?`toNumber(${n})`:"boolean"===t?`toBoolean(${n})`:"string"===t?`toString(${n})`:"date"===t?`toDate(${n})`:"flatten"===t?n:t.startsWith("date:")?`timeParse(${n},'${jK(t.slice(5,t.length))}')`:t.startsWith("utc:")?`utcParse(${n},'${jK(t.slice(4,t.length))}')`:($(function(e){return`Unrecognized parse "${e}".`}(t)),null)}(n,this._parse[n]);return r?{type:"formula",expr:r,as:NI(n)}:null}).filter(n=>null!==n)}}class jl extends pt{clone(){return new jl(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([L0])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:L0}}}class H0 extends pt{constructor(t,n){super(t),this.params=n}clone(){return new H0(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${$e(this.params)}`}assemble(){return Object.assign({type:"graticule"},!0===this.params?{}:this.params)}}class V0 extends pt{constructor(t,n){super(t),this.params=n}clone(){return new V0(null,this.params)}dependentFields(){return new Set}producedFields(){var t;return new Set([null!==(t=this.params.as)&&void 0!==t?t:"data"])}hash(){return`Hash ${$e(this.params)}`}assemble(){return Object.assign({type:"sequence"},this.params)}}class ff extends pt{constructor(t){let n;if(super(null),null!=t||(t={name:"source"}),Rl(t)||(n=t.format?Object.assign({},ki(t.format,["parse"])):{}),j0(t))this._data={values:t.values};else if(Xh(t)){if(this._data={url:t.url},!n.type){let r=/(?:\.([^.]+))?$/.exec(t.url)[1];Be(["json","csv","tsv","dsv","topojson"],r)||(r="json"),n.type=r}}else RQ(t)?this._data={values:[{type:"Sphere"}]}:(IQ(t)||Rl(t))&&(this._data={});this._generator=Rl(t),t.name&&(this._name=t.name),n&&!ht(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}var q0,$K=function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n};function yR(e){return e instanceof ff||e instanceof H0||e instanceof V0}class vR{constructor(){q0.set(this,void 0),$K(this,q0,!1,"f")}setModified(){$K(this,q0,!0,"f")}get modifiedFlag(){return function(e,t,n,r){if("function"==typeof t||!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(e)}(this,q0)}}q0=new WeakMap;class df extends vR{getNodeDepths(t,n,r){r.set(t,n);for(const i of t.children)this.getNodeDepths(i,n+1,r);return r}optimize(t){const r=[...this.getNodeDepths(t,0,new Map).entries()].sort((i,o)=>o[1]-i[1]);for(const i of r)this.run(i[0]);return this.modifiedFlag}}class bR extends vR{optimize(t){this.run(t);for(const n of t.children)this.optimize(n);return this.modifiedFlag}}class i3e extends bR{mergeNodes(t,n){const r=n.shift();for(const i of n)t.removeChild(i),i.parent=r,i.remove()}run(t){const n=t.children.map(i=>i.hash()),r={};for(let i=0;i<n.length;i++)void 0===r[n[i]]?r[n[i]]=[t.children[i]]:r[n[i]].push(t.children[i]);for(const i of P(r))r[i].length>1&&(this.setModified(),this.mergeNodes(t,r[i]))}}class o3e extends bR{constructor(t){super(),this.requiresSelectionId=t&&oR(t)}run(t){t instanceof jl&&(this.requiresSelectionId&&(yR(t.parent)||t.parent instanceof Jo||t.parent instanceof pr)||(this.setModified(),t.remove()))}}class s3e extends vR{optimize(t){return this.run(t,new Set),this.modifiedFlag}run(t,n){let r=new Set;t instanceof ua&&(r=t.producedFields(),kI(r,n)&&(this.setModified(),t.removeFormulas(n),0===t.producedFields.length&&t.remove()));for(const i of t.children)this.run(i,new Set([...n,...r]))}}class a3e extends bR{constructor(){super()}run(t){t instanceof Lr&&!t.isRequired()&&(this.setModified(),t.remove())}}class u3e extends df{run(t){if(!(yR(t)||t.numChildren()>1))for(const n of t.children)if(n instanceof pr)if(t instanceof pr)this.setModified(),t.merge(n);else{if(FI(t.producedFields(),n.dependentFields()))continue;this.setModified(),n.swapWithParent()}}}class l3e extends df{run(t){const n=[...t.children],r=t.children.filter(i=>i instanceof pr);if(t.numChildren()>1&&r.length>=1){const i={},o=new Set;for(const s of r){const a=s.parse;for(const u of P(a))u in i?i[u]!==a[u]&&o.add(u):i[u]=a[u]}for(const s of o)delete i[s];if(!ht(i)){this.setModified();const s=new pr(t,i);for(const a of n){if(a instanceof pr)for(const u of P(i))delete a.parse[u];t.removeChild(a),a.parent=s,a instanceof pr&&0===P(a.parse).length&&a.remove()}}}}}class c3e extends df{run(t){t instanceof Lr||t.numChildren()>0||t instanceof ip||t instanceof ff||(this.setModified(),t.remove())}}class f3e extends df{run(t){const n=t.children.filter(i=>i instanceof ua),r=n.pop();for(const i of n)this.setModified(),r.merge(i)}}class d3e extends df{run(t){const n=t.children.filter(i=>i instanceof Jo),r={};for(const i of n){const o=$e(i.groupBy);o in r||(r[o]=[]),r[o].push(i)}for(const i of P(r)){const o=r[i];if(o.length>1){const s=o.pop();for(const a of o)s.merge(a)&&(t.removeChild(a),a.parent=s,a.remove(),this.setModified())}}}}class h3e extends df{constructor(t){super(),this.model=t}run(t){const n=!(yR(t)||t instanceof ep||t instanceof pr||t instanceof jl),r=[],i=[];for(const o of t.children)o instanceof la&&(n&&!FI(t.producedFields(),o.dependentFields())?r.push(o):i.push(o));if(r.length>0){const o=r.pop();for(const s of r)o.merge(s,this.model.renameSignal.bind(this.model));this.setModified(),t instanceof la?t.merge(o,this.model.renameSignal.bind(this.model)):o.swapWithParent()}if(i.length>1){const o=i.pop();for(const s of i)o.merge(s,this.model.renameSignal.bind(this.model));this.setModified()}}}class p3e extends df{run(t){const n=[...t.children];if(!Xc(n,s=>s instanceof Lr)||t.numChildren()<=1)return;const i=[];let o;for(const s of n)if(s instanceof Lr){let a=s;for(;1===a.numChildren();){const[u]=a.children;if(!(u instanceof Lr))break;a=u}i.push(...a.children),o?(t.removeChild(s),s.parent=o.parent,o.parent.removeChild(o),o.parent=a,this.setModified()):o=a}else i.push(s);if(i.length){this.setModified();for(const s of i)s.parent.removeChild(s),s.parent=o}}}class hf extends pt{constructor(t,n){super(t),this.transform=n}clone(){return new hf(null,we(this.transform))}addDimensions(t){this.transform.groupby=Ws(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(n=>n.field).filter(n=>void 0!==n).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){var n;return null!==(n=t.as)&&void 0!==n?n:q(t)}hash(){return`JoinAggregateTransform ${$e(this.transform)}`}assemble(){const t=[],n=[],r=[];for(const o of this.transform.joinaggregate)n.push(o.op),r.push(this.getDefaultName(o)),t.push(void 0===o.field?null:o.field);const i=this.transform.groupby;return Object.assign({type:"joinaggregate",as:r,ops:n,fields:t},void 0!==i?{groupby:i}:{})}}class lu extends pt{constructor(t,n){super(t),this._stack=n}clone(){return new lu(null,we(this._stack))}static makeFromTransform(t,n){const{stack:r,groupby:i,as:o,offset:s="zero"}=n,a=[],u=[];if(void 0!==n.sort)for(const f of n.sort)a.push(f.field),u.push(sn(f.order,"ascending"));const l={field:a,order:u};let c;return c=function(e){return R(e)&&e.every(t=>Y(t))&&e.length>1}(o)?o:Y(o)?[o,`${o}_end`]:[`${n.stack}_start`,`${n.stack}_end`],new lu(t,{dimensionFieldDefs:[],stackField:r,groupby:i,offset:s,sort:l,facetby:[],as:c})}static makeFromEncoding(t,n){const r=n.stack,{encoding:i}=n;if(!r)return null;const{groupbyChannels:o,fieldChannel:s,offset:a,impute:u}=r,l=o.map(h=>oa(i[h])).filter(h=>!!h),c=function(e){return e.stack.stackBy.reduce((t,n)=>{const i=q(n.fieldDef);return i&&t.push(i),t},[])}(n),f=n.encoding.order;let d;return d=R(f)||V(f)?_Y(f):c.reduce((h,p)=>(h.field.push(p),h.order.push("y"===s?"descending":"ascending"),h),{field:[],order:[]}),new lu(t,{dimensionFieldDefs:l,stackField:n.vgField(s),facetby:[],stackby:c,sort:d,offset:a,impute:u,as:[n.vgField(s,{suffix:"start",forAs:!0}),n.vgField(s,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${$e(this._stack)}`}getGroupbyFields(){const{dimensionFieldDefs:t,impute:n,groupby:r}=this._stack;return t.length>0?t.map(i=>i.bin?n?[q(i,{binSuffix:"mid"})]:[q(i,{}),q(i,{binSuffix:"end"})]:[q(i)]).flat():null!=r?r:[]}assemble(){const t=[],{facetby:n,dimensionFieldDefs:r,stackField:i,stackby:o,sort:s,offset:a,impute:u,as:l}=this._stack;if(u)for(const c of r){const{bandPosition:f=.5,bin:d}=c;if(d){const h=q(c,{expr:"datum"}),p=q(c,{expr:"datum",binSuffix:"end"});t.push({type:"formula",expr:`${f}*${h}+${1-f}*${p}`,as:q(c,{binSuffix:"mid",forAs:!0})})}t.push({type:"impute",field:i,groupby:[...o,...n],key:q(c,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:i,sort:s,as:l,offset:a}),t}}class op extends pt{constructor(t,n){super(t),this.transform=n}clone(){return new op(null,we(this.transform))}addDimensions(t){this.transform.groupby=Ws(this.transform.groupby.concat(t),n=>n)}dependentFields(){var t,n;const r=new Set;return(null!==(t=this.transform.groupby)&&void 0!==t?t:[]).forEach(r.add,r),(null!==(n=this.transform.sort)&&void 0!==n?n:[]).forEach(i=>r.add(i.field)),this.transform.window.map(i=>i.field).filter(i=>void 0!==i).forEach(r.add,r),r}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){var n;return null!==(n=t.as)&&void 0!==n?n:q(t)}hash(){return`WindowTransform ${$e(this.transform)}`}assemble(){var t;const n=[],r=[],i=[],o=[];for(const d of this.transform.window)r.push(d.op),i.push(this.getDefaultName(d)),o.push(void 0===d.param?null:d.param),n.push(void 0===d.field?null:d.field);const s=this.transform.frame,a=this.transform.groupby;if(s&&null===s[0]&&null===s[1]&&r.every(d=>HI(d)))return Object.assign({type:"joinaggregate",as:i,ops:r,fields:n},void 0!==a?{groupby:a}:{});const u=[],l=[];if(void 0!==this.transform.sort)for(const d of this.transform.sort)u.push(d.field),l.push(null!==(t=d.order)&&void 0!==t?t:"ascending");const f=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:o,as:i,ops:r,fields:n,sort:{field:u,order:l}},void 0!==f?{ignorePeers:f}:{}),void 0!==a?{groupby:a}:{}),void 0!==s?{frame:s}:{})}}function _R(e){if(e instanceof ip)if(1!==e.numChildren()||e.children[0]instanceof Lr){const t=e.model.component.data.main;BK(t);const n=function(e){return function t(n){if(!(n instanceof ip)){const r=n.clone();if(r instanceof Lr){const i=wR+r.getSource();r.setSource(i),e.model.component.data.outputNodes[i]=r}else(r instanceof Jo||r instanceof lu||r instanceof op||r instanceof hf)&&r.addDimensions(e.fields);for(const i of n.children.flatMap(t))i.parent=r;return[r]}return n.children.flatMap(t)}}(e),r=e.children.map(n).flat();for(const i of r)i.parent=t}else{const t=e.children[0];(t instanceof Jo||t instanceof lu||t instanceof op||t instanceof hf)&&t.addDimensions(e.fields),t.swapWithParent(),_R(e)}else e.children.map(_R)}function BK(e){if(e instanceof Lr&&e.type===bt.Main&&1===e.numChildren()){const t=e.children[0];t instanceof ip||(t.swapWithParent(),BK(e))}}const wR="scale_";function xR(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return!1;if(!xR(t.children))return!1}return!0}function es(e,t){let n=!1;for(const r of t)n=e.optimize(r)||n;return n}function zK(e,t,n){let r=e.sources,i=!1;return i=es(new a3e,r)||i,i=es(new o3e(t),r)||i,r=r.filter(o=>o.numChildren()>0),i=es(new c3e,r)||i,r=r.filter(o=>o.numChildren()>0),n||(i=es(new u3e,r)||i,i=es(new h3e(t),r)||i,i=es(new s3e,r)||i,i=es(new l3e,r)||i,i=es(new d3e,r)||i,i=es(new f3e,r)||i,i=es(new i3e,r)||i,i=es(new p3e,r)||i),e.sources=r,i}class ui{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,n){return new ui(()=>t(n))}}function UK(e){an(e)?function(e){const t=e.component.scales;for(const n of P(t)){const r=E3e(e,n);if(t[n].setWithExplicit("domains",r),C3e(e,n),e.component.data.isFaceted){let o=e;for(;!ts(o)&&o.parent;)o=o.parent;if("shared"===o.component.resolve.scale[n])for(const a of r.value)iu(a)&&(a.data=wR+a.data.replace(wR,""))}}}(e):function(e){for(const n of e.children)UK(n);const t=e.component.scales;for(const n of P(t)){let r,i=null;for(const o of e.children){const s=o.component.scales[n];if(s){r=void 0===r?s.getWithExplicit("domains"):Fl(r,s.getWithExplicit("domains"),"domains","scale",CR);const a=s.get("selectionExtent");i&&a&&i.param!==a.param&&$("The same selection must be used to override scale domains in a layered view."),i=a}}t[n].setWithExplicit("domains",r),i&&t[n].set("selectionExtent",i,!0)}}(e)}function E3e(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:r}=e,i=function(e,t,n,r){if("unaggregated"===e){const{valid:i,reason:o}=HK(t,n);if(!i)return void $(o)}else if(void 0===e&&r.useUnaggregatedDomain){const{valid:i}=HK(t,n);if(i)return"unaggregated"}return e}(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return i!==e.scaleDomain(t)&&(e.specifiedScales[t]=Object.assign(Object.assign({},e.specifiedScales[t]),{domain:i})),"x"===t&&bn(r.x2)?bn(r.x)?Fl($l(n,i,e,"x"),$l(n,i,e,"x2"),"domain","scale",CR):$l(n,i,e,"x2"):"y"===t&&bn(r.y2)?bn(r.y)?Fl($l(n,i,e,"y"),$l(n,i,e,"y2"),"domain","scale",CR):$l(n,i,e,"y2"):$l(n,i,e,t)}function ER(e,t,n){var r;const i=null===(r=Pr(n))||void 0===r?void 0:r.unit;return"temporal"===t||i?function(e,t,n){return e.map(r=>({signal:`{data: ${Gw(r,{timeUnit:n,type:t})}}`}))}(e,t,i):[e]}function $l(e,t,n,r){const{encoding:i}=n,o=bn(i[r]),{type:s}=o,a=o.timeUnit;if(function(e){return e&&e.unionWith}(t)){const f=$l(e,void 0,n,r),d=ER(t.unionWith,s,a);return aa([...f.value,...d])}if(ie(t))return aa([t]);if(t&&"unaggregated"!==t&&!eX(t))return aa(ER(t,s,a));const u=n.stack;if(u&&r===u.fieldChannel){if("normalize"===u.offset)return Ri([[0,1]]);const f=n.requestDataName(bt.Main);return Ri([{data:f,field:n.vgField(r,{suffix:"start"})},{data:f,field:n.vgField(r,{suffix:"end"})}])}const l=Cl(r)&&V(o)?function(e,t,n){if(!Mn(n))return;const r=e.fieldDef(t),i=r.sort;if(bX(i))return{op:"min",field:np(r,t),order:"ascending"};const{stack:o}=e,s=o?new Set([...o.groupbyFields,...o.stackBy.map(a=>a.fieldDef.field)]):void 0;if(na(i))return DR(i,o&&!s.has(i.field));if(vX(i)){const{encoding:a,order:u}=i,l=e.fieldDef(a),{aggregate:c,field:f}=l,d=o&&!s.has(f);if(ru(c)||Sl(c))return DR({field:q(l),order:u},d);if(HI(c)||!c)return DR({op:c,field:f,order:u},d)}else{if("descending"===i)return{op:"min",field:e.vgField(t),order:"descending"};if(Be(["ascending",void 0],i))return!0}}(n,r,e):void 0;if(ra(o))return Ri(ER([o.datum],s,a));const c=o;if("unaggregated"===t){const f=n.requestDataName(bt.Main),{field:d}=o;return Ri([{data:f,field:q({field:d,aggregate:"min"})},{data:f,field:q({field:d,aggregate:"max"})}])}if(Dt(c.bin)){if(Mn(e))return Ri("bin-ordinal"===e?[]:[{data:w0(l)?n.requestDataName(bt.Main):n.requestDataName(bt.Raw),field:n.vgField(r,N0(c,r)?{binSuffix:"range"}:{}),sort:!0!==l&&J(l)?l:{field:n.vgField(r,{}),op:"min"}}]);{const{bin:f}=c;if(Dt(f)){const d=mR(n,c.field,f);return Ri([new ui(()=>{const h=n.getSignalName(d);return`[${h}.start, ${h}.stop]`})])}return Ri([{data:n.requestDataName(bt.Main),field:n.vgField(r,{})}])}}if(c.timeUnit&&Be(["time","utc"],e)&&EX(c,an(n)?n.encoding[nu(r)]:void 0,n.markDef,n.config)){const f=n.requestDataName(bt.Main);return Ri([{data:f,field:n.vgField(r)},{data:f,field:n.vgField(r,{suffix:"end"})}])}return Ri(l?[{data:w0(l)?n.requestDataName(bt.Main):n.requestDataName(bt.Raw),field:n.vgField(r),sort:l}]:[{data:n.requestDataName(bt.Main),field:n.vgField(r)}])}function DR(e,t){const{op:n,field:r,order:i}=e;return Object.assign(Object.assign({op:null!=n?n:t?"sum":Lw},r?{field:ao(r)}:{}),i?{order:i}:{})}function C3e(e,t){var n;const r=e.component.scales[t],i=e.specifiedScales[t].domain,o=null===(n=e.fieldDef(t))||void 0===n?void 0:n.bin,s=eX(i)&&i,a=ef(o)&&Cw(o.extent)&&o.extent;(s||a)&&r.set("selectionExtent",null!=s?s:a,!0)}function HK(e,t){const{aggregate:n,type:r}=e;return n?Y(n)&&!oFe.has(n)?{valid:!1,reason:XFe(n)}:"quantitative"===r&&"log"===t?{valid:!1,reason:QFe(e)}:{valid:!0}:{valid:!1,reason:YFe(e)}}function CR(e,t,n,r){return e.explicit&&t.explicit&&$(function(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${Et(n)} and ${Et(r)}). Using the union of the two domains.`}(n,r,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function SR(e){if(iu(e)&&Y(e.field))return e.field;if(function(e){return!R(e)&&"fields"in e&&!("data"in e)}(e)){let t;for(const n of e.fields)if(iu(n)&&Y(n.field))if(t){if(t!==n.field)return $("Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect."),t}else t=n.field;return $("Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect."),t}if(function(e){return!R(e)&&"fields"in e&&"data"in e}(e)){$("Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.");const t=e.fields[0];return Y(t)?t:void 0}}function gx(e,t){return function(e){const t=Ws(e.map(s=>iu(s)?function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(s,["sort"]):s),$e),n=Ws(e.map(s=>{if(iu(s)){const a=s.sort;return void 0!==a&&!w0(a)&&("op"in a&&"count"===a.op&&delete a.field,"ascending"===a.order&&delete a.order),a}}).filter(s=>void 0!==s),$e);if(0===t.length)return;if(1===t.length){const s=e[0];if(iu(s)&&n.length>0){let a=n[0];return n.length>1?($(PY),a=!0):J(a)&&"field"in a&&s.field===a.field&&(a=!a.order||{order:a.order}),Object.assign(Object.assign({},s),{sort:a})}return s}const r=Ws(n.map(s=>w0(s)||!("op"in s)||Y(s.op)&&s.op in tFe?s:($(function(e){return`Dropping sort property ${Et(e)} as unioned domains only support boolean or op "count", "min", and "max".`}(s)),!0)),$e);let i;1===r.length?i=r[0]:r.length>1&&($(PY),i=!0);const o=Ws(e.map(s=>iu(s)?s.data:null),s=>s);return Object.assign(1===o.length&&null!==o[0]?{data:o[0],fields:t.map(a=>a.field)}:{fields:t},i?{sort:i}:{})}(e.component.scales[t].get("domains").map(i=>(iu(i)&&(i.data=e.lookupDataSource(i.data)),i)))}function VK(e){return sp(e)||MR(e)?e.children.reduce((t,n)=>t.concat(VK(n)),qK(e)):qK(e)}function qK(e){return P(e.component.scales).reduce((t,n)=>{const r=e.component.scales[n];if(r.merged)return t;const i=r.combine(),{name:o,type:s,selectionExtent:a,reverse:c}=i,f=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(i,["name","type","selectionExtent","domains","range","reverse"]),d=function(e,t,n,r){if(Vn(n)){if(Ol(e))return{step:{signal:`${t}_step`}}}else if(J(e)&&iu(e))return Object.assign(Object.assign({},e),{data:r.lookupDataSource(e.data)});return e}(i.range,o,n,e),h=gx(e,n),p=a?function(e,t,n,r){const i=uK(e,t.param,t);return{signal:Fi(n.get("type"))&&R(r)&&r[0]>r[1]?`isValid(${i}) && reverse(${i})`:i}}(e,a,r,h):null;return t.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:o,type:s},h?{domain:h}:{}),p?{domainRaw:p}:{}),{range:d}),void 0!==c?{reverse:c}:{}),f)),t},[])}class WK extends uu{constructor(t,n){super({},{name:t}),this.merged=!1,this.setWithExplicit("type",n)}domainDefinitelyIncludesZero(){return!1!==this.get("zero")||Xc(this.get("domains"),t=>R(t)&&2===t.length&&t[0]<=0&&t[1]>=0)}}const T3e=["range","scheme"];function GK(e,t){const n=e.fieldDef(t);if(null==n?void 0:n.bin){const{bin:r,field:i}=n,o=oi(t),s=e.getName(o);if(J(r)&&r.binned&&void 0!==r.step)return new ui(()=>{const a=e.scaleName(t),u=`(domain("${a}")[1] - domain("${a}")[0]) / ${r.step}`;return`${e.getSignalName(s)} / (${u})`});if(Dt(r)){const a=mR(e,i,r);return new ui(()=>{const u=e.getSignalName(a),l=`(${u}.stop - ${u}.start) / ${u}.step`;return`${e.getSignalName(s)} / (${l})`})}}}function I3e(e,t){const n=t.specifiedScales[e],{size:r}=t,o=t.getScaleComponent(e).get("type");for(const f of T3e)if(void 0!==n[f]){const d=fF(o,f),h=tX(e,f);if(d)if(h)$(h);else switch(f){case"range":{const p=n.range;if(R(p)){if(Vn(e))return aa(p.map(g=>{if("width"===g||"height"===g){const m=t.getName(g),v=t.getSignalName.bind(t);return ui.fromName(v,m)}return g}))}else if(J(p))return aa({data:t.requestDataName(bt.Main),field:p.field,sort:{op:"min",field:t.vgField(e)}});return aa(p)}case"scheme":return aa(F3e(n[f]))}else $(RY(o,f,e))}const s=e===Rt||"xOffset"===e?"width":"height",a=r[s];if(sa(a))if(Vn(e))if(Mn(o)){const f=YK(a,t,e);if(f)return aa({step:f})}else $(NY(s));else if(Bh(e)&&"band"===t.getScaleComponent(e===bl?"x":"y").get("type")){const p=XK(a,o);if(p)return aa(p)}const{rangeMin:u,rangeMax:l}=n,c=function(e,t){const{size:n,config:r,mark:i,encoding:o}=t,s=t.getSignalName.bind(t),{type:a}=bn(o[e]),l=t.getScaleComponent(e).get("type"),{domain:c,domainMid:f}=t.specifiedScales[e];switch(e){case Rt:case On:{if(Be(["point","band"],l)){const p=QK(e,n,r.view);if(sa(p))return{step:YK(p,t,e)}}const d=oi(e),h=t.getName(d);return e===On&&Fi(l)?[ui.fromName(s,h),0]:[0,ui.fromName(s,h)]}case bl:case jh:return function(e,t,n){const r=e===bl?"x":"y",o=t.getScaleComponent(r).get("type"),s=t.scaleName(r);if("band"===o){const a=QK(r,t.size,t.config.view);if(sa(a)){const u=XK(a,n);if(u)return u}return[0,{signal:`bandwidth('${s}')`}]}return GG(`Cannot use ${e} scale if ${r} scale is not discrete.`)}(e,t,l);case eu:{const h=KK(i,t.component.scales[e].get("zero"),r),p=function(e,t,n,r){const i={x:GK(n,"x"),y:GK(n,"y")};switch(e){case"bar":case"tick":{if(void 0!==r.scale.maxBandSize)return r.scale.maxBandSize;const o=JK(t,i,r.view);return ft(o)?o-1:new ui(()=>`${o.signal} - 1`)}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;const o=JK(t,i,r.view);return ft(o)?Math.pow(.95*o,2):new ui(()=>`pow(0.95 * ${o.signal}, 2)`)}}throw new Error(Aw("size",e))}(i,n,t,r);return Hh(l)?function(e,t,n){const r=()=>{const i=ou(t),o=ou(e),s=`(${i} - ${o}) / (${n} - 1)`;return`sequence(${o}, ${i} + ${s}, ${s})`};return ie(t)?new ui(r):{signal:r()}}(h,p,function(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return void 0!==n&&R(n)?n.length+1:($(function(e){return`Domain for ${e} is required for threshold scale.`}(r)),3)}}(l,r,c,e)):[h,p]}case Yo:return[0,2*Math.PI];case Kc:return[0,360];case Ys:return[0,new ui(()=>`min(${t.getSignalName("width")},${t.getSignalName("height")})/2`)];case xl:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case El:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case ii:return"symbol";case ri:case Ks:case Zs:return"ordinal"===l?"nominal"===a?"category":"ordinal":void 0!==f?"diverging":"rect"===i||"geoshape"===i?"heatmap":"ramp";case tu:case _l:case wl:return[r.scale.minOpacity,r.scale.maxOpacity]}}(e,t);return(void 0!==u||void 0!==l)&&fF(o,"rangeMin")&&R(c)&&2===c.length?aa([null!=u?u:c[0],null!=l?l:c[1]]):Ri(c)}function F3e(e){return function(e){return!Y(e)&&!!e.name}(e)?Object.assign({scheme:e.name},ki(e,["name"])):{scheme:e}}function YK(e,t,n){var r,i,o,s,a;const{encoding:u}=t,l=t.getScaleComponent(n),c=aY(n),f=u[c];if("offset"===iQ({step:e,offsetIsDiscrete:ye(f)&&YY(f.type)})&&LX(u,c)){const h=t.getScaleComponent(c);let g=`domain('${t.scaleName(c)}').length`;"band"===h.get("type")&&(g=`bandspace(${g}, ${null!==(i=null!==(r=h.get("paddingInner"))&&void 0!==r?r:h.get("padding"))&&void 0!==i?i:0}, ${null!==(s=null!==(o=h.get("paddingOuter"))&&void 0!==o?o:h.get("padding"))&&void 0!==s?s:0})`);const m=null!==(a=l.get("paddingInner"))&&void 0!==a?a:l.get("padding");return{signal:`${e.step} * ${g} / (1-${fFe(m)})`}}return e.step}function XK(e,t){if("offset"===iQ({step:e,offsetIsDiscrete:Mn(t)}))return{step:e.step}}function QK(e,t,n){const r=e===Rt?"width":"height";return t[r]||tx(n,r)}function KK(e,t,n){if(t)return ie(t)?{signal:`${t.signal} ? 0 : ${KK(e,!1,n)}`}:0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(Aw("size",e))}function JK(e,t,n){const r=sa(e.width)?e.width.step:ex(n,"width"),i=sa(e.height)?e.height.step:ex(n,"height");return t.x||t.y?new ui(()=>`min(${[t.x?t.x.signal:r,t.y?t.y.signal:i].join(", ")})`):Math.min(r,i)}function eZ(e,t){an(e)?function(e,t){const n=e.component.scales,{config:r,encoding:i,markDef:o,specifiedScales:s}=e;for(const a of P(n)){const u=s[a],l=n[a],c=e.getScaleComponent(a),f=bn(i[a]),d=u[t],h=c.get("type"),p=c.get("padding"),g=c.get("paddingInner"),m=fF(h,t),v=tX(a,t);if(void 0!==d&&(m?v&&$(v):$(RY(h,t,a))),m&&void 0===v)if(void 0!==d){const y=f.timeUnit,b=f.type;switch(t){case"domainMax":case"domainMin":nf(u[t])||"temporal"===b||y?l.set(t,{signal:Gw(u[t],{type:b,timeUnit:y})},!0):l.set(t,u[t],!0);break;default:l.copyKeyFromObject(t,u)}}else{const y=t in tZ?tZ[t]({model:e,channel:a,fieldOrDatumDef:f,scaleType:h,scalePadding:p,scalePaddingInner:g,domain:u.domain,domainMin:u.domainMin,domainMax:u.domainMax,markDef:o,config:r,hasNestedOffsetScale:AF(i,a)}):r.scale[t];void 0!==y&&l.set(t,y,!1)}}}(e,t):rZ(e,t)}const tZ={bins:({model:e,fieldOrDatumDef:t})=>V(t)?function(e,t){const n=t.bin;if(Dt(n)){const r=mR(e,t.field,n);return new ui(()=>e.getSignalName(r))}if(Nr(n)&&ef(n)&&void 0!==n.step)return{step:n.step}}(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>function(e,t){if(Be([ri,Ks,Zs],e)&&"nominal"!==t)return"hcl"}(e,t.type),nice:({scaleType:e,channel:t,domain:n,domainMin:r,domainMax:i,fieldOrDatumDef:o})=>function(e,t,n,r,i,o){var s;if(!((null===(s=oa(o))||void 0===s?void 0:s.bin)||R(n)||null!=i||null!=r||Be(["time","utc"],e)))return!!Vn(t)||void 0}(e,t,n,r,i,o),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:r,config:i})=>function(e,t,n,r,i,o){if(Vn(e)){if(Qo(t)){if(void 0!==n.continuousPadding)return n.continuousPadding;const{type:s,orient:a}=i;if("bar"===s&&(!V(r)||!r.bin&&!r.timeUnit)&&("vertical"===a&&"x"===e||"horizontal"===a&&"y"===e))return o.continuousBandSize}if("point"===t)return n.pointPadding}}(e,t,i.scale,n,r,i.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,scaleType:r,config:i,hasNestedOffsetScale:o})=>function(e,t,n,r,i,o=!1){if(void 0===e){if(Vn(t)){const{bandPaddingInner:s,barBandPaddingInner:a,rectBandPaddingInner:u,bandWithNestedOffsetPaddingInner:l}=i;return o?l:sn(s,"bar"===n?a:u)}if(Bh(t)&&"band"===r)return i.offsetBandPaddingInner}}(e,t,n.type,r,i.scale,o),paddingOuter:({scalePadding:e,channel:t,scaleType:n,scalePaddingInner:r,config:i,hasNestedOffsetScale:o})=>function(e,t,n,r,i,o=!1){if(void 0===e)if(Vn(t)){const{bandPaddingOuter:s,bandWithNestedOffsetPaddingOuter:a}=i;if(o)return a;if("band"===n)return sn(s,ie(r)?{signal:`${r.signal}/2`}:r/2)}else if(Bh(t)){if("point"===n)return.5;if("band"===n)return i.offsetBandPaddingOuter}}(e,t,n,r,i.scale,o),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:r})=>function(e,t,n,r){return"x"===n&&void 0!==r.xReverse?Fi(e)&&"descending"===t?ie(r.xReverse)?{signal:`!${r.xReverse.signal}`}:!r.xReverse:r.xReverse:!(!Fi(e)||"descending"!==t)||void 0}(t,V(e)?e.sort:void 0,n,r.scale),zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:r,scaleType:i})=>function(e,t,n,r,i){if(n&&"unaggregated"!==n&&Fi(i)){if(R(n)){const a=n[n.length-1];if(n[0]<=0&&a>=0)return!0}return!1}if("size"===e&&"quantitative"===t.type&&!Hh(i))return!0;if((!V(t)||!t.bin)&&Be([...Js,...GIe],e)){const{orient:s,type:a}=r;return!(Be(["bar","area","line","trail"],a)&&("horizontal"===s&&"y"===e||"vertical"===s&&"x"===e))}return!1}(e,t,n,r,i)};function nZ(e){an(e)?function(e){const t=e.component.scales;for(const n of Dw){const r=t[n];if(!r)continue;const i=I3e(n,e);r.setWithExplicit("range",i)}}(e):rZ(e,"range")}function rZ(e,t){const n=e.component.scales;for(const r of e.children)"range"===t?nZ(r):eZ(r,t);for(const r of P(n)){let i;for(const o of e.children){const s=o.component.scales[r];s&&(i=Fl(i,s.getWithExplicit(t),t,"scale",kQ((u,l)=>"range"===t&&u.step&&l.step?u.step-l.step:0)))}n[r].setWithExplicit(t,i)}}function Y3e(e,t,n,r,i=!1){const o=function(e,t,n,r){var i;switch(t.type){case"nominal":case"ordinal":if($h(e)||"discrete"===UI(e))return"shape"===e&&"ordinal"===t.type&&$(XI(e,"ordinal")),"ordinal";if(Vn(e)||Bh(e)){if(Be(["rect","bar","image","rule"],n.type)||r)return"band"}else if("arc"===n.type&&e in $I)return"band";return Vh(n[oi(e)])||EF(t)&&(null===(i=t.axis)||void 0===i?void 0:i.tickBand)?"band":"point";case"temporal":return $h(e)?"time":"discrete"===UI(e)?($(XI(e,"temporal")),"ordinal"):V(t)&&t.timeUnit&&Pr(t.timeUnit).utc?"utc":"time";case"quantitative":return $h(e)?V(t)&&Dt(t.bin)?"bin-ordinal":"linear":"discrete"===UI(e)?($(XI(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(IY(t.type))}(t,n,r,i),{type:s}=e;return Cl(t)?void 0!==s?function(e,t,n=!1){if(!Cl(e))return!1;switch(e){case Rt:case On:case bl:case jh:case Yo:case Ys:return!(!Qo(t)&&"band"!==t)||"point"===t&&!n;case eu:case xl:case tu:case _l:case wl:case Kc:return Qo(t)||Hh(t)||Be(["band","point","ordinal"],t);case ri:case Ks:case Zs:return"band"!==t;case El:case ii:return"ordinal"===t||Hh(t)}}(t,s)?V(n)&&!function(e,t){return Be([uF,lF],t)?void 0===e||Mn(e):t===zh?Be(["time","utc",void 0],e):t!==of||ZY(e)||Hh(e)||void 0===e}(s,n.type)?($(function(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}(s,o)),o):s:($(function(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}(t,s,o)),o):o:null}function iZ(e){e.component.scales=an(e)?function(e){const{encoding:t,mark:n,markDef:r}=e,i={};for(const o of Dw){const s=bn(t[o]);if(s&&n===iX&&o===ii&&s.type===Uh)continue;let a=s&&s.scale;if(!Bh(o)||AF(t,uY(o))){if(s&&null!==a&&!1!==a){null!=a||(a={});const l=Y3e(a,o,s,r,AF(t,o));i[o]=new WK(e.scaleName(`${o}`,!0),{value:l,explicit:a.type===l})}}else a&&$(jFe(o))}return i}(e):function(e){var t,n;const r=e.component.scales={},i={},o=e.component.resolve;for(const s of e.children){iZ(s);for(const a of P(s.component.scales))if(null!==(t=(n=o.scale)[a])&&void 0!==t||(n[a]=xK(a,e)),"shared"===o.scale[a]){const u=i[a],l=s.component.scales[a].getWithExplicit("type");u?zRe(u.value,l.value)?i[a]=Fl(u,l,"type","scale",Z3e):(o.scale[a]="independent",delete i[a]):i[a]=l}}for(const s of P(i)){const a=e.scaleName(s,!0);r[s]=new WK(a,i[s]);for(const l of e.children){const c=l.component.scales[s];c&&(l.renameScale(c.get("name"),a),c.merged=!0)}}return r}(e)}const Z3e=kQ((e,t)=>XY(e)-XY(t));var AR=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};class OR{constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return void 0!==this.nameMap[t]}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function an(e){return"unit"===(null==e?void 0:e.type)}function ts(e){return"facet"===(null==e?void 0:e.type)}function MR(e){return"concat"===(null==e?void 0:e.type)}function sp(e){return"layer"===(null==e?void 0:e.type)}class TR{constructor(t,n,r,i,o,s,a){var u,l;this.type=n,this.parent=r,this.config=o,this.correctDataNames=c=>{var f,d,h;return(null===(f=c.from)||void 0===f?void 0:f.data)&&(c.from.data=this.lookupDataSource(c.from.data)),(null===(h=null===(d=c.from)||void 0===d?void 0:d.facet)||void 0===h?void 0:h.data)&&(c.from.facet.data=this.lookupDataSource(c.from.facet.data)),c},this.parent=r,this.config=o,this.view=si(a),this.name=null!==(u=t.name)&&void 0!==u?u:i,this.title=Al(t.title)?{text:t.title}:t.title?si(t.title):void 0,this.scaleNameMap=r?r.scaleNameMap:new OR,this.projectionNameMap=r?r.projectionNameMap:new OR,this.signalNameMap=r?r.signalNameMap:new OR,this.data=t.data,this.description=t.description,this.transforms=function(e){return e.map(t=>GF(t)?{filter:Nh(t.filter,LRe)}:t)}(null!==(l=t.transform)&&void 0!==l?l:[]),this.layout="layer"===n||"unit"===n?{}:function(e,t,n){var r,i;const o=n[t],s={},{spacing:a,columns:u}=o;void 0!==a&&(s.spacing=a),void 0!==u&&(jw(e)&&!F0(e.facet)||BF(e))&&(s.columns=u),Jw(e)&&(s.columns=1);for(const l of sPe)if(void 0!==e[l])if("spacing"===l){const c=e[l];s[l]=ft(c)?c:{row:null!==(r=c.row)&&void 0!==r?r:a,column:null!==(i=c.column)&&void 0!==i?i:a}}else s[l]=e[l];return s}(t,n,o),this.component={data:{sources:r?r.component.data.sources:[],outputNodes:r?r.component.data.outputNodes:{},outputNodeRefCounts:r?r.component.data.outputNodeRefCounts:{},isFaceted:jw(t)||(null==r?void 0:r.component.data.isFaceted)&&void 0===t.data},layoutSize:new uu,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},s?we(s):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){!function(e,{ignoreRange:t}={}){iZ(e),UK(e);for(const n of QRe)eZ(e,n);t||nZ(e)}(this)}parseProjection(){NK(this)}renameTopLevelLayoutSizeSignal(){"width"!==this.getName("width")&&this.renameSignal(this.getName("width"),"width"),"height"!==this.getName("height")&&this.renameSignal(this.getName("height"),"height")}parseLegends(){TK(this)}assembleEncodeFromView(t){const r=AR(t,["style"]),i={};for(const o of P(r)){const s=r[o];void 0!==s&&(i[o]=Ot(s))}return i}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),t||(this.description&&(n.description=Ot(this.description)),"unit"!==this.type&&"layer"!==this.type)?ht(n)?void 0:n:Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},null!=n?n:{})}assembleLayout(){if(!this.layout)return;const t=this.layout,{spacing:n}=t,r=AR(t,["spacing"]),{component:i,config:o}=this,s=function(e,t){const n={};for(const r of lo){const i=e[r];if(null==i?void 0:i.facetFieldDef){const{titleAnchor:o,titleOrient:s}=dx(["titleAnchor","titleOrient"],i.facetFieldDef.header,t,r),a=fx(r,s),u=gje(o,a);void 0!==u&&(n[a]=u)}}return ht(n)?void 0:n}(i.layoutHeaders,o);return Object.assign(Object.assign(Object.assign({padding:n},this.assembleDefaultLayout()),r),s?{titleBand:s}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let n=[];for(const r of lo)t[r].title&&n.push(cje(this,r));for(const r of cR)n=n.concat(fje(this,r));return n}assembleAxes(){return function(e,t){const{x:n=[],y:r=[]}=e;return[...n.map(i=>U0(i,"grid",t)),...r.map(i=>U0(i,"grid",t)),...n.map(i=>U0(i,"main",t)),...r.map(i=>U0(i,"main",t))].filter(i=>i)}(this.component.axes,this.config)}assembleLegends(){return IK(this)}assembleProjections(){return function(e){return sp(e)||MR(e)?function(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),FK(e))}(e):FK(e)}(this)}assembleTitle(){var t,n,r;const i=null!==(t=this.title)&&void 0!==t?t:{},{encoding:o}=i,s=AR(i,["encoding"]),a=Object.assign(Object.assign(Object.assign({},pY(this.config.title).nonMarkTitleProperties),s),o?{encode:{update:o}}:{});if(a.text)return Be(["unit","layer"],this.type)?Be(["middle",void 0],a.anchor)&&(null!==(n=a.frame)&&void 0!==n||(a.frame="group")):null!==(r=a.anchor)&&void 0!==r||(a.anchor="start"),ht(a)?void 0:a}assembleGroup(t=[]){const n={};(t=t.concat(this.assembleSignals())).length>0&&(n.signals=t);const r=this.assembleLayout();r&&(n.layout=r),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const i=!this.parent||ts(this.parent)?VK(this):[];i.length>0&&(n.scales=i);const o=this.assembleAxes();o.length>0&&(n.axes=o);const s=this.assembleLegends();return s.length>0&&(n.legends=s),n}getName(t){return kt((this.name?`${this.name}_`:"")+t)}getDataName(t){return this.getName(bt[t].toLowerCase())}requestDataName(t){const n=this.getDataName(t),r=this.component.data.outputNodeRefCounts;return r[n]=(r[n]||0)+1,n}getSizeSignalRef(t){if(ts(this.parent)){const r=Ew(_K(t)),i=this.component.scales[r];if(i&&!i.merged){const o=i.get("type"),s=i.get("range");if(Mn(o)&&Ol(s)){const a=i.get("name"),l=SR(gx(this,r));return l?{signal:bK(a,i,q({aggregate:"distinct",field:l},{expr:"datum"}))}:($(GI(r)),null)}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){return n?this.getName(t):oY(t)&&Cl(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t))?this.scaleNameMap.get(this.getName(t)):void 0}projectionName(t){return t?this.getName("projection"):this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))?this.projectionNameMap.get(this.getName("projection")):void 0}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getSelectionComponent(t,n){let r=this.component.selection[t];if(!r&&this.parent&&(r=this.parent.getSelectionComponent(t,n)),!r)throw new Error(function(e){return`Cannot find a selection named "${e}".`}(n));return r}hasAxisOrientSignalRef(){var t,n;return(null===(t=this.component.axes.x)||void 0===t?void 0:t.some(r=>r.hasOrientSignalRef()))||(null===(n=this.component.axes.y)||void 0===n?void 0:n.some(r=>r.hasOrientSignalRef()))}}class oZ extends TR{vgField(t,n={}){const r=this.fieldDef(t);if(r)return q(r,n)}reduceFieldDef(t,n){return function(e,t,n,r){return e?P(e).reduce((i,o)=>{const s=e[o];return R(s)?s.reduce((a,u)=>t.call(r,a,u,o),i):t.call(r,i,s,o)},n):n}(this.getMapping(),(r,i,o)=>{const s=oa(i);return s?t(r,s,o):r},n)}forEachFieldDef(t,n){MF(this.getMapping(),(r,i)=>{const o=oa(r);o&&t(o,i)},n)}}class mx extends pt{constructor(t,n){var r,i,o;super(t),this.transform=n,this.transform=we(n);const s=null!==(r=this.transform.as)&&void 0!==r?r:[void 0,void 0];this.transform.as=[null!==(i=s[0])&&void 0!==i?i:"value",null!==(o=s[1])&&void 0!==o?o:"density"]}clone(){return new mx(null,we(this.transform))}dependentFields(){var t;return new Set([this.transform.density,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${$e(this.transform)}`}assemble(){const t=this.transform,{density:n}=t,r=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(t,["density"]);return Object.assign({type:"kde",field:n},r)}}class W0 extends pt{constructor(t,n){super(t),this.filter=n}clone(){return new W0(null,Object.assign({},this.filter))}static make(t,n){const{config:r,mark:i,markDef:o}=n;if("filter"!==st("invalid",o,r))return null;const a=n.reduceFieldDef((u,l,c)=>{const f=Cl(c)&&n.getScaleComponent(c);return f&&Fi(f.get("type"))&&"count"!==l.aggregate&&!Tl(i)&&(u[l.field]=l),u},{});return P(a).length?new W0(t,a):null}dependentFields(){return new Set(P(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${$e(this.filter)}`}assemble(){const t=P(this.filter).reduce((n,r)=>{const i=this.filter[r],o=q(i,{expr:"datum"});return null!==i&&("temporal"===i.type?n.push(`(isDate(${o}) || (isValid(${o}) && isFinite(+${o})))`):"quantitative"===i.type&&(n.push(`isValid(${o})`),n.push(`isFinite(+${o})`))),n},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}class yx extends pt{constructor(t,n){super(t),this.transform=n,this.transform=we(n);const{flatten:r,as:i=[]}=this.transform;this.transform.as=r.map((o,s)=>{var a;return null!==(a=i[s])&&void 0!==a?a:o})}clone(){return new yx(this.parent,we(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${$e(this.transform)}`}assemble(){const{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}}class vx extends pt{constructor(t,n){var r,i,o;super(t),this.transform=n,this.transform=we(n);const s=null!==(r=this.transform.as)&&void 0!==r?r:[void 0,void 0];this.transform.as=[null!==(i=s[0])&&void 0!==i?i:"key",null!==(o=s[1])&&void 0!==o?o:"value"]}clone(){return new vx(null,we(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${$e(this.transform)}`}assemble(){const{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}}class ap extends pt{constructor(t,n,r,i){super(t),this.fields=n,this.geojson=r,this.signal=i}clone(){return new ap(null,we(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;let r=0;for(const i of[[Qs,Xs],[uo,Xo]]){const o=i.map(s=>{const a=bn(n.encoding[s]);return V(a)?a.field:ra(a)?{expr:`${a.datum}`}:Zo(a)?{expr:`${a.value}`}:void 0});(o[0]||o[1])&&(t=new ap(t,o,null,n.getName("geojson_"+r++)))}if(n.channelHasField(ii)){const i=n.typedFieldDef(ii);i.type===Uh&&(t=new ap(t,null,i.field,n.getName("geojson_"+r++)))}return t}dependentFields(){var t;const n=(null!==(t=this.fields)&&void 0!==t?t:[]).filter(Y);return new Set([...this.geojson?[this.geojson]:[],...n])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${$e(this.fields)}`}assemble(){return[...this.geojson?[{type:"filter",expr:`isValid(datum["${this.geojson}"])`}]:[],Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})]}}class G0 extends pt{constructor(t,n,r,i){super(t),this.projection=n,this.fields=r,this.as=i}clone(){return new G0(null,this.projection,we(this.fields),we(this.as))}static parseAll(t,n){if(!n.projectionName())return t;for(const r of[[Qs,Xs],[uo,Xo]]){const i=r.map(s=>{const a=bn(n.encoding[s]);return V(a)?a.field:ra(a)?{expr:`${a.datum}`}:Zo(a)?{expr:`${a.value}`}:void 0}),o=r[0]===uo?"2":"";(i[0]||i[1])&&(t=new G0(t,n.projectionName(),i,[n.getName(`x${o}`),n.getName(`y${o}`)]))}return t}dependentFields(){return new Set(this.fields.filter(Y))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${$e(this.fields)} ${$e(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class pf extends pt{constructor(t,n){super(t),this.transform=n}clone(){return new pf(null,we(this.transform))}dependentFields(){var t;return new Set([this.transform.impute,this.transform.key,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:n=0,stop:r,step:i}=t;return{signal:`sequence(${[n,r,...i?[i]:[]].join(",")})`}}static makeFromTransform(t,n){return new pf(t,n)}static makeFromEncoding(t,n){const r=n.encoding,i=r.x,o=r.y;if(V(i)&&V(o)){const s=i.impute?i:o.impute?o:void 0;if(void 0===s)return;const a=i.impute?o:o.impute?i:void 0,{method:u,value:l,frame:c,keyvals:f}=s.impute,d=$X(n.mark,r);return new pf(t,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:s.field,key:a.field},u?{method:u}:{}),void 0!==l?{value:l}:{}),c?{frame:c}:{}),void 0!==f?{keyvals:f}:{}),d.length?{groupby:d}:{}))}return null}hash(){return`Impute ${$e(this.transform)}`}assemble(){const{impute:t,key:n,keyvals:r,method:i,groupby:o,value:s,frame:a=[null,null]}=this.transform,u=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:t,key:n},r?{keyvals:LPe(r)?this.processSequence(r):r}:{}),{method:"value"}),o?{groupby:o}:{}),{value:i&&"value"!==i?null:s});return i&&"value"!==i?[u,Object.assign({type:"window",as:[`imputed_${t}_value`],ops:[i],fields:[t],frame:a,ignorePeers:!1},o?{groupby:o}:{}),{type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t}]:[u]}}class bx extends pt{constructor(t,n){var r,i,o;super(t),this.transform=n,this.transform=we(n);const s=null!==(r=this.transform.as)&&void 0!==r?r:[void 0,void 0];this.transform.as=[null!==(i=s[0])&&void 0!==i?i:n.on,null!==(o=s[1])&&void 0!==o?o:n.loess]}clone(){return new bx(null,we(this.transform))}dependentFields(){var t;return new Set([this.transform.loess,this.transform.on,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${$e(this.transform)}`}assemble(){const t=this.transform,{loess:n,on:r}=t,i=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(t,["loess","on"]);return Object.assign({type:"loess",x:r,y:n},i)}}class Y0 extends pt{constructor(t,n,r){super(t),this.transform=n,this.secondary=r}clone(){return new Y0(null,we(this.transform),this.secondary)}static make(t,n,r,i){const o=n.component.data.sources,{from:s}=r;let a=null;if(function(e){return"data"in e}(s)){let u=lZ(s.data,o);u||(u=new ff(s.data),o.push(u));const l=n.getName(`lookup_${i}`);a=new Lr(u,l,bt.Lookup,n.component.data.outputNodeRefCounts),n.component.data.outputNodes[l]=a}else if(function(e){return"param"in e}(s)){const u=s.param;let l;r=Object.assign({as:u},r);try{l=n.getSelectionComponent(kt(u),u)}catch(c){throw new Error(function(e){return`Lookups can only be performed on selection parameters. "${e}" is a variable parameter.`}(u))}if(a=l.materialized,!a)throw new Error(function(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}(u))}return new Y0(t,r,a.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?X(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${$e({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t=Object.assign({values:this.transform.from.fields},this.transform.as?{as:X(this.transform.as)}:{});else{let n=this.transform.as;Y(n)||($('If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.'),n="_lookup"),t={as:[n]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},t),this.transform.default?{default:this.transform.default}:{})}}class _x extends pt{constructor(t,n){var r,i,o;super(t),this.transform=n,this.transform=we(n);const s=null!==(r=this.transform.as)&&void 0!==r?r:[void 0,void 0];this.transform.as=[null!==(i=s[0])&&void 0!==i?i:"prob",null!==(o=s[1])&&void 0!==o?o:"value"]}clone(){return new _x(null,we(this.transform))}dependentFields(){var t;return new Set([this.transform.quantile,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${$e(this.transform)}`}assemble(){const t=this.transform,{quantile:n}=t,r=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(t,["quantile"]);return Object.assign({type:"quantile",field:n},r)}}class wx extends pt{constructor(t,n){var r,i,o;super(t),this.transform=n,this.transform=we(n);const s=null!==(r=this.transform.as)&&void 0!==r?r:[void 0,void 0];this.transform.as=[null!==(i=s[0])&&void 0!==i?i:n.on,null!==(o=s[1])&&void 0!==o?o:n.regression]}clone(){return new wx(null,we(this.transform))}dependentFields(){var t;return new Set([this.transform.regression,this.transform.on,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${$e(this.transform)}`}assemble(){const t=this.transform,{regression:n,on:r}=t,i=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(t,["regression","on"]);return Object.assign({type:"regression",x:r,y:n},i)}}class xx extends pt{constructor(t,n){super(t),this.transform=n}clone(){return new xx(null,we(this.transform))}addDimensions(t){var n;this.transform.groupby=Ws((null!==(n=this.transform.groupby)&&void 0!==n?n:[]).concat(t),r=>r)}producedFields(){}dependentFields(){var t;return new Set([this.transform.pivot,this.transform.value,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}hash(){return`PivotTransform ${$e(this.transform)}`}assemble(){const{pivot:t,value:n,groupby:r,limit:i,op:o}=this.transform;return Object.assign(Object.assign(Object.assign({type:"pivot",field:t,value:n},void 0!==i?{limit:i}:{}),void 0!==o?{op:o}:{}),void 0!==r?{groupby:r}:{})}}class Ex extends pt{constructor(t,n){super(t),this.transform=n}clone(){return new Ex(null,we(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${$e(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function sZ(e){let t=0;return function n(r,i){var o;if(r instanceof ff&&!r.isGenerator&&!Xh(r.data)&&(e.push(i),i={name:null,source:i.name,transform:[]}),r instanceof pr&&(r.parent instanceof ff&&!i.source?(i.format=Object.assign(Object.assign({},null!==(o=i.format)&&void 0!==o?o:{}),{parse:r.assembleFormatParse()}),i.transform.push(...r.assembleTransforms(!0))):i.transform.push(...r.assembleTransforms())),r instanceof ip)return i.name||(i.name="data_"+t++),!i.source||i.transform.length>0?(e.push(i),r.data=i.name):r.data=i.source,void e.push(...r.assemble());switch((r instanceof H0||r instanceof V0||r instanceof W0||r instanceof ep||r instanceof tp||r instanceof G0||r instanceof Jo||r instanceof Y0||r instanceof op||r instanceof hf||r instanceof vx||r instanceof yx||r instanceof mx||r instanceof bx||r instanceof _x||r instanceof wx||r instanceof jl||r instanceof Ex||r instanceof xx)&&i.transform.push(r.assemble()),(r instanceof la||r instanceof ua||r instanceof pf||r instanceof lu||r instanceof ap)&&i.transform.push(...r.assemble()),r instanceof Lr&&(i.source&&0===i.transform.length?r.setSource(i.source):r.parent instanceof Lr?r.setSource(i.name):(i.name||(i.name="data_"+t++),r.setSource(i.name),1===r.numChildren()&&(e.push(i),i={name:null,source:i.name,transform:[]}))),r.numChildren()){case 0:r instanceof Lr&&(!i.source||i.transform.length>0)&&e.push(i);break;case 1:n(r.children[0],i);break;default:{i.name||(i.name="data_"+t++);let s=i.name;!i.source||i.transform.length>0?e.push(i):s=i.source;for(const a of r.children)n(a,{name:null,source:s,transform:[]});break}}}}function s$e(e){return"top"===e||"left"===e||ie(e)?"header":"footer"}function u$e(e,t){var n;const{facet:r,config:i,child:o,component:s}=e;if(e.channelHasField(t)){const a=r[t],u=rp("title",null,i,t);let l=qh(a,i,{allowDisabling:!0,includeDefault:void 0===u||!!u});o.component.layoutHeaders[t].title&&(l=R(l)?l.join(", "):l,l+=` / ${o.component.layoutHeaders[t].title}`,o.component.layoutHeaders[t].title=null);const c=rp("labelOrient",a.header,i,t),f=null!==a.header&&sn(null===(n=a.header)||void 0===n?void 0:n.labels,i.header.labels,!0),d=Be(["bottom","right"],c)?"footer":"header";s.layoutHeaders[t]={title:null!==a.header?l:null,facetFieldDef:a,[d]:"facet"===t?[]:[aZ(e,t,f)]}}}function aZ(e,t,n){const r="row"===t?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(r)?e.child.getSizeSignalRef(r):void 0,axes:[]}}function uZ(e,t){var n;const{child:r}=e;if(r.component.axes[t]){const{layoutHeaders:i,resolve:o}=e.component;if(o.axis[t]=pR(o,t),"shared"===o.axis[t]){const s="x"===t?"column":"row",a=i[s];for(const u of r.component.axes[t]){const l=s$e(u.get("orient"));null!==(n=a[l])&&void 0!==n||(a[l]=[aZ(e,s,!1)]);const c=U0(u,"main",e.config,{header:!0});c&&a[l][0].axes.push(c),u.mainExtracted=!0}}}}function kR(e){for(const t of e.children)t.parseLayoutSize()}function Dx(e,t){var n;const r=_K(t),i=Ew(r),o=e.component.resolve,s=e.component.layoutSize;let a;for(const u of e.children){const l=u.component.layoutSize.getWithExplicit(r),c=null!==(n=o.scale[i])&&void 0!==n?n:xK(i,e);if("independent"===c&&"step"===l.value){a=void 0;break}if(a){if("independent"===c&&a.value!==l.value){a=void 0;break}a=Fl(a,l,r,"")}else a=l}if(a){for(const u of e.children)e.renameSignal(u.getName(r),e.getName(t)),u.component.layoutSize.set(r,"merged",!1);s.setWithExplicit(t,a)}else s.setWithExplicit(t,{explicit:!1,value:void 0})}function d$e(e,t){const r=e.config,i=e.getScaleComponent("width"===t?"x":"y");if(i){const o=i.get("type"),s=i.get("range");if(Mn(o)){const a=tx(r.view,t);return Ol(s)||sa(a)?"step":a}return UF(r.view,t)}if(e.hasProjection||"arc"===e.mark)return UF(r.view,t);{const o=tx(r.view,t);return sa(o)?o.step:o}}function IR(e,t,n){return q(t,Object.assign({suffix:`by_${q(e)}`},null!=n?n:{}))}class X0 extends oZ{constructor(t,n,r,i){super(t,"facet",n,r,i,t.resolve),this.child=LR(t.spec,this,this.getName("child"),void 0,i),this.children=[this.child],this.facet=this.initFacet(t.facet)}initFacet(t){if(!F0(t))return{facet:this.initFacetFieldDef(t,"facet")};const n=P(t),r={};for(const i of n){if(![Qa,Ka].includes(i)){$(Aw(i,"facet"));break}const o=t[i];if(void 0===o.field){$(YI(o,i));break}r[i]=this.initFacetFieldDef(o,i)}return r}initFacetFieldDef(t,n){const r=SF(t,n);return r.header?r.header=si(r.header):null===r.header&&(r.header=null),r}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=Cx(this),this.child.parseData()}parseLayoutSize(){kR(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),function(e){for(const t of lo)u$e(e,t);uZ(e,"x"),uZ(e,"y")}(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){var t,n,r;const i={};for(const o of lo)for(const s of fR){const a=this.component.layoutHeaders[o],u=a[s],{facetFieldDef:l}=a;if(l){const c=rp("titleOrient",l.header,this.config,o);if(["right","bottom"].includes(c)){const f=fx(o,c);null!==(t=i.titleAnchor)&&void 0!==t||(i.titleAnchor={}),i.titleAnchor[f]="end"}}if(null==u?void 0:u[0]){const c="row"===o?"height":"width",f="header"===s?"headerBand":"footerBand";"facet"!==o&&!this.child.component.layoutSize.get(c)&&(null!==(n=i[f])&&void 0!==n||(i[f]={}),i[f][o]=.5),a.title&&(null!==(r=i.offset)&&void 0!==r||(i.offset={}),i.offset["row"===o?"rowTitle":"columnTitle"]=10)}}return i}assembleDefaultLayout(){const{column:t,row:n}=this.facet,r=t?this.columnDistinctSignal():n?1:void 0;let i="all";return(!n&&"independent"===this.component.resolve.scale.x||!t&&"independent"===this.component.resolve.scale.y)&&(i="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),r?{columns:r}:{}),{bounds:"full",align:i})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof X0))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroupStyle(){}assembleGroup(t){return this.parent&&this.parent instanceof X0?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:q(this.facet.column,{prefix:"distinct"})}}}}:{}),super.assembleGroup(t)):super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],n=[],r=[];if(this.child instanceof X0){if(this.child.channelHasField("column")){const i=q(this.child.facet.column);t.push(i),n.push("distinct"),r.push(`distinct_${i}`)}}else for(const i of Js){const o=this.child.component.scales[i];if(o&&!o.merged){const s=o.get("type"),a=o.get("range");if(Mn(s)&&Ol(a)){const l=SR(gx(this.child,i));l?(t.push(l),n.push("distinct"),r.push(`distinct_${l}`)):$(GI(i))}}}return{fields:t,ops:n,as:r}}assembleFacet(){const{name:t,data:n}=this.component.data.facetRoot,{row:r,column:i}=this.facet,{fields:o,ops:s,as:a}=this.getCardinalityAggregateForChild(),u=[];for(const c of lo){const f=this.facet[c];if(f){u.push(q(f));const{bin:d,sort:h}=f;if(Dt(d)&&u.push(q(f,{binSuffix:"end"})),na(h)){const{field:p,op:g=Lw}=h,m=IR(f,h);r&&i?(o.push(m),s.push("max"),a.push(m)):(o.push(p),s.push(g),a.push(m))}else if(R(h)){const p=np(f,c);o.push(p),s.push("max"),a.push(p)}}}const l=!!r&&!!i;return Object.assign({name:t,data:n,groupby:u},l||o.length>0?{aggregate:Object.assign(Object.assign({},l?{cross:l}:{}),o.length?{fields:o,ops:s,as:a}:{})}:{})}facetSortFields(t){const{facet:n}=this,r=n[t];return r?na(r.sort)?[IR(r,r.sort,{expr:"datum"})]:R(r.sort)?[np(r,t,{expr:"datum"})]:[q(r,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:n}=this,r=n[t];if(r){const{sort:i}=r;return[(na(i)?i.order:!R(i)&&i)||"ascending"]}return[]}assembleLabelTitle(){var t;const{facet:n,config:r}=this;if(n.facet)return dR(n.facet,"facet",r);const i={row:["top","bottom"],column:["left","right"]};for(const o of cR)if(n[o]){const s=rp("labelOrient",null===(t=n[o])||void 0===t?void 0:t.header,r,o);if(i[o].includes(s))return dR(n[o],o,r)}}assembleMarks(){const{child:t}=this,r=function(e){const t=[],n=sZ(t);for(const r of e.children)n(r,{source:e.name,name:null,transform:[]});return t}(this.component.data.facetRoot),i=t.assembleGroupEncodeEntry(!1),o=this.assembleLabelTitle()||t.assembleTitle(),s=t.assembleGroupStyle();return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},o?{title:o}:{}),s?{style:s}:{}),{from:{facet:this.assembleFacet()},sort:{field:lo.map(u=>this.facetSortFields(u)).flat(),order:lo.map(u=>this.facetSortOrder(u)).flat()}}),r.length>0?{data:r}:{}),i?{encode:{update:i}}:{}),t.assembleGroup(pLe(this,[])))]}getMapping(){return this.facet}}function lZ(e,t){var n,r,i,o;for(const s of t){const a=s.data;if(e.name&&s.hasName()&&e.name!==s.dataName)continue;const u=null===(n=e.format)||void 0===n?void 0:n.mesh,l=null===(r=a.format)||void 0===r?void 0:r.feature;if(u&&l)continue;const c=null===(i=e.format)||void 0===i?void 0:i.feature;if((c||l)&&c!==l)continue;const f=null===(o=a.format)||void 0===o?void 0:o.mesh;if(!u&&!f||u===f)if(j0(e)&&j0(a)){if(qs(e.values,a.values))return s}else if(Xh(e)&&Xh(a)){if(e.url===a.url)return s}else if(IQ(e)&&e.name===s.dataName)return s}return null}function Cx(e){var t,n,r,i,o,s,a,u,l,c;let f=function(e,t){if(e.data||!e.parent){if(null===e.data){const r=new ff({values:[]});return t.push(r),r}const n=lZ(e.data,t);if(n)return Rl(e.data)||(n.data.format=YG({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const r=new ff(e.data);return t.push(r),r}}return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}(e,e.component.data.sources);const{outputNodes:d,outputNodeRefCounts:h}=e.component.data,p=e.data,m=p&&(Rl(p)||Xh(p)||j0(p))||!e.parent?new fLe:e.parent.component.data.ancestorParse.clone();Rl(p)?(FQ(p)?f=new V0(f,p.sequence):QF(p)&&(f=new H0(f,p.graticule)),m.parseNothing=!0):null===(null===(t=null==p?void 0:p.format)||void 0===t?void 0:t.parse)&&(m.parseNothing=!0),f=null!==(n=pr.makeExplicit(f,e,m))&&void 0!==n?n:f,f=new jl(f);const v=e.parent&&sp(e.parent);(an(e)||ts(e))&&v&&(f=null!==(r=la.makeFromEncoding(f,e))&&void 0!==r?r:f),e.transforms.length>0&&(f=function(e,t,n){var r,i;let o=0;for(const s of t.transforms){let a,u;if(XPe(s))u=e=new tp(e,s),a="derived";else if(GF(s)){const l=e3e(s);u=e=null!==(r=pr.makeWithAncestors(e,{},l,n))&&void 0!==r?r:e,e=new ep(e,t,s.filter)}else if(EQ(s))u=e=la.makeFromTransform(e,s,t),a="number";else if(KPe(s))a="date",void 0===n.getWithExplicit(s.field).value&&(e=new pr(e,{[s.field]:a}),n.set(s.field,a,!1)),u=e=ua.makeFromTransform(e,s);else if(ZPe(s))u=e=Jo.makeFromTransform(e,s),a="number",oR(t)&&(e=new jl(e));else if(xQ(s))u=e=Y0.make(e,t,s,o++),a="derived";else if(WPe(s))u=e=new op(e,s),a="number";else if(GPe(s))u=e=new hf(e,s),a="number";else if(JPe(s))u=e=lu.makeFromTransform(e,s),a="derived";else if(eLe(s))u=e=new vx(e,s),a="derived";else if(YPe(s))u=e=new yx(e,s),a="derived";else if(BPe(s))u=e=new xx(e,s),a="derived";else if(qPe(s))e=new Ex(e,s);else if(QPe(s))u=e=pf.makeFromTransform(e,s),a="derived";else if(zPe(s))u=e=new mx(e,s),a="derived";else if(UPe(s))u=e=new _x(e,s),a="derived";else if(HPe(s))u=e=new wx(e,s),a="derived";else{if(!VPe(s)){$(AFe(s));continue}u=e=new bx(e,s),a="derived"}if(u&&void 0!==a)for(const l of null!==(i=u.producedFields())&&void 0!==i?i:[])n.set(l,a,!1)}return e}(f,e,m));const y=function(e){const t={};if(an(e)&&e.component.selection)for(const n of P(e.component.selection)){const r=e.component.selection[n];for(const i of r.project.items)!i.channel&&Lh(i.field)>1&&(t[i.field]="flatten")}return t}(e),b=function(e){const t={};function n(r){Gh(r)?t[r.field]="date":"quantitative"===r.type&&function(e){return Y(e)&&Be(["min","max"],e)}(r.aggregate)?t[r.field]="number":Lh(r.field)>1?r.field in t||(t[r.field]="flatten"):uf(r)&&na(r.sort)&&Lh(r.sort.field)>1&&(r.sort.field in t||(t[r.sort.field]="flatten"))}if((an(e)||ts(e))&&e.forEachFieldDef((r,i)=>{if(co(r))n(r);else{const o=Jc(i),s=e.fieldDef(o);n(Object.assign(Object.assign({},r),{type:s.type}))}}),an(e)){const{mark:r,markDef:i,encoding:o}=e;if(Tl(r)&&!e.encoding.order){const a=o["horizontal"===i.orient?"y":"x"];V(a)&&"quantitative"===a.type&&!(a.field in t)&&(t[a.field]="number")}}return t}(e);f=null!==(i=pr.makeWithAncestors(f,{},Object.assign(Object.assign({},y),b),m))&&void 0!==i?i:f,an(e)&&(f=ap.parseAll(f,e),f=G0.parseAll(f,e)),(an(e)||ts(e))&&(v||(f=null!==(o=la.makeFromEncoding(f,e))&&void 0!==o?o:f),f=null!==(s=ua.makeFromEncoding(f,e))&&void 0!==s?s:f,f=tp.parseAllForSortIndex(f,e));const _=e.getDataName(bt.Raw),w=new Lr(f,_,bt.Raw,h);if(d[_]=w,f=w,an(e)){const S=Jo.makeFromEncoding(f,e);S&&(f=S,oR(e)&&(f=new jl(f))),f=null!==(a=pf.makeFromEncoding(f,e))&&void 0!==a?a:f,f=null!==(u=lu.makeFromEncoding(f,e))&&void 0!==u?u:f}an(e)&&(f=null!==(l=W0.make(f,e))&&void 0!==l?l:f);const E=e.getDataName(bt.Main),x=new Lr(f,E,bt.Main,h);d[E]=x,f=x,an(e)&&function(e,t){var n;for(const[r,i]of vl(null!==(n=e.component.selection)&&void 0!==n?n:{})){const o=e.getName(`lookup_${r}`);e.component.data.outputNodes[o]=i.materialized=new Lr(new ep(t,e,{param:r}),o,bt.Lookup,e.component.data.outputNodeRefCounts)}}(e,x);let D=null;if(ts(e)){const S=e.getName("facet");f=null!==(c=function(e,t){const{row:n,column:r}=t;if(n&&r){let i=null;for(const o of[n,r])if(na(o.sort)){const{field:s,op:a=Lw}=o.sort;e=i=new hf(e,{joinaggregate:[{op:a,field:s,as:IR(o,o.sort,{forAs:!0})}],groupby:[q(o)]})}return i}return null}(f,e.facet))&&void 0!==c?c:f,D=new ip(f,e,S,x.getSource()),d[S]=D}return Object.assign(Object.assign({},e.component.data),{outputNodes:d,outputNodeRefCounts:h,raw:w,main:x,facetRoot:D,ancestorParse:m})}class m$e extends TR{constructor(t,n,r,i){var o,s,a,u;super(t,"concat",n,r,i,t.resolve),("shared"===(null===(s=null===(o=t.resolve)||void 0===o?void 0:o.axis)||void 0===s?void 0:s.x)||"shared"===(null===(u=null===(a=t.resolve)||void 0===a?void 0:a.axis)||void 0===u?void 0:u.y))&&$("Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415)."),this.children=this.getChildren(t).map((l,c)=>LR(l,this,this.getName(`concat_${c}`),void 0,i))}parseData(){this.component.data=Cx(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of P(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return Jw(t)?t.vconcat:zF(t)?t.hconcat:t.concat}parseLayoutSize(){!function(e){kR(e);const n=void 0===e.layout.columns?"height":"childHeight";Dx(e,1===e.layout.columns?"width":"childWidth"),Dx(e,n)}(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){const t=hR(this);for(const n of this.children)t.push(...n.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{const n=t.assembleTitle(),r=t.assembleGroupStyle(),i=t.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:t.getName("group")},n?{title:n}:{}),r?{style:r}:{}),i?{encode:{update:i}}:{}),t.assembleGroup())})}assembleGroupStyle(){}assembleDefaultLayout(){const t=this.layout.columns;return Object.assign(Object.assign({},null!=t?{columns:t}:{}),{bounds:"full",align:"each"})}}const v$e=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},FX),{labelExpr:1,encode:1}),cZ=P(v$e);class FR extends uu{constructor(t={},n={},r=!1){super(),this.explicit=t,this.implicit=n,this.mainExtracted=r}clone(){return new FR(we(this.explicit),we(this.implicit),this.mainExtracted)}hasAxisPart(t){return"axis"===t||("grid"===t||"title"===t?!!this.get(t):!function(e){return!1===e||null===e}(this.get(t)))}hasOrientSignalRef(){return ie(this.explicit.orient)}}const w$e={bottom:"top",top:"bottom",left:"right",right:"left"};function E$e(e,t){if(!e)return t.map(n=>n.clone());{if(e.length!==t.length)return;const n=e.length;for(let r=0;r<n;r++){const i=e[r],o=t[r];if(!!i!=!!o)return;if(i&&o){const s=i.getWithExplicit("orient"),a=o.getWithExplicit("orient");if(s.explicit&&a.explicit&&s.value!==a.value)return;e[r]=D$e(i,o)}}}return e}function D$e(e,t){for(const n of cZ){const r=Fl(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(i,o)=>{switch(n){case"title":return EY(i,o);case"gridScale":return{explicit:i.explicit,value:sn(i.value,o.value)}}return rx(i,o,n,"axis")});e.setWithExplicit(n,r)}return e}function C$e(e,t,n,r,i){if("disable"===t)return void 0!==n;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(ie(n.labelAngle)?n.labelAngle:D0(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===pK(r,i))return!0}return e===n[t]}const S$e=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function A$e(e,t){var n,r,i;let o=t.axis(e);const s=new FR,a=bn(t.encoding[e]),{mark:u,config:l}=t,c=(null==o?void 0:o.orient)||(null===(n=l["x"===e?"axisX":"axisY"])||void 0===n?void 0:n.orient)||(null===(r=l.axis)||void 0===r?void 0:r.orient)||function(e){return"x"===e?"bottom":"left"}(e),f=t.getScaleComponent(e).get("type"),d=function(e,t,n,r){const i="band"===t?["axisDiscrete","axisBand"]:"point"===t?["axisDiscrete","axisPoint"]:ZY(t)?["axisQuantitative"]:"time"===t||"utc"===t?["axisTemporal"]:[],o="x"===e?"axisX":"axisY",s=ie(n)?"axisOrient":`axis${E0(n)}`,a=[...i,...i.map(l=>o+l.substr(4))],u=["axis",s,o];return{vlOnlyAxisConfig:cK(a,r,e,n),vgAxisConfig:cK(u,r,e,n),axisConfigStyle:eje([...u,...a],r)}}(e,f,c,t.config),h=void 0!==o?!o:uR("disable",l.style,null==o?void 0:o.style,d).configValue;if(s.set("disable",h,void 0!==o),h)return s;o=o||{};const p=function(e,t,n,r,i){const o=null==t?void 0:t.labelAngle;if(void 0!==o)return ie(o)?o:D0(o);{const{configValue:s}=uR("labelAngle",r,null==t?void 0:t.style,i);return void 0!==s?D0(s):n!==Rt||!Be([lF,uF],e.type)||V(e)&&e.timeUnit?void 0:270}}(a,o,e,l.style,d),g={fieldOrDatumDef:a,axis:o,channel:e,model:t,scaleType:f,orient:c,labelAngle:p,mark:u,config:l};for(const y of cZ){const b=y in fK?fK[y](g):NX(y)?o[y]:void 0,_=void 0!==b,w=C$e(b,y,o,t,e);if(_&&w)s.set(y,b,w);else{const{configValue:E,configFrom:x}=NX(y)&&"values"!==y?uR(y,l.style,o.style,d):{},D=void 0!==E;_&&!D?s.set(y,b,w):("vgAxisConfig"!==x||S$e.has(y)&&D||P0(E)||ie(E))&&s.set(y,E,!1)}}const m=null!==(i=o.encoding)&&void 0!==i?i:{},v=IX.reduce((y,b)=>{var _;if(!s.hasAxisPart(b))return y;const w=wK(null!==(_=m[b])&&void 0!==_?_:{},t),E="labels"===b?function(e,t,n){var r;const{encoding:i,config:o}=e,s=null!==(r=bn(i[t]))&&void 0!==r?r:bn(i[nu(t)]),a=e.axis(t)||{},{format:u,formatType:l}=a;return af(l)?Object.assign({text:bF({fieldOrDatumDef:s,field:"datum.value",format:u,formatType:l,config:o})},n):n}(t,e,w):w;return void 0!==E&&!ht(E)&&(y[b]={update:E}),y},{});return ht(v)||s.set("encode",v,!!o.encoding||void 0!==o.labelAngle),s}const R$e={vgMark:"arc",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},fo(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),hr("x",e,{defaultPos:"mid"})),hr("y",e,{defaultPos:"mid"})),Pl(e,"radius")),Pl(e,"theta"))},N$e={vgMark:"area",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},fo(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),ox("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"horizontal"===e.markDef.orient})),ox("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"vertical"===e.markDef.orient})),rR(e))},P$e={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},fo(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Pl(e,"x")),Pl(e,"y"))},L$e={vgMark:"shape",encodeEntry:e=>Object.assign({},fo(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[Object.assign({type:"geoshape",projection:e.projectionName()},n&&V(n)&&n.type===Uh?{field:q(n,{expr:"datum"})}:{})]}},j$e={vgMark:"image",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},fo(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),Pl(e,"x")),Pl(e,"y")),tR(e,"url"))},$$e={vgMark:"line",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},fo(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),hr("x",e,{defaultPos:"mid"})),hr("y",e,{defaultPos:"mid"})),Tn("size",e,{vgChannel:"strokeWidth"})),rR(e))},B$e={vgMark:"trail",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},fo(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),hr("x",e,{defaultPos:"mid"})),hr("y",e,{defaultPos:"mid"})),Tn("size",e)),rR(e))};function RR(e,t){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},fo(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),hr("x",e,{defaultPos:"mid"})),hr("y",e,{defaultPos:"mid"})),Tn("size",e)),Tn("angle",e)),function(e,t,n){return n?{shape:{value:n}}:Tn("shape",e)}(e,0,t))}const U$e={vgMark:"symbol",encodeEntry:e=>RR(e)},H$e={vgMark:"symbol",encodeEntry:e=>RR(e,"circle")},V$e={vgMark:"symbol",encodeEntry:e=>RR(e,"square")},q$e={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},fo(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Pl(e,"x")),Pl(e,"y"))},W$e={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return e.encoding.x||e.encoding.y||e.encoding.latitude||e.encoding.longitude?Object.assign(Object.assign(Object.assign(Object.assign({},fo(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),ox("x",e,{defaultPos:"horizontal"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"vertical"!==n})),ox("y",e,{defaultPos:"vertical"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"horizontal"!==n})),Tn("size",e,{vgChannel:"strokeWidth"})):{}}},G$e={vgMark:"text",encodeEntry:e=>{const{config:t}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},fo(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),hr("x",e,{defaultPos:"mid"})),hr("y",e,{defaultPos:"mid"})),tR(e)),Tn("size",e,{vgChannel:"fontSize"})),Tn("angle",e)),WQ("align",function(e,t,n){if(void 0===st("align",e,n))return"center"}(e.markDef,0,t))),WQ("baseline",function(e,t,n){if(void 0===st("baseline",e,n))return"middle"}(e.markDef,0,t))),hr("radius",e,{defaultPos:null})),hr("theta",e,{defaultPos:null}))}},Q$e={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,r=n.orient,i="horizontal"===r?"width":"height",o="horizontal"===r?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},fo(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),hr("x",e,{defaultPos:"mid",vgChannel:"xc"})),hr("y",e,{defaultPos:"mid",vgChannel:"yc"})),Tn("size",e,{defaultValue:K$e(e),vgChannel:i})),{[o]:Ot(st("thickness",n,t))})}};function K$e(e){var t;const{config:n,markDef:r}=e,{orient:i}=r,o="horizontal"===i?"width":"height",s=e.getScaleComponent("horizontal"===i?"x":"y"),a=null!==(t=st("size",r,n,{vgChannel:o}))&&void 0!==t?t:n.tick.bandSize;if(void 0!==a)return a;{const u=s?s.get("range"):void 0;return u&&Ol(u)&&ft(u.step)?3*u.step/4:3*ex(n.view,o)/4}}const Sx={arc:R$e,area:N$e,bar:P$e,circle:H$e,geoshape:L$e,image:j$e,line:$$e,point:U$e,rect:q$e,rule:W$e,square:V$e,text:G$e,tick:Q$e,trail:B$e};const fZ="faceted_path_",dZ="stack_group_";function NR(e,t={fromPrefix:""}){const{mark:n,markDef:r,encoding:i,config:o}=e,s=sn(r.clip,function(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return!(!(null==t?void 0:t.get("selectionExtent"))&&!(null==n?void 0:n.get("selectionExtent")))||void 0}(e),function(e){const t=e.component.projection;return!(!t||t.isFit)||void 0}(e)),a=vY(r),u=i.key,l=function(e){var t;const{encoding:n,stack:r,mark:i,markDef:o,config:s}=e,a=n.order;if(!(!R(a)&&Zo(a)&&MI(a.value)||!a&&MI(st("order",o,s)))){if((R(a)||V(a))&&!r)return _Y(a,{expr:"datum"});if(Tl(i)){const u="horizontal"===o.orient?"y":"x",l=n[u];if(V(l)){const c=l.sort;return R(c)?{field:q(l,{prefix:u,suffix:"sort_index",expr:"datum"})}:na(c)?{field:q({aggregate:OF(e.encoding)?c.op:void 0,field:c.field},{expr:"datum"})}:vX(c)?{field:q(e.fieldDef(c.encoding),{expr:"datum"}),order:c.order}:null===c?void 0:{field:q(l,{binSuffix:(null===(t=e.stack)||void 0===t?void 0:t.impute)?"mid":void 0,expr:"datum"})}}return}}}(e),c=function(e){if(!e.component.selection)return null;const t=P(e.component.selection).length;let n=t,r=e.parent;for(;r&&0===n;)n=P(r.component.selection).length,r=r.parent;return n?{interactive:t>0||!!e.encoding.tooltip}:null}(e),f=st("aria",r,o),d=Sx[n].postEncodingTransform?Sx[n].postEncodingTransform(e):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("marks"),type:Sx[n].vgMark},s?{clip:!0}:{}),a?{style:a}:{}),u?{key:u.field}:{}),l?{sort:l}:{}),c||{}),!1===f?{aria:f}:{}),{from:{data:t.fromPrefix+e.requestDataName(bt.Main)},encode:{update:Sx[n].encodeEntry(e)}}),d?{transform:d}:{})]}class hZ extends oZ{constructor(t,n,r,i={},o){var s;super(t,"unit",n,r,o,void 0,oQ(t)?t.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection=[],this.children=[];const a=Ko(t.mark)?Object.assign({},t.mark):{type:t.mark},u=a.type;void 0===a.filled&&(a.filled=function(e,t,{graticule:n}){if(n)return!1;const r=tf("filled",e,t),i=e.type;return sn(r,i!==Fw&&i!==Iw&&i!==Rw)}(a,o,{graticule:t.data&&QF(t.data)}));const l=this.encoding=function(e,t,n,r){const i={};for(const o of P(e))oY(o)||$($Fe(o));for(let o of qIe){if(!e[o])continue;const s=e[o];if(Bh(o)){const a=uY(o),u=i[a];if(V(u)){if(jRe(u.type)&&V(s)){$(kFe(a));continue}}else o=a,$(IFe(a))}if("angle"===o&&"arc"===t&&!e.theta&&($("Arc marks uses theta channel rather than angle, replacing angle with theta."),o=Yo),NNe(e,o,t)){if(o===eu&&"line"===t){const a=oa(e[o]);if(null==a?void 0:a.aggregate){$("Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.");continue}}if(o===ri&&(n?"fill"in e:"stroke"in e))$(FY("encoding",{fill:"fill"in e,stroke:"stroke"in e}));else if(o===O0||o===A0&&!R(s)&&!Zo(s)||o===Zc&&R(s))s&&(i[o]=X(s).reduce((a,u)=>(V(u)?a.push(SF(u,o)):$(YI(u,o)),a),[]));else{if(o===Zc&&null===s)i[o]=null;else if(!(V(s)||ra(s)||Zo(s)||$w(s)||ie(s))){$(YI(s,o));continue}i[o]=MX(s,o,r)}}else $(Aw(o,t))}return i}(t.encoding||{},u,a.filled,o);this.markDef=function(e,t,n){const r=si(e),i=st("orient",r,n);if(r.orient=function(e,t,n){switch(e){case Fw:case hF:case pF:case rX:case eNe:case JRe:return}const{x:r,y:i,x2:o,y2:s}=t;switch(e){case kw:if(V(r)&&(Nr(r.bin)||V(i)&&i.aggregate&&!r.aggregate))return"vertical";if(V(i)&&(Nr(i.bin)||V(r)&&r.aggregate&&!i.aggregate))return"horizontal";if(s||o){if(n)return n;if(!o&&(V(r)&&r.type===of&&!Dt(r.bin)||Uw(r)))return"horizontal";if(!s&&(V(i)&&i.type===of&&!Dt(i.bin)||Uw(i)))return"vertical"}case Rw:if(o&&(!V(r)||!Nr(r.bin))&&s&&(!V(i)||!Nr(i.bin)))return;case Tw:if(s)return V(i)&&Nr(i.bin)?"horizontal":"vertical";if(o)return V(r)&&Nr(r.bin)?"vertical":"horizontal";if(e===Rw){if(r&&!i)return"vertical";if(i&&!r)return"horizontal"}case Iw:case dF:{const a=ia(r),u=ia(i);if(n)return n;if(a&&!u)return"tick"!==e?"horizontal":"vertical";if(!a&&u)return"tick"!==e?"vertical":"horizontal";if(a&&u){const l=r,c=i,f=l.type===zh,d=c.type===zh;return f&&!d?"tick"!==e?"vertical":"horizontal":!f&&d?"tick"!==e?"horizontal":"vertical":!l.aggregate&&c.aggregate?"tick"!==e?"vertical":"horizontal":l.aggregate&&!c.aggregate&&"tick"!==e?"horizontal":"vertical"}return}}return"vertical"}(r.type,t,i),void 0!==i&&i!==r.orient&&$(function(e,t){return`Specified orient "${e}" overridden with "${t}".`}(r.orient,i)),"bar"===r.type&&r.orient){const a=st("cornerRadiusEnd",r,n);if(void 0!==a){const u="horizontal"===r.orient&&t.x2||"vertical"===r.orient&&t.y2?["cornerRadius"]:aNe[r.orient];for(const l of u)r[l]=a;void 0!==r.cornerRadiusEnd&&delete r.cornerRadiusEnd}}return void 0===st("opacity",r,n)&&(r.opacity=function(e,t){if(Be([Fw,dF,hF,pF],e)&&!OF(t))return.7}(r.type,t)),void 0===st("cursor",r,n)&&(r.cursor=function(e,t,n){return t.href||e.href||st("href",e,n)?"pointer":e.cursor}(r,t,n)),r}(a,l,o),this.size=function({encoding:e,size:t}){for(const n of Js){const r=oi(n);sa(t[r])&&ia(e[n])&&(delete t[r],$(NY(r)))}return t}({encoding:l,size:oQ(t)?Object.assign(Object.assign(Object.assign({},i),t.width?{width:t.width}:{}),t.height?{height:t.height}:{}):i}),this.stack=hQ(u,l),this.specifiedScales=this.initScales(u,l),this.specifiedAxes=this.initAxes(l),this.specifiedLegends=this.initLegends(l),this.specifiedProjection=t.projection,this.selection=(null!==(s=t.params)&&void 0!==s?s:[]).filter(c=>$F(c))}get hasProjection(){const{encoding:t}=this,n=this.mark===iX,r=t&&BIe.some(i=>ye(t[i]));return n||r}scaleDomain(t){const n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return Dw.reduce((r,i)=>{var o;const s=bn(n[i]);return s&&(r[i]=this.initScale(null!==(o=s.scale)&&void 0!==o?o:{})),r},{})}initScale(t){const{domain:n,range:r}=t,i=si(t);return R(n)&&(i.domain=n.map(Ii)),R(r)&&(i.range=r.map(Ii)),i}initAxes(t){return Js.reduce((n,r)=>{const i=t[r];if(ye(i)||r===Rt&&ye(t.x2)||r===On&&ye(t.y2)){const o=ye(i)?i.axis:void 0;n[r]=o&&this.initAxis(Object.assign({},o))}return n},{})}initAxis(t){const n=P(t),r={};for(const i of n){const o=t[i];r[i]=P0(o)?gY(o):Ii(o)}return r}initLegends(t){return YIe.reduce((n,r)=>{const i=bn(t[r]);if(i&&function(e){switch(e){case ri:case Ks:case Zs:case eu:case ii:case tu:case xl:case El:return!0;case _l:case wl:case Kc:return!1}}(r)){const o=i.legend;n[r]=o&&si(o)}return n},{})}parseData(){this.component.data=Cx(this)}parseLayoutSize(){!function(e){const{size:t,component:n}=e;for(const r of Js){const i=oi(r);if(t[i]){const o=t[i];n.layoutSize.set(i,sa(o)?"step":o,!0)}else{const o=d$e(e,i);n.layoutSize.set(i,o,!1)}}}(this)}parseSelections(){this.component.selection=function(e,t){var n;const r={},i=e.config.selection;if(!t||!t.length)return r;for(const o of t){const s=kt(o.name),a=o.select,u=Y(a)?a:a.type,l=J(a)?we(a):{type:u},c=i[u];for(const d in c)"fields"===d||"encodings"===d||("mark"===d&&(l[d]=Object.assign(Object.assign({},c[d]),l[d])),(void 0===l[d]||!0===l[d])&&(l[d]=null!==(n=c[d])&&void 0!==n?n:l[d]));const f=r[s]=Object.assign(Object.assign({},l),{name:s,type:u,init:o.value,bind:o.bind,events:Y(l.on)?ml(l.on,"scope"):X(we(l.on))});for(const d of ux)d.defined(f)&&d.parse&&d.parse(e,f,o)}return r}(this,this.selection)}parseMarkGroup(){this.component.mark=function(e){if(Be([Iw,Tw,tNe],e.mark)){const t=$X(e.mark,e.encoding);if(t.length>0)return function(e,t){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:fZ+e.requestDataName(bt.Main),data:e.requestDataName(bt.Main),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:NR(e,{fromPrefix:fZ})}]}(e,t)}else if(e.mark===kw){const t=VI.some(n=>st(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t)return function(e){var t;const[n]=NR(e,{fromPrefix:dZ}),r=e.scaleName(e.stack.fieldChannel),i=(c={})=>e.vgField(e.stack.fieldChannel,c),o=(c,f)=>`${c}(${[i({prefix:"min",suffix:"start",expr:f}),i({prefix:"max",suffix:"start",expr:f}),i({prefix:"min",suffix:"end",expr:f}),i({prefix:"max",suffix:"end",expr:f})].map(h=>`scale('${r}',${h})`).join(",")})`;let s,a;"x"===e.stack.fieldChannel?(s=Object.assign(Object.assign({},Ph(n.encode.update,["y","yc","y2","height",...VI])),{x:{signal:o("min","datum")},x2:{signal:o("max","datum")},clip:{value:!0}}),a={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},n.encode.update=Object.assign(Object.assign({},ki(n.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(s=Object.assign(Object.assign({},Ph(n.encode.update,["x","xc","x2","width"])),{y:{signal:o("min","datum")},y2:{signal:o("max","datum")},clip:{value:!0}}),a={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},n.encode.update=Object.assign(Object.assign({},ki(n.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));for(const c of VI){const f=tf(c,e.markDef,e.config);n.encode.update[c]?(s[c]=n.encode.update[c],delete n.encode.update[c]):f&&(s[c]=Ot(f)),f&&(n.encode.update[c]={value:0})}const u=[];if((null===(t=e.stack.groupbyChannels)||void 0===t?void 0:t.length)>0)for(const c of e.stack.groupbyChannels){const f=e.fieldDef(c),d=q(f);d&&u.push(d),((null==f?void 0:f.bin)||(null==f?void 0:f.timeUnit))&&u.push(q(f,{binSuffix:"end"}))}return s=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((c,f)=>{if(n.encode.update[f])return Object.assign(Object.assign({},c),{[f]:n.encode.update[f]});{const d=tf(f,e.markDef,e.config);return void 0!==d?Object.assign(Object.assign({},c),{[f]:Ot(d)}):c}},s),s.stroke&&(s.strokeForeground={value:!0},s.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(bt.Main),name:dZ+e.requestDataName(bt.Main),groupby:u,aggregate:{fields:[i({suffix:"start"}),i({suffix:"start"}),i({suffix:"end"}),i({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:s},marks:[{type:"group",encode:{update:a},marks:[n]}]}]}(e)}return NR(e)}(this)}parseAxesAndHeaders(){this.component.axes=function(e){return Js.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[A$e(n,e)]),t),{})}(this)}assembleSelectionTopLevelSignals(t){return function(e,t){var n;let r=!1;for(const i of fr(null!==(n=e.component.selection)&&void 0!==n?n:{})){const o=i.name,s=H(o+cf);if(0===t.filter(u=>u.name===o).length){const l="point"===i.type?", true, true)":")";t.push({name:i.name,update:`${rK}(${s}, ${H("global"===i.resolve?"union":i.resolve)}${l}`})}r=!0;for(const u of ux)u.defined(i)&&u.topLevelSignals&&(t=u.topLevelSignals(e,i,t))}return r&&0===t.filter(o=>"unit"===o.name).length&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]}),KF(t)}(this,t)}assembleSignals(){return[...lK(this),...hLe(this,[])]}assembleSelectionData(t){return function(e,t){var n;const r=[...t];for(const i of fr(null!==(n=e.component.selection)&&void 0!==n?n:{})){const o={name:i.name+cf};if(i.init){const a=i.project.items.map(u=>dLe(u,["signals"]));o.values=i.init.map(u=>({unit:Jh(e,{escape:!1}),fields:a,values:Qh(u,!1)}))}r.filter(a=>a.name===i.name+cf).length||r.push(o)}return r}(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return hR(this)}assembleMarks(){var t;let n=null!==(t=this.component.mark)&&void 0!==t?t:[];return(!this.parent||!sp(this.parent))&&(n=NQ(this,n)),n.map(this.correctDataNames)}assembleGroupStyle(){const{style:t}=this.view||{};return void 0!==t?t:this.encoding.x||this.encoding.y?"cell":void 0}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return lf(this.encoding,t)}fieldDef(t){return oa(this.encoding[t])}typedFieldDef(t){const n=this.fieldDef(t);return co(n)?n:null}}class PR extends TR{constructor(t,n,r,i,o){super(t,"layer",n,r,o,t.resolve,t.view);const s=Object.assign(Object.assign(Object.assign({},i),t.width?{width:t.width}:{}),t.height?{height:t.height}:{});this.children=t.layer.map((a,u)=>{if(nx(a))return new PR(a,this,this.getName(`layer_${u}`),s,o);if(su(a))return new hZ(a,this,this.getName(`layer_${u}`),s,o);throw new Error(WI(a))})}parseData(){this.component.data=Cx(this);for(const t of this.children)t.parseData()}parseLayoutSize(){!function(e){kR(e),Dx(e,"width"),Dx(e,"height")}(this)}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of P(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){!function(e){var t;const{axes:n,resolve:r}=e.component,i={top:0,bottom:0,right:0,left:0};for(const o of e.children){o.parseAxesAndHeaders();for(const s of P(o.component.axes))r.axis[s]=pR(e.component.resolve,s),"shared"===r.axis[s]&&(n[s]=E$e(n[s],o.component.axes[s]),n[s]||(r.axis[s]="independent",delete n[s]))}for(const o of Js){for(const s of e.children)if(s.component.axes[o]){if("independent"===r.axis[o]){n[o]=(null!==(t=n[o])&&void 0!==t?t:[]).concat(s.component.axes[o]);for(const a of s.component.axes[o]){const{value:u,explicit:l}=a.getWithExplicit("orient");if(!ie(u)){if(i[u]>0&&!l){const c=w$e[u];i[u]>i[c]&&a.set("orient",c,!1)}i[u]++}}}delete s.component.axes[o]}if("independent"===r.axis[o]&&n[o]&&n[o].length>1)for(const s of n[o])s.get("grid")&&!s.explicit.grid&&(s.implicit.grid=!1)}}(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSignals()),lK(this))}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),hR(this))}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleGroupStyle(){const t=new Set;for(const r of this.children)for(const i of X(r.assembleGroupStyle()))t.add(i);const n=Array.from(t);return n.length>1?n:1===n.length?n[0]:void 0}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return function(e,t){for(const n of e.children)an(n)&&(t=NQ(n,t));return t}(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),IK(this))}}function LR(e,t,n,r,i){if(jw(e))return new X0(e,t,n,i);if(nx(e))return new PR(e,t,n,r,i);if(su(e))return new hZ(e,t,n,r,i);if(function(e){return Jw(e)||zF(e)||BF(e)}(e))return new m$e(e,t,n,i);throw new Error(WI(e))}function s5e(e,t={}){t.logger&&function(e){ea=e}(t.logger),t.fieldTitle&&OX(t.fieldTitle);try{const n=fQ(Md(t.config,e.config)),r=OQ(e,n),i=LR(r,null,"",void 0,n);return i.parse(),function(e,t){xR(e.sources);let n=0,r=0;for(let i=0;i<5&&zK(e,t,!0);i++)n++;e.sources.map(_R);for(let i=0;i<5&&zK(e,t,!1);i++)r++;xR(e.sources),5===Math.max(n,r)&&$("Maximum optimization runs(5) reached.")}(i.component.data,i),{spec:u5e(i,a5e(e,r.autosize,n,i),e.datasets,e.usermeta),normalized:r}}finally{t.logger&&(ea=$Y),t.fieldTitle&&OX(SX)}}function a5e(e,t,n,r){const i=r.component.layoutSize.get("width"),o=r.component.layoutSize.get("height");if(void 0===t?(t={type:"pad"},r.hasAxisOrientSignalRef()&&(t.resize=!0)):Y(t)&&(t={type:t}),i&&o&&function(e){return"fit"===e||"fit-x"===e||"fit-y"===e}(t.type))if("step"===i&&"step"===o)$(SY()),t.type="pad";else if("step"===i||"step"===o){const s="step"===i?"width":"height";$(SY(Ew(s))),t.type=function(e){return e?`fit-${Ew(e)}`:"fit"}("width"===s?"height":"width")}return Object.assign(Object.assign(Object.assign({},1===P(t).length&&t.type?"pad"===t.type?{}:{autosize:t.type}:{autosize:t}),TQ(n,!1)),TQ(e,!0))}function u5e(e,t,n={},r){const i=e.config?function(e){e=we(e);for(const t of yPe)delete e[t];if(e.axis)for(const t in e.axis)P0(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of JNe)delete e.legend[t];if(e.mark){for(const t of aX)delete e.mark[t];e.mark.tooltip&&J(e.mark.tooltip)&&delete e.mark.tooltip}e.params&&(e.signals=(e.signals||[]).concat(rQ(e.params)),delete e.params);for(const t of mPe){for(const r of aX)delete e[t][r];const n=vPe[t];if(n)for(const r of n)delete e[t][r];wPe(e,t)}for(const t of P(NF))delete e[t];!function(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:r}=pY(e.title);ht(t)||(e.style["group-title"]=Object.assign(Object.assign({},e.style["group-title"]),t)),ht(n)||(e.style["group-subtitle"]=Object.assign(Object.assign({},e.style["group-subtitle"]),n)),ht(r)?delete e.title:e.title=r}(e);for(const t in e)J(e[t])&&ht(e[t])&&delete e[t];return ht(e)?void 0:e}(e.config):void 0,o=[].concat(e.assembleSelectionData([]),function(e,t){var n,r;const i=[],o=sZ(i);let s=0;for(const u of e.sources){u.hasName()||(u.dataName="source_"+s++);const l=u.assemble();o(u,l)}for(const u of i)0===u.transform.length&&delete u.transform;let a=0;for(const[u,l]of i.entries())0===(null!==(n=l.transform)&&void 0!==n?n:[]).length&&!l.source&&i.splice(a++,0,i.splice(u,1)[0]);for(const u of i)for(const l of null!==(r=u.transform)&&void 0!==r?r:[])"lookup"===l.type&&(l.from=e.outputNodes[l.from].getSource());for(const u of i)u.name in t&&(u.values=t[u.name]);return i}(e.component.data,n)),s=e.assembleProjections(),a=e.assembleTitle(),u=e.assembleGroupStyle(),l=e.assembleGroupEncodeEntry(!0);let c=e.assembleLayoutSignals();c=c.filter(h=>"width"!==h.name&&"height"!==h.name||void 0===h.value||(t[h.name]=+h.value,!1));const{params:f}=t,d=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(t,["params"]);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),d),a?{title:a}:{}),u?{style:u}:{}),l?{encode:{update:l}}:{}),{data:o}),s.length>0?{projections:s}:{}),e.assembleGroup([...c,...e.assembleSelectionTopLevelSignals([]),...rQ(f)])),i?{config:i}:{}),r?{usermeta:r}:{})}const l5e="5.2.0",pZ=function(e){const[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}},up="#fff",M5e={background:"#333",title:{color:up,subtitleColor:up},style:{"guide-label":{fill:up},"guide-title":{fill:up}},axis:{domainColor:up,gridColor:"#888",tickColor:up}},gf="#4572a7",T5e={background:"#fff",arc:{fill:gf},area:{fill:gf},line:{stroke:gf,strokeWidth:2},path:{stroke:gf},rect:{fill:gf},shape:{stroke:gf},symbol:{fill:gf,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},mf="#30a2da",jR="#cbcbcb",gZ="#f0f0f0",F5e={arc:{fill:mf},area:{fill:mf},axis:{domainColor:jR,grid:!0,gridColor:jR,gridWidth:1,labelColor:"#999",labelFontSize:10,titleColor:"#333",tickColor:jR,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:gZ,group:{fill:gZ},legend:{labelColor:"#333",labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:"#333",titleFontSize:14,titlePadding:10},line:{stroke:mf,strokeWidth:2},path:{stroke:mf,strokeWidth:.5},rect:{fill:mf},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:mf},bar:{binSpacing:2,fill:mf,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},yf="#000",R5e={group:{fill:"#e5e5e5"},arc:{fill:yf},area:{fill:yf},line:{stroke:yf},path:{stroke:yf},rect:{fill:yf},shape:{stroke:yf},symbol:{fill:yf,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},yZ="Benton Gothic, sans-serif",vf="#82c6df",$R="Benton Gothic Bold, sans-serif",Q0={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},j5e={background:"#ffffff",title:{anchor:"start",color:"#000000",font:$R,fontSize:22,fontWeight:"normal"},arc:{fill:vf},area:{fill:vf},line:{stroke:vf,strokeWidth:2},path:{stroke:vf},rect:{fill:vf},shape:{stroke:vf},symbol:{fill:vf,size:30},axis:{labelFont:yZ,labelFontSize:11.5,labelFontWeight:"normal",titleFont:$R,titleFontSize:13,titleFontWeight:"normal"},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:yZ,labelFontSize:11.5,symbolType:"square",titleFont:$R,titleFontSize:13,titleFontWeight:"normal"},range:{category:Q0["category-6"],diverging:Q0["fireandice-6"],heatmap:Q0["fire-7"],ordinal:Q0["fire-7"],ramp:Q0["fire-7"]}},bf="#ab5787",Ax="#979797",$5e={background:"#f9f9f9",arc:{fill:bf},area:{fill:bf},line:{stroke:bf},path:{stroke:bf},rect:{fill:bf},shape:{stroke:bf},symbol:{fill:bf,size:30},axis:{domainColor:Ax,domainWidth:.5,gridWidth:.2,labelColor:Ax,tickColor:Ax,tickWidth:.2,titleColor:Ax},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},_f="#3e5c69",B5e={background:"#fff",arc:{fill:_f},area:{fill:_f},line:{stroke:_f},path:{stroke:_f},rect:{fill:_f},shape:{stroke:_f},symbol:{fill:_f},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},ho="#1696d2",wZ="#000000",Ox="Lato",BR="Lato",K0={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},q5e={background:"#FFFFFF",title:{anchor:"start",fontSize:18,font:Ox},axisX:{domain:!0,domainColor:wZ,domainWidth:1,grid:!1,labelFontSize:12,labelFont:BR,labelAngle:0,tickColor:wZ,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:Ox},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:"#DEDDDD",gridWidth:1,labelFontSize:12,labelFont:BR,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:Ox,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:BR,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:Ox,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:K0["six-groups-cat-1"],diverging:K0["diverging-colors"],heatmap:K0["diverging-colors"],ordinal:K0["six-groups-seq"],ramp:K0["shades-blue"]},area:{fill:ho},rect:{fill:ho},line:{color:ho,stroke:ho,strokeWidth:5},trail:{color:ho,stroke:ho,strokeWidth:0,size:1},path:{stroke:ho,strokeWidth:.5},point:{filled:!0},text:{font:"Lato",color:ho,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:ho,stroke:null}},arc:{fill:ho},shape:{stroke:ho},symbol:{fill:ho,size:30}},wf="#3366CC",Mx="Arial, sans-serif",W5e={arc:{fill:wf},area:{fill:wf},path:{stroke:wf},rect:{fill:wf},shape:{stroke:wf},symbol:{stroke:wf},circle:{fill:wf},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:Mx,fontSize:12},"guide-title":{font:Mx,fontSize:12},"group-title":{font:Mx,fontSize:12}},title:{font:Mx,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:"#ccc",tickColor:"#ccc",domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},G5e="2.10.0";function EZ(e,t){return JSON.stringify(e,function(e){const t=[];return function(n,r){if("object"!=typeof r||null===r)return r;const i=t.indexOf(this)+1;return t.length=i,t.length>e?"[Object]":t.indexOf(r)>=0?"[Circular]":(t.push(r),r)}}(t))}const DZ="vg-tooltip-element",v8e={offsetX:10,offsetY:10,id:DZ,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")},maxDepth:2,formatTooltip:function(e,t,n){if(R(e))return`[${e.map(r=>t(Y(r)?r:EZ(r,n))).join(", ")}]`;if(J(e)){let r="";const i=e,{title:o,image:s}=i,a=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(i,["title","image"]);o&&(r+=`<h2>${t(o)}</h2>`),s&&(r+=`<img src="${t(s)}">`);const u=Object.keys(a);if(u.length>0){r+="<table>";for(const l of u){let c=a[l];void 0!==c&&(J(c)&&(c=EZ(c,n)),r+=`<tr><td class="key">${t(l)}:</td><td class="value">${t(c)}</td></tr>`)}r+="</table>"}return r||"{}"}return t(e)}};class CZ{constructor(t){this.options=Object.assign(Object.assign({},v8e),t);const n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const r=document.createElement("style");r.setAttribute("id",this.options.styleId),r.innerHTML=function(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return"#vg-tooltip-element {\n  visibility: hidden;\n  padding: 8px;\n  position: fixed;\n  z-index: 1000;\n  font-family: sans-serif;\n  font-size: 11px;\n  border-radius: 3px;\n  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\n  /* The default theme is the light theme. */\n  background-color: rgba(255, 255, 255, 0.95);\n  border: 1px solid #d9d9d9;\n  color: black; }\n  #vg-tooltip-element.visible {\n    visibility: visible; }\n  #vg-tooltip-element h2 {\n    margin-top: 0;\n    margin-bottom: 10px;\n    font-size: 13px; }\n  #vg-tooltip-element img {\n    max-width: 200px;\n    max-height: 200px; }\n  #vg-tooltip-element table {\n    border-spacing: 0; }\n    #vg-tooltip-element table tr {\n      border: none; }\n      #vg-tooltip-element table tr td {\n        overflow: hidden;\n        text-overflow: ellipsis;\n        padding-top: 2px;\n        padding-bottom: 2px; }\n        #vg-tooltip-element table tr td.key {\n          color: #808080;\n          max-width: 150px;\n          text-align: right;\n          padding-right: 4px; }\n        #vg-tooltip-element table tr td.value {\n          display: block;\n          max-width: 300px;\n          max-height: 7em;\n          text-align: left; }\n  #vg-tooltip-element.dark-theme {\n    background-color: rgba(32, 32, 32, 0.9);\n    border: 1px solid #f5f5f5;\n    color: white; }\n    #vg-tooltip-element.dark-theme td.key {\n      color: #bfbfbf; }\n".toString().replace(DZ,e)}(n);const i=document.head;i.childNodes.length>0?i.insertBefore(r,i.childNodes[0]):i.appendChild(r)}}tooltipHandler(t,n,r,i){var o;if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el)),(null!==(o=document.fullscreenElement)&&void 0!==o?o:document.body).appendChild(this.el),null==i||""===i)return void this.el.classList.remove("visible",`${this.options.theme}-theme`);this.el.innerHTML=this.options.formatTooltip(i,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:a,y:u}=function(e,t,n,r){let i=e.clientX+n;i+t.width>window.innerWidth&&(i=+e.clientX-n-t.width);let o=e.clientY+r;return o+t.height>window.innerHeight&&(o=+e.clientY-r-t.height),{x:i,y:o}}(n,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${u}px; left: ${a}px`)}}function x8e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function SZ(e,t,n,r,i,o,s){try{var a=e[o](s),u=a.value}catch(l){return void n(l)}a.done?t(u):Promise.resolve(u).then(r,i)}function Tx(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function s(u){SZ(o,r,i,s,a,"next",u)}function a(u){SZ(o,r,i,s,a,"throw",u)}s(void 0)})}}var ca,AZ=Object.prototype,xf=AZ.hasOwnProperty,zR="function"==typeof Symbol?Symbol:{},kx=zR.iterator||"@@iterator",E8e=zR.asyncIterator||"@@asyncIterator",Ix=zR.toStringTag||"@@toStringTag";function OZ(e,t,n,r){var o=Object.create((t&&t.prototype instanceof HR?t:HR).prototype),s=new GR(r||[]);return o._invoke=function(e,t,n){var r=MZ;return function(o,s){if(r===TZ)throw new Error("Generator is already running");if(r===Fx){if("throw"===o)throw s;return RZ()}for(n.method=o,n.arg=s;;){var a=n.delegate;if(a){var u=FZ(a,n);if(u){if(u===ns)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===MZ)throw r=Fx,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=TZ;var l=UR(e,t,n);if("normal"===l.type){if(r=n.done?Fx:D8e,l.arg===ns)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r=Fx,n.method="throw",n.arg=l.arg)}}}(e,n,s),o}function UR(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(r){return{type:"throw",arg:r}}}var MZ="suspendedStart",D8e="suspendedYield",TZ="executing",Fx="completed",ns={};function HR(){}function Rx(){}function lp(){}var VR={};VR[kx]=function(){return this};var qR=Object.getPrototypeOf,Nx=qR&&qR(qR(YR([])));Nx&&Nx!==AZ&&xf.call(Nx,kx)&&(VR=Nx);var cp=lp.prototype=HR.prototype=Object.create(VR);function kZ(e){["next","throw","return"].forEach(function(t){e[t]=function(n){return this._invoke(t,n)}})}function IZ(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===Rx||"GeneratorFunction"===(t.displayName||t.name))}function Px(e,t){function n(o,s,a,u){var l=UR(e[o],e,s);if("throw"!==l.type){var c=l.arg,f=c.value;return f&&"object"==typeof f&&xf.call(f,"__await")?t.resolve(f.__await).then(function(d){n("next",d,a,u)},function(d){n("throw",d,a,u)}):t.resolve(f).then(function(d){c.value=d,a(c)},function(d){return n("throw",d,a,u)})}u(l.arg)}var r;this._invoke=function(o,s){function a(){return new t(function(u,l){n(o,s,u,l)})}return r=r?r.then(a,a):a()}}function FZ(e,t){var n=e.iterator[t.method];if(n===ca){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=ca,FZ(e,t),"throw"===t.method))return ns;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return ns}var r=UR(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,ns;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=ca),t.delegate=null,ns):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,ns)}function M8e(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function WR(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function GR(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(M8e,this),this.reset(!0)}function YR(e){if(e){var t=e[kx];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function i(){for(;++n<e.length;)if(xf.call(e,n))return i.value=e[n],i.done=!1,i;return i.value=ca,i.done=!0,i};return r.next=r}}return{next:RZ}}function RZ(){return{value:ca,done:!0}}Rx.prototype=cp.constructor=lp,lp.constructor=Rx,lp[Ix]=Rx.displayName="GeneratorFunction",kZ(Px.prototype),Px.prototype[E8e]=function(){return this},kZ(cp),cp[Ix]="Generator",cp[kx]=function(){return this},cp.toString=function(){return"[object Generator]"},GR.prototype={constructor:GR,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=ca,this.done=!1,this.delegate=null,this.method="next",this.arg=ca,this.tryEntries.forEach(WR),!t)for(var n in this)"t"===n.charAt(0)&&xf.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=ca)},stop:function(){this.done=!0;var n=this.tryEntries[0].completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(l,c){return s.type="throw",s.arg=t,n.next=l,c&&(n.method="next",n.arg=ca),!!c}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var a=xf.call(o,"catchLoc"),u=xf.call(o,"finallyLoc");if(a&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,n){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&xf.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=n&&n<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=n,o?(this.method="next",this.next=o.finallyLoc,ns):this.complete(s)},complete:function(t,n){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&n&&(this.next=n),ns},finish:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),WR(r),ns}},catch:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc===t){var i=r.completion;if("throw"===i.type){var o=i.arg;WR(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:YR(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=ca),ns}};var fa={wrap:OZ,isGeneratorFunction:IZ,AsyncIterator:Px,mark:function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,lp):(e.__proto__=lp,Ix in e||(e[Ix]="GeneratorFunction")),e.prototype=Object.create(cp),e},awrap:function(e){return{__await:e}},async:function(e,t,n,r,i){void 0===i&&(i=Promise);var o=new Px(OZ(e,t,n,r),i);return IZ(t)?o:o.next().then(function(s){return s.done?s.value:o.next()})},keys:function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function r(){for(;t.length;){var i=t.pop();if(i in e)return r.value=i,r.done=!1,r}return r.done=!0,r}},values:YR},k8e=tt;function tt(e){var t=this;if(t instanceof tt||(t=new tt),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach(function(i){t.push(i)});else if(arguments.length>0)for(var n=0,r=arguments.length;n<r;n++)t.push(arguments[n]);return t}function I8e(e,t,n){var r=t===e.head?new Ef(n,null,t,e):new Ef(n,t,t.next,e);return null===r.next&&(e.tail=r),null===r.prev&&(e.head=r),e.length++,r}function F8e(e,t){e.tail=new Ef(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function R8e(e,t){e.head=new Ef(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function Ef(e,t,n,r){if(!(this instanceof Ef))return new Ef(e,t,n,r);this.list=r,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}tt.Node=Ef,tt.create=tt,tt.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t},tt.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},tt.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},tt.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)F8e(this,arguments[e]);return this.length},tt.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)R8e(this,arguments[e]);return this.length},tt.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},tt.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},tt.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,r=0;null!==n;r++)e.call(t,n.value,r,this),n=n.next},tt.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,r=this.length-1;null!==n;r--)e.call(t,n.value,r,this),n=n.prev},tt.prototype.get=function(e){for(var t=0,n=this.head;null!==n&&t<e;t++)n=n.next;if(t===e&&null!==n)return n.value},tt.prototype.getReverse=function(e){for(var t=0,n=this.tail;null!==n&&t<e;t++)n=n.prev;if(t===e&&null!==n)return n.value},tt.prototype.map=function(e,t){t=t||this;for(var n=new tt,r=this.head;null!==r;)n.push(e.call(t,r.value,this)),r=r.next;return n},tt.prototype.mapReverse=function(e,t){t=t||this;for(var n=new tt,r=this.tail;null!==r;)n.push(e.call(t,r.value,this)),r=r.prev;return n},tt.prototype.reduce=function(e,t){var n,r=this.head;if(arguments.length>1)n=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,n=this.head.value}for(var i=0;null!==r;i++)n=e(n,r.value,i),r=r.next;return n},tt.prototype.reduceReverse=function(e,t){var n,r=this.tail;if(arguments.length>1)n=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,n=this.tail.value}for(var i=this.length-1;null!==r;i--)n=e(n,r.value,i),r=r.prev;return n},tt.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;null!==n;t++)e[t]=n.value,n=n.next;return e},tt.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;null!==n;t++)e[t]=n.value,n=n.prev;return e},tt.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new tt;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=0,i=this.head;null!==i&&r<e;r++)i=i.next;for(;null!==i&&r<t;r++,i=i.next)n.push(i.value);return n},tt.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new tt;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=this.length,i=this.tail;null!==i&&r>t;r--)i=i.prev;for(;null!==i&&r>e;r--,i=i.prev)n.push(i.value);return n},tt.prototype.splice=function(e,t){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,r=this.head;null!==r&&n<e;n++)r=r.next;var i=[];for(n=0;r&&n<t;n++)i.push(r.value),r=this.removeNode(r);for(null===r&&(r=this.tail),r!==this.head&&r!==this.tail&&(r=r.prev),n=0;n<(arguments.length<=2?0:arguments.length-2);n++)r=I8e(this,r,n+2<2||arguments.length<=n+2?void 0:arguments[n+2]);return i},tt.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;null!==n;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=t,this.tail=e,this};try{tt.prototype[Symbol.iterator]=fa.mark(function e(){var t;return fa.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:t=this.head;case 1:if(!t){r.next=7;break}return r.next=4,t.value;case 4:t=t.next,r.next=1;break;case 7:case"end":return r.stop()}},e,this)})}catch(e){}var N8e=k8e,Df=Symbol("max"),cu=Symbol("length"),fp=Symbol("lengthCalculator"),Z0=Symbol("allowStale"),Cf=Symbol("maxAge"),fu=Symbol("dispose"),NZ=Symbol("noDisposeOnSet"),kn=Symbol("lruList"),rs=Symbol("cache"),PZ=Symbol("updateAgeOnGet"),XR=()=>1,QR=(e,t,n)=>{var r=e[rs].get(t);if(r){var i=r.value;if(Lx(e,i)){if(dp(e,r),!e[Z0])return}else n&&(e[PZ]&&(r.value.now=Date.now()),e[kn].unshiftNode(r));return i.value}},Lx=(e,t)=>{if(!t||!t.maxAge&&!e[Cf])return!1;var n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[Cf]&&n>e[Cf]},J0=e=>{if(e[cu]>e[Df])for(var t=e[kn].tail;e[cu]>e[Df]&&null!==t;){var n=t.prev;dp(e,t),t=n}},dp=(e,t)=>{if(t){var n=t.value;e[fu]&&e[fu](n.key,n.value),e[cu]-=n.length,e[rs].delete(n.key),e[kn].removeNode(t)}};class L8e{constructor(t,n,r,i,o){this.key=t,this.value=n,this.length=r,this.now=i,this.maxAge=o||0}}var LZ=(e,t,n,r)=>{var i=n.value;Lx(e,i)&&(dp(e,n),e[Z0]||(i=void 0)),i&&t.call(r,i.value,i.key,e)},$8e=["includePrerelease","loose","rtl"],KR=e=>e?"object"!=typeof e?{loose:!0}:$8e.filter(t=>e[t]).reduce((t,n)=>(t[n]=!0,t),{}):{},is={exports:{}},ZR={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991,MAX_SAFE_COMPONENT_LENGTH:16},q8e="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return console.error("SEMVER",...t)}:()=>{},jx=q8e;!function(e,t){var n=ZR.MAX_SAFE_COMPONENT_LENGTH,r=jx,i=(t=e.exports={}).re=[],o=t.src=[],s=t.t={},a=0,u=(l,c,f)=>{var d=a++;r(d,c),s[l]=d,o[d]=c,i[d]=new RegExp(c,f?"g":void 0)};u("NUMERICIDENTIFIER","0|[1-9]\\d*"),u("NUMERICIDENTIFIERLOOSE","[0-9]+"),u("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),u("MAINVERSION","(".concat(o[s.NUMERICIDENTIFIER],")\\.")+"(".concat(o[s.NUMERICIDENTIFIER],")\\.")+"(".concat(o[s.NUMERICIDENTIFIER],")")),u("MAINVERSIONLOOSE","(".concat(o[s.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(o[s.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(o[s.NUMERICIDENTIFIERLOOSE],")")),u("PRERELEASEIDENTIFIER","(?:".concat(o[s.NUMERICIDENTIFIER],"|").concat(o[s.NONNUMERICIDENTIFIER],")")),u("PRERELEASEIDENTIFIERLOOSE","(?:".concat(o[s.NUMERICIDENTIFIERLOOSE],"|").concat(o[s.NONNUMERICIDENTIFIER],")")),u("PRERELEASE","(?:-(".concat(o[s.PRERELEASEIDENTIFIER],"(?:\\.").concat(o[s.PRERELEASEIDENTIFIER],")*))")),u("PRERELEASELOOSE","(?:-?(".concat(o[s.PRERELEASEIDENTIFIERLOOSE],"(?:\\.").concat(o[s.PRERELEASEIDENTIFIERLOOSE],")*))")),u("BUILDIDENTIFIER","[0-9A-Za-z-]+"),u("BUILD","(?:\\+(".concat(o[s.BUILDIDENTIFIER],"(?:\\.").concat(o[s.BUILDIDENTIFIER],")*))")),u("FULLPLAIN","v?".concat(o[s.MAINVERSION]).concat(o[s.PRERELEASE],"?").concat(o[s.BUILD],"?")),u("FULL","^".concat(o[s.FULLPLAIN],"$")),u("LOOSEPLAIN","[v=\\s]*".concat(o[s.MAINVERSIONLOOSE]).concat(o[s.PRERELEASELOOSE],"?").concat(o[s.BUILD],"?")),u("LOOSE","^".concat(o[s.LOOSEPLAIN],"$")),u("GTLT","((?:<|>)?=?)"),u("XRANGEIDENTIFIERLOOSE","".concat(o[s.NUMERICIDENTIFIERLOOSE],"|x|X|\\*")),u("XRANGEIDENTIFIER","".concat(o[s.NUMERICIDENTIFIER],"|x|X|\\*")),u("XRANGEPLAIN","[v=\\s]*(".concat(o[s.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(o[s.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(o[s.XRANGEIDENTIFIER],")")+"(?:".concat(o[s.PRERELEASE],")?").concat(o[s.BUILD],"?")+")?)?"),u("XRANGEPLAINLOOSE","[v=\\s]*(".concat(o[s.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(o[s.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(o[s.XRANGEIDENTIFIERLOOSE],")")+"(?:".concat(o[s.PRERELEASELOOSE],")?").concat(o[s.BUILD],"?")+")?)?"),u("XRANGE","^".concat(o[s.GTLT],"\\s*").concat(o[s.XRANGEPLAIN],"$")),u("XRANGELOOSE","^".concat(o[s.GTLT],"\\s*").concat(o[s.XRANGEPLAINLOOSE],"$")),u("COERCE","".concat("(^|[^\\d])(\\d{1,").concat(n,"})")+"(?:\\.(\\d{1,".concat(n,"}))?")+"(?:\\.(\\d{1,".concat(n,"}))?")+"(?:$|[^\\d])"),u("COERCERTL",o[s.COERCE],!0),u("LONETILDE","(?:~>?)"),u("TILDETRIM","(\\s*)".concat(o[s.LONETILDE],"\\s+"),!0),t.tildeTrimReplace="$1~",u("TILDE","^".concat(o[s.LONETILDE]).concat(o[s.XRANGEPLAIN],"$")),u("TILDELOOSE","^".concat(o[s.LONETILDE]).concat(o[s.XRANGEPLAINLOOSE],"$")),u("LONECARET","(?:\\^)"),u("CARETTRIM","(\\s*)".concat(o[s.LONECARET],"\\s+"),!0),t.caretTrimReplace="$1^",u("CARET","^".concat(o[s.LONECARET]).concat(o[s.XRANGEPLAIN],"$")),u("CARETLOOSE","^".concat(o[s.LONECARET]).concat(o[s.XRANGEPLAINLOOSE],"$")),u("COMPARATORLOOSE","^".concat(o[s.GTLT],"\\s*(").concat(o[s.LOOSEPLAIN],")$|^$")),u("COMPARATOR","^".concat(o[s.GTLT],"\\s*(").concat(o[s.FULLPLAIN],")$|^$")),u("COMPARATORTRIM","(\\s*)".concat(o[s.GTLT],"\\s*(").concat(o[s.LOOSEPLAIN],"|").concat(o[s.XRANGEPLAIN],")"),!0),t.comparatorTrimReplace="$1$2$3",u("HYPHENRANGE","^\\s*(".concat(o[s.XRANGEPLAIN],")")+"\\s+-\\s+"+"(".concat(o[s.XRANGEPLAIN],")")+"\\s*$"),u("HYPHENRANGELOOSE","^\\s*(".concat(o[s.XRANGEPLAINLOOSE],")")+"\\s+-\\s+"+"(".concat(o[s.XRANGEPLAINLOOSE],")")+"\\s*$"),u("STAR","(<|>)?=?\\s*\\*"),u("GTE0","^\\s*>=\\s*0.0.0\\s*$"),u("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")}(is,is.exports);var jZ=/^[0-9]+$/,$x=jx,BZ=ZR.MAX_LENGTH,Bx=ZR.MAX_SAFE_INTEGER,zZ=is.exports.re,UZ=is.exports.t,Y8e=KR,ey=(e,t)=>{var n=jZ.test(e),r=jZ.test(t);return n&&r&&(e=+e,t=+t),e===t?0:n&&!r?-1:r&&!n?1:e<t?-1:1};class os{constructor(t,n){if(n=Y8e(n),t instanceof os){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease)return t;t=t.version}else if("string"!=typeof t)throw new TypeError("Invalid Version: ".concat(t));if(t.length>BZ)throw new TypeError("version is longer than ".concat(BZ," characters"));$x("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;var r=t.trim().match(n.loose?zZ[UZ.LOOSE]:zZ[UZ.FULL]);if(!r)throw new TypeError("Invalid Version: ".concat(t));if(this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>Bx||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Bx||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Bx||this.patch<0)throw new TypeError("Invalid patch version");this.prerelease=r[4]?r[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){var o=+i;if(o>=0&&o<Bx)return o}return i}):[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version="".concat(this.major,".").concat(this.minor,".").concat(this.patch),this.prerelease.length&&(this.version+="-".concat(this.prerelease.join("."))),this.version}toString(){return this.version}compare(t){if($x("SemVer.compare",this.version,this.options,t),!(t instanceof os)){if("string"==typeof t&&t===this.version)return 0;t=new os(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof os||(t=new os(t,this.options)),ey(this.major,t.major)||ey(this.minor,t.minor)||ey(this.patch,t.patch)}comparePre(t){if(t instanceof os||(t=new os(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;var n=0;do{var r=this.prerelease[n],i=t.prerelease[n];if($x("prerelease compare",n,r,i),void 0===r&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===r)return-1;if(r!==i)return ey(r,i)}while(++n)}compareBuild(t){t instanceof os||(t=new os(t,this.options));var n=0;do{var r=this.build[n],i=t.build[n];if($x("prerelease compare",n,r,i),void 0===r&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===r)return-1;if(r!==i)return ey(r,i)}while(++n)}inc(t,n){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n),this.inc("pre",n);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",n),this.inc("pre",n);break;case"major":(0!==this.minor||0!==this.patch||0===this.prerelease.length)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(0!==this.patch||0===this.prerelease.length)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)"number"==typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);-1===r&&this.prerelease.push(0)}n&&(this.prerelease[0]===n?isNaN(this.prerelease[1])&&(this.prerelease=[n,0]):this.prerelease=[n,0]);break;default:throw new Error("invalid increment argument: ".concat(t))}return this.format(),this.raw=this.version,this}}var JR=os,HZ=JR,hp=(e,t,n)=>new HZ(e,n).compare(new HZ(t,n)),Q8e=hp,J8e=hp,n6e=hp,o6e=hp,u6e=hp,f6e=hp,p6e=(e,t,n)=>0===Q8e(e,t,n),g6e=(e,t,n)=>0!==J8e(e,t,n),m6e=(e,t,n)=>n6e(e,t,n)>0,y6e=(e,t,n)=>o6e(e,t,n)>=0,v6e=(e,t,n)=>u6e(e,t,n)<0,b6e=(e,t,n)=>f6e(e,t,n)<=0,ty=Symbol("SemVer ANY");class zx{static get ANY(){return ty}constructor(t,n){if(n=E6e(n),t instanceof zx){if(t.loose===!!n.loose)return t;t=t.value}tN("comparator",t,n),this.options=n,this.loose=!!n.loose,this.parse(t),this.value=this.semver===ty?"":this.operator+this.semver.version,tN("comp",this)}parse(t){var r=t.match(this.options.loose?VZ[qZ.COMPARATORLOOSE]:VZ[qZ.COMPARATOR]);if(!r)throw new TypeError("Invalid comparator: ".concat(t));this.operator=void 0!==r[1]?r[1]:"","="===this.operator&&(this.operator=""),this.semver=r[2]?new WZ(r[2],this.options.loose):ty}toString(){return this.value}test(t){if(tN("Comparator.test",t,this.options.loose),this.semver===ty||t===ty)return!0;if("string"==typeof t)try{t=new WZ(t,this.options)}catch(n){return!1}return eN(t,this.operator,this.semver,this.options)}intersects(t,n){if(!(t instanceof zx))throw new TypeError("a Comparator is required");if((!n||"object"!=typeof n)&&(n={loose:!!n,includePrerelease:!1}),""===this.operator)return""===this.value||new GZ(t.value,n).test(this.value);if(""===t.operator)return""===t.value||new GZ(this.value,n).test(t.semver);var r=!(">="!==this.operator&&">"!==this.operator||">="!==t.operator&&">"!==t.operator),i=!("<="!==this.operator&&"<"!==this.operator||"<="!==t.operator&&"<"!==t.operator),o=this.semver.version===t.semver.version,s=!(">="!==this.operator&&"<="!==this.operator||">="!==t.operator&&"<="!==t.operator),a=eN(this.semver,"<",t.semver,n)&&(">="===this.operator||">"===this.operator)&&("<="===t.operator||"<"===t.operator),u=eN(this.semver,">",t.semver,n)&&("<="===this.operator||"<"===this.operator)&&(">="===t.operator||">"===t.operator);return r||i||o&&s||a||u}}var x6e=zx,E6e=KR,VZ=is.exports.re,qZ=is.exports.t,eN=(e,t,n,r)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e===n;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e!==n;case"":case"=":case"==":return p6e(e,n,r);case"!=":return g6e(e,n,r);case">":return m6e(e,n,r);case">=":return y6e(e,n,r);case"<":return v6e(e,n,r);case"<=":return b6e(e,n,r);default:throw new TypeError("Invalid operator: ".concat(t))}},tN=jx,WZ=JR,GZ=QZ;function YZ(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return XZ(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return XZ(e,t)}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(l){throw l},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var l=n.next();return o=l.done,l},e:function(l){s=!0,a=l},f:function(){try{!o&&null!=n.return&&n.return()}finally{if(s)throw a}}}}function XZ(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}class ny{constructor(t,n){if(n=S6e(n),t instanceof ny)return t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease?t:new ny(t.raw,n);if(t instanceof nN)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease,this.raw=t,this.set=t.split(/\s*\|\|\s*/).map(a=>this.parseRange(a.trim())).filter(a=>a.length),!this.set.length)throw new TypeError("Invalid SemVer Range: ".concat(t));if(this.set.length>1){var r=this.set[0];if(this.set=this.set.filter(a=>!ZZ(a[0])),0===this.set.length)this.set=[r];else if(this.set.length>1){var o,i=YZ(this.set);try{for(i.s();!(o=i.n()).done;){var s=o.value;if(1===s.length&&k6e(s[0])){this.set=[s];break}}}catch(a){i.e(a)}finally{i.f()}}}this.format()}format(){return this.range=this.set.map(t=>t.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(t){t=t.trim();var n=Object.keys(this.options).join(","),r="parseRange:".concat(n,":").concat(t),i=KZ.get(r);if(i)return i;var o=this.options.loose;t=t.replace(o?gr[qn.HYPHENRANGELOOSE]:gr[qn.HYPHENRANGE],z6e(this.options.includePrerelease)),Qt("hyphen replace",t),t=t.replace(gr[qn.COMPARATORTRIM],O6e),Qt("comparator trim",t,gr[qn.COMPARATORTRIM]),t=(t=(t=t.replace(gr[qn.TILDETRIM],M6e)).replace(gr[qn.CARETTRIM],T6e)).split(/\s+/).join(" ");var f,a=o?gr[qn.COMPARATORLOOSE]:gr[qn.COMPARATOR],u=t.split(" ").map(p=>I6e(p,this.options)).join(" ").split(/\s+/).map(p=>B6e(p,this.options)).filter(this.options.loose?p=>!!p.match(a):()=>!0).map(p=>new nN(p,this.options)),l=new Map,c=YZ(u);try{for(c.s();!(f=c.n()).done;){var d=f.value;if(ZZ(d))return[d];l.set(d.value,d)}}catch(p){c.e(p)}finally{c.f()}l.size>1&&l.has("")&&l.delete("");var h=[...l.values()];return KZ.set(r,h),h}intersects(t,n){if(!(t instanceof ny))throw new TypeError("a Range is required");return this.set.some(r=>JZ(r,n)&&t.set.some(i=>JZ(i,n)&&r.every(o=>i.every(s=>o.intersects(s,n)))))}test(t){if(!t)return!1;if("string"==typeof t)try{t=new A6e(t,this.options)}catch(r){return!1}for(var n=0;n<this.set.length;n++)if(U6e(this.set[n],t,this.options))return!0;return!1}}var QZ=ny,KZ=new class{constructor(t){if("number"==typeof t&&(t={max:t}),t||(t={}),t.max&&("number"!=typeof t.max||t.max<0))throw new TypeError("max must be a non-negative number");this[Df]=t.max||1/0;var n=t.length||XR;if(this[fp]="function"!=typeof n?XR:n,this[Z0]=t.stale||!1,t.maxAge&&"number"!=typeof t.maxAge)throw new TypeError("maxAge must be a number");this[Cf]=t.maxAge||0,this[fu]=t.dispose,this[NZ]=t.noDisposeOnSet||!1,this[PZ]=t.updateAgeOnGet||!1,this.reset()}set max(t){if("number"!=typeof t||t<0)throw new TypeError("max must be a non-negative number");this[Df]=t||1/0,J0(this)}get max(){return this[Df]}set allowStale(t){this[Z0]=!!t}get allowStale(){return this[Z0]}set maxAge(t){if("number"!=typeof t)throw new TypeError("maxAge must be a non-negative number");this[Cf]=t,J0(this)}get maxAge(){return this[Cf]}set lengthCalculator(t){"function"!=typeof t&&(t=XR),t!==this[fp]&&(this[fp]=t,this[cu]=0,this[kn].forEach(n=>{n.length=this[fp](n.value,n.key),this[cu]+=n.length})),J0(this)}get lengthCalculator(){return this[fp]}get length(){return this[cu]}get itemCount(){return this[kn].length}rforEach(t,n){n=n||this;for(var r=this[kn].tail;null!==r;){var i=r.prev;LZ(this,t,r,n),r=i}}forEach(t,n){n=n||this;for(var r=this[kn].head;null!==r;){var i=r.next;LZ(this,t,r,n),r=i}}keys(){return this[kn].toArray().map(t=>t.key)}values(){return this[kn].toArray().map(t=>t.value)}reset(){this[fu]&&this[kn]&&this[kn].length&&this[kn].forEach(t=>this[fu](t.key,t.value)),this[rs]=new Map,this[kn]=new N8e,this[cu]=0}dump(){return this[kn].map(t=>!Lx(this,t)&&{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[kn]}set(t,n,r){if((r=r||this[Cf])&&"number"!=typeof r)throw new TypeError("maxAge must be a number");var i=r?Date.now():0,o=this[fp](n,t);if(this[rs].has(t)){if(o>this[Df])return dp(this,this[rs].get(t)),!1;var a=this[rs].get(t).value;return this[fu]&&(this[NZ]||this[fu](t,a.value)),a.now=i,a.maxAge=r,a.value=n,this[cu]+=o-a.length,a.length=o,this.get(t),J0(this),!0}var u=new L8e(t,n,o,i,r);return u.length>this[Df]?(this[fu]&&this[fu](t,n),!1):(this[cu]+=u.length,this[kn].unshift(u),this[rs].set(t,this[kn].head),J0(this),!0)}has(t){if(!this[rs].has(t))return!1;var n=this[rs].get(t).value;return!Lx(this,n)}get(t){return QR(this,t,!0)}peek(t){return QR(this,t,!1)}pop(){var t=this[kn].tail;return t?(dp(this,t),t.value):null}del(t){dp(this,this[rs].get(t))}load(t){this.reset();for(var n=Date.now(),r=t.length-1;r>=0;r--){var i=t[r],o=i.e||0;if(0===o)this.set(i.k,i.v);else{var s=o-n;s>0&&this.set(i.k,i.v,s)}}}prune(){this[rs].forEach((t,n)=>QR(this,n,!1))}}({max:1e3}),S6e=KR,nN=x6e,Qt=jx,A6e=JR,gr=is.exports.re,qn=is.exports.t,O6e=is.exports.comparatorTrimReplace,M6e=is.exports.tildeTrimReplace,T6e=is.exports.caretTrimReplace,ZZ=e=>"<0.0.0-0"===e.value,k6e=e=>""===e.value,JZ=(e,t)=>{for(var n=!0,r=e.slice(),i=r.pop();n&&r.length;)n=r.every(o=>i.intersects(o,t)),i=r.pop();return n},I6e=(e,t)=>(Qt("comp",e,t),e=N6e(e,t),Qt("caret",e),e=F6e(e,t),Qt("tildes",e),e=L6e(e,t),Qt("xrange",e),e=$6e(e,t),Qt("stars",e),e),jr=e=>!e||"x"===e.toLowerCase()||"*"===e,F6e=(e,t)=>e.trim().split(/\s+/).map(n=>R6e(n,t)).join(" "),R6e=(e,t)=>e.replace(t.loose?gr[qn.TILDELOOSE]:gr[qn.TILDE],(r,i,o,s,a)=>{var u;return Qt("tilde",e,r,i,o,s,a),jr(i)?u="":jr(o)?u=">=".concat(i,".0.0 <").concat(+i+1,".0.0-0"):jr(s)?u=">=".concat(i,".").concat(o,".0 <").concat(i,".").concat(+o+1,".0-0"):a?(Qt("replaceTilde pr",a),u=">=".concat(i,".").concat(o,".").concat(s,"-").concat(a," <").concat(i,".").concat(+o+1,".0-0")):u=">=".concat(i,".").concat(o,".").concat(s," <").concat(i,".").concat(+o+1,".0-0"),Qt("tilde return",u),u}),N6e=(e,t)=>e.trim().split(/\s+/).map(n=>P6e(n,t)).join(" "),P6e=(e,t)=>{Qt("caret",e,t);var r=t.includePrerelease?"-0":"";return e.replace(t.loose?gr[qn.CARETLOOSE]:gr[qn.CARET],(i,o,s,a,u)=>{var l;return Qt("caret",e,i,o,s,a,u),jr(o)?l="":jr(s)?l=">=".concat(o,".0.0").concat(r," <").concat(+o+1,".0.0-0"):jr(a)?l="0"===o?">=".concat(o,".").concat(s,".0").concat(r," <").concat(o,".").concat(+s+1,".0-0"):">=".concat(o,".").concat(s,".0").concat(r," <").concat(+o+1,".0.0-0"):u?(Qt("replaceCaret pr",u),l="0"===o?"0"===s?">=".concat(o,".").concat(s,".").concat(a,"-").concat(u," <").concat(o,".").concat(s,".").concat(+a+1,"-0"):">=".concat(o,".").concat(s,".").concat(a,"-").concat(u," <").concat(o,".").concat(+s+1,".0-0"):">=".concat(o,".").concat(s,".").concat(a,"-").concat(u," <").concat(+o+1,".0.0-0")):(Qt("no pr"),l="0"===o?"0"===s?">=".concat(o,".").concat(s,".").concat(a).concat(r," <").concat(o,".").concat(s,".").concat(+a+1,"-0"):">=".concat(o,".").concat(s,".").concat(a).concat(r," <").concat(o,".").concat(+s+1,".0-0"):">=".concat(o,".").concat(s,".").concat(a," <").concat(+o+1,".0.0-0")),Qt("caret return",l),l})},L6e=(e,t)=>(Qt("replaceXRanges",e,t),e.split(/\s+/).map(n=>j6e(n,t)).join(" ")),j6e=(e,t)=>(e=e.trim()).replace(t.loose?gr[qn.XRANGELOOSE]:gr[qn.XRANGE],(r,i,o,s,a,u)=>{Qt("xRange",e,r,i,o,s,a,u);var l=jr(o),c=l||jr(s),f=c||jr(a);return"="===i&&f&&(i=""),u=t.includePrerelease?"-0":"",l?r=">"===i||"<"===i?"<0.0.0-0":"*":i&&f?(c&&(s=0),a=0,">"===i?(i=">=",c?(o=+o+1,s=0,a=0):(s=+s+1,a=0)):"<="===i&&(i="<",c?o=+o+1:s=+s+1),"<"===i&&(u="-0"),r="".concat(i+o,".").concat(s,".").concat(a).concat(u)):c?r=">=".concat(o,".0.0").concat(u," <").concat(+o+1,".0.0-0"):f&&(r=">=".concat(o,".").concat(s,".0").concat(u," <").concat(o,".").concat(+s+1,".0-0")),Qt("xRange return",r),r}),$6e=(e,t)=>(Qt("replaceStars",e,t),e.trim().replace(gr[qn.STAR],"")),B6e=(e,t)=>(Qt("replaceGTE0",e,t),e.trim().replace(gr[t.includePrerelease?qn.GTE0PRE:qn.GTE0],"")),z6e=e=>(t,n,r,i,o,s,a,u,l,c,f,d,h)=>(n=jr(r)?"":jr(i)?">=".concat(r,".0.0").concat(e?"-0":""):jr(o)?">=".concat(r,".").concat(i,".0").concat(e?"-0":""):s?">=".concat(n):">=".concat(n).concat(e?"-0":""),u=jr(l)?"":jr(c)?"<".concat(+l+1,".0.0-0"):jr(f)?"<".concat(l,".").concat(+c+1,".0-0"):d?"<=".concat(l,".").concat(c,".").concat(f,"-").concat(d):e?"<".concat(l,".").concat(c,".").concat(+f+1,"-0"):"<=".concat(u),"".concat(n," ").concat(u).trim()),U6e=(e,t,n)=>{for(var r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(var i=0;i<e.length;i++)if(Qt(e[i].semver),e[i].semver!==nN.ANY&&e[i].semver.prerelease.length>0){var o=e[i].semver;if(o.major===t.major&&o.minor===t.minor&&o.patch===t.patch)return!0}return!1}return!0},H6e=QZ,eJ=(e,t,n)=>{try{t=new H6e(t,n)}catch(r){return!1}return t.test(e)};function q6e(e,t,n){var r=e.open(t),a=new URL(t).origin,u=40;e.addEventListener("message",function l(f){f.source===r&&(u=0,e.removeEventListener("message",l,!1))},!1),setTimeout(function c(){u<=0||(r.postMessage(n,a),setTimeout(c,250),u-=1)},250)}var rN,W6e='.vega-embed {\n  position: relative;\n  display: inline-block;\n  box-sizing: border-box;\n}\n.vega-embed.has-actions {\n  padding-right: 38px;\n}\n.vega-embed details:not([open]) > :not(summary) {\n  display: none !important;\n}\n.vega-embed summary {\n  list-style: none;\n  position: absolute;\n  top: 0;\n  right: 0;\n  padding: 6px;\n  z-index: 1000;\n  background: white;\n  box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);\n  color: #1b1e23;\n  border: 1px solid #aaa;\n  border-radius: 999px;\n  opacity: 0.2;\n  transition: opacity 0.4s ease-in;\n  outline: none;\n  cursor: pointer;\n  line-height: 0px;\n}\n.vega-embed summary::-webkit-details-marker {\n  display: none;\n}\n.vega-embed summary:active {\n  box-shadow: #aaa 0px 0px 0px 1px inset;\n}\n.vega-embed summary svg {\n  width: 14px;\n  height: 14px;\n}\n.vega-embed details[open] summary {\n  opacity: 0.7;\n}\n.vega-embed:hover summary, .vega-embed:focus summary {\n  opacity: 1 !important;\n  transition: opacity 0.2s ease;\n}\n.vega-embed .vega-actions {\n  position: absolute;\n  z-index: 1001;\n  top: 35px;\n  right: -9px;\n  display: flex;\n  flex-direction: column;\n  padding-bottom: 8px;\n  padding-top: 8px;\n  border-radius: 4px;\n  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);\n  border: 1px solid #d9d9d9;\n  background: white;\n  animation-duration: 0.15s;\n  animation-name: scale-in;\n  animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);\n  text-align: left;\n}\n.vega-embed .vega-actions a {\n  padding: 8px 16px;\n  font-family: sans-serif;\n  font-size: 14px;\n  font-weight: 600;\n  white-space: nowrap;\n  color: #434a56;\n  text-decoration: none;\n}\n.vega-embed .vega-actions a:hover {\n  background-color: #f7f7f9;\n  color: black;\n}\n.vega-embed .vega-actions::before, .vega-embed .vega-actions::after {\n  content: "";\n  display: inline-block;\n  position: absolute;\n}\n.vega-embed .vega-actions::before {\n  left: auto;\n  right: 14px;\n  top: -16px;\n  border: 8px solid #0000;\n  border-bottom-color: #d9d9d9;\n}\n.vega-embed .vega-actions::after {\n  left: auto;\n  right: 15px;\n  top: -14px;\n  border: 7px solid #0000;\n  border-bottom-color: #fff;\n}\n.vega-embed .chart-wrapper.fit-x {\n  width: 100%;\n}\n.vega-embed .chart-wrapper.fit-y {\n  height: 100%;\n}\n\n.vega-embed-wrapper {\n  max-width: 100%;\n  overflow: auto;\n  padding-right: 14px;\n}\n\n@keyframes scale-in {\n  from {\n    opacity: 0;\n    transform: scale(0.6);\n  }\n  to {\n    opacity: 1;\n    transform: scale(1);\n  }\n}\n';function tJ(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var i=0,o=n;i<o.length;i++){var s=o[i];G6e(e,s)}return e}function G6e(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var i=r[n];Td(e,i,t[i],!0)}}function nJ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function Bl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nJ(Object(n),!0).forEach(function(r){x8e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nJ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e});var zl=us,ry=Wn,Ux="undefined"!=typeof window?window:void 0;void 0===ry&&null!=Ux&&null!==(rN=Ux.vl)&&void 0!==rN&&rN.compile&&(ry=Ux.vl);var mBe={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},yBe={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},iy={vega:"Vega","vega-lite":"Vega-Lite"},Hx={vega:zl.version,"vega-lite":ry?ry.version:"not available"},vBe={vega:e=>e,"vega-lite":(e,t)=>ry.compile(e,{config:t}).spec},bBe='\n<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">\n  <circle r="2" cy="8" cx="2"></circle>\n  <circle r="2" cy="8" cx="8"></circle>\n  <circle r="2" cy="8" cx="14"></circle>\n</svg>',_Be="chart-wrapper";function wBe(e){return"function"==typeof e}function rJ(e,t,n,r){var i="<html><head>".concat(t,'</head><body><pre><code class="json">'),o="</code></pre>".concat(n,"</body></html>"),s=window.open("");s.document.write(i+e+o),s.document.title="".concat(iy[r]," JSON Source")}function xBe(e,t){if(e.$schema){var r,n=pZ(e.$schema);t&&t!==n.library&&console.warn("The given visualization spec is written in ".concat(iy[n.library],", but mode argument sets ").concat(null!==(r=iy[t])&&void 0!==r?r:t,"."));var i=n.library;return eJ(Hx[i],"^".concat(n.version.slice(1)))||console.warn("The input spec uses ".concat(iy[i]," ").concat(n.version,", but the current version of ").concat(iy[i]," is v").concat(Hx[i],".")),i}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":null!=t?t:"vega"}function iJ(e){return function(e){return!(!e||!("load"in e))}(e)?e:zl.loader(e)}function oJ(e){var t;return null!==(t=e.usermeta&&e.usermeta.embedOptions)&&void 0!==t?t:{}}function iN(){return iN=Tx(fa.mark(function e(t,n){var r,i,o,s,a,u,l,c,f,d,h=arguments;return fa.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(o=h.length>2&&void 0!==h[2]?h[2]:{},!Y(n)){g.next=10;break}return a=iJ(o.loader),g.t0=JSON,g.next=6,a.load(n);case 6:g.t1=g.sent,s=g.t0.parse.call(g.t0,g.t1),g.next=11;break;case 10:s=n;case 11:return u=oJ(s).loader,(!a||u)&&(a=iJ(null!==(l=o.loader)&&void 0!==l?l:u)),g.next=15,sJ(oJ(s),a);case 15:return c=g.sent,g.next=18,sJ(o,a);case 18:return d=Bl(Bl({},tJ(f=g.sent,c)),{},{config:Md(null!==(r=f.config)&&void 0!==r?r:{},null!==(i=c.config)&&void 0!==i?i:{})}),g.next=22,SBe(t,s,d,a);case 22:return g.abrupt("return",g.sent);case 23:case"end":return g.stop()}},e)})),iN.apply(this,arguments)}function sJ(e,t){return oN.apply(this,arguments)}function oN(){return oN=Tx(fa.mark(function e(t,n){var r,i,o;return fa.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!Y(t.config)){a.next=8;break}return a.t1=JSON,a.next=4,n.load(t.config);case 4:a.t2=a.sent,a.t0=a.t1.parse.call(a.t1,a.t2),a.next=9;break;case 8:a.t0=null!==(r=t.config)&&void 0!==r?r:{};case 9:if(i=a.t0,!Y(t.patch)){a.next=18;break}return a.t4=JSON,a.next=14,n.load(t.patch);case 14:a.t5=a.sent,a.t3=a.t4.parse.call(a.t4,a.t5),a.next=19;break;case 18:a.t3=t.patch;case 19:return o=a.t3,a.abrupt("return",Bl(Bl(Bl({},t),o?{patch:o}:{}),i?{config:i}:{}));case 21:case"end":return a.stop()}},e)})),oN.apply(this,arguments)}function CBe(e){var t,n=e.getRootNode?e.getRootNode():document;return n instanceof ShadowRoot?{root:n,rootContainer:n}:{root:document,rootContainer:null!==(t=document.head)&&void 0!==t?t:document.body}}function SBe(e,t){return sN.apply(this,arguments)}function sN(){return sN=Tx(fa.mark(function e(t,n){var r,i,o,s,a,u,l,c,f,d,h,p,g,m,v,y,b,_,E,x,D,S,C,A,M,T,L,O,N,U,W,te,Ge,Ht,_t,Kt,$r,ss,as,Z,de,Me,B,un,ze,Zt,Vt=arguments;return fa.wrap(function(du){for(;;)switch(du.prev=du.next){case 0:if(Zt=function(){Ge&&document.removeEventListener("click",Ge),N.finalize()},f=Vt.length>3?Vt[3]:void 0,d=(c=Vt.length>2&&void 0!==Vt[2]?Vt[2]:{}).theme?Md(ls[c.theme],null!==(r=c.config)&&void 0!==r?r:{}):c.config,h=ku(c.actions)?c.actions:tJ({},mBe,null!==(i=c.actions)&&void 0!==i?i:{}),p=Bl(Bl({},yBe),c.i18n),g=null!==(o=c.renderer)&&void 0!==o?o:"canvas",m=null!==(s=c.logLevel)&&void 0!==s?s:zl.Warn,v=null!==(a=c.downloadFileName)&&void 0!==a?a:"visualization",y="string"==typeof t?document.querySelector(t):t){du.next=12;break}throw new Error("".concat(t," does not exist"));case 12:return!1!==c.defaultStyle&&(b="vega-embed-style",_=CBe(y),E=_.rootContainer,_.root.getElementById(b)||((x=document.createElement("style")).id=b,x.innerText=void 0===c.defaultStyle||!0===c.defaultStyle?W6e.toString():c.defaultStyle,E.appendChild(x))),D=xBe(n,c.mode),S=vBe[D](n,d),"vega-lite"===D&&S.$schema&&(C=pZ(S.$schema),eJ(Hx.vega,"^".concat(C.version.slice(1)))||console.warn("The compiled spec uses Vega ".concat(C.version,", but current version is v").concat(Hx.vega,"."))),y.classList.add("vega-embed"),h&&y.classList.add("has-actions"),y.innerHTML="",A=y,h&&((M=document.createElement("div")).classList.add(_Be),y.appendChild(M),A=M),(T=c.patch)&&(S=T instanceof Function?T(S):Yv(S,T,!0,!1).newDocument),c.formatLocale&&zl.formatLocale(c.formatLocale),c.timeFormatLocale&&zl.timeFormatLocale(c.timeFormatLocale),O=zl.parse(S,"vega-lite"===D?{}:d,{ast:L=c.ast}),(N=new(c.viewClass||zl.View)(O,Bl({loader:f,logLevel:m,renderer:g},L?{expr:null!==(u=null!==(l=zl.expressionInterpreter)&&void 0!==l?l:c.expr)&&void 0!==u?u:SIe}:{}))).addSignalListener("autosize",(ha,li)=>{var Ni=li.type;"fit-x"==Ni?(A.classList.add("fit-x"),A.classList.remove("fit-y")):"fit-y"==Ni?(A.classList.remove("fit-x"),A.classList.add("fit-y")):"fit"==Ni?A.classList.add("fit-x","fit-y"):A.classList.remove("fit-x","fit-y")}),!1!==c.tooltip&&(U=wBe(c.tooltip)?c.tooltip:new CZ(!0===c.tooltip?{}:c.tooltip).call,N.tooltip(U)),void 0===(W=c.hover)&&(W="vega"===D),W&&N.hover((te="boolean"==typeof W?{}:W).hoverSet,te.updateSet),c&&(null!=c.width&&N.width(c.width),null!=c.height&&N.height(c.height),null!=c.padding&&N.padding(c.padding)),du.next=36,N.initialize(A,c.bind).runAsync();case 36:if(!1!==h){if(Ht=y,!1!==c.defaultStyle&&((_t=document.createElement("details")).title=p.CLICK_TO_VIEW_ACTIONS,y.append(_t),Ht=_t,(Kt=document.createElement("summary")).innerHTML=bBe,_t.append(Kt),Ge=ha=>{_t.contains(ha.target)||_t.removeAttribute("open")},document.addEventListener("click",Ge)),$r=document.createElement("div"),Ht.append($r),$r.classList.add("vega-actions"),!0===h||!1!==h.export)for(ss=function(){var li=Z[as];if(!0===h||!0===h.export||h.export[li]){var Ni=p["".concat(li.toUpperCase(),"_ACTION")],pp=document.createElement("a");pp.text=Ni,pp.href="#",pp.target="_blank",pp.download="".concat(v,".").concat(li),pp.addEventListener("mousedown",function(){var MBe=Tx(fa.mark(function aJ(TBe){return fa.wrap(function(oy){for(;;)switch(oy.prev=oy.next){case 0:return TBe.preventDefault(),oy.next=3,N.toImageURL(li,c.scaleFactor);case 3:this.href=oy.sent;case 5:case"end":return oy.stop()}},aJ,this)}));return function(aJ){return MBe.apply(this,arguments)}}()),$r.append(pp)}},as=0,Z=["svg","png"];as<Z.length;as++)ss();(!0===h||!1!==h.source)&&((de=document.createElement("a")).text=p.SOURCE_ACTION,de.href="#",de.addEventListener("click",function(ha){var li,Ni;rJ(CS()(n),null!==(li=c.sourceHeader)&&void 0!==li?li:"",null!==(Ni=c.sourceFooter)&&void 0!==Ni?Ni:"",D),ha.preventDefault()}),$r.append(de)),"vega-lite"===D&&(!0===h||!1!==h.compiled)&&((Me=document.createElement("a")).text=p.COMPILED_ACTION,Me.href="#",Me.addEventListener("click",function(ha){var li,Ni;rJ(CS()(S),null!==(li=c.sourceHeader)&&void 0!==li?li:"",null!==(Ni=c.sourceFooter)&&void 0!==Ni?Ni:"","vega"),ha.preventDefault()}),$r.append(Me)),(!0===h||!1!==h.editor)&&(un=null!==(B=c.editorUrl)&&void 0!==B?B:"https://vega.github.io/editor/",(ze=document.createElement("a")).text=p.EDITOR_ACTION,ze.href="#",ze.addEventListener("click",function(ha){q6e(window,un,{config:d,mode:D,renderer:g,spec:CS()(n)}),ha.preventDefault()}),$r.append(ze))}return du.abrupt("return",{view:N,spec:n,vgSpec:S,finalize:Zt});case 38:case"end":return du.stop()}},e)})),sN.apply(this,arguments)}let ABe=(()=>{class e{constructor(){}ngOnInit(){this.embedGraph("https://abulsyed.github.io/stats/vis/v1.json","#vis1"),this.embedGraph("https://abulsyed.github.io/stats/vis/v2.json","#vis2"),this.embedGraph("https://abulsyed.github.io/stats/vis/v3.json","#vis3")}embedGraph(n,r){return Zn(function*(){const i=yield function(e,t){return iN.apply(this,arguments)}(r,n);console.log(i.view)})()}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=fy({type:e,selectors:[["app-root"]],decls:3,vars:0,consts:[["id","vis1"],["id","vis2"],["id","vis3"]],template:function(n,r){1&n&&(Wp(0,"div",0),Wp(1,"div",1),Wp(2,"div",2))},styles:["#vis1[_ngcontent-%COMP%], #vis2[_ngcontent-%COMP%], #vis3[_ngcontent-%COMP%]{display:block;padding:2.5rem}"]}),e})(),OBe=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Yl({type:e,bootstrap:[ABe]}),e.\u0275inj=hu({providers:[],imports:[[Oce,lhe]]}),e})();o5=!1,Sce().bootstrapModule(OBe).catch(e=>console.error(e))},559:Pi=>{"use strict";Pi.exports=function po(G,nt){if(G===nt)return!0;if(G&&nt&&"object"==typeof G&&"object"==typeof nt){if(G.constructor!==nt.constructor)return!1;var ut,lt,gt;if(Array.isArray(G)){if((ut=G.length)!=nt.length)return!1;for(lt=ut;0!=lt--;)if(!po(G[lt],nt[lt]))return!1;return!0}if(G.constructor===RegExp)return G.source===nt.source&&G.flags===nt.flags;if(G.valueOf!==Object.prototype.valueOf)return G.valueOf()===nt.valueOf();if(G.toString!==Object.prototype.toString)return G.toString()===nt.toString();if((ut=(gt=Object.keys(G)).length)!==Object.keys(nt).length)return!1;for(lt=ut;0!=lt--;)if(!Object.prototype.hasOwnProperty.call(nt,gt[lt]))return!1;for(lt=ut;0!=lt--;){var Oe=gt[lt];if(!po(G[Oe],nt[Oe]))return!1}return!0}return G!=G&&nt!=nt}},245:Pi=>{"use strict";Pi.exports=function(po,G){G||(G={}),"function"==typeof G&&(G={cmp:G});var gt,nt="boolean"==typeof G.cycles&&G.cycles,ut=G.cmp&&(gt=G.cmp,function(Oe){return function(qt,Ke){return gt({key:qt,value:Oe[qt]},{key:Ke,value:Oe[Ke]})}}),lt=[];return function gt(Oe){if(Oe&&Oe.toJSON&&"function"==typeof Oe.toJSON&&(Oe=Oe.toJSON()),void 0!==Oe){if("number"==typeof Oe)return isFinite(Oe)?""+Oe:"null";if("object"!=typeof Oe)return JSON.stringify(Oe);var qt,Ke;if(Array.isArray(Oe)){for(Ke="[",qt=0;qt<Oe.length;qt++)qt&&(Ke+=","),Ke+=gt(Oe[qt])||"null";return Ke+"]"}if(null===Oe)return"null";if(-1!==lt.indexOf(Oe)){if(nt)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var ci=lt.push(Oe)-1,fi=Object.keys(Oe).sort(ut&&ut(Oe));for(Ke="",qt=0;qt<fi.length;qt++){var Ye=fi[qt],Re=gt(Oe[Ye]);!Re||(Ke&&(Ke+=","),Ke+=JSON.stringify(Ye)+":"+Re)}return lt.splice(ci,1),"{"+Ke+"}"}}(po)}},478:Pi=>{var po=function(){"use strict";function G(Ye,Re){return null!=Re&&Ye instanceof Re}var nt,ut,lt;try{nt=Map}catch(Ye){nt=function(){}}try{ut=Set}catch(Ye){ut=function(){}}try{lt=Promise}catch(Ye){lt=function(){}}function gt(Ye,Re,In,Li,go){"object"==typeof Re&&(In=Re.depth,Li=Re.prototype,go=Re.includeNonEnumerable,Re=Re.circular);var us=[],Wn=[],ls="undefined"!=typeof Buffer;return void 0===Re&&(Re=!0),void 0===In&&(In=1/0),function Pe(me,Wt){if(null===me)return null;if(0===Wt)return me;var rt,Jt;if("object"!=typeof me)return me;if(G(me,nt))rt=new nt;else if(G(me,ut))rt=new ut;else if(G(me,lt))rt=new lt(function(Vl,ql){me.then(function(ma){Vl(Pe(ma,Wt-1))},function(ma){ql(Pe(ma,Wt-1))})});else if(gt.__isArray(me))rt=[];else if(gt.__isRegExp(me))rt=new RegExp(me.source,fi(me)),me.lastIndex&&(rt.lastIndex=me.lastIndex);else if(gt.__isDate(me))rt=new Date(me.getTime());else{if(ls&&Buffer.isBuffer(me))return rt=Buffer.allocUnsafe?Buffer.allocUnsafe(me.length):new Buffer(me.length),me.copy(rt),rt;G(me,Error)?rt=Object.create(me):void 0===Li?(Jt=Object.getPrototypeOf(me),rt=Object.create(Jt)):(rt=Object.create(Li),Jt=Li)}if(Re){var Ul=us.indexOf(me);if(-1!=Ul)return Wn[Ul];us.push(me),Wn.push(rt)}for(var Br in G(me,nt)&&me.forEach(function(Vl,ql){var ma=Pe(ql,Wt-1),ya=Pe(Vl,Wt-1);rt.set(ma,ya)}),G(me,ut)&&me.forEach(function(Vl){var ql=Pe(Vl,Wt-1);rt.add(ql)}),me){var Sf;Jt&&(Sf=Object.getOwnPropertyDescriptor(Jt,Br)),(!Sf||null!=Sf.set)&&(rt[Br]=Pe(me[Br],Wt-1))}if(Object.getOwnPropertySymbols){var cs=Object.getOwnPropertySymbols(me);for(Br=0;Br<cs.length;Br++){var pa=cs[Br];(ga=Object.getOwnPropertyDescriptor(me,pa))&&!ga.enumerable&&!go||(rt[pa]=Pe(me[pa],Wt-1),ga.enumerable||Object.defineProperty(rt,pa,{enumerable:!1}))}}if(go){var Hl=Object.getOwnPropertyNames(me);for(Br=0;Br<Hl.length;Br++){var ga,Af=Hl[Br];(ga=Object.getOwnPropertyDescriptor(me,Af))&&ga.enumerable||(rt[Af]=Pe(me[Af],Wt-1),Object.defineProperty(rt,Af,{enumerable:!1}))}}return rt}(Ye,In)}function Oe(Ye){return Object.prototype.toString.call(Ye)}function fi(Ye){var Re="";return Ye.global&&(Re+="g"),Ye.ignoreCase&&(Re+="i"),Ye.multiline&&(Re+="m"),Re}return gt.clonePrototype=function(Re){if(null===Re)return null;var In=function(){};return In.prototype=Re,new In},gt.__objToStr=Oe,gt.__isDate=function(Ye){return"object"==typeof Ye&&"[object Date]"===Oe(Ye)},gt.__isArray=function(Ye){return"object"==typeof Ye&&"[object Array]"===Oe(Ye)},gt.__isRegExp=function(Ye){return"object"==typeof Ye&&"[object RegExp]"===Oe(Ye)},gt.__getRegExpFlags=fi,gt}();Pi.exports&&(Pi.exports=po)},564:Pi=>{"use strict";var po=/("(?:[^\\"]|\\.)*")|[:,]/g;Pi.exports=function(nt,ut){var lt,gt,Oe;return ut=ut||{},lt=JSON.stringify([1],void 0,void 0===ut.indent?2:ut.indent).slice(2,-3),gt=""===lt?1/0:void 0===ut.maxLength?80:ut.maxLength,Oe=ut.replacer,function qt(Ke,ci,fi){var Ye,Re,In,Li,go,us,Wn,ls,Pe,me,Wt,rt;if(Ke&&"function"==typeof Ke.toJSON&&(Ke=Ke.toJSON()),void 0===(Wt=JSON.stringify(Ke,Oe)))return Wt;if(Wt.length<=(Wn=gt-ci.length-fi)&&(Pe=Wt.replace(po,function(Jt,Ul){return Ul||Jt+" "})).length<=Wn)return Pe;if(null!=Oe&&(Ke=JSON.parse(Wt),Oe=void 0),"object"==typeof Ke&&null!==Ke){if(ls=ci+lt,In=[],Re=0,Array.isArray(Ke))for(me="[",Ye="]",Wn=Ke.length;Re<Wn;Re++)In.push(qt(Ke[Re],ls,Re===Wn-1?0:1)||"null");else for(me="{",Ye="}",Wn=(us=Object.keys(Ke)).length;Re<Wn;Re++)Li=us[Re],go=JSON.stringify(Li)+": ",void 0!==(rt=qt(Ke[Li],ls,go.length+(Re===Wn-1?0:1)))&&In.push(go+rt);if(In.length>0)return[me,lt+In.join(",\n"+ls),Ye].join("\n"+ci)}return Wt}(nt,"",0)}}},Pi=>{Pi(Pi.s=121)}]);